nohup: ignoring input
2020-12-15 02:06:07.772886: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-15 02:07:40,389 - train_supervised_bert_with_dsp.py - INFO - running train_supervised_bert_with_dsp.py --pretrain_path /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext --pooler entity --metric micro_f1 --dataset test-policy --dropout_rate 0.1 --compress_seq --only_test --dsp_preprocessed --use_attention --adv fgm --loss dice --dice_alpha 0.6 --batch_size 12 --lr 1e-5 --bert_lr 1e-5 --weight_decay 0 --warmup_step 0 --max_length 256 --max_dsp_path_length 10 --max_epoch 20 --dsp_tool ltp --optimizer adam --use_sampler
2020-12-15 02:07:40,414 - train_supervised_bert_with_dsp.py - INFO - Arguments:
2020-12-15 02:07:40,419 - train_supervised_bert_with_dsp.py - INFO - pretrain_path: /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext
2020-12-15 02:07:40,423 - train_supervised_bert_with_dsp.py - INFO - ckpt: test-policy/bert_entity_ltp_dsp_dice_fgm_attention_cat
2020-12-15 02:07:40,427 - train_supervised_bert_with_dsp.py - INFO - pooler: entity
2020-12-15 02:07:40,432 - train_supervised_bert_with_dsp.py - INFO - only_test: True
2020-12-15 02:07:40,436 - train_supervised_bert_with_dsp.py - INFO - mask_entity: False
2020-12-15 02:07:40,440 - train_supervised_bert_with_dsp.py - INFO - use_sampler: True
2020-12-15 02:07:40,444 - train_supervised_bert_with_dsp.py - INFO - use_attention: True
2020-12-15 02:07:40,449 - train_supervised_bert_with_dsp.py - INFO - embed_entity_type: False
2020-12-15 02:07:40,453 - train_supervised_bert_with_dsp.py - INFO - adv: fgm
2020-12-15 02:07:40,457 - train_supervised_bert_with_dsp.py - INFO - loss: dice
2020-12-15 02:07:40,461 - train_supervised_bert_with_dsp.py - INFO - dsp_tool: ltp
2020-12-15 02:07:40,465 - train_supervised_bert_with_dsp.py - INFO - metric: micro_f1
2020-12-15 02:07:40,469 - train_supervised_bert_with_dsp.py - INFO - dataset: test-policy
2020-12-15 02:07:40,472 - train_supervised_bert_with_dsp.py - INFO - train_file: /home/liujian/github/AIPolicy/input/benchmark/relation/test-policy/test-policy_train.txt
2020-12-15 02:07:40,475 - train_supervised_bert_with_dsp.py - INFO - val_file: /home/liujian/github/AIPolicy/input/benchmark/relation/test-policy/test-policy_val.txt
2020-12-15 02:07:40,479 - train_supervised_bert_with_dsp.py - INFO - test_file: /home/liujian/github/AIPolicy/input/benchmark/relation/test-policy/test-policy_test.txt
2020-12-15 02:07:40,482 - train_supervised_bert_with_dsp.py - INFO - rel2id_file: /home/liujian/github/AIPolicy/input/benchmark/relation/test-policy/test-policy_rel2id.json
2020-12-15 02:07:40,485 - train_supervised_bert_with_dsp.py - INFO - compress_seq: True
2020-12-15 02:07:40,489 - train_supervised_bert_with_dsp.py - INFO - dsp_preprocessed: True
2020-12-15 02:07:40,493 - train_supervised_bert_with_dsp.py - INFO - dice_alpha: 0.6
2020-12-15 02:07:40,496 - train_supervised_bert_with_dsp.py - INFO - dropout_rate: 0.1
2020-12-15 02:07:40,499 - train_supervised_bert_with_dsp.py - INFO - batch_size: 12
2020-12-15 02:07:40,503 - train_supervised_bert_with_dsp.py - INFO - lr: 1e-05
2020-12-15 02:07:40,506 - train_supervised_bert_with_dsp.py - INFO - bert_lr: 1e-05
2020-12-15 02:07:40,510 - train_supervised_bert_with_dsp.py - INFO - optimizer: adam
2020-12-15 02:07:40,513 - train_supervised_bert_with_dsp.py - INFO - max_grad_norm: 5.0
2020-12-15 02:07:40,516 - train_supervised_bert_with_dsp.py - INFO - weight_decay: 0.0
2020-12-15 02:07:40,520 - train_supervised_bert_with_dsp.py - INFO - warmup_step: 0
2020-12-15 02:07:40,523 - train_supervised_bert_with_dsp.py - INFO - max_length: 256
2020-12-15 02:07:40,526 - train_supervised_bert_with_dsp.py - INFO - max_dsp_path_length: 10
2020-12-15 02:07:40,529 - train_supervised_bert_with_dsp.py - INFO - max_epoch: 20
2020-12-15 02:07:40,545 - root - INFO - Loading BERT pre-trained checkpoint.
2020-12-15 02:10:10,571 - root - INFO - we have added 3 tokens ['“', '”', '—']
2020-12-15 02:13:38,886 - root - INFO - parsed 500 sentences for DSP path
2020-12-15 02:13:39,801 - root - INFO - parsed 1000 sentences for DSP path
2020-12-15 02:13:40,688 - root - INFO - parsed 1500 sentences for DSP path
2020-12-15 02:13:41,699 - root - INFO - parsed 2000 sentences for DSP path
2020-12-15 02:13:55,924 - root - INFO - parsed 2500 sentences for DSP path
2020-12-15 02:14:15,198 - root - INFO - parsed 3000 sentences for DSP path
2020-12-15 02:14:34,608 - root - INFO - parsed 3500 sentences for DSP path
2020-12-15 02:14:36,052 - root - INFO - Loaded sentence RE dataset /home/liujian/github/AIPolicy/input/benchmark/relation/test-policy/test-policy_test.txt with 3509 lines and 13 relations.
2020-12-15 02:15:17,594 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 20, acc: 0.4125, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-12-15 02:15:45,526 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 40, acc: 0.4188, micro_p: 0.0075, micro_r: 0.0625, micro_f1: 0.0134
2020-12-15 02:16:13,157 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 60, acc: 0.4083, micro_p: 0.0098, micro_r: 0.0784, micro_f1: 0.0174
2020-12-15 02:16:40,801 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 80, acc: 0.4135, micro_p: 0.0112, micro_r: 0.0833, micro_f1: 0.0197
2020-12-15 02:17:08,807 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 100, acc: 0.4075, micro_p: 0.0103, micro_r: 0.0814, micro_f1: 0.0183
2020-12-15 02:17:36,521 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 120, acc: 0.4000, micro_p: 0.0085, micro_r: 0.0636, micro_f1: 0.0150
2020-12-15 02:18:03,935 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 140, acc: 0.3917, micro_p: 0.0072, micro_r: 0.0530, micro_f1: 0.0127
2020-12-15 02:18:31,373 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 160, acc: 0.3922, micro_p: 0.0072, micro_r: 0.0556, micro_f1: 0.0127
2020-12-15 02:18:58,652 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 180, acc: 0.3931, micro_p: 0.0064, micro_r: 0.0494, micro_f1: 0.0113
2020-12-15 02:19:26,339 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 200, acc: 0.3921, micro_p: 0.0065, micro_r: 0.0474, micro_f1: 0.0114
2020-12-15 02:19:53,780 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 220, acc: 0.3917, micro_p: 0.0072, micro_r: 0.0516, micro_f1: 0.0127
2020-12-15 02:20:21,285 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 240, acc: 0.3882, micro_p: 0.0066, micro_r: 0.0478, micro_f1: 0.0116
2020-12-15 02:20:48,250 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 260, acc: 0.3888, micro_p: 0.0061, micro_r: 0.0453, micro_f1: 0.0107
2020-12-15 02:21:15,183 - train_supervised_bert_with_dsp.py - INFO - Evaluation...steps: 280, acc: 0.3911, micro_p: 0.0057, micro_r: 0.0418, micro_f1: 0.0100
2020-12-15 02:21:32,693 - train_supervised_bert_with_dsp.py - INFO - Test set results:
2020-12-15 02:21:32,703 - train_supervised_bert_with_dsp.py - INFO - Accuracy: 0.3921345112567683
2020-12-15 02:21:32,707 - train_supervised_bert_with_dsp.py - INFO - Micro precision: 0.005469915464942815
2020-12-15 02:21:32,710 - train_supervised_bert_with_dsp.py - INFO - Micro recall: 0.039711191335740074
2020-12-15 02:21:32,714 - train_supervised_bert_with_dsp.py - INFO - Micro F1: 0.009615384615384616
