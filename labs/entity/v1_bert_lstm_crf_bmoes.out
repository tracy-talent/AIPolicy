nohup: ignoring input
2020-10-27 16:26:13.695832: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-10-27 16:26:15 - INFO - train_bert_crf.py - running train_bert_crf.py --pretrain_path /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext --metric micro_f1 --dataset policy --tagscheme bmoes --use_lstm --use_crf --batch_size 16 --lr 1e-3 --bert_lr 3e-5 --weight_decay 0 --warmup_step 0 --max_length 256 --max_epoch 20 --optimizer adam
train_bert_crf.py:109: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
  logger.warn("Val file {} does not exist! Use test file instead".format(args.val_file))
2020-10-27 16:26:15 - WARNING - train_bert_crf.py - Val file /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/val.char.bmoes does not exist! Use test file instead
2020-10-27 16:26:15 - INFO - train_bert_crf.py - Arguments:
2020-10-27 16:26:15 - INFO - train_bert_crf.py - pretrain_path: /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext
2020-10-27 16:26:15 - INFO - train_bert_crf.py - ckpt: policy_bmoes_bert_lstm_crf_bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - only_test: False
2020-10-27 16:26:15 - INFO - train_bert_crf.py - use_lstm: True
2020-10-27 16:26:15 - INFO - train_bert_crf.py - use_crf: True
2020-10-27 16:26:15 - INFO - train_bert_crf.py - tagscheme: bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - metric: micro_f1
2020-10-27 16:26:15 - INFO - train_bert_crf.py - dataset: policy
2020-10-27 16:26:15 - INFO - train_bert_crf.py - train_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/train.char.bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - val_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/test.char.bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - test_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/test.char.bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - tag2id_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/tag2id.bmoes
2020-10-27 16:26:15 - INFO - train_bert_crf.py - batch_size: 16
2020-10-27 16:26:15 - INFO - train_bert_crf.py - lr: 0.001
2020-10-27 16:26:15 - INFO - train_bert_crf.py - bert_lr: 3e-05
2020-10-27 16:26:15 - INFO - train_bert_crf.py - optimizer: adam
2020-10-27 16:26:15 - INFO - train_bert_crf.py - weight_decay: 0.0
2020-10-27 16:26:15 - INFO - train_bert_crf.py - warmup_step: 0
2020-10-27 16:26:15 - INFO - train_bert_crf.py - max_length: 256
2020-10-27 16:26:15 - INFO - train_bert_crf.py - max_epoch: 20
2020-10-27 16:27:53 - INFO - train_bert_crf.py - === Epoch 0 train ===
INFO:train_bert_crf.py:=== Epoch 0 train ===
2020-10-27 16:29:36 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 5, loss: 2.8285, acc: 0.0337, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 5, loss: 2.8285, acc: 0.0337, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 16:31:34 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 10, loss: 2.3190, acc: 0.0971, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 10, loss: 2.3190, acc: 0.0971, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 16:33:15 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 15, loss: 2.0286, acc: 0.1244, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 15, loss: 2.0286, acc: 0.1244, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 16:34:48 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 20, loss: 1.8287, acc: 0.1888, micro_p: 0.5098, micro_r: 0.0181, micro_f1: 0.0349
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 20, loss: 1.8287, acc: 0.1888, micro_p: 0.5098, micro_r: 0.0181, micro_f1: 0.0349
2020-10-27 16:36:43 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 25, loss: 1.6498, acc: 0.2446, micro_p: 0.5515, micro_r: 0.0414, micro_f1: 0.0770
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 25, loss: 1.6498, acc: 0.2446, micro_p: 0.5515, micro_r: 0.0414, micro_f1: 0.0770
2020-10-27 16:38:28 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 30, loss: 1.5093, acc: 0.2924, micro_p: 0.6827, micro_r: 0.0855, micro_f1: 0.1520
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 30, loss: 1.5093, acc: 0.2924, micro_p: 0.6827, micro_r: 0.0855, micro_f1: 0.1520
2020-10-27 16:39:18 - INFO - train_bert_crf.py - === Epoch 0 val ===
INFO:train_bert_crf.py:=== Epoch 0 val ===
2020-10-27 16:40:25 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.6602836879432624, 'micro_p': 0.7881619937694704, 'micro_r': 0.44778761061946903, 'micro_f1': 0.5711060948081264}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.6602836879432624, 'micro_p': 0.7881619937694704, 'micro_r': 0.44778761061946903, 'micro_f1': 0.5711060948081264}.
2020-10-27 16:40:25 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.5711060948081264 / 0
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.5711060948081264 / 0
2020-10-27 16:40:25 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 16:41:05 - INFO - train_bert_crf.py - === Epoch 1 train ===
INFO:train_bert_crf.py:=== Epoch 1 train ===
2020-10-27 16:42:15 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 35, loss: 0.5744, acc: 0.6097, micro_p: 0.7456, micro_r: 0.4146, micro_f1: 0.5329
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 35, loss: 0.5744, acc: 0.6097, micro_p: 0.7456, micro_r: 0.4146, micro_f1: 0.5329
2020-10-27 16:43:56 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 40, loss: 0.4864, acc: 0.7012, micro_p: 0.8165, micro_r: 0.4819, micro_f1: 0.6061
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 40, loss: 0.4864, acc: 0.7012, micro_p: 0.8165, micro_r: 0.4819, micro_f1: 0.6061
2020-10-27 16:45:44 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 45, loss: 0.4689, acc: 0.7185, micro_p: 0.8351, micro_r: 0.5100, micro_f1: 0.6332
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 45, loss: 0.4689, acc: 0.7185, micro_p: 0.8351, micro_r: 0.5100, micro_f1: 0.6332
2020-10-27 16:47:39 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 50, loss: 0.4603, acc: 0.7398, micro_p: 0.8326, micro_r: 0.5512, micro_f1: 0.6633
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 50, loss: 0.4603, acc: 0.7398, micro_p: 0.8326, micro_r: 0.5512, micro_f1: 0.6633
2020-10-27 16:49:30 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 55, loss: 0.4434, acc: 0.7475, micro_p: 0.8287, micro_r: 0.5751, micro_f1: 0.6790
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 55, loss: 0.4434, acc: 0.7475, micro_p: 0.8287, micro_r: 0.5751, micro_f1: 0.6790
2020-10-27 16:51:35 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 60, loss: 0.4388, acc: 0.7490, micro_p: 0.8266, micro_r: 0.5773, micro_f1: 0.6798
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 60, loss: 0.4388, acc: 0.7490, micro_p: 0.8266, micro_r: 0.5773, micro_f1: 0.6798
2020-10-27 16:53:08 - INFO - train_bert_crf.py - === Epoch 1 val ===
INFO:train_bert_crf.py:=== Epoch 1 val ===
2020-10-27 16:54:14 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8361702127659575, 'micro_p': 0.8702460850111857, 'micro_r': 0.6884955752212389, 'micro_f1': 0.7687747035573123}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8361702127659575, 'micro_p': 0.8702460850111857, 'micro_r': 0.6884955752212389, 'micro_f1': 0.7687747035573123}.
2020-10-27 16:54:14 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.7687747035573123 / 0.5711060948081264
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.7687747035573123 / 0.5711060948081264
2020-10-27 16:54:14 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 16:54:56 - INFO - train_bert_crf.py - === Epoch 2 train ===
INFO:train_bert_crf.py:=== Epoch 2 train ===
2020-10-27 16:55:20 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 65, loss: 0.1564, acc: 0.9217, micro_p: 0.9231, micro_r: 0.8000, micro_f1: 0.8571
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 65, loss: 0.1564, acc: 0.9217, micro_p: 0.9231, micro_r: 0.8000, micro_f1: 0.8571
2020-10-27 16:57:07 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 70, loss: 0.2312, acc: 0.8718, micro_p: 0.8580, micro_r: 0.7552, micro_f1: 0.8033
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 70, loss: 0.2312, acc: 0.8718, micro_p: 0.8580, micro_r: 0.7552, micro_f1: 0.8033
2020-10-27 16:58:47 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 75, loss: 0.2069, acc: 0.8792, micro_p: 0.8530, micro_r: 0.7608, micro_f1: 0.8043
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 75, loss: 0.2069, acc: 0.8792, micro_p: 0.8530, micro_r: 0.7608, micro_f1: 0.8043
2020-10-27 17:00:30 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 80, loss: 0.1996, acc: 0.8740, micro_p: 0.8610, micro_r: 0.7566, micro_f1: 0.8054
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 80, loss: 0.1996, acc: 0.8740, micro_p: 0.8610, micro_r: 0.7566, micro_f1: 0.8054
2020-10-27 17:02:24 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 85, loss: 0.2070, acc: 0.8671, micro_p: 0.8654, micro_r: 0.7425, micro_f1: 0.7993
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 85, loss: 0.2070, acc: 0.8671, micro_p: 0.8654, micro_r: 0.7425, micro_f1: 0.7993
2020-10-27 17:04:17 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 90, loss: 0.2121, acc: 0.8689, micro_p: 0.8726, micro_r: 0.7503, micro_f1: 0.8068
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 90, loss: 0.2121, acc: 0.8689, micro_p: 0.8726, micro_r: 0.7503, micro_f1: 0.8068
2020-10-27 17:06:07 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 95, loss: 0.2131, acc: 0.8665, micro_p: 0.8682, micro_r: 0.7482, micro_f1: 0.8038
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 95, loss: 0.2131, acc: 0.8665, micro_p: 0.8682, micro_r: 0.7482, micro_f1: 0.8038
2020-10-27 17:06:30 - INFO - train_bert_crf.py - === Epoch 2 val ===
INFO:train_bert_crf.py:=== Epoch 2 val ===
2020-10-27 17:07:37 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.874468085106383, 'micro_p': 0.8543307086614174, 'micro_r': 0.768141592920354, 'micro_f1': 0.8089468779123952}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.874468085106383, 'micro_p': 0.8543307086614174, 'micro_r': 0.768141592920354, 'micro_f1': 0.8089468779123952}.
2020-10-27 17:07:37 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8089468779123952 / 0.7687747035573123
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8089468779123952 / 0.7687747035573123
2020-10-27 17:07:37 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:08:21 - INFO - train_bert_crf.py - === Epoch 3 train ===
INFO:train_bert_crf.py:=== Epoch 3 train ===
2020-10-27 17:09:52 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 100, loss: 0.1292, acc: 0.9105, micro_p: 0.8940, micro_r: 0.8241, micro_f1: 0.8576
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 100, loss: 0.1292, acc: 0.9105, micro_p: 0.8940, micro_r: 0.8241, micro_f1: 0.8576
2020-10-27 17:11:40 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 105, loss: 0.1361, acc: 0.9101, micro_p: 0.9003, micro_r: 0.8140, micro_f1: 0.8550
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 105, loss: 0.1361, acc: 0.9101, micro_p: 0.9003, micro_r: 0.8140, micro_f1: 0.8550
2020-10-27 17:13:30 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 110, loss: 0.1319, acc: 0.9149, micro_p: 0.8989, micro_r: 0.8253, micro_f1: 0.8605
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 110, loss: 0.1319, acc: 0.9149, micro_p: 0.8989, micro_r: 0.8253, micro_f1: 0.8605
2020-10-27 17:15:20 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 115, loss: 0.1293, acc: 0.9218, micro_p: 0.9041, micro_r: 0.8364, micro_f1: 0.8689
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 115, loss: 0.1293, acc: 0.9218, micro_p: 0.9041, micro_r: 0.8364, micro_f1: 0.8689
2020-10-27 17:17:06 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 120, loss: 0.1230, acc: 0.9208, micro_p: 0.9116, micro_r: 0.8351, micro_f1: 0.8717
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 120, loss: 0.1230, acc: 0.9208, micro_p: 0.9116, micro_r: 0.8351, micro_f1: 0.8717
2020-10-27 17:18:52 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 125, loss: 0.1302, acc: 0.9221, micro_p: 0.9086, micro_r: 0.8393, micro_f1: 0.8726
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 125, loss: 0.1302, acc: 0.9221, micro_p: 0.9086, micro_r: 0.8393, micro_f1: 0.8726
2020-10-27 17:20:02 - INFO - train_bert_crf.py - === Epoch 3 val ===
INFO:train_bert_crf.py:=== Epoch 3 val ===
2020-10-27 17:21:08 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8677304964539007, 'micro_p': 0.8954918032786885, 'micro_r': 0.7734513274336283, 'micro_f1': 0.8300094966761633}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8677304964539007, 'micro_p': 0.8954918032786885, 'micro_r': 0.7734513274336283, 'micro_f1': 0.8300094966761633}.
2020-10-27 17:21:08 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8300094966761633 / 0.8089468779123952
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8300094966761633 / 0.8089468779123952
2020-10-27 17:21:08 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:21:53 - INFO - train_bert_crf.py - === Epoch 4 train ===
INFO:train_bert_crf.py:=== Epoch 4 train ===
2020-10-27 17:22:36 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 130, loss: 0.0630, acc: 0.9477, micro_p: 0.9573, micro_r: 0.8682, micro_f1: 0.9106
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 130, loss: 0.0630, acc: 0.9477, micro_p: 0.9573, micro_r: 0.8682, micro_f1: 0.9106
2020-10-27 17:24:25 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 135, loss: 0.0844, acc: 0.9481, micro_p: 0.9342, micro_r: 0.8659, micro_f1: 0.8987
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 135, loss: 0.0844, acc: 0.9481, micro_p: 0.9342, micro_r: 0.8659, micro_f1: 0.8987
2020-10-27 17:26:28 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 140, loss: 0.0948, acc: 0.9389, micro_p: 0.9240, micro_r: 0.8521, micro_f1: 0.8866
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 140, loss: 0.0948, acc: 0.9389, micro_p: 0.9240, micro_r: 0.8521, micro_f1: 0.8866
2020-10-27 17:28:08 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 145, loss: 0.0957, acc: 0.9414, micro_p: 0.9270, micro_r: 0.8618, micro_f1: 0.8932
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 145, loss: 0.0957, acc: 0.9414, micro_p: 0.9270, micro_r: 0.8618, micro_f1: 0.8932
202020-10-27 17:40:12 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 150, loss: 0.0992, acc: 0.9417, micro_p: 0.9265, micro_r: 0.8822, micro_f1: 0.9038
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 150, loss: 0.0992, acc: 0.9417, micro_p: 0.9265, micro_r: 0.8822, micro_f1: 0.9038
2020-10-27 17:55:48 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 155, loss: 0.0927, acc: 0.9435, micro_p: 0.9337, micro_r: 0.8881, micro_f1: 0.9103
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 155, loss: 0.0927, acc: 0.9435, micro_p: 0.9337, micro_r: 0.8881, micro_f1: 0.9103
2020-10-27 18:15:13 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 160, loss: 0.0939, acc: 0.9441, micro_p: 0.9331, micro_r: 0.8871, micro_f1: 0.9095
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 160, loss: 0.0939, acc: 0.9441, micro_p: 0.9331, micro_r: 0.8871, micro_f1: 0.9095
2020-10-27 18:17:08 - INFO - train_bert_crf.py - === Epoch 4 val ===
INFO:train_bert_crf.py:=== Epoch 4 val ===
2020-10-27 18:25:49 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8815602836879433, 'micro_p': 0.8590476190476191, 'micro_r': 0.7982300884955752, 'micro_f1': 0.8275229357798164}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8815602836879433, 'micro_p': 0.8590476190476191, 'micro_r': 0.7982300884955752, 'micro_f1': 0.8275229357798164}.
2020-10-27 18:25:49 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8275229357798164 / 0.8003629764065334
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8275229357798164 / 0.8003629764065334
2020-10-27 18:25:49 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 18:26:18 - INFO - train_bert_crf.py - === Epoch 5 train ===
INFO:train_bert_crf.py:=== Epoch 5 train ===
2020-10-27 18:46:50 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 165, loss: 0.0432, acc: 0.9662, micro_p: 0.9910, micro_r: 0.9118, micro_f1: 0.9498
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 165, loss: 0.0432, acc: 0.9662, micro_p: 0.9910, micro_r: 0.9118, micro_f1: 0.9498
2020-10-27 19:03:16 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 170, loss: 0.0450, acc: 0.9649, micro_p: 0.9827, micro_r: 0.9191, micro_f1: 0.9498
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 170, loss: 0.0450, acc: 0.9649, micro_p: 0.9827, micro_r: 0.9191, micro_f1: 0.9498
2020-10-27 19:23:27 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 175, loss: 0.0484, acc: 0.9667, micro_p: 0.9726, micro_r: 0.9187, micro_f1: 0.9449
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 175, loss: 0.0484, acc: 0.9667, micro_p: 0.9726, micro_r: 0.9187, micro_f1: 0.9449
2020-10-27 19:44:05 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 180, loss: 0.0542, acc: 0.9599, micro_p: 0.9674, micro_r: 0.9179, micro_f1: 0.9420
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 180, loss: 0.0542, acc: 0.9599, micro_p: 0.9674, micro_r: 0.9179, micro_f1: 0.9420
2020-10-27 20:05:15 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 185, loss: 0.0671, acc: 0.9583, micro_p: 0.9547, micro_r: 0.9112, micro_f1: 0.9324
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 185, loss: 0.0671, acc: 0.9583, micro_p: 0.9547, micro_r: 0.9112, micro_f1: 0.9324
2020-10-27 20:26:12 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 190, loss: 0.0676, acc: 0.9569, micro_p: 0.9501, micro_r: 0.9062, micro_f1: 0.9276
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 190, loss: 0.0676, acc: 0.9569, micro_p: 0.9501, micro_r: 0.9062, micro_f1: 0.9276
2020-10-27 20:34:10 - INFO - train_bert_crf.py - === Epoch 5 val ===
INFO:train_bert_crf.py:=== Epoch 5 val ===
2020-10-27 20:43:17 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8801418439716312, 'micro_p': 0.8538899430740038, 'micro_r': 0.7964601769911505, 'micro_f1': 0.8241758241758242}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8801418439716312, 'micro_p': 0.8538899430740038, 'micro_r': 0.7964601769911505, 'micro_f1': 0.8241758241758242}.
2020-10-27 20:43:17 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8241758241758242 / 0.8275229357798164
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8241758241758242 / 0.8275229357798164
2020-10-27 20:43:18 - INFO - train_bert_crf.py - === Epoch 6 train ===
INFO:train_bert_crf.py:=== Epoch 6 train ===
2020-10-27 20:49:28 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 195, loss: 0.0641, acc: 0.9700, micro_p: 0.9749, micro_r: 0.9510, micro_f1: 0.9628
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 195, loss: 0.0641, acc: 0.9700, micro_p: 0.9749, micro_r: 0.9510, micro_f1: 0.9628
2020-10-27 20:50:23 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 200, loss: 0.0582, acc: 0.9747, micro_p: 0.9643, micro_r: 0.9500, micro_f1: 0.9571
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 200, loss: 0.0582, acc: 0.9747, micro_p: 0.9643, micro_r: 0.9500, micro_f1: 0.9571
2020-10-27 20:50:54 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 205, loss: 0.0722, acc: 0.9596, micro_p: 0.9495, micro_r: 0.9272, micro_f1: 0.9382
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 205, loss: 0.0722, acc: 0.9596, micro_p: 0.9495, micro_r: 0.9272, micro_f1: 0.9382
2020-10-27 20:51:24 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 210, loss: 0.0678, acc: 0.9627, micro_p: 0.9497, micro_r: 0.9260, micro_f1: 0.9377
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 210, loss: 0.0678, acc: 0.9627, micro_p: 0.9497, micro_r: 0.9260, micro_f1: 0.9377
2020-10-27 20:52:00 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 215, loss: 0.0667, acc: 0.9622, micro_p: 0.9542, micro_r: 0.9212, micro_f1: 0.9374
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 215, loss: 0.0667, acc: 0.9622, micro_p: 0.9542, micro_r: 0.9212, micro_f1: 0.9374
2020-10-27 20:52:30 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 220, loss: 0.0605, acc: 0.9643, micro_p: 0.9572, micro_r: 0.9211, micro_f1: 0.9388
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 220, loss: 0.0605, acc: 0.9643, micro_p: 0.9572, micro_r: 0.9211, micro_f1: 0.9388
2020-10-27 20:53:00 - INFO - train_bert_crf.py - === Epoch 6 val ===
INFO:train_bert_crf.py:=== Epoch 6 val ===
2020-10-27 20:53:15 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8971631205673759, 'micro_p': 0.8550185873605948, 'micro_r': 0.8141592920353983, 'micro_f1': 0.8340888485947416}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8971631205673759, 'micro_p': 0.8550185873605948, 'micro_r': 0.8141592920353983, 'micro_f1': 0.8340888485947416}.
2020-10-27 20:53:15 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8340888485947416 / 0.8275229357798164
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8340888485947416 / 0.8275229357798164
2020-10-27 20:53:15 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 20:53:17 - INFO - train_bert_crf.py - === Epoch 7 train ===
INFO:train_bert_crf.py:=== Epoch 7 train ===
2020-10-27 20:53:23 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 225, loss: 0.0132, acc: 0.9939, micro_p: 0.9833, micro_r: 0.9672, micro_f1: 0.9752
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 225, loss: 0.0132, acc: 0.9939, micro_p: 0.9833, micro_r: 0.9672, micro_f1: 0.9752
2020-10-27 20:54:09 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 230, loss: 0.0447, acc: 0.9763, micro_p: 0.9646, micro_r: 0.9430, micro_f1: 0.9537
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 230, loss: 0.0447, acc: 0.9763, micro_p: 0.9646, micro_r: 0.9430, micro_f1: 0.9537
2020-10-27 20:54:37 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 235, loss: 0.0345, acc: 0.9802, micro_p: 0.9737, micro_r: 0.9534, micro_f1: 0.9635
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 235, loss: 0.0345, acc: 0.9802, micro_p: 0.9737, micro_r: 0.9534, micro_f1: 0.9635
2020-10-27 20:55:07 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 240, loss: 0.0341, acc: 0.9819, micro_p: 0.9738, micro_r: 0.9540, micro_f1: 0.9638
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 240, loss: 0.0341, acc: 0.9819, micro_p: 0.9738, micro_r: 0.9540, micro_f1: 0.9638
2020-10-27 20:55:37 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 245, loss: 0.0324, acc: 0.9810, micro_p: 0.9730, micro_r: 0.9544, micro_f1: 0.9636
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 245, loss: 0.0324, acc: 0.9810, micro_p: 0.9730, micro_r: 0.9544, micro_f1: 0.9636
2020-10-27 20:56:07 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 250, loss: 0.0330, acc: 0.9815, micro_p: 0.9731, micro_r: 0.9542, micro_f1: 0.9636
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 250, loss: 0.0330, acc: 0.9815, micro_p: 0.9731, micro_r: 0.9542, micro_f1: 0.9636
2020-10-27 20:56:35 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 255, loss: 0.0338, acc: 0.9816, micro_p: 0.9719, micro_r: 0.9539, micro_f1: 0.9628
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 255, loss: 0.0338, acc: 0.9816, micro_p: 0.9719, micro_r: 0.9539, micro_f1: 0.9628
2020-10-27 20:56:43 - INFO - train_bert_crf.py - === Epoch 7 val ===
INFO:train_bert_crf.py:=== Epoch 7 val ===
2020-10-27 20:57:00 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8897163120567376, 'micro_p': 0.8555758683729433, 'micro_r': 0.8283185840707965, 'micro_f1': 0.841726618705036}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8897163120567376, 'micro_p': 0.8555758683729433, 'micro_r': 0.8283185840707965, 'micro_f1': 0.841726618705036}.
2020-10-27 20:57:00 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.841726618705036 / 0.8340888485947416
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.841726618705036 / 0.8340888485947416
2020-10-27 20:57:00 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 20:57:02 - INFO - train_bert_crf.py - === Epoch 8 train ===
INFO:train_bert_crf.py:=== Epoch 8 train ===
2020-10-27 20:57:29 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 260, loss: 0.0451, acc: 0.9750, micro_p: 0.9696, micro_r: 0.9503, micro_f1: 0.9599
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 260, loss: 0.0451, acc: 0.9750, micro_p: 0.9696, micro_r: 0.9503, micro_f1: 0.9599
2020-10-27 20:58:00 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 265, loss: 0.0377, acc: 0.9817, micro_p: 0.9782, micro_r: 0.9662, micro_f1: 0.9721
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 265, loss: 0.0377, acc: 0.9817, micro_p: 0.9782, micro_r: 0.9662, micro_f1: 0.9721
2020-10-27 20:58:26 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 270, loss: 0.0321, acc: 0.9863, micro_p: 0.9778, micro_r: 0.9727, micro_f1: 0.9752
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 270, loss: 0.0321, acc: 0.9863, micro_p: 0.9778, micro_r: 0.9727, micro_f1: 0.9752
2020-10-27 20:59:02 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 275, loss: 0.0327, acc: 0.9827, micro_p: 0.9696, micro_r: 0.9594, micro_f1: 0.9644
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 275, loss: 0.0327, acc: 0.9827, micro_p: 0.9696, micro_r: 0.9594, micro_f1: 0.9644
2020-10-27 20:59:39 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 280, loss: 0.0307, acc: 0.9826, micro_p: 0.9745, micro_r: 0.9602, micro_f1: 0.9673
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 280, loss: 0.0307, acc: 0.9826, micro_p: 0.9745, micro_r: 0.9602, micro_f1: 0.9673
2020-10-27 21:00:10 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 285, loss: 0.0281, acc: 0.9840, micro_p: 0.9755, micro_r: 0.9621, micro_f1: 0.9688
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 285, loss: 0.0281, acc: 0.9840, micro_p: 0.9755, micro_r: 0.9621, micro_f1: 0.9688
2020-10-27 21:00:26 - INFO - train_bert_crf.py - === Epoch 8 val ===
INFO:train_bert_crf.py:=== Epoch 8 val ===
2020-10-27 21:00:40 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9085106382978724, 'micro_p': 0.8440860215053764, 'micro_r': 0.8336283185840708, 'micro_f1': 0.8388245770258237}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9085106382978724, 'micro_p': 0.8440860215053764, 'micro_r': 0.8336283185840708, 'micro_f1': 0.8388245770258237}.
2020-10-27 21:00:40 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8388245770258237 / 0.841726618705036
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8388245770258237 / 0.841726618705036
2020-10-27 21:00:40 - INFO - train_bert_crf.py - === Epoch 9 train ===
INFO:train_bert_crf.py:=== Epoch 9 train ===
2020-10-27 21:00:54 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 290, loss: 0.0121, acc: 0.9966, micro_p: 0.9939, micro_r: 0.9878, micro_f1: 0.9908
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 290, loss: 0.0121, acc: 0.9966, micro_p: 0.9939, micro_r: 0.9878, micro_f1: 0.9908
2020-10-27 21:01:31 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 295, loss: 0.0188, acc: 0.9912, micro_p: 0.9744, micro_r: 0.9744, micro_f1: 0.9744
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 295, loss: 0.0188, acc: 0.9912, micro_p: 0.9744, micro_r: 0.9744, micro_f1: 0.9744
2020-10-27 21:01:58 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 300, loss: 0.0162, acc: 0.9918, micro_p: 0.9821, micro_r: 0.9745, micro_f1: 0.9783
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 300, loss: 0.0162, acc: 0.9918, micro_p: 0.9821, micro_r: 0.9745, micro_f1: 0.9783
2020-10-27 21:02:32 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 305, loss: 0.0171, acc: 0.9908, micro_p: 0.9822, micro_r: 0.9728, micro_f1: 0.9775
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 305, loss: 0.0171, acc: 0.9908, micro_p: 0.9822, micro_r: 0.9728, micro_f1: 0.9775
2020-10-27 21:03:07 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 310, loss: 0.0205, acc: 0.9861, micro_p: 0.9735, micro_r: 0.9668, micro_f1: 0.9702
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 310, loss: 0.0205, acc: 0.9861, micro_p: 0.9735, micro_r: 0.9668, micro_f1: 0.9702
2020-10-27 21:03:33 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 315, loss: 0.0281, acc: 0.9856, micro_p: 0.9736, micro_r: 0.9651, micro_f1: 0.9693
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 315, loss: 0.0281, acc: 0.9856, micro_p: 0.9736, micro_r: 0.9651, micro_f1: 0.9693
2020-10-27 21:03:59 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 320, loss: 0.0274, acc: 0.9860, micro_p: 0.9731, micro_r: 0.9658, micro_f1: 0.9694
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 320, loss: 0.0274, acc: 0.9860, micro_p: 0.9731, micro_r: 0.9658, micro_f1: 0.9694
2020-10-27 21:04:02 - INFO - train_bert_crf.py - === Epoch 9 val ===
INFO:train_bert_crf.py:=== Epoch 9 val ===
2020-10-27 21:04:16 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9017730496453901, 'micro_p': 0.8476702508960573, 'micro_r': 0.8371681415929203, 'micro_f1': 0.8423864648263579}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9017730496453901, 'micro_p': 0.8476702508960573, 'micro_r': 0.8371681415929203, 'micro_f1': 0.8423864648263579}.
2020-10-27 21:04:16 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8423864648263579 / 0.841726618705036
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8423864648263579 / 0.841726618705036
2020-10-27 21:04:16 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 21:04:19 - INFO - train_bert_crf.py - === Epoch 10 train ===
INFO:train_bert_crf.py:=== Epoch 10 train ===
2020-10-27 21:04:54 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 325, loss: 0.0271, acc: 0.9901, micro_p: 0.9658, micro_r: 0.9688, micro_f1: 0.9673
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 325, loss: 0.0271, acc: 0.9901, micro_p: 0.9658, micro_r: 0.9688, micro_f1: 0.9673
2020-10-27 21:05:29 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 330, loss: 0.0294, acc: 0.9795, micro_p: 0.9653, micro_r: 0.9495, micro_f1: 0.9573
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 330, loss: 0.0294, acc: 0.9795, micro_p: 0.9653, micro_r: 0.9495, micro_f1: 0.9573
2020-10-27 21:06:03 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 335, loss: 0.0272, acc: 0.9827, micro_p: 0.9737, micro_r: 0.9597, micro_f1: 0.9667
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 335, loss: 0.0272, acc: 0.9827, micro_p: 0.9737, micro_r: 0.9597, micro_f1: 0.9667
2020-10-27 21:06:44 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 340, loss: 0.0279, acc: 0.9839, micro_p: 0.9729, micro_r: 0.9616, micro_f1: 0.9672
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 340, loss: 0.0279, acc: 0.9839, micro_p: 0.9729, micro_r: 0.9616, micro_f1: 0.9672
2020-10-27 21:07:15 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 345, loss: 0.0263, acc: 0.9855, micro_p: 0.9755, micro_r: 0.9626, micro_f1: 0.9690
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 345, loss: 0.0263, acc: 0.9855, micro_p: 0.9755, micro_r: 0.9626, micro_f1: 0.9690
2020-10-27 21:07:44 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 350, loss: 0.0256, acc: 0.9853, micro_p: 0.9774, micro_r: 0.9638, micro_f1: 0.9706
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 350, loss: 0.0256, acc: 0.9853, micro_p: 0.9774, micro_r: 0.9638, micro_f1: 0.9706
2020-10-27 21:07:57 - INFO - train_bert_crf.py - === Epoch 10 val ===
INFO:train_bert_crf.py:=== Epoch 10 val ===
2020-10-27 21:08:11 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9099290780141844, 'micro_p': 0.8403508771929824, 'micro_r': 0.8477876106194691, 'micro_f1': 0.8440528634361233}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9099290780141844, 'micro_p': 0.8403508771929824, 'micro_r': 0.8477876106194691, 'micro_f1': 0.8440528634361233}.
2020-10-27 21:08:11 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8440528634361233 / 0.8423864648263579
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8440528634361233 / 0.8423864648263579
2020-10-27 21:08:11 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 21:08:13 - INFO - train_bert_crf.py - === Epoch 11 train ===
INFO:train_bert_crf.py:=== Epoch 11 train ===
2020-10-27 21:08:37 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 355, loss: 0.0149, acc: 0.9919, micro_p: 0.9780, micro_r: 0.9867, micro_f1: 0.9823
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 355, loss: 0.0149, acc: 0.9919, micro_p: 0.9780, micro_r: 0.9867, micro_f1: 0.9823
2020-10-27 21:09:04 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 360, loss: 0.0185, acc: 0.9909, micro_p: 0.9805, micro_r: 0.9875, micro_f1: 0.9840
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 360, loss: 0.0185, acc: 0.9909, micro_p: 0.9805, micro_r: 0.9875, micro_f1: 0.9840
2020-10-27 21:09:34 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 365, loss: 0.0176, acc: 0.9923, micro_p: 0.9803, micro_r: 0.9846, micro_f1: 0.9824
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 365, loss: 0.0176, acc: 0.9923, micro_p: 0.9803, micro_r: 0.9846, micro_f1: 0.9824
2020-10-27 21:10:07 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 370, loss: 0.0165, acc: 0.9904, micro_p: 0.9802, micro_r: 0.9810, micro_f1: 0.9806
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 370, loss: 0.0165, acc: 0.9904, micro_p: 0.9802, micro_r: 0.9810, micro_f1: 0.9806
2020-10-27 21:10:36 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 375, loss: 0.0179, acc: 0.9890, micro_p: 0.9773, micro_r: 0.9761, micro_f1: 0.9767
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 375, loss: 0.0179, acc: 0.9890, micro_p: 0.9773, micro_r: 0.9761, micro_f1: 0.9767
2020-10-27 21:11:05 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 380, loss: 0.0176, acc: 0.9892, micro_p: 0.9804, micro_r: 0.9779, micro_f1: 0.9792
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 380, loss: 0.0176, acc: 0.9892, micro_p: 0.9804, micro_r: 0.9779, micro_f1: 0.9792
2020-10-27 21:11:38 - INFO - train_bert_crf.py - === Epoch 11 val ===
INFO:train_bert_crf.py:=== Epoch 11 val ===
2020-10-27 21:11:53 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8736059479553904, 'micro_r': 0.831858407079646, 'micro_f1': 0.8522212148685404}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8736059479553904, 'micro_r': 0.831858407079646, 'micro_f1': 0.8522212148685404}.
2020-10-27 21:11:53 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8522212148685404 / 0.8440528634361233
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8522212148685404 / 0.8440528634361233
2020-10-27 21:11:53 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 21:11:55 - INFO - train_bert_crf.py - === Epoch 12 train ===
INFO:train_bert_crf.py:=== Epoch 12 train ===
2020-10-27 21:12:02 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 385, loss: 0.0043, acc: 1.0000, micro_p: 1.0000, micro_r: 1.0000, micro_f1: 1.0000
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 385, loss: 0.0043, acc: 1.0000, micro_p: 1.0000, micro_r: 1.0000, micro_f1: 1.0000
2020-10-27 21:12:37 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 390, loss: 0.0102, acc: 0.9948, micro_p: 0.9912, micro_r: 0.9868, micro_f1: 0.9890
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 390, loss: 0.0102, acc: 0.9948, micro_p: 0.9912, micro_r: 0.9868, micro_f1: 0.9890
2020-10-27 21:13:10 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 395, loss: 0.0085, acc: 0.9958, micro_p: 0.9940, micro_r: 0.9892, micro_f1: 0.9916
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 395, loss: 0.0085, acc: 0.9958, micro_p: 0.9940, micro_r: 0.9892, micro_f1: 0.9916
2020-10-27 21:13:47 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 400, loss: 0.0114, acc: 0.9929, micro_p: 0.9829, micro_r: 0.9837, micro_f1: 0.9833
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 400, loss: 0.0114, acc: 0.9929, micro_p: 0.9829, micro_r: 0.9837, micro_f1: 0.9833
2020-10-27 21:14:23 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 405, loss: 0.0136, acc: 0.9933, micro_p: 0.9835, micro_r: 0.9848, micro_f1: 0.9842
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 405, loss: 0.0136, acc: 0.9933, micro_p: 0.9835, micro_r: 0.9848, micro_f1: 0.9842
2020-10-27 21:14:52 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 410, loss: 0.0129, acc: 0.9932, micro_p: 0.9853, micro_r: 0.9848, micro_f1: 0.9850
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 410, loss: 0.0129, acc: 0.9932, micro_p: 0.9853, micro_r: 0.9848, micro_f1: 0.9850
2020-10-27 21:15:22 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 415, loss: 0.0121, acc: 0.9933, micro_p: 0.9852, micro_r: 0.9852, micro_f1: 0.9852
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 415, loss: 0.0121, acc: 0.9933, micro_p: 0.9852, micro_r: 0.9852, micro_f1: 0.9852
2020-10-27 21:15:30 - INFO - train_bert_crf.py - === Epoch 12 val ===
INFO:train_bert_crf.py:=== Epoch 12 val ===
2020-10-27 21:15:47 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8936170212765957, 'micro_p': 0.8670411985018727, 'micro_r': 0.8194690265486726, 'micro_f1': 0.8425841674249317}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8936170212765957, 'micro_p': 0.8670411985018727, 'micro_r': 0.8194690265486726, 'micro_f1': 0.8425841674249317}.
2020-10-27 21:15:47 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8425841674249317 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8425841674249317 / 0.8522212148685404
2020-10-27 21:15:47 - INFO - train_bert_crf.py - === Epoch 13 train ===
INFO:train_bert_crf.py:=== Epoch 13 train ===
2020-10-27 21:16:19 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 420, loss: 0.0066, acc: 0.9940, micro_p: 0.9865, micro_r: 0.9832, micro_f1: 0.9849
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 420, loss: 0.0066, acc: 0.9940, micro_p: 0.9865, micro_r: 0.9832, micro_f1: 0.9849
2020-10-27 21:16:47 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 425, loss: 0.0062, acc: 0.9947, micro_p: 0.9886, micro_r: 0.9869, micro_f1: 0.9878
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 425, loss: 0.0062, acc: 0.9947, micro_p: 0.9886, micro_r: 0.9869, micro_f1: 0.9878
2020-10-27 21:17:20 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 430, loss: 0.0061, acc: 0.9953, micro_p: 0.9902, micro_r: 0.9873, micro_f1: 0.9887
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 430, loss: 0.0061, acc: 0.9953, micro_p: 0.9902, micro_r: 0.9873, micro_f1: 0.9887
2020-10-27 21:17:58 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 435, loss: 0.0090, acc: 0.9927, micro_p: 0.9887, micro_r: 0.9866, micro_f1: 0.9877
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 435, loss: 0.0090, acc: 0.9927, micro_p: 0.9887, micro_r: 0.9866, micro_f1: 0.9877
2020-10-27 21:18:29 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 440, loss: 0.0084, acc: 0.9935, micro_p: 0.9892, micro_r: 0.9876, micro_f1: 0.9884
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 440, loss: 0.0084, acc: 0.9935, micro_p: 0.9892, micro_r: 0.9876, micro_f1: 0.9884
2020-10-27 21:18:59 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 445, loss: 0.0078, acc: 0.9939, micro_p: 0.9894, micro_r: 0.9880, micro_f1: 0.9887
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 445, loss: 0.0078, acc: 0.9939, micro_p: 0.9894, micro_r: 0.9880, micro_f1: 0.9887
2020-10-27 21:19:18 - INFO - train_bert_crf.py - === Epoch 13 val ===
INFO:train_bert_crf.py:=== Epoch 13 val ===
2020-10-27 21:19:33 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8836879432624114, 'micro_p': 0.8604206500956023, 'micro_r': 0.7964601769911505, 'micro_f1': 0.8272058823529411}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8836879432624114, 'micro_p': 0.8604206500956023, 'micro_r': 0.7964601769911505, 'micro_f1': 0.8272058823529411}.
2020-10-27 21:19:33 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8272058823529411 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8272058823529411 / 0.8522212148685404
2020-10-27 21:19:33 - INFO - train_bert_crf.py - === Epoch 14 train ===
INFO:train_bert_crf.py:=== Epoch 14 train ===
2020-10-27 21:19:52 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 450, loss: 0.0177, acc: 0.9873, micro_p: 0.9951, micro_r: 0.9761, micro_f1: 0.9855
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 450, loss: 0.0177, acc: 0.9873, micro_p: 0.9951, micro_r: 0.9761, micro_f1: 0.9855
2020-10-27 21:20:23 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 455, loss: 0.0144, acc: 0.9893, micro_p: 0.9923, micro_r: 0.9772, micro_f1: 0.9847
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 455, loss: 0.0144, acc: 0.9893, micro_p: 0.9923, micro_r: 0.9772, micro_f1: 0.9847
2020-10-27 21:20:53 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 460, loss: 0.0202, acc: 0.9858, micro_p: 0.9908, micro_r: 0.9708, micro_f1: 0.9807
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 460, loss: 0.0202, acc: 0.9858, micro_p: 0.9908, micro_r: 0.9708, micro_f1: 0.9807
2020-10-27 21:21:29 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 465, loss: 0.0205, acc: 0.9899, micro_p: 0.9881, micro_r: 0.9787, micro_f1: 0.9834
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 465, loss: 0.0205, acc: 0.9899, micro_p: 0.9881, micro_r: 0.9787, micro_f1: 0.9834
2020-10-27 21:21:55 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 470, loss: 0.0226, acc: 0.9882, micro_p: 0.9861, micro_r: 0.9774, micro_f1: 0.9817
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 470, loss: 0.0226, acc: 0.9882, micro_p: 0.9861, micro_r: 0.9774, micro_f1: 0.9817
2020-10-27 21:22:26 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 475, loss: 0.0220, acc: 0.9892, micro_p: 0.9853, micro_r: 0.9792, micro_f1: 0.9822
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 475, loss: 0.0220, acc: 0.9892, micro_p: 0.9853, micro_r: 0.9792, micro_f1: 0.9822
2020-10-27 21:22:57 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 480, loss: 0.0250, acc: 0.9889, micro_p: 0.9835, micro_r: 0.9773, micro_f1: 0.9804
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 480, loss: 0.0250, acc: 0.9889, micro_p: 0.9835, micro_r: 0.9773, micro_f1: 0.9804
2020-10-27 21:23:01 - INFO - train_bert_crf.py - === Epoch 14 val ===
INFO:train_bert_crf.py:=== Epoch 14 val ===
2020-10-27 21:23:15 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8964539007092198, 'micro_p': 0.8388888888888889, 'micro_r': 0.8017699115044248, 'micro_f1': 0.8199095022624435}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8964539007092198, 'micro_p': 0.8388888888888889, 'micro_r': 0.8017699115044248, 'micro_f1': 0.8199095022624435}.
2020-10-27 21:23:15 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8199095022624435 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8199095022624435 / 0.8522212148685404
2020-10-27 21:23:15 - INFO - train_bert_crf.py - === Epoch 15 train ===
INFO:train_bert_crf.py:=== Epoch 15 train ===
2020-10-27 21:23:57 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 485, loss: 0.0371, acc: 0.9788, micro_p: 0.9723, micro_r: 0.9507, micro_f1: 0.9614
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 485, loss: 0.0371, acc: 0.9788, micro_p: 0.9723, micro_r: 0.9507, micro_f1: 0.9614
2020-10-27 21:24:28 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 490, loss: 0.0266, acc: 0.9844, micro_p: 0.9812, micro_r: 0.9605, micro_f1: 0.9707
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 490, loss: 0.0266, acc: 0.9844, micro_p: 0.9812, micro_r: 0.9605, micro_f1: 0.9707
2020-10-27 21:25:01 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 495, loss: 0.0249, acc: 0.9857, micro_p: 0.9783, micro_r: 0.9660, micro_f1: 0.9721
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 495, loss: 0.0249, acc: 0.9857, micro_p: 0.9783, micro_r: 0.9660, micro_f1: 0.9721
2020-10-27 21:25:28 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 500, loss: 0.0236, acc: 0.9881, micro_p: 0.9813, micro_r: 0.9699, micro_f1: 0.9755
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 500, loss: 0.0236, acc: 0.9881, micro_p: 0.9813, micro_r: 0.9699, micro_f1: 0.9755
2020-10-27 21:25:58 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 505, loss: 0.0226, acc: 0.9873, micro_p: 0.9821, micro_r: 0.9686, micro_f1: 0.9753
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 505, loss: 0.0226, acc: 0.9873, micro_p: 0.9821, micro_r: 0.9686, micro_f1: 0.9753
2020-10-27 21:26:27 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 510, loss: 0.0221, acc: 0.9883, micro_p: 0.9822, micro_r: 0.9708, micro_f1: 0.9765
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 510, loss: 0.0221, acc: 0.9883, micro_p: 0.9822, micro_r: 0.9708, micro_f1: 0.9765
2020-10-27 21:26:42 - INFO - train_bert_crf.py - === Epoch 15 val ===
INFO:train_bert_crf.py:=== Epoch 15 val ===
2020-10-27 21:26:57 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9017730496453901, 'micro_p': 0.8197879858657244, 'micro_r': 0.8212389380530973, 'micro_f1': 0.8205128205128205}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9017730496453901, 'micro_p': 0.8197879858657244, 'micro_r': 0.8212389380530973, 'micro_f1': 0.8205128205128205}.
2020-10-27 21:26:57 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8205128205128205 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8205128205128205 / 0.8522212148685404
2020-10-27 21:26:57 - INFO - train_bert_crf.py - === Epoch 16 train ===
INFO:train_bert_crf.py:=== Epoch 16 train ===
2020-10-27 21:27:23 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 515, loss: 0.0086, acc: 0.9984, micro_p: 0.9959, micro_r: 0.9918, micro_f1: 0.9938
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 515, loss: 0.0086, acc: 0.9984, micro_p: 0.9959, micro_r: 0.9918, micro_f1: 0.9938
2020-10-27 21:27:56 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 520, loss: 0.0120, acc: 0.9958, micro_p: 0.9892, micro_r: 0.9805, micro_f1: 0.9848
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 520, loss: 0.0120, acc: 0.9958, micro_p: 0.9892, micro_r: 0.9805, micro_f1: 0.9848
2020-10-27 21:28:22 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 525, loss: 0.0135, acc: 0.9927, micro_p: 0.9887, micro_r: 0.9809, micro_f1: 0.9848
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 525, loss: 0.0135, acc: 0.9927, micro_p: 0.9887, micro_r: 0.9809, micro_f1: 0.9848
2020-10-27 21:28:54 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 530, loss: 0.0150, acc: 0.9942, micro_p: 0.9879, micro_r: 0.9839, micro_f1: 0.9859
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 530, loss: 0.0150, acc: 0.9942, micro_p: 0.9879, micro_r: 0.9839, micro_f1: 0.9859
2020-10-27 21:29:41 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 535, loss: 0.0184, acc: 0.9936, micro_p: 0.9843, micro_r: 0.9837, micro_f1: 0.9840
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 535, loss: 0.0184, acc: 0.9936, micro_p: 0.9843, micro_r: 0.9837, micro_f1: 0.9840
2020-10-27 21:30:15 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 540, loss: 0.0207, acc: 0.9890, micro_p: 0.9845, micro_r: 0.9762, micro_f1: 0.9803
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 540, loss: 0.0207, acc: 0.9890, micro_p: 0.9845, micro_r: 0.9762, micro_f1: 0.9803
2020-10-27 21:30:43 - INFO - train_bert_crf.py - === Epoch 16 val ===
INFO:train_bert_crf.py:=== Epoch 16 val ===
2020-10-27 21:31:00 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8925531914893617, 'micro_p': 0.8354430379746836, 'micro_r': 0.8176991150442477, 'micro_f1': 0.8264758497316638}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8925531914893617, 'micro_p': 0.8354430379746836, 'micro_r': 0.8176991150442477, 'micro_f1': 0.8264758497316638}.
2020-10-27 21:31:00 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8264758497316638 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8264758497316638 / 0.8522212148685404
2020-10-27 21:31:00 - INFO - train_bert_crf.py - === Epoch 17 train ===
INFO:train_bert_crf.py:=== Epoch 17 train ===
2020-10-27 21:31:07 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 545, loss: 0.0535, acc: 0.9745, micro_p: 0.9438, micro_r: 0.9545, micro_f1: 0.9492
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 545, loss: 0.0535, acc: 0.9745, micro_p: 0.9438, micro_r: 0.9545, micro_f1: 0.9492
2020-10-27 21:31:43 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 550, loss: 0.0379, acc: 0.9804, micro_p: 0.9690, micro_r: 0.9640, micro_f1: 0.9665
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 550, loss: 0.0379, acc: 0.9804, micro_p: 0.9690, micro_r: 0.9640, micro_f1: 0.9665
2020-10-27 21:32:19 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 555, loss: 0.0279, acc: 0.9849, micro_p: 0.9728, micro_r: 0.9715, micro_f1: 0.9722
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 555, loss: 0.0279, acc: 0.9849, micro_p: 0.9728, micro_r: 0.9715, micro_f1: 0.9722
2020-10-27 21:33:03 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 560, loss: 0.0265, acc: 0.9823, micro_p: 0.9764, micro_r: 0.9671, micro_f1: 0.9717
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 560, loss: 0.0265, acc: 0.9823, micro_p: 0.9764, micro_r: 0.9671, micro_f1: 0.9717
2020-10-27 21:33:46 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 565, loss: 0.0266, acc: 0.9840, micro_p: 0.9793, micro_r: 0.9698, micro_f1: 0.9745
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 565, loss: 0.0266, acc: 0.9840, micro_p: 0.9793, micro_r: 0.9698, micro_f1: 0.9745
2020-10-27 21:34:18 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 570, loss: 0.0241, acc: 0.9857, micro_p: 0.9823, micro_r: 0.9714, micro_f1: 0.9768
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 570, loss: 0.0241, acc: 0.9857, micro_p: 0.9823, micro_r: 0.9714, micro_f1: 0.9768
2020-10-27 21:34:50 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 575, loss: 0.0278, acc: 0.9850, micro_p: 0.9818, micro_r: 0.9690, micro_f1: 0.9754
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 575, loss: 0.0278, acc: 0.9850, micro_p: 0.9818, micro_r: 0.9690, micro_f1: 0.9754
2020-10-27 21:34:58 - INFO - train_bert_crf.py - === Epoch 17 val ===
INFO:train_bert_crf.py:=== Epoch 17 val ===
2020-10-27 21:35:13 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8597449908925319, 'micro_r': 0.8353982300884956, 'micro_f1': 0.8473967684021543}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8597449908925319, 'micro_r': 0.8353982300884956, 'micro_f1': 0.8473967684021543}.
2020-10-27 21:35:13 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8473967684021543 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8473967684021543 / 0.8522212148685404
2020-10-27 21:35:13 - INFO - train_bert_crf.py - === Epoch 18 train ===
INFO:train_bert_crf.py:=== Epoch 18 train ===
2020-10-27 21:35:45 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 580, loss: 0.0111, acc: 0.9972, micro_p: 0.9898, micro_r: 0.9898, micro_f1: 0.9898
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 580, loss: 0.0111, acc: 0.9972, micro_p: 0.9898, micro_r: 0.9898, micro_f1: 0.9898
2020-10-27 21:36:15 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 585, loss: 0.0156, acc: 0.9953, micro_p: 0.9844, micro_r: 0.9859, micro_f1: 0.9852
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 585, loss: 0.0156, acc: 0.9953, micro_p: 0.9844, micro_r: 0.9859, micro_f1: 0.9852
2020-10-27 21:36:50 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 590, loss: 0.0229, acc: 0.9844, micro_p: 0.9863, micro_r: 0.9720, micro_f1: 0.9791
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 590, loss: 0.0229, acc: 0.9844, micro_p: 0.9863, micro_r: 0.9720, micro_f1: 0.9791
2020-10-27 21:37:21 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 595, loss: 0.0241, acc: 0.9854, micro_p: 0.9857, micro_r: 0.9704, micro_f1: 0.9780
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 595, loss: 0.0241, acc: 0.9854, micro_p: 0.9857, micro_r: 0.9704, micro_f1: 0.9780
2020-10-27 21:37:52 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 600, loss: 0.0234, acc: 0.9869, micro_p: 0.9830, micro_r: 0.9711, micro_f1: 0.9770
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 600, loss: 0.0234, acc: 0.9869, micro_p: 0.9830, micro_r: 0.9711, micro_f1: 0.9770
2020-10-27 21:38:22 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 605, loss: 0.0238, acc: 0.9857, micro_p: 0.9827, micro_r: 0.9716, micro_f1: 0.9771
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 605, loss: 0.0238, acc: 0.9857, micro_p: 0.9827, micro_r: 0.9716, micro_f1: 0.9771
2020-10-27 21:38:42 - INFO - train_bert_crf.py - === Epoch 18 val ===
INFO:train_bert_crf.py:=== Epoch 18 val ===
2020-10-27 21:38:58 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8929078014184397, 'micro_p': 0.850909090909091, 'micro_r': 0.8283185840707965, 'micro_f1': 0.8394618834080717}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8929078014184397, 'micro_p': 0.850909090909091, 'micro_r': 0.8283185840707965, 'micro_f1': 0.8394618834080717}.
2020-10-27 21:38:58 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8394618834080717 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8394618834080717 / 0.8522212148685404
2020-10-27 21:38:58 - INFO - train_bert_crf.py - === Epoch 19 train ===
INFO:train_bert_crf.py:=== Epoch 19 train ===
2020-10-27 21:39:17 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 610, loss: 0.0098, acc: 0.9951, micro_p: 0.9930, micro_r: 0.9861, micro_f1: 0.9895
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 610, loss: 0.0098, acc: 0.9951, micro_p: 0.9930, micro_r: 0.9861, micro_f1: 0.9895
2020-10-27 21:39:55 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 615, loss: 0.0092, acc: 0.9936, micro_p: 0.9945, micro_r: 0.9835, micro_f1: 0.9890
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 615, loss: 0.0092, acc: 0.9936, micro_p: 0.9945, micro_r: 0.9835, micro_f1: 0.9890
2020-10-27 21:40:30 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 620, loss: 0.0107, acc: 0.9941, micro_p: 0.9927, micro_r: 0.9835, micro_f1: 0.9881
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 620, loss: 0.0107, acc: 0.9941, micro_p: 0.9927, micro_r: 0.9835, micro_f1: 0.9881
2020-10-27 21:41:01 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 625, loss: 0.0163, acc: 0.9929, micro_p: 0.9900, micro_r: 0.9801, micro_f1: 0.9850
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 625, loss: 0.0163, acc: 0.9929, micro_p: 0.9900, micro_r: 0.9801, micro_f1: 0.9850
2020-10-27 21:41:29 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 630, loss: 0.0199, acc: 0.9900, micro_p: 0.9878, micro_r: 0.9752, micro_f1: 0.9814
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 630, loss: 0.0199, acc: 0.9900, micro_p: 0.9878, micro_r: 0.9752, micro_f1: 0.9814
2020-10-27 21:41:55 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 635, loss: 0.0177, acc: 0.9906, micro_p: 0.9887, micro_r: 0.9777, micro_f1: 0.9832
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 635, loss: 0.0177, acc: 0.9906, micro_p: 0.9887, micro_r: 0.9777, micro_f1: 0.9832
2020-10-27 21:42:21 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 640, loss: 0.0173, acc: 0.9914, micro_p: 0.9897, micro_r: 0.9791, micro_f1: 0.9844
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 640, loss: 0.0173, acc: 0.9914, micro_p: 0.9897, micro_r: 0.9791, micro_f1: 0.9844
2020-10-27 21:42:25 - INFO - train_bert_crf.py - === Epoch 19 val ===
INFO:train_bert_crf.py:=== Epoch 19 val ===
2020-10-27 21:42:40 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8992907801418439, 'micro_p': 0.8414414414414414, 'micro_r': 0.8265486725663717, 'micro_f1': 0.8339285714285715}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8992907801418439, 'micro_p': 0.8414414414414414, 'micro_r': 0.8265486725663717, 'micro_f1': 0.8339285714285715}.
2020-10-27 21:42:40 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8339285714285715 / 0.8522212148685404
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8339285714285715 / 0.8522212148685404
2020-10-27 21:42:40 - INFO - train_bert_crf.py - Best micro_f1 on val set: 0.852221
INFO:train_bert_crf.py:Best micro_f1 on val set: 0.852221
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8736059479553904, 'micro_r': 0.831858407079646, 'micro_f1': 0.8522212148685404}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8978723404255319, 'micro_p': 0.8736059479553904, 'micro_r': 0.831858407079646, 'micro_f1': 0.8522212148685404}.
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Test set results:
INFO:train_bert_crf.py:Test set results:
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Accuracy: 0.8978723404255319
INFO:train_bert_crf.py:Accuracy: 0.8978723404255319
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Micro precision: 0.8736059479553904
INFO:train_bert_crf.py:Micro precision: 0.8736059479553904
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Micro recall: 0.831858407079646
INFO:train_bert_crf.py:Micro recall: 0.831858407079646
2020-10-27 21:42:56 - INFO - train_bert_crf.py - Micro F1: 0.8522212148685404
INFO:train_bert_crf.py:Micro F1: 0.8522212148685404
