nohup: ignoring input
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 1.6498, span_acc: 0.6058, attr_start_acc: 0.0025, attr_end_acc: 0.0076, span_micro_p: 0.3043, span_micro_r: 0.0354, span_micro_f1: 0.0633, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.2627, span_acc: 0.7591, attr_start_acc: 0.0125, attr_end_acc: 0.1793, span_micro_p: 0.6774, span_micro_r: 0.3330, span_micro_f1: 0.4465, micro_p: 0.0789, micro_r: 0.0034, micro_f1: 0.0066
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.0642, span_acc: 0.8159, attr_start_acc: 0.1723, attr_end_acc: 0.3163, span_micro_p: 0.7497, span_micro_r: 0.4701, span_micro_f1: 0.5778, micro_p: 0.7351, micro_r: 0.1039, micro_f1: 0.1821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 0.9348, span_acc: 0.8488, attr_start_acc: 0.3253, attr_end_acc: 0.4380, span_micro_p: 0.8038, span_micro_r: 0.5597, span_micro_f1: 0.6599, micro_p: 0.8073, micro_r: 0.2445, micro_f1: 0.3753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 0.8498, span_acc: 0.8710, attr_start_acc: 0.4202, attr_end_acc: 0.5175, span_micro_p: 0.8347, span_micro_r: 0.6191, span_micro_f1: 0.7109, micro_p: 0.8626, micro_r: 0.3463, micro_f1: 0.4942
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 0.7756, span_acc: 0.8881, attr_start_acc: 0.4825, attr_end_acc: 0.5726, span_micro_p: 0.8584, span_micro_r: 0.6667, span_micro_f1: 0.7505, micro_p: 0.8851, micro_r: 0.4137, micro_f1: 0.5639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 0.7279, span_acc: 0.8975, attr_start_acc: 0.5276, attr_end_acc: 0.6173, span_micro_p: 0.8687, span_micro_r: 0.6939, span_micro_f1: 0.7715, micro_p: 0.8945, micro_r: 0.4605, micro_f1: 0.6080
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 0.6831, span_acc: 0.9040, attr_start_acc: 0.5625, attr_end_acc: 0.6454, span_micro_p: 0.8729, span_micro_r: 0.7116, span_micro_f1: 0.7840, micro_p: 0.9022, micro_r: 0.4964, micro_f1: 0.6404
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 0.6419, span_acc: 0.9118, attr_start_acc: 0.5967, attr_end_acc: 0.6739, span_micro_p: 0.8824, span_micro_r: 0.7347, span_micro_f1: 0.8018, micro_p: 0.9127, micro_r: 0.5334, micro_f1: 0.6733
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 0.6122, span_acc: 0.9174, attr_start_acc: 0.6263, attr_end_acc: 0.6990, span_micro_p: 0.8889, span_micro_r: 0.7513, span_micro_f1: 0.8143, micro_p: 0.9184, micro_r: 0.5661, micro_f1: 0.7005
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 0.5802, span_acc: 0.9228, attr_start_acc: 0.6505, attr_end_acc: 0.7158, span_micro_p: 0.8923, span_micro_r: 0.7647, span_micro_f1: 0.8236, micro_p: 0.9222, micro_r: 0.5904, micro_f1: 0.7199
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 0.5506, span_acc: 0.9282, attr_start_acc: 0.6736, attr_end_acc: 0.7358, span_micro_p: 0.8974, span_micro_r: 0.7800, span_micro_f1: 0.8346, micro_p: 0.9261, micro_r: 0.6171, micro_f1: 0.7407
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 0.5255, span_acc: 0.9322, attr_start_acc: 0.6935, attr_end_acc: 0.7520, span_micro_p: 0.9027, span_micro_r: 0.7928, span_micro_f1: 0.8442, micro_p: 0.9304, micro_r: 0.6395, micro_f1: 0.7580
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 0.5048, span_acc: 0.9348, attr_start_acc: 0.7101, attr_end_acc: 0.7649, span_micro_p: 0.9049, span_micro_r: 0.8006, span_micro_f1: 0.8495, micro_p: 0.9337, micro_r: 0.6564, micro_f1: 0.7708
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 0.4825, span_acc: 0.9378, attr_start_acc: 0.7242, attr_end_acc: 0.7764, span_micro_p: 0.9075, span_micro_r: 0.8088, span_micro_f1: 0.8553, micro_p: 0.9364, micro_r: 0.6728, micro_f1: 0.7830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 0.4635, span_acc: 0.9397, attr_start_acc: 0.7365, attr_end_acc: 0.7856, span_micro_p: 0.9097, span_micro_r: 0.8153, span_micro_f1: 0.8599, micro_p: 0.9386, micro_r: 0.6859, micro_f1: 0.7926
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 0.4428, span_acc: 0.9422, attr_start_acc: 0.7487, attr_end_acc: 0.7955, span_micro_p: 0.9117, span_micro_r: 0.8220, span_micro_f1: 0.8645, micro_p: 0.9389, micro_r: 0.6985, micro_f1: 0.8010
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 0.4225, span_acc: 0.9440, attr_start_acc: 0.7583, attr_end_acc: 0.8039, span_micro_p: 0.9136, span_micro_r: 0.8269, span_micro_f1: 0.8681, micro_p: 0.9410, micro_r: 0.7092, micro_f1: 0.8088
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 0.4064, span_acc: 0.9453, attr_start_acc: 0.7671, attr_end_acc: 0.8115, span_micro_p: 0.9117, span_micro_r: 0.8294, span_micro_f1: 0.8686, micro_p: 0.9385, micro_r: 0.7175, micro_f1: 0.8133
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 0.3886, span_acc: 0.9470, attr_start_acc: 0.7753, attr_end_acc: 0.8187, span_micro_p: 0.9132, span_micro_r: 0.8346, span_micro_f1: 0.8721, micro_p: 0.9386, micro_r: 0.7267, micro_f1: 0.8192
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 0.3731, span_acc: 0.9484, attr_start_acc: 0.7835, attr_end_acc: 0.8255, span_micro_p: 0.9153, span_micro_r: 0.8389, span_micro_f1: 0.8755, micro_p: 0.9404, micro_r: 0.7355, micro_f1: 0.8255
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 0.3598, span_acc: 0.9493, attr_start_acc: 0.7903, attr_end_acc: 0.8314, span_micro_p: 0.9157, span_micro_r: 0.8423, span_micro_f1: 0.8774, micro_p: 0.9415, micro_r: 0.7425, micro_f1: 0.8303
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 0.3428, span_acc: 0.9502, attr_start_acc: 0.7967, attr_end_acc: 0.8367, span_micro_p: 0.9172, span_micro_r: 0.8454, span_micro_f1: 0.8798, micro_p: 0.9427, micro_r: 0.7496, micro_f1: 0.8351
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 0.3297, span_acc: 0.9515, attr_start_acc: 0.8032, attr_end_acc: 0.8423, span_micro_p: 0.9181, span_micro_r: 0.8485, span_micro_f1: 0.8819, micro_p: 0.9427, micro_r: 0.7561, micro_f1: 0.8391
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 0.3138, span_acc: 0.9528, attr_start_acc: 0.8089, attr_end_acc: 0.8472, span_micro_p: 0.9205, span_micro_r: 0.8525, span_micro_f1: 0.8852, micro_p: 0.9444, micro_r: 0.7629, micro_f1: 0.8440
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 0.2984, span_acc: 0.9537, attr_start_acc: 0.8135, attr_end_acc: 0.8518, span_micro_p: 0.9203, span_micro_r: 0.8545, span_micro_f1: 0.8862, micro_p: 0.9434, micro_r: 0.7679, micro_f1: 0.8467
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 0.2830, span_acc: 0.9543, attr_start_acc: 0.8176, attr_end_acc: 0.8562, span_micro_p: 0.9208, span_micro_r: 0.8570, span_micro_f1: 0.8877, micro_p: 0.9437, micro_r: 0.7729, micro_f1: 0.8498
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 0.2693, span_acc: 0.9553, attr_start_acc: 0.8225, attr_end_acc: 0.8600, span_micro_p: 0.9215, span_micro_r: 0.8595, span_micro_f1: 0.8894, micro_p: 0.9441, micro_r: 0.7779, micro_f1: 0.8530
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 0.2544, span_acc: 0.9560, attr_start_acc: 0.8272, attr_end_acc: 0.8636, span_micro_p: 0.9225, span_micro_r: 0.8624, span_micro_f1: 0.8914, micro_p: 0.9447, micro_r: 0.7832, micro_f1: 0.8564
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 0.2399, span_acc: 0.9572, attr_start_acc: 0.8324, attr_end_acc: 0.8673, span_micro_p: 0.9245, span_micro_r: 0.8662, span_micro_f1: 0.8944, micro_p: 0.9464, micro_r: 0.7890, micro_f1: 0.8605
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 0.2245, span_acc: 0.9582, attr_start_acc: 0.8360, attr_end_acc: 0.8702, span_micro_p: 0.9258, span_micro_r: 0.8688, span_micro_f1: 0.8964, micro_p: 0.9474, micro_r: 0.7931, micro_f1: 0.8634
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.02 / 96.37 / 97.11), p: (96.09 / 96.94), r: (95.32000000000001 / 93.88), f1: (95.71 / 95.38)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.3234965352594981, 'span_acc': 0.9802226432970156, 'attr_start_acc': 0.9637096774193549, 'attr_end_acc': 0.9711021505376344, 'span_micro_p': 0.960942760942761, 'span_micro_r': 0.9532398129592519, 'span_micro_f1': 0.9570757880617036, 'micro_p': 0.9694232105628909, 'micro_r': 0.9387617765814267, 'micro_f1': 0.9538461538461539, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9444, 0.9444, 0.9444), 'ORG': (0.9567, 0.9328, 0.9446), 'TITLE': (0.9729, 0.9348, 0.9535), 'EDU': (0.9802, 0.934, 0.9565), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9538461538461539 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.15 / 95.46 / 96.44), p: (95.52000000000001 / 96.93), r: (94.11 / 92.88), f1: (94.81 / 94.86)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.3186668367505823, 'span_acc': 0.9715438950554995, 'attr_start_acc': 0.9546012269938651, 'attr_end_acc': 0.9644171779141104, 'span_micro_p': 0.9551681195516812, 'span_micro_r': 0.9411042944785276, 'span_micro_f1': 0.9480840543881335, 'micro_p': 0.969270166453265, 'micro_r': 0.9288343558282208, 'micro_f1': 0.9486215538847118, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9118, 0.9394, 0.9254), 'ORG': (0.9476, 0.915, 0.931), 'TITLE': (0.9782, 0.9288, 0.9529), 'EDU': (0.9907, 0.9464, 0.968), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9486215538847118 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: -0.1279, span_acc: 0.9509, attr_start_acc: 0.8857, attr_end_acc: 0.9143, span_micro_p: 0.8824, span_micro_r: 0.8571, span_micro_f1: 0.8696, micro_p: 1.0000, micro_r: 0.8286, micro_f1: 0.9062
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: -0.2839, span_acc: 0.9848, attr_start_acc: 0.9690, attr_end_acc: 0.9793, span_micro_p: 0.9556, span_micro_r: 0.9433, span_micro_f1: 0.9494, micro_p: 0.9813, micro_r: 0.9483, micro_f1: 0.9645
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: -0.2842, span_acc: 0.9847, attr_start_acc: 0.9657, attr_end_acc: 0.9718, span_micro_p: 0.9508, span_micro_r: 0.9415, span_micro_f1: 0.9461, micro_p: 0.9696, micro_r: 0.9364, micro_f1: 0.9527
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: -0.3043, span_acc: 0.9855, attr_start_acc: 0.9623, attr_end_acc: 0.9678, span_micro_p: 0.9573, span_micro_r: 0.9461, span_micro_f1: 0.9517, micro_p: 0.9683, micro_r: 0.9341, micro_f1: 0.9509
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: -0.2884, span_acc: 0.9838, attr_start_acc: 0.9648, attr_end_acc: 0.9732, span_micro_p: 0.9586, span_micro_r: 0.9461, span_micro_f1: 0.9523, micro_p: 0.9699, micro_r: 0.9404, micro_f1: 0.9549
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: -0.2875, span_acc: 0.9813, attr_start_acc: 0.9570, attr_end_acc: 0.9713, span_micro_p: 0.9505, span_micro_r: 0.9410, span_micro_f1: 0.9458, micro_p: 0.9614, micro_r: 0.9297, micro_f1: 0.9453
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: -0.3047, span_acc: 0.9813, attr_start_acc: 0.9586, attr_end_acc: 0.9713, span_micro_p: 0.9501, span_micro_r: 0.9411, span_micro_f1: 0.9456, micro_p: 0.9602, micro_r: 0.9304, micro_f1: 0.9450
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: -0.3126, span_acc: 0.9808, attr_start_acc: 0.9608, attr_end_acc: 0.9721, span_micro_p: 0.9514, span_micro_r: 0.9436, span_micro_f1: 0.9475, micro_p: 0.9631, micro_r: 0.9332, micro_f1: 0.9479
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: -0.3219, span_acc: 0.9805, attr_start_acc: 0.9622, attr_end_acc: 0.9724, span_micro_p: 0.9533, span_micro_r: 0.9450, span_micro_f1: 0.9492, micro_p: 0.9640, micro_r: 0.9345, micro_f1: 0.9490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: -0.3350, span_acc: 0.9813, attr_start_acc: 0.9618, attr_end_acc: 0.9720, span_micro_p: 0.9549, span_micro_r: 0.9440, span_micro_f1: 0.9495, micro_p: 0.9655, micro_r: 0.9346, micro_f1: 0.9498
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: -0.3403, span_acc: 0.9823, attr_start_acc: 0.9642, attr_end_acc: 0.9738, span_micro_p: 0.9566, span_micro_r: 0.9473, span_micro_f1: 0.9519, micro_p: 0.9671, micro_r: 0.9387, micro_f1: 0.9527
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: -0.3555, span_acc: 0.9828, attr_start_acc: 0.9647, attr_end_acc: 0.9741, span_micro_p: 0.9576, span_micro_r: 0.9480, span_micro_f1: 0.9528, micro_p: 0.9679, micro_r: 0.9398, micro_f1: 0.9536
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: -0.3656, span_acc: 0.9833, attr_start_acc: 0.9653, attr_end_acc: 0.9743, span_micro_p: 0.9579, span_micro_r: 0.9486, span_micro_f1: 0.9533, micro_p: 0.9683, micro_r: 0.9409, micro_f1: 0.9544
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: -0.3731, span_acc: 0.9835, attr_start_acc: 0.9643, attr_end_acc: 0.9748, span_micro_p: 0.9582, span_micro_r: 0.9483, span_micro_f1: 0.9532, micro_p: 0.9691, micro_r: 0.9409, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: -0.3807, span_acc: 0.9835, attr_start_acc: 0.9639, attr_end_acc: 0.9754, span_micro_p: 0.9583, span_micro_r: 0.9486, span_micro_f1: 0.9534, micro_p: 0.9693, micro_r: 0.9407, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: -0.3919, span_acc: 0.9837, attr_start_acc: 0.9643, attr_end_acc: 0.9755, span_micro_p: 0.9588, span_micro_r: 0.9493, span_micro_f1: 0.9540, micro_p: 0.9704, micro_r: 0.9415, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: -0.3936, span_acc: 0.9836, attr_start_acc: 0.9643, attr_end_acc: 0.9748, span_micro_p: 0.9577, span_micro_r: 0.9490, span_micro_f1: 0.9534, micro_p: 0.9701, micro_r: 0.9411, micro_f1: 0.9554
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: -0.4039, span_acc: 0.9840, attr_start_acc: 0.9656, attr_end_acc: 0.9749, span_micro_p: 0.9585, span_micro_r: 0.9497, span_micro_f1: 0.9541, micro_p: 0.9716, micro_r: 0.9427, micro_f1: 0.9569
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: -0.4034, span_acc: 0.9834, attr_start_acc: 0.9653, attr_end_acc: 0.9752, span_micro_p: 0.9580, span_micro_r: 0.9498, span_micro_f1: 0.9539, micro_p: 0.9708, micro_r: 0.9425, micro_f1: 0.9564
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: -0.4123, span_acc: 0.9836, attr_start_acc: 0.9650, attr_end_acc: 0.9744, span_micro_p: 0.9578, span_micro_r: 0.9492, span_micro_f1: 0.9535, micro_p: 0.9703, micro_r: 0.9418, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: -0.4189, span_acc: 0.9836, attr_start_acc: 0.9649, attr_end_acc: 0.9742, span_micro_p: 0.9580, span_micro_r: 0.9494, span_micro_f1: 0.9537, micro_p: 0.9711, micro_r: 0.9418, micro_f1: 0.9563
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: -0.4289, span_acc: 0.9841, attr_start_acc: 0.9657, attr_end_acc: 0.9744, span_micro_p: 0.9590, span_micro_r: 0.9507, span_micro_f1: 0.9548, micro_p: 0.9715, micro_r: 0.9429, micro_f1: 0.9570
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: -0.4380, span_acc: 0.9843, attr_start_acc: 0.9660, attr_end_acc: 0.9745, span_micro_p: 0.9596, span_micro_r: 0.9516, span_micro_f1: 0.9556, micro_p: 0.9719, micro_r: 0.9434, micro_f1: 0.9574
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: -0.4488, span_acc: 0.9842, attr_start_acc: 0.9650, attr_end_acc: 0.9743, span_micro_p: 0.9592, span_micro_r: 0.9513, span_micro_f1: 0.9552, micro_p: 0.9724, micro_r: 0.9427, micro_f1: 0.9574
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: -0.4464, span_acc: 0.9843, attr_start_acc: 0.9649, attr_end_acc: 0.9748, span_micro_p: 0.9591, span_micro_r: 0.9507, span_micro_f1: 0.9549, micro_p: 0.9724, micro_r: 0.9432, micro_f1: 0.9575
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: -0.4515, span_acc: 0.9837, attr_start_acc: 0.9656, attr_end_acc: 0.9755, span_micro_p: 0.9571, span_micro_r: 0.9509, span_micro_f1: 0.9540, micro_p: 0.9720, micro_r: 0.9435, micro_f1: 0.9575
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: -0.4585, span_acc: 0.9838, attr_start_acc: 0.9661, attr_end_acc: 0.9757, span_micro_p: 0.9569, span_micro_r: 0.9509, span_micro_f1: 0.9539, micro_p: 0.9719, micro_r: 0.9438, micro_f1: 0.9577
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: -0.4628, span_acc: 0.9839, attr_start_acc: 0.9665, attr_end_acc: 0.9761, span_micro_p: 0.9566, span_micro_r: 0.9511, span_micro_f1: 0.9538, micro_p: 0.9716, micro_r: 0.9439, micro_f1: 0.9576
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: -0.4747, span_acc: 0.9841, attr_start_acc: 0.9671, attr_end_acc: 0.9766, span_micro_p: 0.9576, span_micro_r: 0.9521, span_micro_f1: 0.9549, micro_p: 0.9721, micro_r: 0.9450, micro_f1: 0.9584
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: -0.4734, span_acc: 0.9841, attr_start_acc: 0.9672, attr_end_acc: 0.9759, span_micro_p: 0.9576, span_micro_r: 0.9514, span_micro_f1: 0.9545, micro_p: 0.9722, micro_r: 0.9447, micro_f1: 0.9582
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: -0.4834, span_acc: 0.9843, attr_start_acc: 0.9674, attr_end_acc: 0.9759, span_micro_p: 0.9580, span_micro_r: 0.9517, span_micro_f1: 0.9548, micro_p: 0.9720, micro_r: 0.9449, micro_f1: 0.9583
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: -0.4835, span_acc: 0.9841, attr_start_acc: 0.9670, attr_end_acc: 0.9757, span_micro_p: 0.9578, span_micro_r: 0.9511, span_micro_f1: 0.9544, micro_p: 0.9717, micro_r: 0.9443, micro_f1: 0.9578
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.83999999999999 / 97.58 / 97.92), p: (95.58 / 96.34), r: (96.86 / 95.56), f1: (96.22 / 95.95)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.7686679932262676, 'span_acc': 0.9883941260066319, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9791666666666666, 'span_micro_p': 0.955833882663151, 'span_micro_r': 0.9686038744154977, 'span_micro_f1': 0.962176509621765, 'micro_p': 0.9633649932157394, 'micro_r': 0.955585464333782, 'micro_f1': 0.9594594594594593, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9498, 0.9443, 0.947), 'TITLE': (0.9676, 0.9522, 0.9598), 'EDU': (0.9717, 0.9717, 0.9717), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9594594594594593 / 0.9538461538461539
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.39 / 96.75 / 97.3), p: (95.04 / 96.74000000000001), r: (95.28 / 94.6), f1: (95.16 / 95.66)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.8900136970124155, 'span_acc': 0.9838546922300706, 'attr_start_acc': 0.9674846625766871, 'attr_end_acc': 0.9730061349693252, 'span_micro_p': 0.9504283965728274, 'span_micro_r': 0.9527607361963191, 'span_micro_f1': 0.9515931372549019, 'micro_p': 0.9673776662484316, 'micro_r': 0.9460122699386503, 'micro_f1': 0.956575682382134, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9534, 0.9259, 0.9394), 'PRO': (0.9412, 0.9697, 0.9552), 'TITLE': (0.9695, 0.9456, 0.9574), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.956575682382134 / 0.9486215538847118
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: -0.9591, span_acc: 0.9979, attr_start_acc: 0.9870, attr_end_acc: 1.0000, span_micro_p: 0.9872, span_micro_r: 0.9872, span_micro_f1: 0.9872, micro_p: 0.9868, micro_r: 0.9740, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: -0.9190, span_acc: 0.9879, attr_start_acc: 0.9703, attr_end_acc: 0.9745, span_micro_p: 0.9681, span_micro_r: 0.9579, span_micro_f1: 0.9630, micro_p: 0.9780, micro_r: 0.9448, micro_f1: 0.9611
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: -0.7960, span_acc: 0.9847, attr_start_acc: 0.9627, attr_end_acc: 0.9751, span_micro_p: 0.9605, span_micro_r: 0.9518, span_micro_f1: 0.9561, micro_p: 0.9674, micro_r: 0.9422, micro_f1: 0.9546
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: -0.8221, span_acc: 0.9870, attr_start_acc: 0.9662, attr_end_acc: 0.9791, span_micro_p: 0.9631, span_micro_r: 0.9593, span_micro_f1: 0.9612, micro_p: 0.9743, micro_r: 0.9476, micro_f1: 0.9608
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: -0.8268, span_acc: 0.9876, attr_start_acc: 0.9696, attr_end_acc: 0.9815, span_micro_p: 0.9649, span_micro_r: 0.9598, span_micro_f1: 0.9624, micro_p: 0.9726, micro_r: 0.9523, micro_f1: 0.9623
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: -0.8220, span_acc: 0.9884, attr_start_acc: 0.9707, attr_end_acc: 0.9830, span_micro_p: 0.9652, span_micro_r: 0.9634, span_micro_f1: 0.9643, micro_p: 0.9739, micro_r: 0.9541, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: -0.7791, span_acc: 0.9885, attr_start_acc: 0.9708, attr_end_acc: 0.9828, span_micro_p: 0.9666, span_micro_r: 0.9648, span_micro_f1: 0.9657, micro_p: 0.9749, micro_r: 0.9547, micro_f1: 0.9647
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: -0.8061, span_acc: 0.9894, attr_start_acc: 0.9718, attr_end_acc: 0.9836, span_micro_p: 0.9689, span_micro_r: 0.9670, span_micro_f1: 0.9680, micro_p: 0.9774, micro_r: 0.9571, micro_f1: 0.9671
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: -0.8035, span_acc: 0.9878, attr_start_acc: 0.9720, attr_end_acc: 0.9825, span_micro_p: 0.9663, span_micro_r: 0.9647, span_micro_f1: 0.9655, micro_p: 0.9762, micro_r: 0.9560, micro_f1: 0.9660
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: -0.8191, span_acc: 0.9883, attr_start_acc: 0.9722, attr_end_acc: 0.9825, span_micro_p: 0.9684, span_micro_r: 0.9654, span_micro_f1: 0.9669, micro_p: 0.9778, micro_r: 0.9564, micro_f1: 0.9670
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: -0.8272, span_acc: 0.9890, attr_start_acc: 0.9737, attr_end_acc: 0.9838, span_micro_p: 0.9698, span_micro_r: 0.9673, span_micro_f1: 0.9686, micro_p: 0.9791, micro_r: 0.9589, micro_f1: 0.9689
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: -0.8008, span_acc: 0.9885, attr_start_acc: 0.9715, attr_end_acc: 0.9816, span_micro_p: 0.9677, span_micro_r: 0.9648, span_micro_f1: 0.9663, micro_p: 0.9757, micro_r: 0.9554, micro_f1: 0.9654
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: -0.8062, span_acc: 0.9886, attr_start_acc: 0.9720, attr_end_acc: 0.9813, span_micro_p: 0.9681, span_micro_r: 0.9651, span_micro_f1: 0.9666, micro_p: 0.9764, micro_r: 0.9550, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: -0.8180, span_acc: 0.9891, attr_start_acc: 0.9733, attr_end_acc: 0.9826, span_micro_p: 0.9694, span_micro_r: 0.9662, span_micro_f1: 0.9678, micro_p: 0.9776, micro_r: 0.9572, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: -0.8311, span_acc: 0.9893, attr_start_acc: 0.9742, attr_end_acc: 0.9832, span_micro_p: 0.9696, span_micro_r: 0.9669, span_micro_f1: 0.9682, micro_p: 0.9778, micro_r: 0.9584, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: -0.8343, span_acc: 0.9891, attr_start_acc: 0.9745, attr_end_acc: 0.9834, span_micro_p: 0.9685, span_micro_r: 0.9670, span_micro_f1: 0.9677, micro_p: 0.9766, micro_r: 0.9585, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: -0.8273, span_acc: 0.9891, attr_start_acc: 0.9749, attr_end_acc: 0.9832, span_micro_p: 0.9678, span_micro_r: 0.9666, span_micro_f1: 0.9672, micro_p: 0.9759, micro_r: 0.9586, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: -0.8332, span_acc: 0.9891, attr_start_acc: 0.9750, attr_end_acc: 0.9835, span_micro_p: 0.9674, span_micro_r: 0.9667, span_micro_f1: 0.9671, micro_p: 0.9758, micro_r: 0.9587, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: -0.8169, span_acc: 0.9894, attr_start_acc: 0.9752, attr_end_acc: 0.9840, span_micro_p: 0.9676, span_micro_r: 0.9676, span_micro_f1: 0.9676, micro_p: 0.9760, micro_r: 0.9592, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: -0.8234, span_acc: 0.9891, attr_start_acc: 0.9752, attr_end_acc: 0.9833, span_micro_p: 0.9670, span_micro_r: 0.9669, span_micro_f1: 0.9670, micro_p: 0.9762, micro_r: 0.9588, micro_f1: 0.9674
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: -0.8072, span_acc: 0.9885, attr_start_acc: 0.9752, attr_end_acc: 0.9824, span_micro_p: 0.9672, span_micro_r: 0.9667, span_micro_f1: 0.9669, micro_p: 0.9763, micro_r: 0.9584, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: -0.7951, span_acc: 0.9883, attr_start_acc: 0.9757, attr_end_acc: 0.9827, span_micro_p: 0.9674, span_micro_r: 0.9670, span_micro_f1: 0.9672, micro_p: 0.9762, micro_r: 0.9589, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: -0.8063, span_acc: 0.9886, attr_start_acc: 0.9757, attr_end_acc: 0.9832, span_micro_p: 0.9682, span_micro_r: 0.9676, span_micro_f1: 0.9679, micro_p: 0.9768, micro_r: 0.9596, micro_f1: 0.9681
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: -0.8068, span_acc: 0.9887, attr_start_acc: 0.9753, attr_end_acc: 0.9832, span_micro_p: 0.9682, span_micro_r: 0.9674, span_micro_f1: 0.9678, micro_p: 0.9767, micro_r: 0.9591, micro_f1: 0.9678
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: -0.8172, span_acc: 0.9888, attr_start_acc: 0.9758, attr_end_acc: 0.9835, span_micro_p: 0.9679, span_micro_r: 0.9676, span_micro_f1: 0.9677, micro_p: 0.9763, micro_r: 0.9599, micro_f1: 0.9681
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: -0.8227, span_acc: 0.9890, attr_start_acc: 0.9761, attr_end_acc: 0.9838, span_micro_p: 0.9684, span_micro_r: 0.9679, span_micro_f1: 0.9682, micro_p: 0.9766, micro_r: 0.9603, micro_f1: 0.9684
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: -0.8088, span_acc: 0.9889, attr_start_acc: 0.9760, attr_end_acc: 0.9835, span_micro_p: 0.9682, span_micro_r: 0.9679, span_micro_f1: 0.9680, micro_p: 0.9762, micro_r: 0.9599, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: -0.8093, span_acc: 0.9890, attr_start_acc: 0.9758, attr_end_acc: 0.9838, span_micro_p: 0.9685, span_micro_r: 0.9676, span_micro_f1: 0.9680, micro_p: 0.9765, micro_r: 0.9600, micro_f1: 0.9682
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: -0.8071, span_acc: 0.9889, attr_start_acc: 0.9763, attr_end_acc: 0.9839, span_micro_p: 0.9686, span_micro_r: 0.9675, span_micro_f1: 0.9681, micro_p: 0.9766, micro_r: 0.9602, micro_f1: 0.9684
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: -0.8083, span_acc: 0.9890, attr_start_acc: 0.9762, attr_end_acc: 0.9837, span_micro_p: 0.9690, span_micro_r: 0.9676, span_micro_f1: 0.9683, micro_p: 0.9767, micro_r: 0.9602, micro_f1: 0.9684
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: -0.8105, span_acc: 0.9892, attr_start_acc: 0.9763, attr_end_acc: 0.9835, span_micro_p: 0.9695, span_micro_r: 0.9678, span_micro_f1: 0.9687, micro_p: 0.9770, micro_r: 0.9603, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: -0.8096, span_acc: 0.9891, attr_start_acc: 0.9766, attr_end_acc: 0.9836, span_micro_p: 0.9700, span_micro_r: 0.9682, span_micro_f1: 0.9691, micro_p: 0.9772, micro_r: 0.9608, micro_f1: 0.9689
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.85000000000001 / 96.98 / 97.98), p: (96.24000000000001 / 97.38), r: (95.78999999999999 / 95.15), f1: (96.02000000000001 / 96.26)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.7000543123702508, 'span_acc': 0.9885125532922785, 'attr_start_acc': 0.969758064516129, 'attr_end_acc': 0.9798387096774194, 'span_micro_p': 0.9624161073825503, 'span_micro_r': 0.9579158316633266, 'span_micro_f1': 0.9601606963508537, 'micro_p': 0.9738292011019284, 'micro_r': 0.9515477792732167, 'micro_f1': 0.9625595643294759, 'category-p/r/f1': {'PRO': (0.9, 1.0, 0.9474), 'ORG': (0.9608, 0.9405, 0.9505), 'TITLE': (0.979, 0.9449, 0.9616), 'EDU': (0.9904, 0.9717, 0.981), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9625595643294759 / 0.9594594594594593
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.38 / 96.2 / 97.42), p: (96.38 / 97.22), r: (94.85 / 94.54), f1: (95.61 / 95.86)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -1.0034055117541139, 'span_acc': 0.9837537840565086, 'attr_start_acc': 0.9619631901840491, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9638403990024937, 'span_micro_r': 0.9484662576687116, 'span_micro_f1': 0.9560915275200988, 'micro_p': 0.9722397476340694, 'micro_r': 0.945398773006135, 'micro_f1': 0.9586314152410575, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.961, 0.9349, 0.9478), 'TITLE': (0.9744, 0.9365, 0.9551), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9586314152410575 / 0.956575682382134
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.9692, span_acc: 0.9876, attr_start_acc: 0.9739, attr_end_acc: 0.9739, span_micro_p: 0.9737, span_micro_r: 0.9569, span_micro_f1: 0.9652, micro_p: 0.9821, micro_r: 0.9565, micro_f1: 0.9692
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -1.2197, span_acc: 0.9950, attr_start_acc: 0.9828, attr_end_acc: 0.9845, span_micro_p: 0.9879, span_micro_r: 0.9761, span_micro_f1: 0.9820, micro_p: 0.9894, micro_r: 0.9690, micro_f1: 0.9791
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -1.1559, span_acc: 0.9946, attr_start_acc: 0.9770, attr_end_acc: 0.9871, span_micro_p: 0.9844, span_micro_r: 0.9772, span_micro_f1: 0.9808, micro_p: 0.9859, micro_r: 0.9668, micro_f1: 0.9763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -1.1792, span_acc: 0.9952, attr_start_acc: 0.9732, attr_end_acc: 0.9870, span_micro_p: 0.9863, span_micro_r: 0.9789, span_micro_f1: 0.9826, micro_p: 0.9873, micro_r: 0.9643, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -1.1639, span_acc: 0.9948, attr_start_acc: 0.9757, attr_end_acc: 0.9868, span_micro_p: 0.9836, span_micro_r: 0.9764, span_micro_f1: 0.9800, micro_p: 0.9870, micro_r: 0.9646, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -1.1002, span_acc: 0.9932, attr_start_acc: 0.9741, attr_end_acc: 0.9849, span_micro_p: 0.9805, span_micro_r: 0.9725, span_micro_f1: 0.9765, micro_p: 0.9854, micro_r: 0.9615, micro_f1: 0.9733
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -1.1017, span_acc: 0.9929, attr_start_acc: 0.9741, attr_end_acc: 0.9856, span_micro_p: 0.9796, span_micro_r: 0.9728, span_micro_f1: 0.9762, micro_p: 0.9848, micro_r: 0.9622, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -1.1041, span_acc: 0.9933, attr_start_acc: 0.9752, attr_end_acc: 0.9863, span_micro_p: 0.9806, span_micro_r: 0.9734, span_micro_f1: 0.9770, micro_p: 0.9860, micro_r: 0.9643, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -1.0819, span_acc: 0.9935, attr_start_acc: 0.9762, attr_end_acc: 0.9874, span_micro_p: 0.9801, span_micro_r: 0.9744, span_micro_f1: 0.9773, micro_p: 0.9863, micro_r: 0.9658, micro_f1: 0.9759
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: -0.9997, span_acc: 0.9934, attr_start_acc: 0.9756, attr_end_acc: 0.9870, span_micro_p: 0.9801, span_micro_r: 0.9730, span_micro_f1: 0.9765, micro_p: 0.9862, micro_r: 0.9651, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: -0.9260, span_acc: 0.9934, attr_start_acc: 0.9769, attr_end_acc: 0.9874, span_micro_p: 0.9798, span_micro_r: 0.9730, span_micro_f1: 0.9764, micro_p: 0.9867, micro_r: 0.9663, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: -0.8931, span_acc: 0.9933, attr_start_acc: 0.9772, attr_end_acc: 0.9862, span_micro_p: 0.9795, span_micro_r: 0.9737, span_micro_f1: 0.9765, micro_p: 0.9855, micro_r: 0.9658, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: -0.8581, span_acc: 0.9926, attr_start_acc: 0.9771, attr_end_acc: 0.9863, span_micro_p: 0.9798, span_micro_r: 0.9740, span_micro_f1: 0.9769, micro_p: 0.9850, micro_r: 0.9658, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: -0.8489, span_acc: 0.9928, attr_start_acc: 0.9774, attr_end_acc: 0.9861, span_micro_p: 0.9792, span_micro_r: 0.9742, span_micro_f1: 0.9767, micro_p: 0.9842, micro_r: 0.9662, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: -0.8752, span_acc: 0.9932, attr_start_acc: 0.9771, attr_end_acc: 0.9863, span_micro_p: 0.9804, span_micro_r: 0.9755, span_micro_f1: 0.9779, micro_p: 0.9849, micro_r: 0.9664, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: -0.8582, span_acc: 0.9929, attr_start_acc: 0.9777, attr_end_acc: 0.9860, span_micro_p: 0.9799, span_micro_r: 0.9746, span_micro_f1: 0.9772, micro_p: 0.9849, micro_r: 0.9664, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: -0.8203, span_acc: 0.9928, attr_start_acc: 0.9770, attr_end_acc: 0.9856, span_micro_p: 0.9792, span_micro_r: 0.9740, span_micro_f1: 0.9766, micro_p: 0.9842, micro_r: 0.9654, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: -0.8039, span_acc: 0.9928, attr_start_acc: 0.9772, attr_end_acc: 0.9858, span_micro_p: 0.9791, span_micro_r: 0.9733, span_micro_f1: 0.9762, micro_p: 0.9845, micro_r: 0.9659, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: -0.7847, span_acc: 0.9931, attr_start_acc: 0.9780, attr_end_acc: 0.9861, span_micro_p: 0.9799, span_micro_r: 0.9745, span_micro_f1: 0.9772, micro_p: 0.9851, micro_r: 0.9673, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: -0.7760, span_acc: 0.9929, attr_start_acc: 0.9783, attr_end_acc: 0.9862, span_micro_p: 0.9804, span_micro_r: 0.9745, span_micro_f1: 0.9774, micro_p: 0.9855, micro_r: 0.9677, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: -0.7673, span_acc: 0.9927, attr_start_acc: 0.9783, attr_end_acc: 0.9860, span_micro_p: 0.9806, span_micro_r: 0.9745, span_micro_f1: 0.9776, micro_p: 0.9855, micro_r: 0.9679, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: -0.7838, span_acc: 0.9926, attr_start_acc: 0.9785, attr_end_acc: 0.9862, span_micro_p: 0.9802, span_micro_r: 0.9745, span_micro_f1: 0.9773, micro_p: 0.9849, micro_r: 0.9683, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: -0.7561, span_acc: 0.9919, attr_start_acc: 0.9783, attr_end_acc: 0.9856, span_micro_p: 0.9807, span_micro_r: 0.9744, span_micro_f1: 0.9776, micro_p: 0.9852, micro_r: 0.9681, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: -0.7274, span_acc: 0.9920, attr_start_acc: 0.9785, attr_end_acc: 0.9854, span_micro_p: 0.9805, span_micro_r: 0.9745, span_micro_f1: 0.9775, micro_p: 0.9855, micro_r: 0.9683, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: -0.7244, span_acc: 0.9920, attr_start_acc: 0.9791, attr_end_acc: 0.9857, span_micro_p: 0.9801, span_micro_r: 0.9747, span_micro_f1: 0.9774, micro_p: 0.9856, micro_r: 0.9690, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: -0.7476, span_acc: 0.9921, attr_start_acc: 0.9794, attr_end_acc: 0.9856, span_micro_p: 0.9802, span_micro_r: 0.9751, span_micro_f1: 0.9776, micro_p: 0.9855, micro_r: 0.9692, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: -0.7338, span_acc: 0.9922, attr_start_acc: 0.9795, attr_end_acc: 0.9854, span_micro_p: 0.9801, span_micro_r: 0.9751, span_micro_f1: 0.9776, micro_p: 0.9853, micro_r: 0.9690, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: -0.7407, span_acc: 0.9922, attr_start_acc: 0.9800, attr_end_acc: 0.9858, span_micro_p: 0.9799, span_micro_r: 0.9752, span_micro_f1: 0.9775, micro_p: 0.9852, micro_r: 0.9693, micro_f1: 0.9772
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: -0.7556, span_acc: 0.9922, attr_start_acc: 0.9800, attr_end_acc: 0.9858, span_micro_p: 0.9796, span_micro_r: 0.9752, span_micro_f1: 0.9774, micro_p: 0.9850, micro_r: 0.9692, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: -0.7557, span_acc: 0.9922, attr_start_acc: 0.9798, attr_end_acc: 0.9856, span_micro_p: 0.9794, span_micro_r: 0.9751, span_micro_f1: 0.9772, micro_p: 0.9844, micro_r: 0.9689, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: -0.7656, span_acc: 0.9924, attr_start_acc: 0.9800, attr_end_acc: 0.9859, span_micro_p: 0.9799, span_micro_r: 0.9757, span_micro_f1: 0.9778, micro_p: 0.9847, micro_r: 0.9693, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: -0.7670, span_acc: 0.9925, attr_start_acc: 0.9805, attr_end_acc: 0.9861, span_micro_p: 0.9800, span_micro_r: 0.9760, span_micro_f1: 0.9780, micro_p: 0.9844, micro_r: 0.9692, micro_f1: 0.9767
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.65 / 97.38 / 98.19), p: (95.99 / 96.39999999999999), r: (96.06 / 95.42), f1: (96.03 / 95.91)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.6501990440854758, 'span_acc': 0.9864992894362862, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9599465954606141, 'span_micro_r': 0.9605878423513694, 'span_micro_f1': 0.9602671118530884, 'micro_p': 0.9639700883752549, 'micro_r': 0.9542395693135935, 'micro_f1': 0.9590801487994589, 'category-p/r/f1': {'PRO': (0.7727, 0.9444, 0.85), 'ORG': (0.9481, 0.9463, 0.9472), 'TITLE': (0.9718, 0.9493, 0.9604), 'EDU': (0.9903, 0.9623, 0.9761), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9590801487994589 / 0.9625595643294759
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.32 / 96.44 / 96.87), p: (95.24000000000001 / 96.55), r: (94.54 / 94.36), f1: (94.89 / 95.44)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.1316457859375192, 'span_acc': 0.9832492431886983, 'attr_start_acc': 0.9644171779141104, 'attr_end_acc': 0.9687116564417177, 'span_micro_p': 0.9524103831891224, 'span_micro_r': 0.945398773006135, 'span_micro_f1': 0.9488916256157636, 'micro_p': 0.965473948524796, 'micro_r': 0.943558282208589, 'micro_f1': 0.9543903195780329, 'category-p/r/f1': {'PRO': (0.8919, 1.0, 0.9429), 'ORG': (0.954, 0.9367, 0.9453), 'TITLE': (0.9665, 0.9352, 0.9506), 'EDU': (0.9906, 0.9375, 0.9633), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9543903195780329 / 0.9586314152410575
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: -1.2840, span_acc: 0.9967, attr_start_acc: 0.9799, attr_end_acc: 0.9933, span_micro_p: 0.9932, span_micro_r: 0.9800, span_micro_f1: 0.9866, micro_p: 1.0000, micro_r: 0.9732, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: -0.6990, span_acc: 0.9859, attr_start_acc: 0.9824, attr_end_acc: 0.9883, span_micro_p: 0.9747, span_micro_r: 0.9709, span_micro_f1: 0.9728, micro_p: 0.9900, micro_r: 0.9686, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: -0.6277, span_acc: 0.9903, attr_start_acc: 0.9877, attr_end_acc: 0.9922, span_micro_p: 0.9767, span_micro_r: 0.9789, span_micro_f1: 0.9778, micro_p: 0.9875, micro_r: 0.9753, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: -0.7218, span_acc: 0.9925, attr_start_acc: 0.9883, attr_end_acc: 0.9914, span_micro_p: 0.9791, span_micro_r: 0.9814, span_micro_f1: 0.9803, micro_p: 0.9882, micro_r: 0.9758, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: -0.7442, span_acc: 0.9928, attr_start_acc: 0.9859, attr_end_acc: 0.9912, span_micro_p: 0.9831, span_micro_r: 0.9826, span_micro_f1: 0.9829, micro_p: 0.9887, micro_r: 0.9754, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: -0.7763, span_acc: 0.9928, attr_start_acc: 0.9857, attr_end_acc: 0.9903, span_micro_p: 0.9822, span_micro_r: 0.9808, span_micro_f1: 0.9815, micro_p: 0.9879, micro_r: 0.9747, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: -0.8547, span_acc: 0.9932, attr_start_acc: 0.9852, attr_end_acc: 0.9905, span_micro_p: 0.9820, span_micro_r: 0.9801, span_micro_f1: 0.9810, micro_p: 0.9873, micro_r: 0.9739, micro_f1: 0.9805
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: -0.8621, span_acc: 0.9938, attr_start_acc: 0.9857, attr_end_acc: 0.9910, span_micro_p: 0.9834, span_micro_r: 0.9812, span_micro_f1: 0.9823, micro_p: 0.9885, micro_r: 0.9750, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: -0.8971, span_acc: 0.9941, attr_start_acc: 0.9858, attr_end_acc: 0.9908, span_micro_p: 0.9839, span_micro_r: 0.9808, span_micro_f1: 0.9823, micro_p: 0.9880, micro_r: 0.9751, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: -0.9652, span_acc: 0.9943, attr_start_acc: 0.9866, attr_end_acc: 0.9907, span_micro_p: 0.9849, span_micro_r: 0.9814, span_micro_f1: 0.9831, micro_p: 0.9888, micro_r: 0.9763, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: -0.9821, span_acc: 0.9948, attr_start_acc: 0.9870, attr_end_acc: 0.9912, span_micro_p: 0.9857, span_micro_r: 0.9830, span_micro_f1: 0.9843, micro_p: 0.9897, micro_r: 0.9773, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: -0.9713, span_acc: 0.9947, attr_start_acc: 0.9862, attr_end_acc: 0.9904, span_micro_p: 0.9865, span_micro_r: 0.9824, span_micro_f1: 0.9844, micro_p: 0.9904, micro_r: 0.9766, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: -0.9924, span_acc: 0.9948, attr_start_acc: 0.9864, attr_end_acc: 0.9904, span_micro_p: 0.9863, span_micro_r: 0.9823, span_micro_f1: 0.9843, micro_p: 0.9905, micro_r: 0.9768, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: -1.0169, span_acc: 0.9949, attr_start_acc: 0.9863, attr_end_acc: 0.9902, span_micro_p: 0.9867, span_micro_r: 0.9828, span_micro_f1: 0.9848, micro_p: 0.9904, micro_r: 0.9763, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: -0.9619, span_acc: 0.9947, attr_start_acc: 0.9857, attr_end_acc: 0.9898, span_micro_p: 0.9862, span_micro_r: 0.9820, span_micro_f1: 0.9841, micro_p: 0.9901, micro_r: 0.9754, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: -0.9921, span_acc: 0.9949, attr_start_acc: 0.9862, attr_end_acc: 0.9900, span_micro_p: 0.9864, span_micro_r: 0.9825, span_micro_f1: 0.9844, micro_p: 0.9902, micro_r: 0.9757, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: -0.9603, span_acc: 0.9949, attr_start_acc: 0.9853, attr_end_acc: 0.9897, span_micro_p: 0.9864, span_micro_r: 0.9824, span_micro_f1: 0.9844, micro_p: 0.9901, micro_r: 0.9748, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: -0.8823, span_acc: 0.9948, attr_start_acc: 0.9850, attr_end_acc: 0.9898, span_micro_p: 0.9858, span_micro_r: 0.9826, span_micro_f1: 0.9842, micro_p: 0.9895, micro_r: 0.9749, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: -0.8973, span_acc: 0.9947, attr_start_acc: 0.9849, attr_end_acc: 0.9896, span_micro_p: 0.9859, span_micro_r: 0.9829, span_micro_f1: 0.9844, micro_p: 0.9896, micro_r: 0.9748, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: -0.9033, span_acc: 0.9947, attr_start_acc: 0.9848, attr_end_acc: 0.9895, span_micro_p: 0.9859, span_micro_r: 0.9831, span_micro_f1: 0.9845, micro_p: 0.9893, micro_r: 0.9746, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: -0.9103, span_acc: 0.9946, attr_start_acc: 0.9844, attr_end_acc: 0.9895, span_micro_p: 0.9851, span_micro_r: 0.9817, span_micro_f1: 0.9834, micro_p: 0.9895, micro_r: 0.9742, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: -0.9231, span_acc: 0.9947, attr_start_acc: 0.9848, attr_end_acc: 0.9899, span_micro_p: 0.9853, span_micro_r: 0.9818, span_micro_f1: 0.9835, micro_p: 0.9898, micro_r: 0.9750, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: -0.9282, span_acc: 0.9948, attr_start_acc: 0.9847, attr_end_acc: 0.9899, span_micro_p: 0.9856, span_micro_r: 0.9824, span_micro_f1: 0.9840, micro_p: 0.9898, micro_r: 0.9751, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: -0.9270, span_acc: 0.9949, attr_start_acc: 0.9847, attr_end_acc: 0.9897, span_micro_p: 0.9856, span_micro_r: 0.9827, span_micro_f1: 0.9842, micro_p: 0.9896, micro_r: 0.9752, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: -0.8768, span_acc: 0.9950, attr_start_acc: 0.9849, attr_end_acc: 0.9897, span_micro_p: 0.9858, span_micro_r: 0.9832, span_micro_f1: 0.9845, micro_p: 0.9897, micro_r: 0.9755, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: -0.9009, span_acc: 0.9951, attr_start_acc: 0.9853, attr_end_acc: 0.9899, span_micro_p: 0.9861, span_micro_r: 0.9835, span_micro_f1: 0.9848, micro_p: 0.9896, micro_r: 0.9759, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: -0.8120, span_acc: 0.9949, attr_start_acc: 0.9848, attr_end_acc: 0.9897, span_micro_p: 0.9857, span_micro_r: 0.9829, span_micro_f1: 0.9843, micro_p: 0.9892, micro_r: 0.9753, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: -0.7752, span_acc: 0.9945, attr_start_acc: 0.9845, attr_end_acc: 0.9893, span_micro_p: 0.9838, span_micro_r: 0.9818, span_micro_f1: 0.9828, micro_p: 0.9880, micro_r: 0.9745, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: -0.7785, span_acc: 0.9946, attr_start_acc: 0.9845, attr_end_acc: 0.9894, span_micro_p: 0.9839, span_micro_r: 0.9821, span_micro_f1: 0.9830, micro_p: 0.9879, micro_r: 0.9746, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: -0.7770, span_acc: 0.9944, attr_start_acc: 0.9840, attr_end_acc: 0.9891, span_micro_p: 0.9833, span_micro_r: 0.9817, span_micro_f1: 0.9825, micro_p: 0.9873, micro_r: 0.9741, micro_f1: 0.9807
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: -0.7774, span_acc: 0.9943, attr_start_acc: 0.9840, attr_end_acc: 0.9891, span_micro_p: 0.9833, span_micro_r: 0.9816, span_micro_f1: 0.9825, micro_p: 0.9873, micro_r: 0.9741, micro_f1: 0.9807
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: -0.7732, span_acc: 0.9944, attr_start_acc: 0.9840, attr_end_acc: 0.9892, span_micro_p: 0.9833, span_micro_r: 0.9816, span_micro_f1: 0.9824, micro_p: 0.9875, micro_r: 0.9743, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.94 / 97.85000000000001 / 97.98), p: (94.23 / 95.96000000000001), r: (96.06 / 95.83), f1: (95.14 / 95.89)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.490913653476707, 'span_acc': 0.9793936522974893, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9798387096774194, 'span_micro_p': 0.9423328964613368, 'span_micro_r': 0.9605878423513694, 'span_micro_f1': 0.951372808468409, 'micro_p': 0.9595687331536388, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9589225589225588, 'category-p/r/f1': {'PRO': (0.7391, 0.9444, 0.8292), 'ORG': (0.9465, 0.9501, 0.9483), 'TITLE': (0.9648, 0.9536, 0.9592), 'EDU': (0.981, 0.9717, 0.9763), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9589225589225588 / 0.9625595643294759
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.33000000000001 / 97.11999999999999 / 97.48), p: (93.5 / 95.5), r: (95.34 / 95.15), f1: (94.41000000000001 / 95.33)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.0886213172156856, 'span_acc': 0.9732593340060545, 'attr_start_acc': 0.9711656441717792, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.9350180505415162, 'span_micro_r': 0.9533742331288344, 'span_micro_f1': 0.9441069258809235, 'micro_p': 0.9550492610837439, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9532882606023355, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9314, 0.9331, 0.9322), 'PRO': (0.8919, 1.0, 0.9429), 'TITLE': (0.9619, 0.9495, 0.9557), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9532882606023355 / 0.9586314152410575
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -1.1491, span_acc: 0.9961, attr_start_acc: 0.9894, attr_end_acc: 0.9894, span_micro_p: 1.0000, span_micro_r: 0.9947, span_micro_f1: 0.9973, micro_p: 1.0000, micro_r: 0.9894, micro_f1: 0.9947
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -1.1452, span_acc: 0.9932, attr_start_acc: 0.9902, attr_end_acc: 0.9870, span_micro_p: 0.9951, span_micro_r: 0.9903, span_micro_f1: 0.9927, micro_p: 0.9951, micro_r: 0.9821, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -1.2457, span_acc: 0.9952, attr_start_acc: 0.9891, attr_end_acc: 0.9882, span_micro_p: 0.9937, span_micro_r: 0.9919, span_micro_f1: 0.9928, micro_p: 0.9936, micro_r: 0.9827, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -1.1444, span_acc: 0.9962, attr_start_acc: 0.9906, attr_end_acc: 0.9886, span_micro_p: 0.9933, span_micro_r: 0.9927, span_micro_f1: 0.9930, micro_p: 0.9952, micro_r: 0.9839, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: -1.1889, span_acc: 0.9964, attr_start_acc: 0.9876, attr_end_acc: 0.9876, span_micro_p: 0.9925, span_micro_r: 0.9925, span_micro_f1: 0.9925, micro_p: 0.9918, micro_r: 0.9822, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.9035, span_acc: 0.9964, attr_start_acc: 0.9878, attr_end_acc: 0.9892, span_micro_p: 0.9910, span_micro_r: 0.9910, span_micro_f1: 0.9910, micro_p: 0.9905, micro_r: 0.9829, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.9556, span_acc: 0.9966, attr_start_acc: 0.9872, attr_end_acc: 0.9898, span_micro_p: 0.9916, span_micro_r: 0.9909, span_micro_f1: 0.9913, micro_p: 0.9915, micro_r: 0.9828, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.9955, span_acc: 0.9966, attr_start_acc: 0.9855, attr_end_acc: 0.9906, span_micro_p: 0.9906, span_micro_r: 0.9900, span_micro_f1: 0.9903, micro_p: 0.9905, micro_r: 0.9811, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -1.0518, span_acc: 0.9963, attr_start_acc: 0.9849, attr_end_acc: 0.9904, span_micro_p: 0.9898, span_micro_r: 0.9882, span_micro_f1: 0.9890, micro_p: 0.9905, micro_r: 0.9799, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -1.0744, span_acc: 0.9967, attr_start_acc: 0.9863, attr_end_acc: 0.9911, span_micro_p: 0.9906, span_micro_r: 0.9894, span_micro_f1: 0.9900, micro_p: 0.9910, micro_r: 0.9817, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: -1.0134, span_acc: 0.9963, attr_start_acc: 0.9853, attr_end_acc: 0.9903, span_micro_p: 0.9886, span_micro_r: 0.9873, span_micro_f1: 0.9880, micro_p: 0.9900, micro_r: 0.9793, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: -1.0441, span_acc: 0.9960, attr_start_acc: 0.9843, attr_end_acc: 0.9897, span_micro_p: 0.9876, span_micro_r: 0.9858, span_micro_f1: 0.9867, micro_p: 0.9890, micro_r: 0.9779, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: -1.0293, span_acc: 0.9960, attr_start_acc: 0.9844, attr_end_acc: 0.9896, span_micro_p: 0.9878, span_micro_r: 0.9861, span_micro_f1: 0.9869, micro_p: 0.9885, micro_r: 0.9776, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: -1.0147, span_acc: 0.9962, attr_start_acc: 0.9847, attr_end_acc: 0.9899, span_micro_p: 0.9881, span_micro_r: 0.9867, span_micro_f1: 0.9874, micro_p: 0.9884, micro_r: 0.9777, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: -1.0270, span_acc: 0.9959, attr_start_acc: 0.9844, attr_end_acc: 0.9896, span_micro_p: 0.9873, span_micro_r: 0.9857, span_micro_f1: 0.9865, micro_p: 0.9880, micro_r: 0.9770, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: -0.9160, span_acc: 0.9951, attr_start_acc: 0.9847, attr_end_acc: 0.9895, span_micro_p: 0.9862, span_micro_r: 0.9851, span_micro_f1: 0.9856, micro_p: 0.9881, micro_r: 0.9774, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: -0.8143, span_acc: 0.9953, attr_start_acc: 0.9845, attr_end_acc: 0.9892, span_micro_p: 0.9865, span_micro_r: 0.9851, span_micro_f1: 0.9858, micro_p: 0.9883, micro_r: 0.9772, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: -0.6094, span_acc: 0.9952, attr_start_acc: 0.9846, attr_end_acc: 0.9895, span_micro_p: 0.9867, span_micro_r: 0.9852, span_micro_f1: 0.9859, micro_p: 0.9883, micro_r: 0.9773, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: -0.5142, span_acc: 0.9953, attr_start_acc: 0.9845, attr_end_acc: 0.9899, span_micro_p: 0.9870, span_micro_r: 0.9857, span_micro_f1: 0.9864, micro_p: 0.9883, micro_r: 0.9775, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: -0.5395, span_acc: 0.9955, attr_start_acc: 0.9846, attr_end_acc: 0.9904, span_micro_p: 0.9876, span_micro_r: 0.9864, span_micro_f1: 0.9870, micro_p: 0.9888, micro_r: 0.9779, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: -0.5749, span_acc: 0.9956, attr_start_acc: 0.9850, attr_end_acc: 0.9906, span_micro_p: 0.9876, span_micro_r: 0.9866, span_micro_f1: 0.9871, micro_p: 0.9887, micro_r: 0.9780, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: -0.5877, span_acc: 0.9956, attr_start_acc: 0.9850, attr_end_acc: 0.9903, span_micro_p: 0.9882, span_micro_r: 0.9869, span_micro_f1: 0.9875, micro_p: 0.9891, micro_r: 0.9782, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: -0.6247, span_acc: 0.9957, attr_start_acc: 0.9855, attr_end_acc: 0.9906, span_micro_p: 0.9882, span_micro_r: 0.9869, span_micro_f1: 0.9876, micro_p: 0.9895, micro_r: 0.9788, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: -0.6259, span_acc: 0.9957, attr_start_acc: 0.9855, attr_end_acc: 0.9906, span_micro_p: 0.9884, span_micro_r: 0.9870, span_micro_f1: 0.9877, micro_p: 0.9896, micro_r: 0.9788, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: -0.5950, span_acc: 0.9957, attr_start_acc: 0.9850, attr_end_acc: 0.9903, span_micro_p: 0.9882, span_micro_r: 0.9864, span_micro_f1: 0.9873, micro_p: 0.9891, micro_r: 0.9779, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: -0.5563, span_acc: 0.9957, attr_start_acc: 0.9854, attr_end_acc: 0.9902, span_micro_p: 0.9881, span_micro_r: 0.9863, span_micro_f1: 0.9872, micro_p: 0.9893, micro_r: 0.9781, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: -0.5746, span_acc: 0.9957, attr_start_acc: 0.9854, attr_end_acc: 0.9900, span_micro_p: 0.9881, span_micro_r: 0.9865, span_micro_f1: 0.9873, micro_p: 0.9890, micro_r: 0.9782, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: -0.5732, span_acc: 0.9956, attr_start_acc: 0.9853, attr_end_acc: 0.9898, span_micro_p: 0.9877, span_micro_r: 0.9861, span_micro_f1: 0.9869, micro_p: 0.9885, micro_r: 0.9779, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: -0.5311, span_acc: 0.9956, attr_start_acc: 0.9850, attr_end_acc: 0.9896, span_micro_p: 0.9875, span_micro_r: 0.9856, span_micro_f1: 0.9866, micro_p: 0.9884, micro_r: 0.9773, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: -0.5397, span_acc: 0.9956, attr_start_acc: 0.9849, attr_end_acc: 0.9896, span_micro_p: 0.9876, span_micro_r: 0.9858, span_micro_f1: 0.9867, micro_p: 0.9883, micro_r: 0.9772, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: -0.5788, span_acc: 0.9957, attr_start_acc: 0.9851, attr_end_acc: 0.9896, span_micro_p: 0.9878, span_micro_r: 0.9859, span_micro_f1: 0.9868, micro_p: 0.9885, micro_r: 0.9775, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: -0.5614, span_acc: 0.9956, attr_start_acc: 0.9849, attr_end_acc: 0.9896, span_micro_p: 0.9879, span_micro_r: 0.9861, span_micro_f1: 0.9870, micro_p: 0.9885, micro_r: 0.9775, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.78 / 97.78 / 98.32), p: (96.15 / 96.49), r: (96.66 / 96.3), f1: (96.39999999999999 / 96.39999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 4.426997880055117, 'span_acc': 0.9878019895783988, 'attr_start_acc': 0.9778225806451613, 'attr_end_acc': 0.9831989247311828, 'span_micro_p': 0.9614617940199336, 'span_micro_r': 0.9665998663994656, 'span_micro_f1': 0.9640239840106596, 'micro_p': 0.9649359406608227, 'micro_r': 0.9629878869448183, 'micro_f1': 0.9639609296059278, 'category-p/r/f1': {'LOC': (0.6667, 1.0, 0.8), 'PRO': (0.8571, 1.0, 0.9231), 'ORG': (0.9504, 0.9559, 0.9531), 'TITLE': (0.9707, 0.9594, 0.965), 'EDU': (0.9904, 0.9717, 0.981), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9639609296059278 / 0.9625595643294759
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.4 / 97.24000000000001 / 97.48), p: (96.24000000000001 / 96.59), r: (95.83 / 95.52000000000001), f1: (96.03 / 96.05)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.6698596140123763, 'span_acc': 0.9839556004036327, 'attr_start_acc': 0.9723926380368099, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.9624152803450401, 'span_micro_r': 0.9582822085889571, 'span_micro_f1': 0.9603442975714725, 'micro_p': 0.9658808933002482, 'micro_r': 0.9552147239263804, 'micro_f1': 0.9605181986428131, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9579, 0.9458, 0.9518), 'TITLE': (0.9619, 0.9495, 0.9557), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9605181986428131 / 0.9586314152410575
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: -0.9649, span_acc: 0.9954, attr_start_acc: 0.9805, attr_end_acc: 0.9805, span_micro_p: 0.9883, span_micro_r: 0.9845, span_micro_f1: 0.9864, micro_p: 0.9880, micro_r: 0.9688, micro_f1: 0.9783
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -1.3888, span_acc: 0.9975, attr_start_acc: 0.9897, attr_end_acc: 0.9897, span_micro_p: 0.9912, span_micro_r: 0.9927, span_micro_f1: 0.9919, micro_p: 0.9911, micro_r: 0.9809, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -1.5538, span_acc: 0.9984, attr_start_acc: 0.9905, attr_end_acc: 0.9913, span_micro_p: 0.9940, span_micro_r: 0.9948, span_micro_f1: 0.9944, micro_p: 0.9921, micro_r: 0.9835, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -1.6221, span_acc: 0.9988, attr_start_acc: 0.9897, attr_end_acc: 0.9916, span_micro_p: 0.9955, span_micro_r: 0.9962, span_micro_f1: 0.9958, micro_p: 0.9941, micro_r: 0.9839, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -1.3180, span_acc: 0.9986, attr_start_acc: 0.9896, attr_end_acc: 0.9916, span_micro_p: 0.9946, span_micro_r: 0.9956, span_micro_f1: 0.9951, micro_p: 0.9920, micro_r: 0.9837, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -1.3244, span_acc: 0.9987, attr_start_acc: 0.9910, attr_end_acc: 0.9931, span_micro_p: 0.9947, span_micro_r: 0.9959, span_micro_f1: 0.9953, micro_p: 0.9926, micro_r: 0.9861, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: -1.1628, span_acc: 0.9984, attr_start_acc: 0.9910, attr_end_acc: 0.9924, span_micro_p: 0.9942, span_micro_r: 0.9952, span_micro_f1: 0.9947, micro_p: 0.9917, micro_r: 0.9858, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: -0.8644, span_acc: 0.9982, attr_start_acc: 0.9913, attr_end_acc: 0.9925, span_micro_p: 0.9931, span_micro_r: 0.9943, span_micro_f1: 0.9937, micro_p: 0.9906, micro_r: 0.9855, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: -0.4493, span_acc: 0.9980, attr_start_acc: 0.9914, attr_end_acc: 0.9927, span_micro_p: 0.9917, span_micro_r: 0.9936, span_micro_f1: 0.9926, micro_p: 0.9897, micro_r: 0.9854, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: -0.4216, span_acc: 0.9982, attr_start_acc: 0.9914, attr_end_acc: 0.9926, span_micro_p: 0.9925, span_micro_r: 0.9942, span_micro_f1: 0.9933, micro_p: 0.9904, micro_r: 0.9855, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: -0.5472, span_acc: 0.9982, attr_start_acc: 0.9915, attr_end_acc: 0.9929, span_micro_p: 0.9925, span_micro_r: 0.9942, span_micro_f1: 0.9934, micro_p: 0.9908, micro_r: 0.9857, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: -0.4799, span_acc: 0.9981, attr_start_acc: 0.9910, attr_end_acc: 0.9924, span_micro_p: 0.9925, span_micro_r: 0.9939, span_micro_f1: 0.9932, micro_p: 0.9903, micro_r: 0.9852, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: -0.3733, span_acc: 0.9981, attr_start_acc: 0.9911, attr_end_acc: 0.9922, span_micro_p: 0.9925, span_micro_r: 0.9936, span_micro_f1: 0.9930, micro_p: 0.9904, micro_r: 0.9852, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: -0.4281, span_acc: 0.9982, attr_start_acc: 0.9915, attr_end_acc: 0.9923, span_micro_p: 0.9929, span_micro_r: 0.9940, span_micro_f1: 0.9935, micro_p: 0.9909, micro_r: 0.9854, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: -0.4754, span_acc: 0.9982, attr_start_acc: 0.9911, attr_end_acc: 0.9927, span_micro_p: 0.9930, span_micro_r: 0.9941, span_micro_f1: 0.9935, micro_p: 0.9909, micro_r: 0.9852, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: -0.4513, span_acc: 0.9981, attr_start_acc: 0.9901, attr_end_acc: 0.9923, span_micro_p: 0.9928, span_micro_r: 0.9932, span_micro_f1: 0.9930, micro_p: 0.9910, micro_r: 0.9841, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: -0.4345, span_acc: 0.9979, attr_start_acc: 0.9891, attr_end_acc: 0.9912, span_micro_p: 0.9925, span_micro_r: 0.9928, span_micro_f1: 0.9927, micro_p: 0.9905, micro_r: 0.9826, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: -0.4861, span_acc: 0.9980, attr_start_acc: 0.9888, attr_end_acc: 0.9913, span_micro_p: 0.9928, span_micro_r: 0.9930, span_micro_f1: 0.9929, micro_p: 0.9904, micro_r: 0.9824, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: -0.4133, span_acc: 0.9979, attr_start_acc: 0.9889, attr_end_acc: 0.9914, span_micro_p: 0.9926, span_micro_r: 0.9921, span_micro_f1: 0.9923, micro_p: 0.9909, micro_r: 0.9826, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: -0.2178, span_acc: 0.9978, attr_start_acc: 0.9888, attr_end_acc: 0.9916, span_micro_p: 0.9927, span_micro_r: 0.9921, span_micro_f1: 0.9924, micro_p: 0.9910, micro_r: 0.9827, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: -0.0335, span_acc: 0.9978, attr_start_acc: 0.9889, attr_end_acc: 0.9916, span_micro_p: 0.9927, span_micro_r: 0.9919, span_micro_f1: 0.9923, micro_p: 0.9912, micro_r: 0.9828, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: -0.0992, span_acc: 0.9978, attr_start_acc: 0.9888, attr_end_acc: 0.9919, span_micro_p: 0.9928, span_micro_r: 0.9920, span_micro_f1: 0.9924, micro_p: 0.9910, micro_r: 0.9825, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: -0.0946, span_acc: 0.9978, attr_start_acc: 0.9890, attr_end_acc: 0.9921, span_micro_p: 0.9929, span_micro_r: 0.9922, span_micro_f1: 0.9926, micro_p: 0.9911, micro_r: 0.9829, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: -0.0326, span_acc: 0.9978, attr_start_acc: 0.9886, attr_end_acc: 0.9917, span_micro_p: 0.9930, span_micro_r: 0.9922, span_micro_f1: 0.9926, micro_p: 0.9912, micro_r: 0.9822, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.0012, span_acc: 0.9977, attr_start_acc: 0.9881, attr_end_acc: 0.9914, span_micro_p: 0.9926, span_micro_r: 0.9919, span_micro_f1: 0.9923, micro_p: 0.9909, micro_r: 0.9817, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: -0.0497, span_acc: 0.9978, attr_start_acc: 0.9882, attr_end_acc: 0.9917, span_micro_p: 0.9928, span_micro_r: 0.9922, span_micro_f1: 0.9925, micro_p: 0.9911, micro_r: 0.9820, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: -0.0687, span_acc: 0.9977, attr_start_acc: 0.9881, attr_end_acc: 0.9918, span_micro_p: 0.9923, span_micro_r: 0.9919, span_micro_f1: 0.9921, micro_p: 0.9909, micro_r: 0.9818, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: -0.1202, span_acc: 0.9977, attr_start_acc: 0.9882, attr_end_acc: 0.9920, span_micro_p: 0.9925, span_micro_r: 0.9920, span_micro_f1: 0.9922, micro_p: 0.9911, micro_r: 0.9820, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: -0.1086, span_acc: 0.9978, attr_start_acc: 0.9886, attr_end_acc: 0.9922, span_micro_p: 0.9926, span_micro_r: 0.9921, span_micro_f1: 0.9923, micro_p: 0.9915, micro_r: 0.9826, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: -0.1156, span_acc: 0.9979, attr_start_acc: 0.9888, attr_end_acc: 0.9924, span_micro_p: 0.9928, span_micro_r: 0.9924, span_micro_f1: 0.9926, micro_p: 0.9916, micro_r: 0.9830, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: -0.0994, span_acc: 0.9977, attr_start_acc: 0.9889, attr_end_acc: 0.9925, span_micro_p: 0.9919, span_micro_r: 0.9920, span_micro_f1: 0.9919, micro_p: 0.9914, micro_r: 0.9828, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: -0.0923, span_acc: 0.9977, attr_start_acc: 0.9889, attr_end_acc: 0.9927, span_micro_p: 0.9917, span_micro_r: 0.9918, span_micro_f1: 0.9918, micro_p: 0.9911, micro_r: 0.9828, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.38 / 97.85000000000001 / 97.78), p: (95.25 / 96.39999999999999), r: (96.46000000000001 / 95.42), f1: (95.85000000000001 / 95.91)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 3.4277630530732237, 'span_acc': 0.9837754618664141, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9778225806451613, 'span_micro_p': 0.9525065963060686, 'span_micro_r': 0.9645958583834335, 'span_micro_f1': 0.958513109857285, 'micro_p': 0.9639700883752549, 'micro_r': 0.9542395693135935, 'micro_f1': 0.9590801487994589, 'category-p/r/f1': {'PRO': (0.7727, 0.9444, 0.85), 'ORG': (0.953, 0.9347, 0.9438), 'TITLE': (0.9719, 0.9536, 0.9627), 'EDU': (0.9633, 0.9906, 0.9768), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9590801487994589 / 0.9639609296059278
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.17 / 96.99 / 97.48), p: (94.08 / 95.39), r: (95.58 / 95.15), f1: (94.83 / 95.27)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.7438771739695806, 'span_acc': 0.9817356205852674, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.9408212560386473, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9482653682288497, 'micro_p': 0.9538745387453874, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9527027027027026, 'category-p/r/f1': {'PRO': (0.8684, 1.0, 0.9296), 'ORG': (0.9332, 0.9349, 0.934), 'TITLE': (0.9581, 0.9469, 0.9525), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9527027027027026 / 0.9605181986428131
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -2.0173, span_acc: 1.0000, attr_start_acc: 0.9964, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9964, micro_f1: 0.9982
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: -1.9341, span_acc: 0.9985, attr_start_acc: 0.9928, attr_end_acc: 0.9986, span_micro_p: 0.9957, span_micro_r: 0.9943, span_micro_f1: 0.9950, micro_p: 0.9971, micro_r: 0.9914, micro_f1: 0.9943
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: -1.4509, span_acc: 0.9982, attr_start_acc: 0.9895, attr_end_acc: 0.9965, span_micro_p: 0.9939, span_micro_r: 0.9939, span_micro_f1: 0.9939, micro_p: 0.9938, micro_r: 0.9869, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: -1.3342, span_acc: 0.9984, attr_start_acc: 0.9871, attr_end_acc: 0.9949, span_micro_p: 0.9949, span_micro_r: 0.9936, span_micro_f1: 0.9943, micro_p: 0.9948, micro_r: 0.9845, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: -1.4043, span_acc: 0.9987, attr_start_acc: 0.9880, attr_end_acc: 0.9953, span_micro_p: 0.9959, span_micro_r: 0.9948, span_micro_f1: 0.9954, micro_p: 0.9958, micro_r: 0.9854, micro_f1: 0.9906
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: -1.4520, span_acc: 0.9987, attr_start_acc: 0.9868, attr_end_acc: 0.9940, span_micro_p: 0.9958, span_micro_r: 0.9945, span_micro_f1: 0.9952, micro_p: 0.9948, micro_r: 0.9838, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: -1.1626, span_acc: 0.9987, attr_start_acc: 0.9862, attr_end_acc: 0.9942, span_micro_p: 0.9957, span_micro_r: 0.9942, span_micro_f1: 0.9950, micro_p: 0.9945, micro_r: 0.9836, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: -0.3638, span_acc: 0.9977, attr_start_acc: 0.9854, attr_end_acc: 0.9933, span_micro_p: 0.9943, span_micro_r: 0.9925, span_micro_f1: 0.9934, micro_p: 0.9936, micro_r: 0.9822, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: -0.4270, span_acc: 0.9978, attr_start_acc: 0.9852, attr_end_acc: 0.9934, span_micro_p: 0.9943, span_micro_r: 0.9924, span_micro_f1: 0.9934, micro_p: 0.9934, micro_r: 0.9823, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: -0.4111, span_acc: 0.9980, attr_start_acc: 0.9853, attr_end_acc: 0.9934, span_micro_p: 0.9947, span_micro_r: 0.9929, span_micro_f1: 0.9938, micro_p: 0.9933, micro_r: 0.9827, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: -0.4324, span_acc: 0.9981, attr_start_acc: 0.9853, attr_end_acc: 0.9931, span_micro_p: 0.9948, span_micro_r: 0.9934, span_micro_f1: 0.9941, micro_p: 0.9935, micro_r: 0.9821, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: -0.4618, span_acc: 0.9982, attr_start_acc: 0.9859, attr_end_acc: 0.9933, span_micro_p: 0.9952, span_micro_r: 0.9939, span_micro_f1: 0.9946, micro_p: 0.9936, micro_r: 0.9829, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: -0.4666, span_acc: 0.9983, attr_start_acc: 0.9861, attr_end_acc: 0.9934, span_micro_p: 0.9952, span_micro_r: 0.9942, span_micro_f1: 0.9947, micro_p: 0.9935, micro_r: 0.9832, micro_f1: 0.9883
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 0.0801, span_acc: 0.9982, attr_start_acc: 0.9863, attr_end_acc: 0.9935, span_micro_p: 0.9950, span_micro_r: 0.9939, span_micro_f1: 0.9945, micro_p: 0.9934, micro_r: 0.9832, micro_f1: 0.9883
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 0.3643, span_acc: 0.9980, attr_start_acc: 0.9861, attr_end_acc: 0.9931, span_micro_p: 0.9942, span_micro_r: 0.9927, span_micro_f1: 0.9934, micro_p: 0.9929, micro_r: 0.9824, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 0.3964, span_acc: 0.9980, attr_start_acc: 0.9862, attr_end_acc: 0.9930, span_micro_p: 0.9943, span_micro_r: 0.9927, span_micro_f1: 0.9935, micro_p: 0.9929, micro_r: 0.9825, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 0.3270, span_acc: 0.9981, attr_start_acc: 0.9866, attr_end_acc: 0.9932, span_micro_p: 0.9943, span_micro_r: 0.9928, span_micro_f1: 0.9936, micro_p: 0.9931, micro_r: 0.9829, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 0.3837, span_acc: 0.9980, attr_start_acc: 0.9862, attr_end_acc: 0.9930, span_micro_p: 0.9941, span_micro_r: 0.9925, span_micro_f1: 0.9933, micro_p: 0.9929, micro_r: 0.9826, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 0.3213, span_acc: 0.9981, attr_start_acc: 0.9866, attr_end_acc: 0.9932, span_micro_p: 0.9941, span_micro_r: 0.9925, span_micro_f1: 0.9933, micro_p: 0.9928, micro_r: 0.9828, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 0.2546, span_acc: 0.9981, attr_start_acc: 0.9870, attr_end_acc: 0.9935, span_micro_p: 0.9942, span_micro_r: 0.9927, span_micro_f1: 0.9934, micro_p: 0.9930, micro_r: 0.9833, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 0.2007, span_acc: 0.9982, attr_start_acc: 0.9872, attr_end_acc: 0.9935, span_micro_p: 0.9943, span_micro_r: 0.9929, span_micro_f1: 0.9936, micro_p: 0.9933, micro_r: 0.9834, micro_f1: 0.9883
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 0.3994, span_acc: 0.9980, attr_start_acc: 0.9868, attr_end_acc: 0.9933, span_micro_p: 0.9938, span_micro_r: 0.9925, span_micro_f1: 0.9932, micro_p: 0.9927, micro_r: 0.9827, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 0.3840, span_acc: 0.9979, attr_start_acc: 0.9867, attr_end_acc: 0.9932, span_micro_p: 0.9933, span_micro_r: 0.9922, span_micro_f1: 0.9928, micro_p: 0.9925, micro_r: 0.9825, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 0.3556, span_acc: 0.9979, attr_start_acc: 0.9870, attr_end_acc: 0.9934, span_micro_p: 0.9932, span_micro_r: 0.9923, span_micro_f1: 0.9928, micro_p: 0.9926, micro_r: 0.9827, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 0.3051, span_acc: 0.9980, attr_start_acc: 0.9871, attr_end_acc: 0.9935, span_micro_p: 0.9934, span_micro_r: 0.9925, span_micro_f1: 0.9929, micro_p: 0.9927, micro_r: 0.9829, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 0.2714, span_acc: 0.9980, attr_start_acc: 0.9872, attr_end_acc: 0.9936, span_micro_p: 0.9934, span_micro_r: 0.9924, span_micro_f1: 0.9929, micro_p: 0.9924, micro_r: 0.9827, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 0.3149, span_acc: 0.9979, attr_start_acc: 0.9871, attr_end_acc: 0.9935, span_micro_p: 0.9931, span_micro_r: 0.9921, span_micro_f1: 0.9926, micro_p: 0.9924, micro_r: 0.9823, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 0.2724, span_acc: 0.9979, attr_start_acc: 0.9870, attr_end_acc: 0.9932, span_micro_p: 0.9932, span_micro_r: 0.9922, span_micro_f1: 0.9927, micro_p: 0.9922, micro_r: 0.9821, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 0.2547, span_acc: 0.9978, attr_start_acc: 0.9866, attr_end_acc: 0.9930, span_micro_p: 0.9930, span_micro_r: 0.9920, span_micro_f1: 0.9925, micro_p: 0.9919, micro_r: 0.9815, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 0.1960, span_acc: 0.9978, attr_start_acc: 0.9865, attr_end_acc: 0.9928, span_micro_p: 0.9928, span_micro_r: 0.9919, span_micro_f1: 0.9924, micro_p: 0.9917, micro_r: 0.9811, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 0.1853, span_acc: 0.9978, attr_start_acc: 0.9868, attr_end_acc: 0.9929, span_micro_p: 0.9928, span_micro_r: 0.9920, span_micro_f1: 0.9924, micro_p: 0.9917, micro_r: 0.9813, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 0.1726, span_acc: 0.9978, attr_start_acc: 0.9867, attr_end_acc: 0.9929, span_micro_p: 0.9928, span_micro_r: 0.9920, span_micro_f1: 0.9924, micro_p: 0.9916, micro_r: 0.9813, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.78 / 97.78 / 98.11999999999999), p: (95.14 / 96.48), r: (96.78999999999999 / 95.83), f1: (95.96000000000001 / 96.15)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 11.471301086520532, 'span_acc': 0.9878019895783988, 'attr_start_acc': 0.9778225806451613, 'attr_end_acc': 0.9811827956989247, 'span_micro_p': 0.9514116874589625, 'span_micro_r': 0.9679358717434869, 'span_micro_f1': 0.9596026490066226, 'micro_p': 0.964769647696477, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9615124915597569, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9483, 0.9501, 0.9492), 'TITLE': (0.9706, 0.9565, 0.9635), 'EDU': (0.9904, 0.9717, 0.981), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9615124915597569 / 0.9639609296059278
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.09 / 97.06 / 97.42), p: (95.07 / 95.98), r: (95.89 / 95.09), f1: (95.48 / 95.53)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 6.507105229035863, 'span_acc': 0.9809283551967709, 'attr_start_acc': 0.9705521472392638, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9507299270072993, 'span_micro_r': 0.9588957055214724, 'span_micro_f1': 0.9547953573610263, 'micro_p': 0.9597523219814241, 'micro_r': 0.950920245398773, 'micro_f1': 0.9553158705701079, 'category-p/r/f1': {'LOC': (1.0, 0.1667, 0.2858), 'ORG': (0.942, 0.9403, 0.9411), 'TITLE': (0.9606, 0.9482, 0.9544), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9553158705701079 / 0.9605181986428131
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: -0.7975, span_acc: 1.0000, attr_start_acc: 0.9939, attr_end_acc: 0.9969, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9908, micro_f1: 0.9954
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: -1.0627, span_acc: 0.9998, attr_start_acc: 0.9889, attr_end_acc: 0.9944, span_micro_p: 0.9986, span_micro_r: 0.9986, span_micro_f1: 0.9986, micro_p: 0.9958, micro_r: 0.9875, micro_f1: 0.9916
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: -0.8814, span_acc: 0.9990, attr_start_acc: 0.9876, attr_end_acc: 0.9920, span_micro_p: 0.9947, span_micro_r: 0.9965, span_micro_f1: 0.9956, micro_p: 0.9902, micro_r: 0.9822, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: -0.7607, span_acc: 0.9991, attr_start_acc: 0.9873, attr_end_acc: 0.9918, span_micro_p: 0.9956, span_micro_r: 0.9962, span_micro_f1: 0.9959, micro_p: 0.9904, micro_r: 0.9836, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 0.4934, span_acc: 0.9986, attr_start_acc: 0.9889, attr_end_acc: 0.9924, span_micro_p: 0.9965, span_micro_r: 0.9960, span_micro_f1: 0.9962, micro_p: 0.9919, micro_r: 0.9844, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 1.4696, span_acc: 0.9986, attr_start_acc: 0.9883, attr_end_acc: 0.9920, span_micro_p: 0.9967, span_micro_r: 0.9954, span_micro_f1: 0.9960, micro_p: 0.9915, micro_r: 0.9832, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 1.1217, span_acc: 0.9981, attr_start_acc: 0.9877, attr_end_acc: 0.9912, span_micro_p: 0.9951, span_micro_r: 0.9930, span_micro_f1: 0.9940, micro_p: 0.9900, micro_r: 0.9813, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 1.4387, span_acc: 0.9981, attr_start_acc: 0.9878, attr_end_acc: 0.9917, span_micro_p: 0.9948, span_micro_r: 0.9930, span_micro_f1: 0.9939, micro_p: 0.9907, micro_r: 0.9816, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 1.3473, span_acc: 0.9982, attr_start_acc: 0.9882, attr_end_acc: 0.9920, span_micro_p: 0.9949, span_micro_r: 0.9931, span_micro_f1: 0.9940, micro_p: 0.9908, micro_r: 0.9824, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 1.0861, span_acc: 0.9981, attr_start_acc: 0.9885, attr_end_acc: 0.9916, span_micro_p: 0.9945, span_micro_r: 0.9926, span_micro_f1: 0.9936, micro_p: 0.9913, micro_r: 0.9825, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 1.2720, span_acc: 0.9980, attr_start_acc: 0.9888, attr_end_acc: 0.9921, span_micro_p: 0.9943, span_micro_r: 0.9926, span_micro_f1: 0.9935, micro_p: 0.9914, micro_r: 0.9827, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 1.1361, span_acc: 0.9979, attr_start_acc: 0.9884, attr_end_acc: 0.9914, span_micro_p: 0.9944, span_micro_r: 0.9923, span_micro_f1: 0.9933, micro_p: 0.9917, micro_r: 0.9822, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 1.0938, span_acc: 0.9981, attr_start_acc: 0.9886, attr_end_acc: 0.9912, span_micro_p: 0.9948, span_micro_r: 0.9928, span_micro_f1: 0.9938, micro_p: 0.9921, micro_r: 0.9824, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 0.9719, span_acc: 0.9982, attr_start_acc: 0.9891, attr_end_acc: 0.9917, span_micro_p: 0.9950, span_micro_r: 0.9932, span_micro_f1: 0.9941, micro_p: 0.9925, micro_r: 0.9833, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 0.9850, span_acc: 0.9980, attr_start_acc: 0.9895, attr_end_acc: 0.9921, span_micro_p: 0.9942, span_micro_r: 0.9928, span_micro_f1: 0.9935, micro_p: 0.9923, micro_r: 0.9834, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 0.8950, span_acc: 0.9981, attr_start_acc: 0.9898, attr_end_acc: 0.9920, span_micro_p: 0.9946, span_micro_r: 0.9931, span_micro_f1: 0.9939, micro_p: 0.9926, micro_r: 0.9839, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 0.9060, span_acc: 0.9981, attr_start_acc: 0.9897, attr_end_acc: 0.9920, span_micro_p: 0.9945, span_micro_r: 0.9934, span_micro_f1: 0.9940, micro_p: 0.9927, micro_r: 0.9838, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 0.8687, span_acc: 0.9982, attr_start_acc: 0.9902, attr_end_acc: 0.9923, span_micro_p: 0.9947, span_micro_r: 0.9935, span_micro_f1: 0.9941, micro_p: 0.9929, micro_r: 0.9842, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 1.1392, span_acc: 0.9980, attr_start_acc: 0.9903, attr_end_acc: 0.9920, span_micro_p: 0.9941, span_micro_r: 0.9932, span_micro_f1: 0.9937, micro_p: 0.9924, micro_r: 0.9838, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 1.0370, span_acc: 0.9981, attr_start_acc: 0.9908, attr_end_acc: 0.9922, span_micro_p: 0.9944, span_micro_r: 0.9936, span_micro_f1: 0.9940, micro_p: 0.9926, micro_r: 0.9844, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 1.1803, span_acc: 0.9982, attr_start_acc: 0.9907, attr_end_acc: 0.9926, span_micro_p: 0.9944, span_micro_r: 0.9936, span_micro_f1: 0.9940, micro_p: 0.9926, micro_r: 0.9846, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 1.2698, span_acc: 0.9982, attr_start_acc: 0.9904, attr_end_acc: 0.9929, span_micro_p: 0.9943, span_micro_r: 0.9936, span_micro_f1: 0.9940, micro_p: 0.9927, micro_r: 0.9846, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 1.2908, span_acc: 0.9982, attr_start_acc: 0.9903, attr_end_acc: 0.9927, span_micro_p: 0.9942, span_micro_r: 0.9936, span_micro_f1: 0.9939, micro_p: 0.9926, micro_r: 0.9845, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 1.1332, span_acc: 0.9982, attr_start_acc: 0.9903, attr_end_acc: 0.9926, span_micro_p: 0.9944, span_micro_r: 0.9937, span_micro_f1: 0.9940, micro_p: 0.9926, micro_r: 0.9845, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 1.1879, span_acc: 0.9982, attr_start_acc: 0.9900, attr_end_acc: 0.9929, span_micro_p: 0.9943, span_micro_r: 0.9936, span_micro_f1: 0.9939, micro_p: 0.9926, micro_r: 0.9845, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 1.1505, span_acc: 0.9982, attr_start_acc: 0.9899, attr_end_acc: 0.9930, span_micro_p: 0.9942, span_micro_r: 0.9936, span_micro_f1: 0.9939, micro_p: 0.9927, micro_r: 0.9842, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 1.1035, span_acc: 0.9983, attr_start_acc: 0.9901, attr_end_acc: 0.9931, span_micro_p: 0.9945, span_micro_r: 0.9938, span_micro_f1: 0.9942, micro_p: 0.9927, micro_r: 0.9845, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 1.1152, span_acc: 0.9983, attr_start_acc: 0.9902, attr_end_acc: 0.9933, span_micro_p: 0.9945, span_micro_r: 0.9938, span_micro_f1: 0.9942, micro_p: 0.9927, micro_r: 0.9846, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 1.2768, span_acc: 0.9982, attr_start_acc: 0.9900, attr_end_acc: 0.9933, span_micro_p: 0.9945, span_micro_r: 0.9937, span_micro_f1: 0.9941, micro_p: 0.9927, micro_r: 0.9844, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 1.7166, span_acc: 0.9983, attr_start_acc: 0.9900, attr_end_acc: 0.9935, span_micro_p: 0.9946, span_micro_r: 0.9939, span_micro_f1: 0.9942, micro_p: 0.9929, micro_r: 0.9846, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 1.6635, span_acc: 0.9983, attr_start_acc: 0.9901, attr_end_acc: 0.9932, span_micro_p: 0.9947, span_micro_r: 0.9940, span_micro_f1: 0.9943, micro_p: 0.9929, micro_r: 0.9846, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 1.7224, span_acc: 0.9983, attr_start_acc: 0.9901, attr_end_acc: 0.9930, span_micro_p: 0.9946, span_micro_r: 0.9940, span_micro_f1: 0.9943, micro_p: 0.9930, micro_r: 0.9845, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.67 / 97.72 / 97.92), p: (95.5 / 96.48), r: (96.33 / 95.89999999999999), f1: (95.91 / 96.19)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 23.37951800323717, 'span_acc': 0.9867361440075794, 'attr_start_acc': 0.9771505376344086, 'attr_end_acc': 0.9791666666666666, 'span_micro_p': 0.9549668874172186, 'span_micro_r': 0.9632598530394122, 'span_micro_f1': 0.9590954439640837, 'micro_p': 0.9647935003385241, 'micro_r': 0.9589502018842531, 'micro_f1': 0.9618629767127911, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9443, 0.9443, 0.9443), 'TITLE': (0.9721, 0.9594, 0.9657), 'CONT': (1.0, 0.9697, 0.9846), 'EDU': (1.0, 0.9811, 0.9905), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9618629767127911 / 0.9639609296059278
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.94 / 96.69 / 97.36), p: (94.82000000000001 / 95.54), r: (95.46 / 94.72), f1: (95.14 / 95.13000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 15.692833925193211, 'span_acc': 0.9794147325933401, 'attr_start_acc': 0.9668711656441717, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9482023156611822, 'span_micro_r': 0.9546012269938651, 'span_micro_f1': 0.9513910119229594, 'micro_p': 0.9554455445544554, 'micro_r': 0.947239263803681, 'micro_f1': 0.9513247073321012, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9364, 0.9313, 0.9338), 'PRO': (0.8919, 1.0, 0.9429), 'TITLE': (0.9579, 0.943, 0.9504), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9513247073321012 / 0.9605181986428131
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: -1.6588, span_acc: 1.0000, attr_start_acc: 0.9919, attr_end_acc: 0.9919, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9973, micro_r: 0.9919, micro_f1: 0.9946
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: -1.7979, span_acc: 0.9998, attr_start_acc: 0.9906, attr_end_acc: 0.9947, span_micro_p: 0.9987, span_micro_r: 0.9987, span_micro_f1: 0.9987, micro_p: 0.9946, micro_r: 0.9906, micro_f1: 0.9926
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 1.3859, span_acc: 0.9994, attr_start_acc: 0.9878, attr_end_acc: 0.9939, span_micro_p: 0.9974, span_micro_r: 0.9983, span_micro_f1: 0.9978, micro_p: 0.9939, micro_r: 0.9869, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 1.3699, span_acc: 0.9994, attr_start_acc: 0.9901, attr_end_acc: 0.9950, span_micro_p: 0.9975, span_micro_r: 0.9975, span_micro_f1: 0.9975, micro_p: 0.9950, micro_r: 0.9888, micro_f1: 0.9919
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 1.5855, span_acc: 0.9992, attr_start_acc: 0.9907, attr_end_acc: 0.9956, span_micro_p: 0.9961, span_micro_r: 0.9971, span_micro_f1: 0.9966, micro_p: 0.9956, micro_r: 0.9888, micro_f1: 0.9922
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 1.3414, span_acc: 0.9993, attr_start_acc: 0.9893, attr_end_acc: 0.9944, span_micro_p: 0.9968, span_micro_r: 0.9976, span_micro_f1: 0.9972, micro_p: 0.9944, micro_r: 0.9873, micro_f1: 0.9908
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 2.1500, span_acc: 0.9991, attr_start_acc: 0.9897, attr_end_acc: 0.9935, span_micro_p: 0.9969, span_micro_r: 0.9976, span_micro_f1: 0.9973, micro_p: 0.9938, micro_r: 0.9870, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 3.3113, span_acc: 0.9992, attr_start_acc: 0.9904, attr_end_acc: 0.9937, span_micro_p: 0.9973, span_micro_r: 0.9979, span_micro_f1: 0.9976, micro_p: 0.9945, micro_r: 0.9873, micro_f1: 0.9909
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 3.3118, span_acc: 0.9988, attr_start_acc: 0.9892, attr_end_acc: 0.9933, span_micro_p: 0.9957, span_micro_r: 0.9960, span_micro_f1: 0.9959, micro_p: 0.9938, micro_r: 0.9855, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 3.1179, span_acc: 0.9987, attr_start_acc: 0.9895, attr_end_acc: 0.9936, span_micro_p: 0.9957, span_micro_r: 0.9953, span_micro_f1: 0.9955, micro_p: 0.9940, micro_r: 0.9857, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 2.7695, span_acc: 0.9988, attr_start_acc: 0.9896, attr_end_acc: 0.9939, span_micro_p: 0.9957, span_micro_r: 0.9952, span_micro_f1: 0.9955, micro_p: 0.9943, micro_r: 0.9859, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 3.2954, span_acc: 0.9983, attr_start_acc: 0.9888, attr_end_acc: 0.9938, span_micro_p: 0.9950, span_micro_r: 0.9946, span_micro_f1: 0.9948, micro_p: 0.9933, micro_r: 0.9848, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 3.1726, span_acc: 0.9984, attr_start_acc: 0.9893, attr_end_acc: 0.9943, span_micro_p: 0.9950, span_micro_r: 0.9947, span_micro_f1: 0.9949, micro_p: 0.9938, micro_r: 0.9856, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 2.9096, span_acc: 0.9984, attr_start_acc: 0.9899, attr_end_acc: 0.9945, span_micro_p: 0.9952, span_micro_r: 0.9947, span_micro_f1: 0.9950, micro_p: 0.9943, micro_r: 0.9863, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 2.7521, span_acc: 0.9985, attr_start_acc: 0.9897, attr_end_acc: 0.9947, span_micro_p: 0.9955, span_micro_r: 0.9951, span_micro_f1: 0.9953, micro_p: 0.9942, micro_r: 0.9857, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 2.4800, span_acc: 0.9984, attr_start_acc: 0.9901, attr_end_acc: 0.9946, span_micro_p: 0.9945, span_micro_r: 0.9945, span_micro_f1: 0.9945, micro_p: 0.9939, micro_r: 0.9854, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 2.2340, span_acc: 0.9984, attr_start_acc: 0.9900, attr_end_acc: 0.9947, span_micro_p: 0.9947, span_micro_r: 0.9947, span_micro_f1: 0.9947, micro_p: 0.9939, micro_r: 0.9855, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 2.4455, span_acc: 0.9985, attr_start_acc: 0.9903, attr_end_acc: 0.9945, span_micro_p: 0.9948, span_micro_r: 0.9948, span_micro_f1: 0.9948, micro_p: 0.9937, micro_r: 0.9854, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 2.2532, span_acc: 0.9985, attr_start_acc: 0.9901, attr_end_acc: 0.9939, span_micro_p: 0.9947, span_micro_r: 0.9950, span_micro_f1: 0.9949, micro_p: 0.9934, micro_r: 0.9850, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 2.3405, span_acc: 0.9985, attr_start_acc: 0.9901, attr_end_acc: 0.9938, span_micro_p: 0.9947, span_micro_r: 0.9950, span_micro_f1: 0.9949, micro_p: 0.9935, micro_r: 0.9849, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 2.2650, span_acc: 0.9986, attr_start_acc: 0.9902, attr_end_acc: 0.9937, span_micro_p: 0.9950, span_micro_r: 0.9952, span_micro_f1: 0.9951, micro_p: 0.9934, micro_r: 0.9848, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 2.1198, span_acc: 0.9987, attr_start_acc: 0.9904, attr_end_acc: 0.9938, span_micro_p: 0.9952, span_micro_r: 0.9954, span_micro_f1: 0.9953, micro_p: 0.9933, micro_r: 0.9849, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 1.9949, span_acc: 0.9987, attr_start_acc: 0.9905, attr_end_acc: 0.9939, span_micro_p: 0.9954, span_micro_r: 0.9956, span_micro_f1: 0.9955, micro_p: 0.9933, micro_r: 0.9852, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 2.6211, span_acc: 0.9987, attr_start_acc: 0.9905, attr_end_acc: 0.9940, span_micro_p: 0.9954, span_micro_r: 0.9956, span_micro_f1: 0.9955, micro_p: 0.9935, micro_r: 0.9853, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 3.1298, span_acc: 0.9987, attr_start_acc: 0.9900, attr_end_acc: 0.9937, span_micro_p: 0.9953, span_micro_r: 0.9954, span_micro_f1: 0.9953, micro_p: 0.9934, micro_r: 0.9846, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 3.0191, span_acc: 0.9987, attr_start_acc: 0.9897, attr_end_acc: 0.9934, span_micro_p: 0.9954, span_micro_r: 0.9954, span_micro_f1: 0.9954, micro_p: 0.9935, micro_r: 0.9843, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 2.9090, span_acc: 0.9987, attr_start_acc: 0.9899, attr_end_acc: 0.9933, span_micro_p: 0.9956, span_micro_r: 0.9956, span_micro_f1: 0.9956, micro_p: 0.9936, micro_r: 0.9845, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 2.7659, span_acc: 0.9988, attr_start_acc: 0.9900, attr_end_acc: 0.9935, span_micro_p: 0.9957, span_micro_r: 0.9957, span_micro_f1: 0.9957, micro_p: 0.9938, micro_r: 0.9846, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 2.6769, span_acc: 0.9988, attr_start_acc: 0.9899, attr_end_acc: 0.9935, span_micro_p: 0.9959, span_micro_r: 0.9959, span_micro_f1: 0.9959, micro_p: 0.9938, micro_r: 0.9847, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 2.7919, span_acc: 0.9988, attr_start_acc: 0.9903, attr_end_acc: 0.9938, span_micro_p: 0.9957, span_micro_r: 0.9959, span_micro_f1: 0.9958, micro_p: 0.9940, micro_r: 0.9853, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 3.0704, span_acc: 0.9989, attr_start_acc: 0.9901, attr_end_acc: 0.9937, span_micro_p: 0.9959, span_micro_r: 0.9960, span_micro_f1: 0.9959, micro_p: 0.9940, micro_r: 0.9851, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 3.0211, span_acc: 0.9988, attr_start_acc: 0.9898, attr_end_acc: 0.9935, span_micro_p: 0.9957, span_micro_r: 0.9957, span_micro_f1: 0.9957, micro_p: 0.9939, micro_r: 0.9846, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.47 / 97.65 / 97.65), p: (95.37 / 96.67), r: (96.26 / 95.83), f1: (95.81 / 96.25)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 48.0377961234964, 'span_acc': 0.9847228801515869, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9764784946236559, 'span_micro_p': 0.9536730641958967, 'span_micro_r': 0.9625918503674015, 'span_micro_f1': 0.9581117021276595, 'micro_p': 0.96673455532926, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9624873267995945, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9476, 0.9367, 0.9421), 'TITLE': (0.9736, 0.9638, 0.9687), 'EDU': (0.9904, 0.9717, 0.981), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9624873267995945 / 0.9639609296059278
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.27 / 96.63000000000001 / 97.48), p: (95.19 / 96.21), r: (95.89 / 94.97), f1: (95.54 / 95.59)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 29.706763616897774, 'span_acc': 0.982744702320888, 'attr_start_acc': 0.9662576687116564, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.9518879415347138, 'span_micro_r': 0.9588957055214724, 'span_micro_f1': 0.9553789731051344, 'micro_p': 0.9620882535736482, 'micro_r': 0.9496932515337423, 'micro_f1': 0.9558505711639395, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.9118, 0.9394, 0.9254), 'ORG': (0.9489, 0.9403, 0.9446), 'TITLE': (0.9617, 0.9443, 0.9529), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9558505711639395 / 0.9605181986428131
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.963961
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.960518
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9839556004036327
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9723926380368099
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9723926380368099
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9624152803450401
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9582822085889571
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9603442975714725
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9658808933002482
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9552147239263804
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.9605181986428131
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9579, 0.9458, 0.9518), 'TITLE': (0.9619, 0.9495, 0.9557), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 1.7681, span_acc: 0.6353, attr_start_acc: 0.0051, attr_end_acc: 0.0127, span_micro_p: 0.3626, span_micro_r: 0.0833, span_micro_f1: 0.1355, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.4087, span_acc: 0.7858, attr_start_acc: 0.0091, attr_end_acc: 0.1896, span_micro_p: 0.7154, span_micro_r: 0.4100, span_micro_f1: 0.5212, micro_p: 0.1463, micro_r: 0.0068, micro_f1: 0.0131
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.2297, span_acc: 0.8373, attr_start_acc: 0.1601, attr_end_acc: 0.3392, span_micro_p: 0.7718, span_micro_r: 0.5360, span_micro_f1: 0.6327, micro_p: 0.6944, micro_r: 0.1146, micro_f1: 0.1967
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.1116, span_acc: 0.8652, attr_start_acc: 0.3137, attr_end_acc: 0.4512, span_micro_p: 0.8180, span_micro_r: 0.6114, span_micro_f1: 0.6997, micro_p: 0.7993, micro_r: 0.2555, micro_f1: 0.3872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.0383, span_acc: 0.8836, attr_start_acc: 0.4067, attr_end_acc: 0.5226, span_micro_p: 0.8434, span_micro_r: 0.6577, span_micro_f1: 0.7390, micro_p: 0.8470, micro_r: 0.3467, micro_f1: 0.4920
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 0.9692, span_acc: 0.8985, attr_start_acc: 0.4702, attr_end_acc: 0.5729, span_micro_p: 0.8621, span_micro_r: 0.6973, span_micro_f1: 0.7710, micro_p: 0.8752, micro_r: 0.4126, micro_f1: 0.5608
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 0.9216, span_acc: 0.9070, attr_start_acc: 0.5137, attr_end_acc: 0.6159, span_micro_p: 0.8725, span_micro_r: 0.7218, span_micro_f1: 0.7900, micro_p: 0.8896, micro_r: 0.4567, micro_f1: 0.6036
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 0.8823, span_acc: 0.9126, attr_start_acc: 0.5429, attr_end_acc: 0.6442, span_micro_p: 0.8758, span_micro_r: 0.7375, span_micro_f1: 0.8007, micro_p: 0.8966, micro_r: 0.4876, micro_f1: 0.6317
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 0.8450, span_acc: 0.9192, attr_start_acc: 0.5743, attr_end_acc: 0.6712, span_micro_p: 0.8842, span_micro_r: 0.7576, span_micro_f1: 0.8160, micro_p: 0.9041, micro_r: 0.5217, micro_f1: 0.6616
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 0.8166, span_acc: 0.9247, attr_start_acc: 0.6045, attr_end_acc: 0.6944, span_micro_p: 0.8894, span_micro_r: 0.7727, span_micro_f1: 0.8270, micro_p: 0.9102, micro_r: 0.5516, micro_f1: 0.6869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 0.7884, span_acc: 0.9296, attr_start_acc: 0.6298, attr_end_acc: 0.7122, span_micro_p: 0.8912, span_micro_r: 0.7829, span_micro_f1: 0.8336, micro_p: 0.9138, micro_r: 0.5776, micro_f1: 0.7078
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 0.7618, span_acc: 0.9341, attr_start_acc: 0.6549, attr_end_acc: 0.7315, span_micro_p: 0.8962, span_micro_r: 0.7960, span_micro_f1: 0.8431, micro_p: 0.9204, micro_r: 0.6045, micro_f1: 0.7297
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 0.7385, span_acc: 0.9378, attr_start_acc: 0.6758, attr_end_acc: 0.7475, span_micro_p: 0.9011, span_micro_r: 0.8070, span_micro_f1: 0.8515, micro_p: 0.9258, micro_r: 0.6270, micro_f1: 0.7476
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 0.7212, span_acc: 0.9397, attr_start_acc: 0.6935, attr_end_acc: 0.7602, span_micro_p: 0.9029, span_micro_r: 0.8132, span_micro_f1: 0.8557, micro_p: 0.9288, micro_r: 0.6438, micro_f1: 0.7605
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 0.7026, span_acc: 0.9423, attr_start_acc: 0.7085, attr_end_acc: 0.7715, span_micro_p: 0.9063, span_micro_r: 0.8206, span_micro_f1: 0.8613, micro_p: 0.9326, micro_r: 0.6607, micro_f1: 0.7734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 0.6868, span_acc: 0.9436, attr_start_acc: 0.7215, attr_end_acc: 0.7813, span_micro_p: 0.9086, span_micro_r: 0.8266, span_micro_f1: 0.8656, micro_p: 0.9347, micro_r: 0.6741, micro_f1: 0.7833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 0.6696, span_acc: 0.9459, attr_start_acc: 0.7346, attr_end_acc: 0.7906, span_micro_p: 0.9099, span_micro_r: 0.8321, span_micro_f1: 0.8692, micro_p: 0.9351, micro_r: 0.6870, micro_f1: 0.7921
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 0.6532, span_acc: 0.9474, attr_start_acc: 0.7446, attr_end_acc: 0.7991, span_micro_p: 0.9117, span_micro_r: 0.8368, span_micro_f1: 0.8726, micro_p: 0.9368, micro_r: 0.6984, micro_f1: 0.8002
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 0.6406, span_acc: 0.9486, attr_start_acc: 0.7542, attr_end_acc: 0.8070, span_micro_p: 0.9106, span_micro_r: 0.8387, span_micro_f1: 0.8732, micro_p: 0.9351, micro_r: 0.7078, micro_f1: 0.8057
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 0.6258, span_acc: 0.9500, attr_start_acc: 0.7624, attr_end_acc: 0.8140, span_micro_p: 0.9124, span_micro_r: 0.8434, span_micro_f1: 0.8765, micro_p: 0.9358, micro_r: 0.7169, micro_f1: 0.8119
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 0.6120, span_acc: 0.9514, attr_start_acc: 0.7706, attr_end_acc: 0.8211, span_micro_p: 0.9144, span_micro_r: 0.8475, span_micro_f1: 0.8797, micro_p: 0.9369, micro_r: 0.7262, micro_f1: 0.8182
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 0.6023, span_acc: 0.9521, attr_start_acc: 0.7772, attr_end_acc: 0.8271, span_micro_p: 0.9149, span_micro_r: 0.8502, span_micro_f1: 0.8814, micro_p: 0.9381, micro_r: 0.7334, micro_f1: 0.8232
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 0.5887, span_acc: 0.9531, attr_start_acc: 0.7832, attr_end_acc: 0.8326, span_micro_p: 0.9167, span_micro_r: 0.8534, span_micro_f1: 0.8839, micro_p: 0.9398, micro_r: 0.7401, micro_f1: 0.8281
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 0.5793, span_acc: 0.9542, attr_start_acc: 0.7899, attr_end_acc: 0.8387, span_micro_p: 0.9174, span_micro_r: 0.8561, span_micro_f1: 0.8857, micro_p: 0.9400, micro_r: 0.7476, micro_f1: 0.8329
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 0.5663, span_acc: 0.9553, attr_start_acc: 0.7961, attr_end_acc: 0.8438, span_micro_p: 0.9189, span_micro_r: 0.8599, span_micro_f1: 0.8884, micro_p: 0.9414, micro_r: 0.7546, micro_f1: 0.8377
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 0.5544, span_acc: 0.9561, attr_start_acc: 0.8013, attr_end_acc: 0.8481, span_micro_p: 0.9185, span_micro_r: 0.8617, span_micro_f1: 0.8892, micro_p: 0.9410, micro_r: 0.7597, micro_f1: 0.8407
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 0.5430, span_acc: 0.9564, attr_start_acc: 0.8064, attr_end_acc: 0.8521, span_micro_p: 0.9185, span_micro_r: 0.8632, span_micro_f1: 0.8900, micro_p: 0.9407, micro_r: 0.7650, micro_f1: 0.8438
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 0.5330, span_acc: 0.9571, attr_start_acc: 0.8118, attr_end_acc: 0.8556, span_micro_p: 0.9194, span_micro_r: 0.8650, span_micro_f1: 0.8914, micro_p: 0.9410, micro_r: 0.7699, micro_f1: 0.8469
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 0.5215, span_acc: 0.9580, attr_start_acc: 0.8168, attr_end_acc: 0.8596, span_micro_p: 0.9201, span_micro_r: 0.8680, span_micro_f1: 0.8933, micro_p: 0.9418, micro_r: 0.7757, micro_f1: 0.8507
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 0.5112, span_acc: 0.9589, attr_start_acc: 0.8223, attr_end_acc: 0.8637, span_micro_p: 0.9221, span_micro_r: 0.8712, span_micro_f1: 0.8959, micro_p: 0.9434, micro_r: 0.7821, micro_f1: 0.8552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 0.5004, span_acc: 0.9598, attr_start_acc: 0.8262, attr_end_acc: 0.8667, span_micro_p: 0.9232, span_micro_r: 0.8738, span_micro_f1: 0.8978, micro_p: 0.9445, micro_r: 0.7866, micro_f1: 0.8583
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.95 / 96.71 / 97.38), p: (96.39999999999999 / 96.83), r: (94.92 / 94.48), f1: (95.66 / 95.64)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.07367644196710113, 'span_acc': 0.9795120795831359, 'attr_start_acc': 0.9670698924731183, 'attr_end_acc': 0.9737903225806451, 'span_micro_p': 0.9640434192672999, 'span_micro_r': 0.9492317969271877, 'span_micro_f1': 0.9565802760013463, 'micro_p': 0.9682758620689655, 'micro_r': 0.9448183041722745, 'micro_f1': 0.9564032697547684, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9412, 0.8889, 0.9143), 'ORG': (0.9528, 0.929, 0.9407), 'TITLE': (0.9746, 0.9464, 0.9603), 'EDU': (0.9714, 0.9623, 0.9668), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9564032697547684 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.23 / 95.52000000000001 / 96.5), p: (96.16 / 97.25), r: (93.67999999999999 / 93.25), f1: (94.89999999999999 / 95.21)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.07816367366778776, 'span_acc': 0.9722502522704339, 'attr_start_acc': 0.9552147239263804, 'attr_end_acc': 0.9650306748466257, 'span_micro_p': 0.9615869017632241, 'span_micro_r': 0.9368098159509203, 'span_micro_f1': 0.9490366687383468, 'micro_p': 0.9724888035828535, 'micro_r': 0.9325153374233128, 'micro_f1': 0.952082680864391, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9118, 0.9394, 0.9254), 'ORG': (0.964, 0.9204, 0.9417), 'TITLE': (0.9743, 0.9313, 0.9523), 'EDU': (0.9817, 0.9554, 0.9684), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.952082680864391 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.3158, span_acc: 0.9448, attr_start_acc: 0.9143, attr_end_acc: 0.9143, span_micro_p: 0.8529, span_micro_r: 0.8286, span_micro_f1: 0.8406, micro_p: 1.0000, micro_r: 0.8286, micro_f1: 0.9062
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.1467, span_acc: 0.9821, attr_start_acc: 0.9638, attr_end_acc: 0.9793, span_micro_p: 0.9557, span_micro_r: 0.9459, span_micro_f1: 0.9508, micro_p: 0.9784, micro_r: 0.9354, micro_f1: 0.9564
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.1327, span_acc: 0.9830, attr_start_acc: 0.9657, attr_end_acc: 0.9718, span_micro_p: 0.9530, span_micro_r: 0.9379, span_micro_f1: 0.9454, micro_p: 0.9732, micro_r: 0.9339, micro_f1: 0.9532
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.1225, span_acc: 0.9843, attr_start_acc: 0.9655, attr_end_acc: 0.9670, span_micro_p: 0.9587, span_micro_r: 0.9422, span_micro_f1: 0.9504, micro_p: 0.9722, micro_r: 0.9325, micro_f1: 0.9519
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.1276, span_acc: 0.9837, attr_start_acc: 0.9672, attr_end_acc: 0.9720, span_micro_p: 0.9574, span_micro_r: 0.9449, span_micro_f1: 0.9511, micro_p: 0.9704, micro_r: 0.9374, micro_f1: 0.9536
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.1313, span_acc: 0.9817, attr_start_acc: 0.9632, attr_end_acc: 0.9699, span_micro_p: 0.9505, span_micro_r: 0.9406, span_micro_f1: 0.9455, micro_p: 0.9648, micro_r: 0.9316, micro_f1: 0.9479
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.1195, span_acc: 0.9815, attr_start_acc: 0.9622, attr_end_acc: 0.9713, span_micro_p: 0.9505, span_micro_r: 0.9411, span_micro_f1: 0.9458, micro_p: 0.9642, micro_r: 0.9324, micro_f1: 0.9480
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.1098, span_acc: 0.9821, attr_start_acc: 0.9646, attr_end_acc: 0.9725, span_micro_p: 0.9535, span_micro_r: 0.9460, span_micro_f1: 0.9497, micro_p: 0.9669, micro_r: 0.9363, micro_f1: 0.9514
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.1022, span_acc: 0.9832, attr_start_acc: 0.9661, attr_end_acc: 0.9724, span_micro_p: 0.9564, span_micro_r: 0.9498, span_micro_f1: 0.9531, micro_p: 0.9684, micro_r: 0.9390, micro_f1: 0.9535
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.0935, span_acc: 0.9831, attr_start_acc: 0.9650, attr_end_acc: 0.9701, span_micro_p: 0.9564, span_micro_r: 0.9472, span_micro_f1: 0.9518, micro_p: 0.9685, micro_r: 0.9370, micro_f1: 0.9525
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.0844, span_acc: 0.9841, attr_start_acc: 0.9666, attr_end_acc: 0.9719, span_micro_p: 0.9581, span_micro_r: 0.9494, span_micro_f1: 0.9537, micro_p: 0.9697, micro_r: 0.9404, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.0693, span_acc: 0.9844, attr_start_acc: 0.9671, attr_end_acc: 0.9728, span_micro_p: 0.9587, span_micro_r: 0.9498, span_micro_f1: 0.9542, micro_p: 0.9703, micro_r: 0.9418, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.0599, span_acc: 0.9847, attr_start_acc: 0.9667, attr_end_acc: 0.9729, span_micro_p: 0.9593, span_micro_r: 0.9498, span_micro_f1: 0.9546, micro_p: 0.9698, micro_r: 0.9425, micro_f1: 0.9559
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.0525, span_acc: 0.9846, attr_start_acc: 0.9659, attr_end_acc: 0.9720, span_micro_p: 0.9586, span_micro_r: 0.9489, span_micro_f1: 0.9537, micro_p: 0.9700, micro_r: 0.9418, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.0418, span_acc: 0.9846, attr_start_acc: 0.9664, attr_end_acc: 0.9726, span_micro_p: 0.9586, span_micro_r: 0.9491, span_micro_f1: 0.9539, micro_p: 0.9692, micro_r: 0.9426, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.0318, span_acc: 0.9849, attr_start_acc: 0.9667, attr_end_acc: 0.9728, span_micro_p: 0.9598, span_micro_r: 0.9500, span_micro_f1: 0.9548, micro_p: 0.9689, micro_r: 0.9428, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.0284, span_acc: 0.9848, attr_start_acc: 0.9662, attr_end_acc: 0.9721, span_micro_p: 0.9594, span_micro_r: 0.9496, span_micro_f1: 0.9545, micro_p: 0.9687, micro_r: 0.9423, micro_f1: 0.9553
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.0194, span_acc: 0.9851, attr_start_acc: 0.9660, attr_end_acc: 0.9721, span_micro_p: 0.9597, span_micro_r: 0.9504, span_micro_f1: 0.9550, micro_p: 0.9694, micro_r: 0.9424, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.0221, span_acc: 0.9844, attr_start_acc: 0.9661, attr_end_acc: 0.9720, span_micro_p: 0.9587, span_micro_r: 0.9494, span_micro_f1: 0.9540, micro_p: 0.9694, micro_r: 0.9423, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.0133, span_acc: 0.9846, attr_start_acc: 0.9657, attr_end_acc: 0.9723, span_micro_p: 0.9586, span_micro_r: 0.9497, span_micro_f1: 0.9541, micro_p: 0.9688, micro_r: 0.9426, micro_f1: 0.9555
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.0067, span_acc: 0.9844, attr_start_acc: 0.9651, attr_end_acc: 0.9726, span_micro_p: 0.9588, span_micro_r: 0.9495, span_micro_f1: 0.9541, micro_p: 0.9686, micro_r: 0.9421, micro_f1: 0.9552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: -0.0045, span_acc: 0.9849, attr_start_acc: 0.9658, attr_end_acc: 0.9731, span_micro_p: 0.9596, span_micro_r: 0.9508, span_micro_f1: 0.9552, micro_p: 0.9692, micro_r: 0.9432, micro_f1: 0.9560
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: -0.0107, span_acc: 0.9849, attr_start_acc: 0.9658, attr_end_acc: 0.9729, span_micro_p: 0.9599, span_micro_r: 0.9509, span_micro_f1: 0.9554, micro_p: 0.9695, micro_r: 0.9431, micro_f1: 0.9561
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: -0.0183, span_acc: 0.9848, attr_start_acc: 0.9652, attr_end_acc: 0.9731, span_micro_p: 0.9598, span_micro_r: 0.9509, span_micro_f1: 0.9553, micro_p: 0.9698, micro_r: 0.9428, micro_f1: 0.9562
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: -0.0121, span_acc: 0.9848, attr_start_acc: 0.9651, attr_end_acc: 0.9731, span_micro_p: 0.9595, span_micro_r: 0.9511, span_micro_f1: 0.9553, micro_p: 0.9697, micro_r: 0.9427, micro_f1: 0.9560
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: -0.0117, span_acc: 0.9842, attr_start_acc: 0.9661, attr_end_acc: 0.9737, span_micro_p: 0.9579, span_micro_r: 0.9510, span_micro_f1: 0.9544, micro_p: 0.9692, micro_r: 0.9432, micro_f1: 0.9560
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: -0.0162, span_acc: 0.9842, attr_start_acc: 0.9667, attr_end_acc: 0.9738, span_micro_p: 0.9571, span_micro_r: 0.9512, span_micro_f1: 0.9542, micro_p: 0.9689, micro_r: 0.9434, micro_f1: 0.9560
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: -0.0192, span_acc: 0.9840, attr_start_acc: 0.9665, attr_end_acc: 0.9743, span_micro_p: 0.9567, span_micro_r: 0.9509, span_micro_f1: 0.9538, micro_p: 0.9685, micro_r: 0.9431, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: -0.0257, span_acc: 0.9842, attr_start_acc: 0.9669, attr_end_acc: 0.9748, span_micro_p: 0.9573, span_micro_r: 0.9518, span_micro_f1: 0.9545, micro_p: 0.9688, micro_r: 0.9439, micro_f1: 0.9562
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: -0.0246, span_acc: 0.9841, attr_start_acc: 0.9670, attr_end_acc: 0.9748, span_micro_p: 0.9572, span_micro_r: 0.9513, span_micro_f1: 0.9542, micro_p: 0.9691, micro_r: 0.9443, micro_f1: 0.9565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: -0.0345, span_acc: 0.9843, attr_start_acc: 0.9673, attr_end_acc: 0.9748, span_micro_p: 0.9575, span_micro_r: 0.9515, span_micro_f1: 0.9545, micro_p: 0.9693, micro_r: 0.9445, micro_f1: 0.9567
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: -0.0363, span_acc: 0.9841, attr_start_acc: 0.9671, attr_end_acc: 0.9746, span_micro_p: 0.9568, span_micro_r: 0.9509, span_micro_f1: 0.9538, micro_p: 0.9689, micro_r: 0.9440, micro_f1: 0.9563
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 97.04 / 97.72), p: (95.65 / 96.17), r: (95.52000000000001 / 94.62), f1: (95.59 / 95.39)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.35473873928092725, 'span_acc': 0.9851965892941734, 'attr_start_acc': 0.9704301075268817, 'attr_end_acc': 0.9771505376344086, 'span_micro_p': 0.9565217391304348, 'span_micro_r': 0.9552438209752839, 'span_micro_f1': 0.9558823529411766, 'micro_p': 0.9616963064295485, 'micro_r': 0.946164199192463, 'micro_f1': 0.9538670284938942, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9417, 0.9309, 0.9363), 'EDU': (0.9802, 0.934, 0.9565), 'TITLE': (0.9675, 0.9478, 0.9575), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9538670284938942 / 0.9564032697547684
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.11999999999999 / 95.77 / 97.11999999999999), p: (95.76 / 96.96000000000001), r: (94.17 / 93.87), f1: (94.96 / 95.39)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.4275501471645427, 'span_acc': 0.9812310797174572, 'attr_start_acc': 0.9576687116564417, 'attr_end_acc': 0.9711656441717792, 'span_micro_p': 0.9575795383655645, 'span_micro_r': 0.941717791411043, 'span_micro_f1': 0.949582431178472, 'micro_p': 0.9695817490494296, 'micro_r': 0.9386503067484663, 'micro_f1': 0.953865336658354, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9604, 0.9204, 0.94), 'TITLE': (0.9652, 0.9352, 0.95), 'PRO': (0.9697, 0.9697, 0.9697), 'EDU': (1.0, 0.9643, 0.9818), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.953865336658354 / 0.952082680864391
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: -0.3166, span_acc: 1.0000, attr_start_acc: 0.9870, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9870, micro_f1: 0.9935
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: -0.3656, span_acc: 0.9780, attr_start_acc: 0.9618, attr_end_acc: 0.9682, span_micro_p: 0.9674, span_micro_r: 0.9368, span_micro_f1: 0.9519, micro_p: 0.9737, micro_r: 0.9427, micro_f1: 0.9579
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: -0.2188, span_acc: 0.9797, attr_start_acc: 0.9570, attr_end_acc: 0.9729, span_micro_p: 0.9596, span_micro_r: 0.9317, span_micro_f1: 0.9455, micro_p: 0.9684, micro_r: 0.9376, micro_f1: 0.9528
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: -0.2957, span_acc: 0.9848, attr_start_acc: 0.9622, attr_end_acc: 0.9783, span_micro_p: 0.9698, span_micro_r: 0.9489, span_micro_f1: 0.9593, micro_p: 0.9751, micro_r: 0.9484, micro_f1: 0.9616
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: -0.3085, span_acc: 0.9861, attr_start_acc: 0.9666, attr_end_acc: 0.9803, span_micro_p: 0.9694, span_micro_r: 0.9539, span_micro_f1: 0.9616, micro_p: 0.9744, micro_r: 0.9529, micro_f1: 0.9635
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: -0.3059, span_acc: 0.9863, attr_start_acc: 0.9674, attr_end_acc: 0.9806, span_micro_p: 0.9677, span_micro_r: 0.9554, span_micro_f1: 0.9615, micro_p: 0.9749, micro_r: 0.9532, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: -0.2851, span_acc: 0.9867, attr_start_acc: 0.9680, attr_end_acc: 0.9809, span_micro_p: 0.9694, span_micro_r: 0.9578, span_micro_f1: 0.9636, micro_p: 0.9765, micro_r: 0.9547, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: -0.2970, span_acc: 0.9872, attr_start_acc: 0.9688, attr_end_acc: 0.9816, span_micro_p: 0.9700, span_micro_r: 0.9597, span_micro_f1: 0.9648, micro_p: 0.9767, micro_r: 0.9554, micro_f1: 0.9659
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: -0.3025, span_acc: 0.9873, attr_start_acc: 0.9691, attr_end_acc: 0.9816, span_micro_p: 0.9690, span_micro_r: 0.9592, span_micro_f1: 0.9640, micro_p: 0.9764, micro_r: 0.9548, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: -0.3208, span_acc: 0.9883, attr_start_acc: 0.9701, attr_end_acc: 0.9825, span_micro_p: 0.9713, span_micro_r: 0.9615, span_micro_f1: 0.9664, micro_p: 0.9783, micro_r: 0.9561, micro_f1: 0.9671
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: -0.3338, span_acc: 0.9887, attr_start_acc: 0.9707, attr_end_acc: 0.9836, span_micro_p: 0.9720, span_micro_r: 0.9627, span_micro_f1: 0.9673, micro_p: 0.9798, micro_r: 0.9577, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: -0.3182, span_acc: 0.9886, attr_start_acc: 0.9696, attr_end_acc: 0.9807, span_micro_p: 0.9707, span_micro_r: 0.9614, span_micro_f1: 0.9660, micro_p: 0.9778, micro_r: 0.9543, micro_f1: 0.9659
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: -0.3239, span_acc: 0.9886, attr_start_acc: 0.9694, attr_end_acc: 0.9807, span_micro_p: 0.9699, span_micro_r: 0.9612, span_micro_f1: 0.9655, micro_p: 0.9771, micro_r: 0.9538, micro_f1: 0.9653
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: -0.3248, span_acc: 0.9889, attr_start_acc: 0.9699, attr_end_acc: 0.9808, span_micro_p: 0.9707, span_micro_r: 0.9622, span_micro_f1: 0.9664, micro_p: 0.9783, micro_r: 0.9546, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: -0.3371, span_acc: 0.9891, attr_start_acc: 0.9707, attr_end_acc: 0.9815, span_micro_p: 0.9706, span_micro_r: 0.9631, span_micro_f1: 0.9668, micro_p: 0.9784, micro_r: 0.9557, micro_f1: 0.9669
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: -0.3479, span_acc: 0.9887, attr_start_acc: 0.9709, attr_end_acc: 0.9815, span_micro_p: 0.9699, span_micro_r: 0.9632, span_micro_f1: 0.9665, micro_p: 0.9773, micro_r: 0.9557, micro_f1: 0.9664
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: -0.3423, span_acc: 0.9890, attr_start_acc: 0.9712, attr_end_acc: 0.9817, span_micro_p: 0.9700, span_micro_r: 0.9638, span_micro_f1: 0.9669, micro_p: 0.9775, micro_r: 0.9561, micro_f1: 0.9667
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: -0.3407, span_acc: 0.9887, attr_start_acc: 0.9707, attr_end_acc: 0.9817, span_micro_p: 0.9688, span_micro_r: 0.9633, span_micro_f1: 0.9660, micro_p: 0.9773, micro_r: 0.9556, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: -0.3441, span_acc: 0.9890, attr_start_acc: 0.9702, attr_end_acc: 0.9820, span_micro_p: 0.9691, span_micro_r: 0.9645, span_micro_f1: 0.9668, micro_p: 0.9775, micro_r: 0.9554, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: -0.3498, span_acc: 0.9887, attr_start_acc: 0.9707, attr_end_acc: 0.9820, span_micro_p: 0.9681, span_micro_r: 0.9643, span_micro_f1: 0.9662, micro_p: 0.9770, micro_r: 0.9558, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: -0.3384, span_acc: 0.9884, attr_start_acc: 0.9711, attr_end_acc: 0.9816, span_micro_p: 0.9688, span_micro_r: 0.9645, span_micro_f1: 0.9666, micro_p: 0.9775, micro_r: 0.9561, micro_f1: 0.9667
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: -0.3347, span_acc: 0.9881, attr_start_acc: 0.9720, attr_end_acc: 0.9819, span_micro_p: 0.9696, span_micro_r: 0.9652, span_micro_f1: 0.9674, micro_p: 0.9776, micro_r: 0.9570, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: -0.3376, span_acc: 0.9884, attr_start_acc: 0.9718, attr_end_acc: 0.9816, span_micro_p: 0.9702, span_micro_r: 0.9656, span_micro_f1: 0.9679, micro_p: 0.9780, micro_r: 0.9567, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: -0.3414, span_acc: 0.9887, attr_start_acc: 0.9718, attr_end_acc: 0.9818, span_micro_p: 0.9706, span_micro_r: 0.9660, span_micro_f1: 0.9683, micro_p: 0.9780, micro_r: 0.9566, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: -0.3546, span_acc: 0.9888, attr_start_acc: 0.9723, attr_end_acc: 0.9821, span_micro_p: 0.9709, span_micro_r: 0.9666, span_micro_f1: 0.9687, micro_p: 0.9781, micro_r: 0.9574, micro_f1: 0.9676
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: -0.3581, span_acc: 0.9890, attr_start_acc: 0.9726, attr_end_acc: 0.9823, span_micro_p: 0.9710, span_micro_r: 0.9666, span_micro_f1: 0.9688, micro_p: 0.9786, micro_r: 0.9579, micro_f1: 0.9682
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: -0.3527, span_acc: 0.9888, attr_start_acc: 0.9723, attr_end_acc: 0.9815, span_micro_p: 0.9705, span_micro_r: 0.9656, span_micro_f1: 0.9680, micro_p: 0.9783, micro_r: 0.9569, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: -0.3618, span_acc: 0.9889, attr_start_acc: 0.9723, attr_end_acc: 0.9818, span_micro_p: 0.9706, span_micro_r: 0.9660, span_micro_f1: 0.9683, micro_p: 0.9784, micro_r: 0.9571, micro_f1: 0.9676
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: -0.3584, span_acc: 0.9887, attr_start_acc: 0.9725, attr_end_acc: 0.9819, span_micro_p: 0.9707, span_micro_r: 0.9657, span_micro_f1: 0.9682, micro_p: 0.9784, micro_r: 0.9570, micro_f1: 0.9676
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: -0.3548, span_acc: 0.9889, attr_start_acc: 0.9728, attr_end_acc: 0.9822, span_micro_p: 0.9710, span_micro_r: 0.9659, span_micro_f1: 0.9685, micro_p: 0.9783, micro_r: 0.9573, micro_f1: 0.9677
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: -0.3571, span_acc: 0.9889, attr_start_acc: 0.9730, attr_end_acc: 0.9822, span_micro_p: 0.9709, span_micro_r: 0.9658, span_micro_f1: 0.9683, micro_p: 0.9782, micro_r: 0.9576, micro_f1: 0.9678
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: -0.3558, span_acc: 0.9889, attr_start_acc: 0.9730, attr_end_acc: 0.9822, span_micro_p: 0.9713, span_micro_r: 0.9660, span_micro_f1: 0.9687, micro_p: 0.9784, micro_r: 0.9577, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.92999999999999 / 97.65 / 98.72), p: (95.46 / 96.41999999999999), r: (96.99 / 96.16), f1: (96.22 / 96.28999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.15418834073497203, 'span_acc': 0.9893415442918049, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9872311827956989, 'span_micro_p': 0.9546351084812623, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.9622266401590456, 'micro_p': 0.9642375168690959, 'micro_r': 0.9616419919246298, 'micro_f1': 0.9629380053908355, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9489, 0.9616, 0.9552), 'TITLE': (0.9676, 0.9536, 0.9605), 'EDU': (0.9903, 0.9623, 0.9761), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9629380053908355 / 0.9564032697547684
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.63 / 96.93 / 97.98), p: (94.56 / 95.74000000000001), r: (95.89 / 95.15), f1: (95.22 / 95.45)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.3831732509271154, 'span_acc': 0.98627648839556, 'attr_start_acc': 0.9693251533742331, 'attr_end_acc': 0.9797546012269939, 'span_micro_p': 0.9455535390199638, 'span_micro_r': 0.9588957055214724, 'span_micro_f1': 0.9521778860798052, 'micro_p': 0.9574074074074074, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9544615384615385, 'category-p/r/f1': {'PRO': (0.9355, 0.8788, 0.9063), 'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9342, 0.9494, 0.9417), 'TITLE': (0.9619, 0.9482, 0.955), 'EDU': (0.9907, 0.9464, 0.968), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9544615384615385 / 0.953865336658354
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.4257, span_acc: 0.9890, attr_start_acc: 0.9913, attr_end_acc: 0.9826, span_micro_p: 0.9739, span_micro_r: 0.9655, span_micro_f1: 0.9697, micro_p: 0.9825, micro_r: 0.9739, micro_f1: 0.9782
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -0.6254, span_acc: 0.9922, attr_start_acc: 0.9845, attr_end_acc: 0.9845, span_micro_p: 0.9845, span_micro_r: 0.9744, span_micro_f1: 0.9794, micro_p: 0.9877, micro_r: 0.9724, micro_f1: 0.9800
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.6419, span_acc: 0.9934, attr_start_acc: 0.9788, attr_end_acc: 0.9871, span_micro_p: 0.9817, span_micro_r: 0.9763, span_micro_f1: 0.9790, micro_p: 0.9813, micro_r: 0.9668, micro_f1: 0.9740
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.6674, span_acc: 0.9948, attr_start_acc: 0.9780, attr_end_acc: 0.9856, span_micro_p: 0.9849, span_micro_r: 0.9809, span_micro_f1: 0.9829, micro_p: 0.9825, micro_r: 0.9670, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -0.6352, span_acc: 0.9943, attr_start_acc: 0.9773, attr_end_acc: 0.9836, span_micro_p: 0.9821, span_micro_r: 0.9774, span_micro_f1: 0.9798, micro_p: 0.9806, micro_r: 0.9630, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -0.4530, span_acc: 0.9925, attr_start_acc: 0.9736, attr_end_acc: 0.9805, span_micro_p: 0.9793, span_micro_r: 0.9730, span_micro_f1: 0.9761, micro_p: 0.9783, micro_r: 0.9572, micro_f1: 0.9676
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -0.4799, span_acc: 0.9928, attr_start_acc: 0.9752, attr_end_acc: 0.9819, span_micro_p: 0.9800, span_micro_r: 0.9750, span_micro_f1: 0.9775, micro_p: 0.9792, micro_r: 0.9600, micro_f1: 0.9695
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -0.3418, span_acc: 0.9927, attr_start_acc: 0.9755, attr_end_acc: 0.9825, span_micro_p: 0.9803, span_micro_r: 0.9734, span_micro_f1: 0.9768, micro_p: 0.9811, micro_r: 0.9608, micro_f1: 0.9708
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -0.3547, span_acc: 0.9923, attr_start_acc: 0.9759, attr_end_acc: 0.9835, span_micro_p: 0.9793, span_micro_r: 0.9739, span_micro_f1: 0.9766, micro_p: 0.9817, micro_r: 0.9619, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: -0.3051, span_acc: 0.9914, attr_start_acc: 0.9746, attr_end_acc: 0.9833, span_micro_p: 0.9778, span_micro_r: 0.9693, span_micro_f1: 0.9735, micro_p: 0.9814, micro_r: 0.9603, micro_f1: 0.9708
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: -0.2842, span_acc: 0.9917, attr_start_acc: 0.9753, attr_end_acc: 0.9834, span_micro_p: 0.9773, span_micro_r: 0.9701, span_micro_f1: 0.9737, micro_p: 0.9812, micro_r: 0.9609, micro_f1: 0.9709
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: -0.3081, span_acc: 0.9917, attr_start_acc: 0.9753, attr_end_acc: 0.9838, span_micro_p: 0.9774, span_micro_r: 0.9708, span_micro_f1: 0.9741, micro_p: 0.9815, micro_r: 0.9615, micro_f1: 0.9714
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: -0.3196, span_acc: 0.9915, attr_start_acc: 0.9758, attr_end_acc: 0.9840, span_micro_p: 0.9775, span_micro_r: 0.9714, span_micro_f1: 0.9744, micro_p: 0.9813, micro_r: 0.9620, micro_f1: 0.9715
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: -0.2988, span_acc: 0.9918, attr_start_acc: 0.9757, attr_end_acc: 0.9842, span_micro_p: 0.9780, span_micro_r: 0.9719, span_micro_f1: 0.9749, micro_p: 0.9820, micro_r: 0.9623, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: -0.3209, span_acc: 0.9921, attr_start_acc: 0.9758, attr_end_acc: 0.9844, span_micro_p: 0.9783, span_micro_r: 0.9729, span_micro_f1: 0.9756, micro_p: 0.9825, micro_r: 0.9626, micro_f1: 0.9725
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: -0.3249, span_acc: 0.9920, attr_start_acc: 0.9765, attr_end_acc: 0.9842, span_micro_p: 0.9780, span_micro_r: 0.9728, span_micro_f1: 0.9754, micro_p: 0.9823, micro_r: 0.9628, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: -0.2900, span_acc: 0.9918, attr_start_acc: 0.9763, attr_end_acc: 0.9840, span_micro_p: 0.9773, span_micro_r: 0.9724, span_micro_f1: 0.9749, micro_p: 0.9817, micro_r: 0.9624, micro_f1: 0.9720
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: -0.3154, span_acc: 0.9919, attr_start_acc: 0.9761, attr_end_acc: 0.9844, span_micro_p: 0.9774, span_micro_r: 0.9725, span_micro_f1: 0.9750, micro_p: 0.9818, micro_r: 0.9624, micro_f1: 0.9720
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: -0.3484, span_acc: 0.9923, attr_start_acc: 0.9769, attr_end_acc: 0.9848, span_micro_p: 0.9785, span_micro_r: 0.9739, span_micro_f1: 0.9762, micro_p: 0.9827, micro_r: 0.9640, micro_f1: 0.9732
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: -0.3342, span_acc: 0.9923, attr_start_acc: 0.9765, attr_end_acc: 0.9849, span_micro_p: 0.9790, span_micro_r: 0.9745, span_micro_f1: 0.9768, micro_p: 0.9831, micro_r: 0.9639, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: -0.3370, span_acc: 0.9925, attr_start_acc: 0.9761, attr_end_acc: 0.9849, span_micro_p: 0.9793, span_micro_r: 0.9746, span_micro_f1: 0.9769, micro_p: 0.9832, micro_r: 0.9635, micro_f1: 0.9733
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: -0.3369, span_acc: 0.9925, attr_start_acc: 0.9766, attr_end_acc: 0.9850, span_micro_p: 0.9785, span_micro_r: 0.9747, span_micro_f1: 0.9766, micro_p: 0.9830, micro_r: 0.9640, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: -0.2576, span_acc: 0.9919, attr_start_acc: 0.9768, attr_end_acc: 0.9847, span_micro_p: 0.9791, span_micro_r: 0.9749, span_micro_f1: 0.9770, micro_p: 0.9834, micro_r: 0.9643, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: -0.2683, span_acc: 0.9918, attr_start_acc: 0.9767, attr_end_acc: 0.9848, span_micro_p: 0.9785, span_micro_r: 0.9744, span_micro_f1: 0.9764, micro_p: 0.9832, micro_r: 0.9640, micro_f1: 0.9735
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: -0.2769, span_acc: 0.9918, attr_start_acc: 0.9768, attr_end_acc: 0.9850, span_micro_p: 0.9786, span_micro_r: 0.9746, span_micro_f1: 0.9766, micro_p: 0.9833, micro_r: 0.9643, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: -0.2769, span_acc: 0.9918, attr_start_acc: 0.9765, attr_end_acc: 0.9850, span_micro_p: 0.9784, span_micro_r: 0.9744, span_micro_f1: 0.9764, micro_p: 0.9829, micro_r: 0.9641, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: -0.2739, span_acc: 0.9919, attr_start_acc: 0.9764, attr_end_acc: 0.9849, span_micro_p: 0.9785, span_micro_r: 0.9745, span_micro_f1: 0.9765, micro_p: 0.9831, micro_r: 0.9639, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: -0.2922, span_acc: 0.9920, attr_start_acc: 0.9769, attr_end_acc: 0.9850, span_micro_p: 0.9790, span_micro_r: 0.9748, span_micro_f1: 0.9769, micro_p: 0.9833, micro_r: 0.9646, micro_f1: 0.9739
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: -0.3094, span_acc: 0.9919, attr_start_acc: 0.9772, attr_end_acc: 0.9851, span_micro_p: 0.9783, span_micro_r: 0.9748, span_micro_f1: 0.9765, micro_p: 0.9831, micro_r: 0.9648, micro_f1: 0.9738
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: -0.3065, span_acc: 0.9920, attr_start_acc: 0.9769, attr_end_acc: 0.9851, span_micro_p: 0.9780, span_micro_r: 0.9750, span_micro_f1: 0.9765, micro_p: 0.9827, micro_r: 0.9648, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: -0.3046, span_acc: 0.9922, attr_start_acc: 0.9774, attr_end_acc: 0.9855, span_micro_p: 0.9786, span_micro_r: 0.9757, span_micro_f1: 0.9771, micro_p: 0.9832, micro_r: 0.9656, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: -0.3287, span_acc: 0.9924, attr_start_acc: 0.9779, attr_end_acc: 0.9858, span_micro_p: 0.9787, span_micro_r: 0.9760, span_micro_f1: 0.9774, micro_p: 0.9833, micro_r: 0.9660, micro_f1: 0.9746
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.71 / 97.45 / 98.05), p: (95.63000000000001 / 96.08), r: (96.59 / 95.63000000000001), f1: (96.11 / 95.85000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.1856724690026392, 'span_acc': 0.9870914258645191, 'attr_start_acc': 0.9744623655913979, 'attr_end_acc': 0.980510752688172, 'span_micro_p': 0.9563492063492064, 'span_micro_r': 0.9659318637274549, 'span_micro_f1': 0.9611166500498505, 'micro_p': 0.9607843137254902, 'micro_r': 0.9562584118438762, 'micro_f1': 0.9585160202360877, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9458, 0.9386, 0.9422), 'TITLE': (0.9677, 0.9565, 0.9621), 'EDU': (0.9633, 0.9906, 0.9768), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9585160202360877 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.57000000000001 / 96.69 / 97.42), p: (95.74000000000001 / 96.81), r: (95.21 / 94.97), f1: (95.48 / 95.88)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.10709192767833015, 'span_acc': 0.9856710393541877, 'attr_start_acc': 0.9668711656441717, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9574336829117829, 'span_micro_r': 0.9521472392638037, 'span_micro_f1': 0.9547831436481083, 'micro_p': 0.9681050656660413, 'micro_r': 0.9496932515337423, 'micro_f1': 0.9588107773304428, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9628, 0.9349, 0.9486), 'TITLE': (0.9643, 0.9443, 0.9542), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9588107773304428 / 0.9544615384615385
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: -0.6528, span_acc: 0.9956, attr_start_acc: 0.9866, attr_end_acc: 0.9866, span_micro_p: 0.9867, span_micro_r: 0.9867, span_micro_f1: 0.9867, micro_p: 0.9732, micro_r: 0.9732, micro_f1: 0.9732
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: -0.3661, span_acc: 0.9876, attr_start_acc: 0.9804, attr_end_acc: 0.9843, span_micro_p: 0.9786, span_micro_r: 0.9767, span_micro_f1: 0.9776, micro_p: 0.9880, micro_r: 0.9706, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: -0.4085, span_acc: 0.9913, attr_start_acc: 0.9821, attr_end_acc: 0.9899, span_micro_p: 0.9811, span_micro_r: 0.9800, span_micro_f1: 0.9805, micro_p: 0.9897, micro_r: 0.9742, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: -0.4970, span_acc: 0.9936, attr_start_acc: 0.9813, attr_end_acc: 0.9899, span_micro_p: 0.9845, span_micro_r: 0.9837, span_micro_f1: 0.9841, micro_p: 0.9897, micro_r: 0.9735, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: -0.1825, span_acc: 0.9929, attr_start_acc: 0.9789, attr_end_acc: 0.9889, span_micro_p: 0.9848, span_micro_r: 0.9802, span_micro_f1: 0.9825, micro_p: 0.9881, micro_r: 0.9725, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: -0.0853, span_acc: 0.9914, attr_start_acc: 0.9733, attr_end_acc: 0.9853, span_micro_p: 0.9802, span_micro_r: 0.9726, span_micro_f1: 0.9764, micro_p: 0.9831, micro_r: 0.9645, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: -0.1866, span_acc: 0.9920, attr_start_acc: 0.9747, attr_end_acc: 0.9860, span_micro_p: 0.9803, span_micro_r: 0.9730, span_micro_f1: 0.9766, micro_p: 0.9830, micro_r: 0.9655, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: -0.1970, span_acc: 0.9926, attr_start_acc: 0.9760, attr_end_acc: 0.9867, span_micro_p: 0.9820, span_micro_r: 0.9752, span_micro_f1: 0.9786, micro_p: 0.9840, micro_r: 0.9666, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: -0.2475, span_acc: 0.9927, attr_start_acc: 0.9769, attr_end_acc: 0.9873, span_micro_p: 0.9815, span_micro_r: 0.9739, span_micro_f1: 0.9777, micro_p: 0.9847, micro_r: 0.9670, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: -0.3309, span_acc: 0.9928, attr_start_acc: 0.9781, attr_end_acc: 0.9879, span_micro_p: 0.9805, span_micro_r: 0.9747, span_micro_f1: 0.9776, micro_p: 0.9843, micro_r: 0.9678, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: -0.3497, span_acc: 0.9932, attr_start_acc: 0.9789, attr_end_acc: 0.9891, span_micro_p: 0.9817, span_micro_r: 0.9763, span_micro_f1: 0.9790, micro_p: 0.9854, micro_r: 0.9696, micro_f1: 0.9774
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: -0.3588, span_acc: 0.9933, attr_start_acc: 0.9785, attr_end_acc: 0.9889, span_micro_p: 0.9825, span_micro_r: 0.9768, span_micro_f1: 0.9796, micro_p: 0.9857, micro_r: 0.9694, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: -0.3982, span_acc: 0.9934, attr_start_acc: 0.9793, attr_end_acc: 0.9893, span_micro_p: 0.9830, span_micro_r: 0.9776, span_micro_f1: 0.9803, micro_p: 0.9866, micro_r: 0.9709, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: -0.4434, span_acc: 0.9936, attr_start_acc: 0.9797, attr_end_acc: 0.9889, span_micro_p: 0.9836, span_micro_r: 0.9784, span_micro_f1: 0.9810, micro_p: 0.9868, micro_r: 0.9709, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: -0.3680, span_acc: 0.9933, attr_start_acc: 0.9799, attr_end_acc: 0.9881, span_micro_p: 0.9826, span_micro_r: 0.9778, span_micro_f1: 0.9802, micro_p: 0.9861, micro_r: 0.9703, micro_f1: 0.9781
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: -0.4032, span_acc: 0.9936, attr_start_acc: 0.9805, attr_end_acc: 0.9885, span_micro_p: 0.9831, span_micro_r: 0.9785, span_micro_f1: 0.9808, micro_p: 0.9869, micro_r: 0.9711, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: -0.3225, span_acc: 0.9936, attr_start_acc: 0.9807, attr_end_acc: 0.9882, span_micro_p: 0.9829, span_micro_r: 0.9782, span_micro_f1: 0.9806, micro_p: 0.9868, micro_r: 0.9711, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: -0.2553, span_acc: 0.9932, attr_start_acc: 0.9808, attr_end_acc: 0.9886, span_micro_p: 0.9809, span_micro_r: 0.9775, span_micro_f1: 0.9792, micro_p: 0.9863, micro_r: 0.9713, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: -0.2865, span_acc: 0.9931, attr_start_acc: 0.9806, attr_end_acc: 0.9884, span_micro_p: 0.9812, span_micro_r: 0.9778, span_micro_f1: 0.9795, micro_p: 0.9865, micro_r: 0.9714, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: -0.3263, span_acc: 0.9933, attr_start_acc: 0.9806, attr_end_acc: 0.9886, span_micro_p: 0.9818, span_micro_r: 0.9787, span_micro_f1: 0.9802, micro_p: 0.9869, micro_r: 0.9716, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: -0.3150, span_acc: 0.9933, attr_start_acc: 0.9805, attr_end_acc: 0.9880, span_micro_p: 0.9823, span_micro_r: 0.9790, span_micro_f1: 0.9806, micro_p: 0.9872, micro_r: 0.9709, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: -0.3354, span_acc: 0.9935, attr_start_acc: 0.9810, attr_end_acc: 0.9880, span_micro_p: 0.9824, span_micro_r: 0.9797, span_micro_f1: 0.9810, micro_p: 0.9876, micro_r: 0.9714, micro_f1: 0.9794
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: -0.3613, span_acc: 0.9937, attr_start_acc: 0.9813, attr_end_acc: 0.9879, span_micro_p: 0.9829, span_micro_r: 0.9804, span_micro_f1: 0.9816, micro_p: 0.9879, micro_r: 0.9718, micro_f1: 0.9798
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: -0.3651, span_acc: 0.9938, attr_start_acc: 0.9810, attr_end_acc: 0.9879, span_micro_p: 0.9832, span_micro_r: 0.9809, span_micro_f1: 0.9821, micro_p: 0.9878, micro_r: 0.9716, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: -0.3760, span_acc: 0.9941, attr_start_acc: 0.9814, attr_end_acc: 0.9880, span_micro_p: 0.9837, span_micro_r: 0.9815, span_micro_f1: 0.9826, micro_p: 0.9880, micro_r: 0.9722, micro_f1: 0.9800
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: -0.3891, span_acc: 0.9942, attr_start_acc: 0.9818, attr_end_acc: 0.9883, span_micro_p: 0.9840, span_micro_r: 0.9819, span_micro_f1: 0.9830, micro_p: 0.9881, micro_r: 0.9727, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: -0.3672, span_acc: 0.9943, attr_start_acc: 0.9818, attr_end_acc: 0.9882, span_micro_p: 0.9843, span_micro_r: 0.9820, span_micro_f1: 0.9831, micro_p: 0.9880, micro_r: 0.9727, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: -0.3325, span_acc: 0.9940, attr_start_acc: 0.9816, attr_end_acc: 0.9880, span_micro_p: 0.9838, span_micro_r: 0.9814, span_micro_f1: 0.9826, micro_p: 0.9874, micro_r: 0.9721, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: -0.3298, span_acc: 0.9941, attr_start_acc: 0.9815, attr_end_acc: 0.9880, span_micro_p: 0.9839, span_micro_r: 0.9816, span_micro_f1: 0.9827, micro_p: 0.9873, micro_r: 0.9722, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: -0.3182, span_acc: 0.9939, attr_start_acc: 0.9809, attr_end_acc: 0.9878, span_micro_p: 0.9836, span_micro_r: 0.9807, span_micro_f1: 0.9821, micro_p: 0.9872, micro_r: 0.9716, micro_f1: 0.9793
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: -0.3299, span_acc: 0.9940, attr_start_acc: 0.9813, attr_end_acc: 0.9881, span_micro_p: 0.9837, span_micro_r: 0.9810, span_micro_f1: 0.9824, micro_p: 0.9871, micro_r: 0.9720, micro_f1: 0.9795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: -0.3251, span_acc: 0.9941, attr_start_acc: 0.9814, attr_end_acc: 0.9883, span_micro_p: 0.9840, span_micro_r: 0.9813, span_micro_f1: 0.9827, micro_p: 0.9871, micro_r: 0.9724, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.48 / 97.38 / 97.50999999999999), p: (94.66 / 95.26), r: (95.86 / 94.75), f1: (95.25 / 95.00999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.2921847493164482, 'span_acc': 0.9848413074372335, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9751344086021505, 'span_micro_p': 0.9465699208443272, 'span_micro_r': 0.9585838343353373, 'span_micro_f1': 0.9525389976767342, 'micro_p': 0.952638700947226, 'micro_r': 0.9475100942126514, 'micro_f1': 0.9500674763832658, 'category-p/r/f1': {'LOC': (1.0, 0.5, 0.6667), 'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.934, 0.9232, 0.9286), 'TITLE': (0.9577, 0.9522, 0.9549), 'EDU': (0.9717, 0.9717, 0.9717), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9500674763832658 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.17 / 96.38 / 96.81), p: (94.89999999999999 / 95.28), r: (94.66 / 94.17), f1: (94.78 / 94.72)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.8783337044640906, 'span_acc': 0.9817356205852674, 'attr_start_acc': 0.9638036809815951, 'attr_end_acc': 0.9680981595092024, 'span_micro_p': 0.9489544895448955, 'span_micro_r': 0.9466257668711656, 'span_micro_f1': 0.9477886977886978, 'micro_p': 0.9528243327126009, 'micro_r': 0.941717791411043, 'micro_f1': 0.9472385066337551, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'ORG': (0.9342, 0.9241, 0.9291), 'TITLE': (0.9539, 0.9391, 0.9464), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (0.9911, 0.9911, 0.9911), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9472385066337551 / 0.9588107773304428
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.5777, span_acc: 0.9981, attr_start_acc: 0.9894, attr_end_acc: 0.9947, span_micro_p: 0.9947, span_micro_r: 0.9894, span_micro_f1: 0.9920, micro_p: 0.9946, micro_r: 0.9840, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -0.7848, span_acc: 0.9946, attr_start_acc: 0.9837, attr_end_acc: 0.9870, span_micro_p: 0.9919, span_micro_r: 0.9903, span_micro_f1: 0.9911, micro_p: 0.9918, micro_r: 0.9789, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -0.6323, span_acc: 0.9949, attr_start_acc: 0.9846, attr_end_acc: 0.9891, span_micro_p: 0.9910, span_micro_r: 0.9892, span_micro_f1: 0.9901, micro_p: 0.9926, micro_r: 0.9791, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -0.6681, span_acc: 0.9955, attr_start_acc: 0.9859, attr_end_acc: 0.9899, span_micro_p: 0.9913, span_micro_r: 0.9893, span_micro_f1: 0.9903, micro_p: 0.9925, micro_r: 0.9799, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: -0.6754, span_acc: 0.9960, attr_start_acc: 0.9844, attr_end_acc: 0.9881, span_micro_p: 0.9903, span_micro_r: 0.9893, span_micro_f1: 0.9898, micro_p: 0.9896, micro_r: 0.9779, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.4998, span_acc: 0.9962, attr_start_acc: 0.9856, attr_end_acc: 0.9892, span_micro_p: 0.9888, span_micro_r: 0.9897, span_micro_f1: 0.9893, micro_p: 0.9891, micro_r: 0.9788, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.5370, span_acc: 0.9969, attr_start_acc: 0.9872, attr_end_acc: 0.9901, span_micro_p: 0.9909, span_micro_r: 0.9913, span_micro_f1: 0.9911, micro_p: 0.9900, micro_r: 0.9799, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.5140, span_acc: 0.9964, attr_start_acc: 0.9855, attr_end_acc: 0.9899, span_micro_p: 0.9887, span_micro_r: 0.9890, span_micro_f1: 0.9889, micro_p: 0.9892, micro_r: 0.9779, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.5175, span_acc: 0.9960, attr_start_acc: 0.9846, attr_end_acc: 0.9898, span_micro_p: 0.9882, span_micro_r: 0.9869, span_micro_f1: 0.9875, micro_p: 0.9885, micro_r: 0.9757, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.5916, span_acc: 0.9962, attr_start_acc: 0.9855, attr_end_acc: 0.9901, span_micro_p: 0.9880, span_micro_r: 0.9873, span_micro_f1: 0.9876, micro_p: 0.9888, micro_r: 0.9773, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: -0.5256, span_acc: 0.9960, attr_start_acc: 0.9855, attr_end_acc: 0.9903, span_micro_p: 0.9873, span_micro_r: 0.9864, span_micro_f1: 0.9869, micro_p: 0.9884, micro_r: 0.9771, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: -0.5344, span_acc: 0.9961, attr_start_acc: 0.9847, attr_end_acc: 0.9903, span_micro_p: 0.9876, span_micro_r: 0.9864, span_micro_f1: 0.9870, micro_p: 0.9884, micro_r: 0.9766, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: -0.5435, span_acc: 0.9962, attr_start_acc: 0.9847, attr_end_acc: 0.9899, span_micro_p: 0.9878, span_micro_r: 0.9865, span_micro_f1: 0.9871, micro_p: 0.9885, micro_r: 0.9767, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: -0.5266, span_acc: 0.9964, attr_start_acc: 0.9851, attr_end_acc: 0.9903, span_micro_p: 0.9881, span_micro_r: 0.9872, span_micro_f1: 0.9876, micro_p: 0.9887, micro_r: 0.9772, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: -0.5054, span_acc: 0.9959, attr_start_acc: 0.9844, attr_end_acc: 0.9899, span_micro_p: 0.9862, span_micro_r: 0.9861, span_micro_f1: 0.9861, micro_p: 0.9880, micro_r: 0.9764, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: -0.4679, span_acc: 0.9956, attr_start_acc: 0.9846, attr_end_acc: 0.9898, span_micro_p: 0.9866, span_micro_r: 0.9860, span_micro_f1: 0.9863, micro_p: 0.9884, micro_r: 0.9764, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: -0.4601, span_acc: 0.9957, attr_start_acc: 0.9844, attr_end_acc: 0.9897, span_micro_p: 0.9866, span_micro_r: 0.9862, span_micro_f1: 0.9864, micro_p: 0.9883, micro_r: 0.9764, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: -0.3336, span_acc: 0.9957, attr_start_acc: 0.9843, attr_end_acc: 0.9898, span_micro_p: 0.9870, span_micro_r: 0.9864, span_micro_f1: 0.9867, micro_p: 0.9887, micro_r: 0.9765, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: -0.3310, span_acc: 0.9955, attr_start_acc: 0.9842, attr_end_acc: 0.9898, span_micro_p: 0.9867, span_micro_r: 0.9857, span_micro_f1: 0.9862, micro_p: 0.9886, micro_r: 0.9763, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: -0.2970, span_acc: 0.9955, attr_start_acc: 0.9841, attr_end_acc: 0.9898, span_micro_p: 0.9869, span_micro_r: 0.9858, span_micro_f1: 0.9863, micro_p: 0.9883, micro_r: 0.9760, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: -0.3324, span_acc: 0.9957, attr_start_acc: 0.9843, attr_end_acc: 0.9902, span_micro_p: 0.9873, span_micro_r: 0.9861, span_micro_f1: 0.9867, micro_p: 0.9887, micro_r: 0.9763, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: -0.3671, span_acc: 0.9958, attr_start_acc: 0.9847, attr_end_acc: 0.9903, span_micro_p: 0.9876, span_micro_r: 0.9864, span_micro_f1: 0.9870, micro_p: 0.9890, micro_r: 0.9769, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: -0.3833, span_acc: 0.9959, attr_start_acc: 0.9850, attr_end_acc: 0.9906, span_micro_p: 0.9878, span_micro_r: 0.9864, span_micro_f1: 0.9871, micro_p: 0.9893, micro_r: 0.9772, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: -0.3208, span_acc: 0.9960, attr_start_acc: 0.9850, attr_end_acc: 0.9908, span_micro_p: 0.9881, span_micro_r: 0.9867, span_micro_f1: 0.9874, micro_p: 0.9894, micro_r: 0.9774, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: -0.2762, span_acc: 0.9959, attr_start_acc: 0.9848, attr_end_acc: 0.9906, span_micro_p: 0.9876, span_micro_r: 0.9863, span_micro_f1: 0.9869, micro_p: 0.9890, micro_r: 0.9769, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: -0.2584, span_acc: 0.9959, attr_start_acc: 0.9849, attr_end_acc: 0.9906, span_micro_p: 0.9875, span_micro_r: 0.9863, span_micro_f1: 0.9869, micro_p: 0.9891, micro_r: 0.9769, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: -0.2706, span_acc: 0.9960, attr_start_acc: 0.9850, attr_end_acc: 0.9909, span_micro_p: 0.9877, span_micro_r: 0.9865, span_micro_f1: 0.9871, micro_p: 0.9892, micro_r: 0.9772, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: -0.2467, span_acc: 0.9959, attr_start_acc: 0.9848, attr_end_acc: 0.9906, span_micro_p: 0.9876, span_micro_r: 0.9863, span_micro_f1: 0.9869, micro_p: 0.9890, micro_r: 0.9767, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: -0.2356, span_acc: 0.9958, attr_start_acc: 0.9847, attr_end_acc: 0.9901, span_micro_p: 0.9871, span_micro_r: 0.9859, span_micro_f1: 0.9865, micro_p: 0.9886, micro_r: 0.9762, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: -0.2335, span_acc: 0.9957, attr_start_acc: 0.9842, attr_end_acc: 0.9900, span_micro_p: 0.9869, span_micro_r: 0.9856, span_micro_f1: 0.9862, micro_p: 0.9883, micro_r: 0.9759, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: -0.1984, span_acc: 0.9958, attr_start_acc: 0.9844, attr_end_acc: 0.9899, span_micro_p: 0.9872, span_micro_r: 0.9859, span_micro_f1: 0.9865, micro_p: 0.9885, micro_r: 0.9760, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: -0.1867, span_acc: 0.9958, attr_start_acc: 0.9844, attr_end_acc: 0.9897, span_micro_p: 0.9871, span_micro_r: 0.9858, span_micro_f1: 0.9865, micro_p: 0.9883, micro_r: 0.9759, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.44000000000001 / 97.58 / 97.24000000000001), p: (95.42 / 96.50999999999999), r: (95.99 / 94.95), f1: (95.7 / 95.73)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 4.280573104357359, 'span_acc': 0.984367598294647, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9724462365591398, 'span_micro_p': 0.954183266932271, 'span_micro_r': 0.9599198396793587, 'span_micro_f1': 0.9570429570429569, 'micro_p': 0.9651162790697675, 'micro_r': 0.949528936742934, 'micro_f1': 0.9572591587516961, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9529, 0.9328, 0.9427), 'TITLE': (0.9705, 0.9522, 0.9613), 'EDU': (0.9712, 0.9528, 0.9619), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9572591587516961 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.98 / 96.93 / 97.24000000000001), p: (96.06 / 96.76), r: (95.77 / 95.15), f1: (95.91 / 95.95)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 2.4565034405615345, 'span_acc': 0.9798183652875883, 'attr_start_acc': 0.9693251533742331, 'attr_end_acc': 0.9723926380368099, 'span_micro_p': 0.9606153846153846, 'span_micro_r': 0.9576687116564417, 'span_micro_f1': 0.9591397849462366, 'micro_p': 0.96756082345602, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9594803587998761, 'category-p/r/f1': {'ORG': (0.9577, 0.9421, 0.9498), 'PRO': (0.9412, 0.9697, 0.9552), 'TITLE': (0.9669, 0.9469, 0.9568), 'EDU': (0.9907, 0.9554, 0.9727), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9594803587998761 / 0.9588107773304428
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: 0.0480, span_acc: 0.9941, attr_start_acc: 0.9766, attr_end_acc: 0.9805, span_micro_p: 0.9844, span_micro_r: 0.9767, span_micro_f1: 0.9805, micro_p: 0.9802, micro_r: 0.9648, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -0.6688, span_acc: 0.9970, attr_start_acc: 0.9838, attr_end_acc: 0.9882, span_micro_p: 0.9897, span_micro_r: 0.9897, span_micro_f1: 0.9897, micro_p: 0.9866, micro_r: 0.9750, micro_f1: 0.9807
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -1.0009, span_acc: 0.9982, attr_start_acc: 0.9879, attr_end_acc: 0.9896, span_micro_p: 0.9940, span_micro_r: 0.9940, span_micro_f1: 0.9940, micro_p: 0.9904, micro_r: 0.9809, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.9103, span_acc: 0.9981, attr_start_acc: 0.9890, attr_end_acc: 0.9903, span_micro_p: 0.9942, span_micro_r: 0.9942, span_micro_f1: 0.9942, micro_p: 0.9928, micro_r: 0.9832, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.8635, span_acc: 0.9973, attr_start_acc: 0.9871, attr_end_acc: 0.9901, span_micro_p: 0.9912, span_micro_r: 0.9912, span_micro_f1: 0.9912, micro_p: 0.9910, micro_r: 0.9807, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -0.8101, span_acc: 0.9975, attr_start_acc: 0.9878, attr_end_acc: 0.9914, span_micro_p: 0.9923, span_micro_r: 0.9915, span_micro_f1: 0.9919, micro_p: 0.9922, micro_r: 0.9824, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: -0.6660, span_acc: 0.9974, attr_start_acc: 0.9858, attr_end_acc: 0.9914, span_micro_p: 0.9921, span_micro_r: 0.9911, span_micro_f1: 0.9916, micro_p: 0.9916, micro_r: 0.9800, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: -0.4509, span_acc: 0.9972, attr_start_acc: 0.9858, attr_end_acc: 0.9913, span_micro_p: 0.9904, span_micro_r: 0.9898, span_micro_f1: 0.9901, micro_p: 0.9905, micro_r: 0.9798, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: -0.4148, span_acc: 0.9973, attr_start_acc: 0.9863, attr_end_acc: 0.9914, span_micro_p: 0.9906, span_micro_r: 0.9904, span_micro_f1: 0.9905, micro_p: 0.9905, micro_r: 0.9801, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: -0.3703, span_acc: 0.9975, attr_start_acc: 0.9858, attr_end_acc: 0.9917, span_micro_p: 0.9915, span_micro_r: 0.9912, span_micro_f1: 0.9914, micro_p: 0.9913, micro_r: 0.9801, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: -0.4897, span_acc: 0.9977, attr_start_acc: 0.9859, attr_end_acc: 0.9917, span_micro_p: 0.9920, span_micro_r: 0.9918, span_micro_f1: 0.9919, micro_p: 0.9919, micro_r: 0.9804, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: -0.5210, span_acc: 0.9976, attr_start_acc: 0.9850, attr_end_acc: 0.9910, span_micro_p: 0.9920, span_micro_r: 0.9910, span_micro_f1: 0.9915, micro_p: 0.9923, micro_r: 0.9793, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: -0.4262, span_acc: 0.9976, attr_start_acc: 0.9855, attr_end_acc: 0.9911, span_micro_p: 0.9921, span_micro_r: 0.9909, span_micro_f1: 0.9915, micro_p: 0.9923, micro_r: 0.9798, micro_f1: 0.9860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: -0.4944, span_acc: 0.9978, attr_start_acc: 0.9865, attr_end_acc: 0.9913, span_micro_p: 0.9926, span_micro_r: 0.9915, span_micro_f1: 0.9920, micro_p: 0.9928, micro_r: 0.9808, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: -0.5533, span_acc: 0.9977, attr_start_acc: 0.9862, attr_end_acc: 0.9914, span_micro_p: 0.9925, span_micro_r: 0.9910, span_micro_f1: 0.9917, micro_p: 0.9930, micro_r: 0.9800, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: -0.3585, span_acc: 0.9976, attr_start_acc: 0.9847, attr_end_acc: 0.9912, span_micro_p: 0.9919, span_micro_r: 0.9899, span_micro_f1: 0.9909, micro_p: 0.9931, micro_r: 0.9788, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: -0.1591, span_acc: 0.9971, attr_start_acc: 0.9834, attr_end_acc: 0.9899, span_micro_p: 0.9914, span_micro_r: 0.9892, span_micro_f1: 0.9903, micro_p: 0.9925, micro_r: 0.9768, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: -0.0550, span_acc: 0.9972, attr_start_acc: 0.9826, attr_end_acc: 0.9897, span_micro_p: 0.9915, span_micro_r: 0.9895, span_micro_f1: 0.9905, micro_p: 0.9922, micro_r: 0.9756, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: -0.0728, span_acc: 0.9971, attr_start_acc: 0.9826, attr_end_acc: 0.9896, span_micro_p: 0.9909, span_micro_r: 0.9889, span_micro_f1: 0.9899, micro_p: 0.9919, micro_r: 0.9757, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 0.0654, span_acc: 0.9970, attr_start_acc: 0.9830, attr_end_acc: 0.9897, span_micro_p: 0.9912, span_micro_r: 0.9891, span_micro_f1: 0.9901, micro_p: 0.9921, micro_r: 0.9761, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 0.0972, span_acc: 0.9970, attr_start_acc: 0.9831, attr_end_acc: 0.9901, span_micro_p: 0.9913, span_micro_r: 0.9892, span_micro_f1: 0.9903, micro_p: 0.9922, micro_r: 0.9764, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 0.0450, span_acc: 0.9971, attr_start_acc: 0.9832, attr_end_acc: 0.9906, span_micro_p: 0.9916, span_micro_r: 0.9894, span_micro_f1: 0.9905, micro_p: 0.9926, micro_r: 0.9769, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 0.0028, span_acc: 0.9972, attr_start_acc: 0.9834, attr_end_acc: 0.9908, span_micro_p: 0.9919, span_micro_r: 0.9897, span_micro_f1: 0.9908, micro_p: 0.9926, micro_r: 0.9771, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 0.0624, span_acc: 0.9972, attr_start_acc: 0.9834, attr_end_acc: 0.9906, span_micro_p: 0.9916, span_micro_r: 0.9897, span_micro_f1: 0.9907, micro_p: 0.9922, micro_r: 0.9769, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.0145, span_acc: 0.9971, attr_start_acc: 0.9833, attr_end_acc: 0.9905, span_micro_p: 0.9913, span_micro_r: 0.9892, span_micro_f1: 0.9902, micro_p: 0.9921, micro_r: 0.9767, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: -0.0150, span_acc: 0.9971, attr_start_acc: 0.9832, attr_end_acc: 0.9905, span_micro_p: 0.9914, span_micro_r: 0.9895, span_micro_f1: 0.9905, micro_p: 0.9920, micro_r: 0.9768, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 0.0470, span_acc: 0.9970, attr_start_acc: 0.9828, attr_end_acc: 0.9906, span_micro_p: 0.9911, span_micro_r: 0.9891, span_micro_f1: 0.9901, micro_p: 0.9918, micro_r: 0.9765, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 0.0136, span_acc: 0.9971, attr_start_acc: 0.9831, attr_end_acc: 0.9908, span_micro_p: 0.9914, span_micro_r: 0.9894, span_micro_f1: 0.9904, micro_p: 0.9919, micro_r: 0.9768, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: -0.0038, span_acc: 0.9973, attr_start_acc: 0.9837, attr_end_acc: 0.9910, span_micro_p: 0.9917, span_micro_r: 0.9898, span_micro_f1: 0.9908, micro_p: 0.9922, micro_r: 0.9775, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: -0.0055, span_acc: 0.9973, attr_start_acc: 0.9839, attr_end_acc: 0.9912, span_micro_p: 0.9918, span_micro_r: 0.9899, span_micro_f1: 0.9908, micro_p: 0.9923, micro_r: 0.9779, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 0.0204, span_acc: 0.9971, attr_start_acc: 0.9838, attr_end_acc: 0.9910, span_micro_p: 0.9913, span_micro_r: 0.9895, span_micro_f1: 0.9904, micro_p: 0.9918, micro_r: 0.9776, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 0.0430, span_acc: 0.9971, attr_start_acc: 0.9839, attr_end_acc: 0.9911, span_micro_p: 0.9910, span_micro_r: 0.9894, span_micro_f1: 0.9902, micro_p: 0.9916, micro_r: 0.9777, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.50999999999999 / 97.04 / 98.52), p: (95.13000000000001 / 95.67), r: (96.53 / 95.22), f1: (95.82000000000001 / 95.45)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 8.008088996356301, 'span_acc': 0.9850781620085267, 'attr_start_acc': 0.9704301075268817, 'attr_end_acc': 0.9852150537634409, 'span_micro_p': 0.9512837393021725, 'span_micro_r': 0.9652638610554443, 'span_micro_f1': 0.9582228116710875, 'micro_p': 0.9567275185936444, 'micro_r': 0.9522207267833109, 'micro_f1': 0.954468802698145, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9335, 0.9424, 0.9379), 'TITLE': (0.966, 0.9464, 0.9561), 'EDU': (0.9811, 0.9811, 0.9811), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.954468802698145 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.31 / 96.44 / 97.72999999999999), p: (94.26 / 95.85000000000001), r: (95.71 / 94.97), f1: (94.98 / 95.41)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 3.2089990201236316, 'span_acc': 0.9831483350151362, 'attr_start_acc': 0.9644171779141104, 'attr_end_acc': 0.9773006134969325, 'span_micro_p': 0.9425981873111783, 'span_micro_r': 0.9570552147239264, 'span_micro_f1': 0.949771689497717, 'micro_p': 0.958513931888545, 'micro_r': 0.9496932515337423, 'micro_f1': 0.9540832049306627, 'category-p/r/f1': {'PRO': (0.9091, 0.9091, 0.9091), 'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.927, 0.9421, 0.9345), 'TITLE': (0.9706, 0.9417, 0.9559), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9540832049306627 / 0.9594803587998761
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -1.4777, span_acc: 0.9987, attr_start_acc: 0.9928, attr_end_acc: 1.0000, span_micro_p: 0.9929, span_micro_r: 0.9964, span_micro_f1: 0.9947, micro_p: 0.9964, micro_r: 0.9928, micro_f1: 0.9946
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: -0.8885, span_acc: 0.9985, attr_start_acc: 0.9914, attr_end_acc: 0.9943, span_micro_p: 0.9943, span_micro_r: 0.9929, span_micro_f1: 0.9936, micro_p: 0.9957, micro_r: 0.9857, micro_f1: 0.9907
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: -0.9472, span_acc: 0.9982, attr_start_acc: 0.9904, attr_end_acc: 0.9939, span_micro_p: 0.9930, span_micro_r: 0.9913, span_micro_f1: 0.9922, micro_p: 0.9912, micro_r: 0.9851, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: -0.9257, span_acc: 0.9985, attr_start_acc: 0.9884, attr_end_acc: 0.9942, span_micro_p: 0.9943, span_micro_r: 0.9924, span_micro_f1: 0.9933, micro_p: 0.9929, micro_r: 0.9845, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: -1.1274, span_acc: 0.9986, attr_start_acc: 0.9901, attr_end_acc: 0.9953, span_micro_p: 0.9943, span_micro_r: 0.9933, span_micro_f1: 0.9938, micro_p: 0.9937, micro_r: 0.9865, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: -0.9930, span_acc: 0.9986, attr_start_acc: 0.9885, attr_end_acc: 0.9945, span_micro_p: 0.9941, span_micro_r: 0.9928, span_micro_f1: 0.9935, micro_p: 0.9927, micro_r: 0.9855, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: -0.9504, span_acc: 0.9984, attr_start_acc: 0.9887, attr_end_acc: 0.9945, span_micro_p: 0.9939, span_micro_r: 0.9917, span_micro_f1: 0.9928, micro_p: 0.9934, micro_r: 0.9858, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 0.3875, span_acc: 0.9975, attr_start_acc: 0.9876, attr_end_acc: 0.9937, span_micro_p: 0.9906, span_micro_r: 0.9899, span_micro_f1: 0.9903, micro_p: 0.9914, micro_r: 0.9844, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 0.3733, span_acc: 0.9977, attr_start_acc: 0.9875, attr_end_acc: 0.9937, span_micro_p: 0.9912, span_micro_r: 0.9907, span_micro_f1: 0.9910, micro_p: 0.9917, micro_r: 0.9843, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 0.3998, span_acc: 0.9978, attr_start_acc: 0.9873, attr_end_acc: 0.9936, span_micro_p: 0.9919, span_micro_r: 0.9912, span_micro_f1: 0.9916, micro_p: 0.9920, micro_r: 0.9842, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 0.2875, span_acc: 0.9979, attr_start_acc: 0.9872, attr_end_acc: 0.9936, span_micro_p: 0.9925, span_micro_r: 0.9916, span_micro_f1: 0.9920, micro_p: 0.9926, micro_r: 0.9842, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 0.2817, span_acc: 0.9981, attr_start_acc: 0.9872, attr_end_acc: 0.9937, span_micro_p: 0.9931, span_micro_r: 0.9923, span_micro_f1: 0.9927, micro_p: 0.9930, micro_r: 0.9842, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 0.2071, span_acc: 0.9981, attr_start_acc: 0.9875, attr_end_acc: 0.9937, span_micro_p: 0.9934, span_micro_r: 0.9926, span_micro_f1: 0.9930, micro_p: 0.9929, micro_r: 0.9844, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 0.1576, span_acc: 0.9982, attr_start_acc: 0.9876, attr_end_acc: 0.9939, span_micro_p: 0.9937, span_micro_r: 0.9927, span_micro_f1: 0.9932, micro_p: 0.9934, micro_r: 0.9843, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 0.1435, span_acc: 0.9979, attr_start_acc: 0.9873, attr_end_acc: 0.9930, span_micro_p: 0.9925, span_micro_r: 0.9915, span_micro_f1: 0.9920, micro_p: 0.9922, micro_r: 0.9826, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 0.1198, span_acc: 0.9979, attr_start_acc: 0.9873, attr_end_acc: 0.9923, span_micro_p: 0.9927, span_micro_r: 0.9915, span_micro_f1: 0.9921, micro_p: 0.9924, micro_r: 0.9823, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 0.1493, span_acc: 0.9979, attr_start_acc: 0.9875, attr_end_acc: 0.9925, span_micro_p: 0.9925, span_micro_r: 0.9911, span_micro_f1: 0.9918, micro_p: 0.9927, micro_r: 0.9825, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 0.0819, span_acc: 0.9978, attr_start_acc: 0.9876, attr_end_acc: 0.9921, span_micro_p: 0.9923, span_micro_r: 0.9908, span_micro_f1: 0.9916, micro_p: 0.9922, micro_r: 0.9820, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: -0.0098, span_acc: 0.9979, attr_start_acc: 0.9883, attr_end_acc: 0.9925, span_micro_p: 0.9928, span_micro_r: 0.9914, span_micro_f1: 0.9921, micro_p: 0.9926, micro_r: 0.9830, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 0.1642, span_acc: 0.9980, attr_start_acc: 0.9887, attr_end_acc: 0.9928, span_micro_p: 0.9926, span_micro_r: 0.9917, span_micro_f1: 0.9922, micro_p: 0.9928, micro_r: 0.9836, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 0.1334, span_acc: 0.9980, attr_start_acc: 0.9883, attr_end_acc: 0.9929, span_micro_p: 0.9927, span_micro_r: 0.9917, span_micro_f1: 0.9922, micro_p: 0.9927, micro_r: 0.9834, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 0.2007, span_acc: 0.9976, attr_start_acc: 0.9881, attr_end_acc: 0.9924, span_micro_p: 0.9909, span_micro_r: 0.9908, span_micro_f1: 0.9908, micro_p: 0.9917, micro_r: 0.9824, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 0.1710, span_acc: 0.9976, attr_start_acc: 0.9879, attr_end_acc: 0.9927, span_micro_p: 0.9909, span_micro_r: 0.9906, span_micro_f1: 0.9908, micro_p: 0.9917, micro_r: 0.9825, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 0.1636, span_acc: 0.9977, attr_start_acc: 0.9883, attr_end_acc: 0.9930, span_micro_p: 0.9911, span_micro_r: 0.9909, span_micro_f1: 0.9910, micro_p: 0.9921, micro_r: 0.9831, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 0.1448, span_acc: 0.9977, attr_start_acc: 0.9884, attr_end_acc: 0.9932, span_micro_p: 0.9914, span_micro_r: 0.9912, span_micro_f1: 0.9913, micro_p: 0.9923, micro_r: 0.9833, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 0.1607, span_acc: 0.9978, attr_start_acc: 0.9884, attr_end_acc: 0.9932, span_micro_p: 0.9916, span_micro_r: 0.9916, span_micro_f1: 0.9916, micro_p: 0.9924, micro_r: 0.9833, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 0.1936, span_acc: 0.9979, attr_start_acc: 0.9884, attr_end_acc: 0.9933, span_micro_p: 0.9916, span_micro_r: 0.9918, span_micro_f1: 0.9917, micro_p: 0.9927, micro_r: 0.9834, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 0.1863, span_acc: 0.9979, attr_start_acc: 0.9884, attr_end_acc: 0.9931, span_micro_p: 0.9918, span_micro_r: 0.9919, span_micro_f1: 0.9919, micro_p: 0.9927, micro_r: 0.9833, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 0.1827, span_acc: 0.9978, attr_start_acc: 0.9881, attr_end_acc: 0.9929, span_micro_p: 0.9914, span_micro_r: 0.9917, span_micro_f1: 0.9915, micro_p: 0.9925, micro_r: 0.9830, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 0.1643, span_acc: 0.9978, attr_start_acc: 0.9877, attr_end_acc: 0.9930, span_micro_p: 0.9913, span_micro_r: 0.9915, span_micro_f1: 0.9914, micro_p: 0.9926, micro_r: 0.9826, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 0.1717, span_acc: 0.9978, attr_start_acc: 0.9879, attr_end_acc: 0.9932, span_micro_p: 0.9912, span_micro_r: 0.9916, span_micro_f1: 0.9914, micro_p: 0.9926, micro_r: 0.9828, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 0.1113, span_acc: 0.9978, attr_start_acc: 0.9877, attr_end_acc: 0.9933, span_micro_p: 0.9914, span_micro_r: 0.9918, span_micro_f1: 0.9916, micro_p: 0.9926, micro_r: 0.9827, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.8 / 97.98 / 97.85000000000001), p: (96.34 / 96.54), r: (96.59 / 95.83), f1: (96.46000000000001 / 96.17999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 16.8261647353162, 'span_acc': 0.9880388441496921, 'attr_start_acc': 0.9798387096774194, 'attr_end_acc': 0.978494623655914, 'span_micro_p': 0.9633577614923384, 'span_micro_r': 0.9659318637274549, 'span_micro_f1': 0.9646430953969312, 'micro_p': 0.9654237288135593, 'micro_r': 0.9582772543741588, 'micro_f1': 0.961837217156366, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9516, 0.9424, 0.947), 'TITLE': (0.9706, 0.958, 0.9643), 'EDU': (0.9722, 0.9906, 0.9813), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.961837217156366 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.37 / 96.87 / 97.91), p: (96.43 / 96.95), r: (96.07 / 95.64), f1: (96.25 / 96.28999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 10.306825883733401, 'span_acc': 0.9836528758829465, 'attr_start_acc': 0.9687116564417177, 'attr_end_acc': 0.9791411042944785, 'span_micro_p': 0.9642857142857143, 'span_micro_r': 0.9607361963190184, 'span_micro_f1': 0.9625076828518747, 'micro_p': 0.9695273631840796, 'micro_r': 0.9564417177914111, 'micro_f1': 0.9629400864731317, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.965, 0.9476, 0.9562), 'TITLE': (0.9644, 0.9482, 0.9562), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9629400864731317 / 0.9594803587998761
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: -1.1768, span_acc: 1.0000, attr_start_acc: 1.0000, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9969, micro_r: 0.9969, micro_f1: 0.9969
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: -0.4053, span_acc: 0.9996, attr_start_acc: 0.9930, attr_end_acc: 0.9958, span_micro_p: 0.9986, span_micro_r: 0.9972, span_micro_f1: 0.9979, micro_p: 0.9930, micro_r: 0.9889, micro_f1: 0.9909
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 0.5716, span_acc: 0.9991, attr_start_acc: 0.9885, attr_end_acc: 0.9964, span_micro_p: 0.9974, span_micro_r: 0.9956, span_micro_f1: 0.9965, micro_p: 0.9919, micro_r: 0.9849, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: 0.8751, span_acc: 0.9994, attr_start_acc: 0.9880, attr_end_acc: 0.9949, span_micro_p: 0.9981, span_micro_r: 0.9969, span_micro_f1: 0.9975, micro_p: 0.9936, micro_r: 0.9855, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 2.6243, span_acc: 0.9988, attr_start_acc: 0.9894, attr_end_acc: 0.9955, span_micro_p: 0.9985, span_micro_r: 0.9965, span_micro_f1: 0.9975, micro_p: 0.9944, micro_r: 0.9869, micro_f1: 0.9906
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 2.9360, span_acc: 0.9985, attr_start_acc: 0.9887, attr_end_acc: 0.9954, span_micro_p: 0.9963, span_micro_r: 0.9950, span_micro_f1: 0.9956, micro_p: 0.9932, micro_r: 0.9866, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 3.0588, span_acc: 0.9982, attr_start_acc: 0.9877, attr_end_acc: 0.9940, span_micro_p: 0.9947, span_micro_r: 0.9933, span_micro_f1: 0.9940, micro_p: 0.9932, micro_r: 0.9852, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 3.0914, span_acc: 0.9978, attr_start_acc: 0.9875, attr_end_acc: 0.9939, span_micro_p: 0.9939, span_micro_r: 0.9921, span_micro_f1: 0.9930, micro_p: 0.9938, micro_r: 0.9844, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 3.1674, span_acc: 0.9979, attr_start_acc: 0.9882, attr_end_acc: 0.9941, span_micro_p: 0.9941, span_micro_r: 0.9923, span_micro_f1: 0.9932, micro_p: 0.9943, micro_r: 0.9850, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 2.9965, span_acc: 0.9980, attr_start_acc: 0.9885, attr_end_acc: 0.9945, span_micro_p: 0.9945, span_micro_r: 0.9926, span_micro_f1: 0.9936, micro_p: 0.9947, micro_r: 0.9856, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 2.6222, span_acc: 0.9982, attr_start_acc: 0.9884, attr_end_acc: 0.9945, span_micro_p: 0.9950, span_micro_r: 0.9933, span_micro_f1: 0.9941, micro_p: 0.9949, micro_r: 0.9858, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 2.6186, span_acc: 0.9981, attr_start_acc: 0.9882, attr_end_acc: 0.9940, span_micro_p: 0.9954, span_micro_r: 0.9931, span_micro_f1: 0.9942, micro_p: 0.9950, micro_r: 0.9856, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 2.5219, span_acc: 0.9981, attr_start_acc: 0.9875, attr_end_acc: 0.9935, span_micro_p: 0.9955, span_micro_r: 0.9928, span_micro_f1: 0.9941, micro_p: 0.9949, micro_r: 0.9848, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 2.3169, span_acc: 0.9982, attr_start_acc: 0.9879, attr_end_acc: 0.9938, span_micro_p: 0.9957, span_micro_r: 0.9930, span_micro_f1: 0.9943, micro_p: 0.9951, micro_r: 0.9852, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 2.0886, span_acc: 0.9981, attr_start_acc: 0.9881, attr_end_acc: 0.9937, span_micro_p: 0.9957, span_micro_r: 0.9933, span_micro_f1: 0.9945, micro_p: 0.9948, micro_r: 0.9855, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 1.9492, span_acc: 0.9983, attr_start_acc: 0.9884, attr_end_acc: 0.9940, span_micro_p: 0.9960, span_micro_r: 0.9937, span_micro_f1: 0.9948, micro_p: 0.9950, micro_r: 0.9860, micro_f1: 0.9905
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 2.1353, span_acc: 0.9980, attr_start_acc: 0.9877, attr_end_acc: 0.9939, span_micro_p: 0.9961, span_micro_r: 0.9934, span_micro_f1: 0.9947, micro_p: 0.9951, micro_r: 0.9852, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 1.9968, span_acc: 0.9980, attr_start_acc: 0.9880, attr_end_acc: 0.9941, span_micro_p: 0.9960, span_micro_r: 0.9931, span_micro_f1: 0.9946, micro_p: 0.9953, micro_r: 0.9854, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 1.8278, span_acc: 0.9980, attr_start_acc: 0.9881, attr_end_acc: 0.9938, span_micro_p: 0.9956, span_micro_r: 0.9930, span_micro_f1: 0.9943, micro_p: 0.9952, micro_r: 0.9847, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 1.7520, span_acc: 0.9979, attr_start_acc: 0.9887, attr_end_acc: 0.9938, span_micro_p: 0.9957, span_micro_r: 0.9932, span_micro_f1: 0.9944, micro_p: 0.9953, micro_r: 0.9850, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 1.6885, span_acc: 0.9979, attr_start_acc: 0.9888, attr_end_acc: 0.9937, span_micro_p: 0.9954, span_micro_r: 0.9927, span_micro_f1: 0.9941, micro_p: 0.9950, micro_r: 0.9846, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 1.6043, span_acc: 0.9980, attr_start_acc: 0.9885, attr_end_acc: 0.9940, span_micro_p: 0.9954, span_micro_r: 0.9929, span_micro_f1: 0.9942, micro_p: 0.9948, micro_r: 0.9843, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 1.5496, span_acc: 0.9980, attr_start_acc: 0.9883, attr_end_acc: 0.9938, span_micro_p: 0.9956, span_micro_r: 0.9932, span_micro_f1: 0.9944, micro_p: 0.9947, micro_r: 0.9841, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 1.4399, span_acc: 0.9981, attr_start_acc: 0.9883, attr_end_acc: 0.9937, span_micro_p: 0.9957, span_micro_r: 0.9933, span_micro_f1: 0.9945, micro_p: 0.9947, micro_r: 0.9841, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 1.5357, span_acc: 0.9981, attr_start_acc: 0.9881, attr_end_acc: 0.9939, span_micro_p: 0.9957, span_micro_r: 0.9933, span_micro_f1: 0.9945, micro_p: 0.9947, micro_r: 0.9841, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 1.4598, span_acc: 0.9981, attr_start_acc: 0.9878, attr_end_acc: 0.9941, span_micro_p: 0.9955, span_micro_r: 0.9934, span_micro_f1: 0.9945, micro_p: 0.9945, micro_r: 0.9835, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 1.5407, span_acc: 0.9982, attr_start_acc: 0.9878, attr_end_acc: 0.9942, span_micro_p: 0.9957, span_micro_r: 0.9937, span_micro_f1: 0.9947, micro_p: 0.9945, micro_r: 0.9836, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 1.6037, span_acc: 0.9982, attr_start_acc: 0.9880, attr_end_acc: 0.9942, span_micro_p: 0.9956, span_micro_r: 0.9936, span_micro_f1: 0.9946, micro_p: 0.9947, micro_r: 0.9839, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 1.6535, span_acc: 0.9978, attr_start_acc: 0.9875, attr_end_acc: 0.9940, span_micro_p: 0.9954, span_micro_r: 0.9931, span_micro_f1: 0.9943, micro_p: 0.9945, micro_r: 0.9834, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 1.6333, span_acc: 0.9979, attr_start_acc: 0.9876, attr_end_acc: 0.9940, span_micro_p: 0.9955, span_micro_r: 0.9931, span_micro_f1: 0.9943, micro_p: 0.9947, micro_r: 0.9834, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 1.5900, span_acc: 0.9979, attr_start_acc: 0.9877, attr_end_acc: 0.9939, span_micro_p: 0.9956, span_micro_r: 0.9933, span_micro_f1: 0.9944, micro_p: 0.9946, micro_r: 0.9836, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 1.6529, span_acc: 0.9979, attr_start_acc: 0.9877, attr_end_acc: 0.9938, span_micro_p: 0.9955, span_micro_r: 0.9932, span_micro_f1: 0.9944, micro_p: 0.9945, micro_r: 0.9834, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.72999999999999 / 97.38 / 98.05), p: (95.7 / 96.15), r: (96.53 / 95.83), f1: (96.11 / 95.99)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 27.867887564405766, 'span_acc': 0.9873282804358124, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.980510752688172, 'span_micro_p': 0.956953642384106, 'span_micro_r': 0.9652638610554443, 'span_micro_f1': 0.9610907881609577, 'micro_p': 0.9615124915597569, 'micro_r': 0.9582772543741588, 'micro_f1': 0.959892146949781, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9462, 0.9443, 0.9452), 'TITLE': (0.9648, 0.9536, 0.9592), 'NAME': (0.9903, 1.0, 0.9951), 'EDU': (0.9907, 1.0, 0.9953), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.959892146949781 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.46000000000001 / 97.24000000000001 / 97.78999999999999), p: (95.73 / 96.78), r: (96.26 / 95.89), f1: (95.99 / 96.33)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 13.080759144429141, 'span_acc': 0.984561049445005, 'attr_start_acc': 0.9723926380368099, 'attr_end_acc': 0.9779141104294479, 'span_micro_p': 0.9572910311165345, 'span_micro_r': 0.9625766871165644, 'span_micro_f1': 0.9599265830529214, 'micro_p': 0.9678018575851394, 'micro_r': 0.9588957055214724, 'micro_f1': 0.9633281972265023, 'category-p/r/f1': {'ORG': (0.9598, 0.9494, 0.9546), 'TITLE': (0.9658, 0.9521, 0.9589), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (0.9911, 0.9911, 0.9911), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9633281972265023 / 0.9629400864731317
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: -2.0941, span_acc: 1.0000, attr_start_acc: 0.9919, attr_end_acc: 0.9946, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9946, micro_r: 0.9919, micro_f1: 0.9932
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: 1.0389, span_acc: 0.9984, attr_start_acc: 0.9893, attr_end_acc: 0.9960, span_micro_p: 0.9908, span_micro_r: 0.9947, span_micro_f1: 0.9927, micro_p: 0.9893, micro_r: 0.9880, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 0.2097, span_acc: 0.9987, attr_start_acc: 0.9887, attr_end_acc: 0.9956, span_micro_p: 0.9931, span_micro_r: 0.9957, span_micro_f1: 0.9944, micro_p: 0.9904, micro_r: 0.9852, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 1.0488, span_acc: 0.9987, attr_start_acc: 0.9907, attr_end_acc: 0.9957, span_micro_p: 0.9933, span_micro_r: 0.9951, span_micro_f1: 0.9942, micro_p: 0.9900, micro_r: 0.9851, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 1.9448, span_acc: 0.9987, attr_start_acc: 0.9917, attr_end_acc: 0.9961, span_micro_p: 0.9937, span_micro_r: 0.9942, span_micro_f1: 0.9940, micro_p: 0.9922, micro_r: 0.9873, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 2.2623, span_acc: 0.9989, attr_start_acc: 0.9908, attr_end_acc: 0.9952, span_micro_p: 0.9949, span_micro_r: 0.9953, span_micro_f1: 0.9951, micro_p: 0.9920, micro_r: 0.9869, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 2.1349, span_acc: 0.9989, attr_start_acc: 0.9908, attr_end_acc: 0.9945, span_micro_p: 0.9952, span_micro_r: 0.9956, span_micro_f1: 0.9954, micro_p: 0.9921, micro_r: 0.9860, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 2.3249, span_acc: 0.9989, attr_start_acc: 0.9913, attr_end_acc: 0.9952, span_micro_p: 0.9955, span_micro_r: 0.9955, span_micro_f1: 0.9955, micro_p: 0.9930, micro_r: 0.9870, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 2.5570, span_acc: 0.9988, attr_start_acc: 0.9906, attr_end_acc: 0.9946, span_micro_p: 0.9947, span_micro_r: 0.9949, span_micro_f1: 0.9948, micro_p: 0.9930, micro_r: 0.9863, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 2.4349, span_acc: 0.9989, attr_start_acc: 0.9902, attr_end_acc: 0.9948, span_micro_p: 0.9953, span_micro_r: 0.9953, span_micro_f1: 0.9953, micro_p: 0.9938, micro_r: 0.9862, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 2.6031, span_acc: 0.9990, attr_start_acc: 0.9896, attr_end_acc: 0.9948, span_micro_p: 0.9957, span_micro_r: 0.9957, span_micro_f1: 0.9957, micro_p: 0.9939, micro_r: 0.9856, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 3.2056, span_acc: 0.9985, attr_start_acc: 0.9890, attr_end_acc: 0.9940, span_micro_p: 0.9948, span_micro_r: 0.9946, span_micro_f1: 0.9947, micro_p: 0.9935, micro_r: 0.9844, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 2.9194, span_acc: 0.9983, attr_start_acc: 0.9882, attr_end_acc: 0.9943, span_micro_p: 0.9941, span_micro_r: 0.9941, span_micro_f1: 0.9941, micro_p: 0.9935, micro_r: 0.9835, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 3.3201, span_acc: 0.9983, attr_start_acc: 0.9889, attr_end_acc: 0.9942, span_micro_p: 0.9940, span_micro_r: 0.9937, span_micro_f1: 0.9939, micro_p: 0.9934, micro_r: 0.9837, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 3.0169, span_acc: 0.9983, attr_start_acc: 0.9888, attr_end_acc: 0.9933, span_micro_p: 0.9940, span_micro_r: 0.9936, span_micro_f1: 0.9938, micro_p: 0.9930, micro_r: 0.9824, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 2.8382, span_acc: 0.9982, attr_start_acc: 0.9887, attr_end_acc: 0.9925, span_micro_p: 0.9937, span_micro_r: 0.9928, span_micro_f1: 0.9933, micro_p: 0.9930, micro_r: 0.9815, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 2.6140, span_acc: 0.9982, attr_start_acc: 0.9889, attr_end_acc: 0.9924, span_micro_p: 0.9939, span_micro_r: 0.9929, span_micro_f1: 0.9934, micro_p: 0.9932, micro_r: 0.9819, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 2.4326, span_acc: 0.9983, attr_start_acc: 0.9892, attr_end_acc: 0.9924, span_micro_p: 0.9942, span_micro_r: 0.9933, span_micro_f1: 0.9937, micro_p: 0.9934, micro_r: 0.9823, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 2.4363, span_acc: 0.9983, attr_start_acc: 0.9889, attr_end_acc: 0.9924, span_micro_p: 0.9942, span_micro_r: 0.9935, span_micro_f1: 0.9939, micro_p: 0.9934, micro_r: 0.9822, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 2.4545, span_acc: 0.9983, attr_start_acc: 0.9893, attr_end_acc: 0.9925, span_micro_p: 0.9941, span_micro_r: 0.9935, span_micro_f1: 0.9938, micro_p: 0.9935, micro_r: 0.9825, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 2.4449, span_acc: 0.9983, attr_start_acc: 0.9891, attr_end_acc: 0.9920, span_micro_p: 0.9944, span_micro_r: 0.9937, span_micro_f1: 0.9941, micro_p: 0.9935, micro_r: 0.9820, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 2.5347, span_acc: 0.9984, attr_start_acc: 0.9892, attr_end_acc: 0.9921, span_micro_p: 0.9946, span_micro_r: 0.9940, span_micro_f1: 0.9943, micro_p: 0.9935, micro_r: 0.9821, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 2.8489, span_acc: 0.9984, attr_start_acc: 0.9891, attr_end_acc: 0.9921, span_micro_p: 0.9948, span_micro_r: 0.9940, span_micro_f1: 0.9944, micro_p: 0.9934, micro_r: 0.9819, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 3.2978, span_acc: 0.9984, attr_start_acc: 0.9890, attr_end_acc: 0.9922, span_micro_p: 0.9947, span_micro_r: 0.9939, span_micro_f1: 0.9943, micro_p: 0.9932, micro_r: 0.9818, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 3.2365, span_acc: 0.9984, attr_start_acc: 0.9889, attr_end_acc: 0.9918, span_micro_p: 0.9949, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9931, micro_r: 0.9813, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 3.1665, span_acc: 0.9983, attr_start_acc: 0.9884, attr_end_acc: 0.9918, span_micro_p: 0.9948, span_micro_r: 0.9938, span_micro_f1: 0.9943, micro_p: 0.9932, micro_r: 0.9809, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 3.0167, span_acc: 0.9983, attr_start_acc: 0.9883, attr_end_acc: 0.9916, span_micro_p: 0.9948, span_micro_r: 0.9940, span_micro_f1: 0.9944, micro_p: 0.9929, micro_r: 0.9809, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 2.8344, span_acc: 0.9984, attr_start_acc: 0.9886, attr_end_acc: 0.9919, span_micro_p: 0.9949, span_micro_r: 0.9940, span_micro_f1: 0.9945, micro_p: 0.9931, micro_r: 0.9814, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 2.7705, span_acc: 0.9984, attr_start_acc: 0.9887, attr_end_acc: 0.9920, span_micro_p: 0.9951, span_micro_r: 0.9942, span_micro_f1: 0.9947, micro_p: 0.9932, micro_r: 0.9818, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 2.7601, span_acc: 0.9985, attr_start_acc: 0.9890, attr_end_acc: 0.9922, span_micro_p: 0.9952, span_micro_r: 0.9945, span_micro_f1: 0.9948, micro_p: 0.9933, micro_r: 0.9820, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 2.8494, span_acc: 0.9985, attr_start_acc: 0.9890, attr_end_acc: 0.9924, span_micro_p: 0.9952, span_micro_r: 0.9946, span_micro_f1: 0.9949, micro_p: 0.9933, micro_r: 0.9820, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 2.7903, span_acc: 0.9984, attr_start_acc: 0.9889, attr_end_acc: 0.9924, span_micro_p: 0.9947, span_micro_r: 0.9942, span_micro_f1: 0.9945, micro_p: 0.9929, micro_r: 0.9819, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.87 / 98.05 / 98.39), p: (96.03 / 96.09), r: (96.86 / 95.83), f1: (96.44 / 95.96000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 53.52202491497633, 'span_acc': 0.9887494078635718, 'attr_start_acc': 0.980510752688172, 'attr_end_acc': 0.9838709677419355, 'span_micro_p': 0.9602649006622517, 'span_micro_r': 0.9686038744154977, 'span_micro_f1': 0.9644163618224143, 'micro_p': 0.9608636977058029, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9595687331536389, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9484, 0.952, 0.9502), 'TITLE': (0.9634, 0.9536, 0.9585), 'EDU': (0.9808, 0.9623, 0.9715), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9595687331536389 / 0.9629380053908355
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.50999999999999 / 97.24000000000001 / 97.78999999999999), p: (95.67 / 96.06), r: (96.13000000000001 / 95.64), f1: (95.89999999999999 / 95.85000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 37.29794944007442, 'span_acc': 0.9850655903128154, 'attr_start_acc': 0.9723926380368099, 'attr_end_acc': 0.9779141104294479, 'span_micro_p': 0.9566544566544567, 'span_micro_r': 0.9613496932515337, 'span_micro_f1': 0.9589963280293757, 'micro_p': 0.9605668515095502, 'micro_r': 0.9564417177914111, 'micro_f1': 0.958499846295727, 'category-p/r/f1': {'LOC': (1.0, 0.5, 0.6667), 'ORG': (0.9373, 0.9458, 0.9415), 'TITLE': (0.9685, 0.9547, 0.9616), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (0.9823, 0.9911, 0.9867), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.958499846295727 / 0.9633281972265023
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.962938
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.963328
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.98627648839556
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9693251533742331
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9693251533742331
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9455535390199638
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9588957055214724
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9521778860798052
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9574074074074074
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9515337423312883
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.9544615384615385
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'PRO': (0.9355, 0.8788, 0.9063), 'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9342, 0.9494, 0.9417), 'TITLE': (0.9619, 0.9482, 0.955), 'EDU': (0.9907, 0.9464, 0.968), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 1.8568, span_acc: 0.6336, attr_start_acc: 0.0025, attr_end_acc: 0.0203, span_micro_p: 0.3548, span_micro_r: 0.0556, span_micro_f1: 0.0961, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.4989, span_acc: 0.7852, attr_start_acc: 0.0363, attr_end_acc: 0.2747, span_micro_p: 0.7305, span_micro_r: 0.4020, span_micro_f1: 0.5186, micro_p: 0.3409, micro_r: 0.0342, micro_f1: 0.0621
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.3336, span_acc: 0.8366, attr_start_acc: 0.2165, attr_end_acc: 0.4085, span_micro_p: 0.7773, span_micro_r: 0.5239, span_micro_f1: 0.6259, micro_p: 0.6469, micro_r: 0.1749, micro_f1: 0.2754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.2275, span_acc: 0.8639, attr_start_acc: 0.3576, attr_end_acc: 0.4870, span_micro_p: 0.8182, span_micro_r: 0.5993, span_micro_f1: 0.6918, micro_p: 0.7412, micro_r: 0.2815, micro_f1: 0.4080
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.1594, span_acc: 0.8828, attr_start_acc: 0.4464, attr_end_acc: 0.5502, span_micro_p: 0.8429, span_micro_r: 0.6503, span_micro_f1: 0.7341, micro_p: 0.8075, micro_r: 0.3706, micro_f1: 0.5080
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.0952, span_acc: 0.8982, attr_start_acc: 0.5037, attr_end_acc: 0.5903, span_micro_p: 0.8643, span_micro_r: 0.6930, span_micro_f1: 0.7692, micro_p: 0.8437, micro_r: 0.4303, micro_f1: 0.5699
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.0520, span_acc: 0.9068, attr_start_acc: 0.5449, attr_end_acc: 0.6319, span_micro_p: 0.8764, span_micro_r: 0.7195, span_micro_f1: 0.7902, micro_p: 0.8625, micro_r: 0.4747, micro_f1: 0.6124
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.0161, span_acc: 0.9128, attr_start_acc: 0.5746, attr_end_acc: 0.6569, span_micro_p: 0.8800, span_micro_r: 0.7360, span_micro_f1: 0.8016, micro_p: 0.8708, micro_r: 0.5051, micro_f1: 0.6394
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 0.9831, span_acc: 0.9198, attr_start_acc: 0.6070, attr_end_acc: 0.6815, span_micro_p: 0.8883, span_micro_r: 0.7568, span_micro_f1: 0.8173, micro_p: 0.8842, micro_r: 0.5385, micro_f1: 0.6694
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 0.9593, span_acc: 0.9245, attr_start_acc: 0.6371, attr_end_acc: 0.7039, span_micro_p: 0.8933, span_micro_r: 0.7715, span_micro_f1: 0.8279, micro_p: 0.8936, micro_r: 0.5688, micro_f1: 0.6951
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 0.9341, span_acc: 0.9298, attr_start_acc: 0.6603, attr_end_acc: 0.7208, span_micro_p: 0.8953, span_micro_r: 0.7836, span_micro_f1: 0.8357, micro_p: 0.9006, micro_r: 0.5938, micro_f1: 0.7157
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 0.9103, span_acc: 0.9344, attr_start_acc: 0.6826, attr_end_acc: 0.7384, span_micro_p: 0.9006, span_micro_r: 0.7972, span_micro_f1: 0.8458, micro_p: 0.9077, micro_r: 0.6185, micro_f1: 0.7357
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 0.8911, span_acc: 0.9381, attr_start_acc: 0.7018, attr_end_acc: 0.7540, span_micro_p: 0.9059, span_micro_r: 0.8089, span_micro_f1: 0.8547, micro_p: 0.9139, micro_r: 0.6404, micro_f1: 0.7531
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 0.8766, span_acc: 0.9403, attr_start_acc: 0.7175, attr_end_acc: 0.7667, span_micro_p: 0.9081, span_micro_r: 0.8146, span_micro_f1: 0.8588, micro_p: 0.9187, micro_r: 0.6569, micro_f1: 0.7660
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 0.8608, span_acc: 0.9430, attr_start_acc: 0.7310, attr_end_acc: 0.7787, span_micro_p: 0.9110, span_micro_r: 0.8224, span_micro_f1: 0.8644, micro_p: 0.9228, micro_r: 0.6728, micro_f1: 0.7782
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 0.8467, span_acc: 0.9447, attr_start_acc: 0.7427, attr_end_acc: 0.7893, span_micro_p: 0.9127, span_micro_r: 0.8278, span_micro_f1: 0.8682, micro_p: 0.9262, micro_r: 0.6862, micro_f1: 0.7883
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 0.8312, span_acc: 0.9471, attr_start_acc: 0.7543, attr_end_acc: 0.8001, span_micro_p: 0.9148, span_micro_r: 0.8338, span_micro_f1: 0.8724, micro_p: 0.9286, micro_r: 0.6993, micro_f1: 0.7978
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 0.8169, span_acc: 0.9486, attr_start_acc: 0.7638, attr_end_acc: 0.8084, span_micro_p: 0.9164, span_micro_r: 0.8385, span_micro_f1: 0.8757, micro_p: 0.9310, micro_r: 0.7100, micro_f1: 0.8056
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 0.8068, span_acc: 0.9495, attr_start_acc: 0.7716, attr_end_acc: 0.8150, span_micro_p: 0.9145, span_micro_r: 0.8396, span_micro_f1: 0.8755, micro_p: 0.9301, micro_r: 0.7180, micro_f1: 0.8104
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 0.7942, span_acc: 0.9509, attr_start_acc: 0.7790, attr_end_acc: 0.8216, span_micro_p: 0.9165, span_micro_r: 0.8440, span_micro_f1: 0.8787, micro_p: 0.9317, micro_r: 0.7267, micro_f1: 0.8165
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 0.7827, span_acc: 0.9521, attr_start_acc: 0.7866, attr_end_acc: 0.8282, span_micro_p: 0.9173, span_micro_r: 0.8473, span_micro_f1: 0.8809, micro_p: 0.9329, micro_r: 0.7351, micro_f1: 0.8223
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 0.7757, span_acc: 0.9528, attr_start_acc: 0.7927, attr_end_acc: 0.8333, span_micro_p: 0.9177, span_micro_r: 0.8498, span_micro_f1: 0.8825, micro_p: 0.9345, micro_r: 0.7416, micro_f1: 0.8269
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 0.7639, span_acc: 0.9539, attr_start_acc: 0.7988, attr_end_acc: 0.8380, span_micro_p: 0.9200, span_micro_r: 0.8535, span_micro_f1: 0.8855, micro_p: 0.9363, micro_r: 0.7485, micro_f1: 0.8319
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 0.7571, span_acc: 0.9550, attr_start_acc: 0.8059, attr_end_acc: 0.8437, span_micro_p: 0.9207, span_micro_r: 0.8569, span_micro_f1: 0.8876, micro_p: 0.9371, micro_r: 0.7561, micro_f1: 0.8369
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 0.7463, span_acc: 0.9561, attr_start_acc: 0.8112, attr_end_acc: 0.8482, span_micro_p: 0.9223, span_micro_r: 0.8604, span_micro_f1: 0.8903, micro_p: 0.9389, micro_r: 0.7627, micro_f1: 0.8417
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 0.7359, span_acc: 0.9568, attr_start_acc: 0.8157, attr_end_acc: 0.8524, span_micro_p: 0.9221, span_micro_r: 0.8623, span_micro_f1: 0.8912, micro_p: 0.9384, micro_r: 0.7677, micro_f1: 0.8445
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 0.7270, span_acc: 0.9571, attr_start_acc: 0.8200, attr_end_acc: 0.8562, span_micro_p: 0.9222, span_micro_r: 0.8642, span_micro_f1: 0.8923, micro_p: 0.9384, micro_r: 0.7725, micro_f1: 0.8474
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 0.7194, span_acc: 0.9578, attr_start_acc: 0.8245, attr_end_acc: 0.8592, span_micro_p: 0.9229, span_micro_r: 0.8664, span_micro_f1: 0.8937, micro_p: 0.9390, micro_r: 0.7768, micro_f1: 0.8502
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 0.7093, span_acc: 0.9585, attr_start_acc: 0.8288, attr_end_acc: 0.8629, span_micro_p: 0.9239, span_micro_r: 0.8689, span_micro_f1: 0.8956, micro_p: 0.9398, micro_r: 0.7822, micro_f1: 0.8538
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 0.7002, span_acc: 0.9595, attr_start_acc: 0.8336, attr_end_acc: 0.8665, span_micro_p: 0.9258, span_micro_r: 0.8718, span_micro_f1: 0.8980, micro_p: 0.9416, micro_r: 0.7879, micro_f1: 0.8579
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 0.6914, span_acc: 0.9603, attr_start_acc: 0.8375, attr_end_acc: 0.8694, span_micro_p: 0.9268, span_micro_r: 0.8739, span_micro_f1: 0.8996, micro_p: 0.9427, micro_r: 0.7924, micro_f1: 0.8611
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.32 / 95.56 / 96.1), p: (96.00999999999999 / 97.02), r: (94.86 / 92.13), f1: (95.43 / 94.51)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.32648692526261186, 'span_acc': 0.983183325438181, 'attr_start_acc': 0.9556451612903226, 'attr_end_acc': 0.9610215053763441, 'span_micro_p': 0.9601081812035159, 'span_micro_r': 0.948563794255177, 'span_micro_f1': 0.9543010752688171, 'micro_p': 0.9702338766832034, 'micro_r': 0.9212651413189771, 'micro_f1': 0.9451156368657232, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (1.0, 0.7778, 0.875), 'ORG': (0.9594, 0.9079, 0.9329), 'TITLE': (0.971, 0.9217, 0.9457), 'EDU': (0.9899, 0.9245, 0.9561), 'RACE': (0.9333, 1.0, 0.9655), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9451156368657232 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.8 / 94.85 / 95.64), p: (95.87 / 97.59), r: (93.99 / 91.84), f1: (94.92 / 94.63000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.3179885334563705, 'span_acc': 0.9780020181634712, 'attr_start_acc': 0.9484662576687116, 'attr_end_acc': 0.9564417177914111, 'span_micro_p': 0.9586983729662077, 'span_micro_r': 0.939877300613497, 'span_micro_f1': 0.949194547707559, 'micro_p': 0.9758800521512386, 'micro_r': 0.9184049079754601, 'micro_f1': 0.9462705436156763, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.92, 0.697, 0.7931), 'ORG': (0.9618, 0.9096, 0.935), 'TITLE': (0.9807, 0.921, 0.9499), 'EDU': (0.9907, 0.9464, 0.968), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9462705436156763 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.4564, span_acc: 0.9571, attr_start_acc: 0.9143, attr_end_acc: 0.8571, span_micro_p: 0.8750, span_micro_r: 0.8000, span_micro_f1: 0.8358, micro_p: 1.0000, micro_r: 0.7714, micro_f1: 0.8710
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.3811, span_acc: 0.9839, attr_start_acc: 0.9742, attr_end_acc: 0.9690, span_micro_p: 0.9504, span_micro_r: 0.9381, span_micro_f1: 0.9442, micro_p: 0.9783, micro_r: 0.9328, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.3754, span_acc: 0.9847, attr_start_acc: 0.9694, attr_end_acc: 0.9645, span_micro_p: 0.9543, span_micro_r: 0.9403, span_micro_f1: 0.9472, micro_p: 0.9719, micro_r: 0.9302, micro_f1: 0.9506
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.3631, span_acc: 0.9858, attr_start_acc: 0.9686, attr_end_acc: 0.9631, span_micro_p: 0.9544, span_micro_r: 0.9469, span_micro_f1: 0.9506, micro_p: 0.9706, micro_r: 0.9333, micro_f1: 0.9516
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.3634, span_acc: 0.9850, attr_start_acc: 0.9678, attr_end_acc: 0.9678, span_micro_p: 0.9576, span_micro_r: 0.9496, span_micro_f1: 0.9536, micro_p: 0.9716, micro_r: 0.9368, micro_f1: 0.9539
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.3632, span_acc: 0.9825, attr_start_acc: 0.9589, attr_end_acc: 0.9646, span_micro_p: 0.9539, span_micro_r: 0.9444, span_micro_f1: 0.9491, micro_p: 0.9671, micro_r: 0.9283, micro_f1: 0.9473
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.3531, span_acc: 0.9817, attr_start_acc: 0.9598, attr_end_acc: 0.9670, span_micro_p: 0.9532, span_micro_r: 0.9423, span_micro_f1: 0.9477, micro_p: 0.9673, micro_r: 0.9308, micro_f1: 0.9487
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.3438, span_acc: 0.9816, attr_start_acc: 0.9621, attr_end_acc: 0.9680, span_micro_p: 0.9561, span_micro_r: 0.9453, span_micro_f1: 0.9506, micro_p: 0.9696, micro_r: 0.9343, micro_f1: 0.9516
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.3323, span_acc: 0.9820, attr_start_acc: 0.9640, attr_end_acc: 0.9676, span_micro_p: 0.9586, span_micro_r: 0.9480, span_micro_f1: 0.9533, micro_p: 0.9713, micro_r: 0.9357, micro_f1: 0.9532
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.3210, span_acc: 0.9815, attr_start_acc: 0.9629, attr_end_acc: 0.9669, span_micro_p: 0.9595, span_micro_r: 0.9475, span_micro_f1: 0.9534, micro_p: 0.9720, micro_r: 0.9354, micro_f1: 0.9533
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.3104, span_acc: 0.9826, attr_start_acc: 0.9647, attr_end_acc: 0.9685, span_micro_p: 0.9611, span_micro_r: 0.9504, span_micro_f1: 0.9557, micro_p: 0.9723, micro_r: 0.9384, micro_f1: 0.9551
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.2967, span_acc: 0.9831, attr_start_acc: 0.9656, attr_end_acc: 0.9688, span_micro_p: 0.9613, span_micro_r: 0.9506, span_micro_f1: 0.9559, micro_p: 0.9727, micro_r: 0.9394, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.2873, span_acc: 0.9836, attr_start_acc: 0.9651, attr_end_acc: 0.9695, span_micro_p: 0.9615, span_micro_r: 0.9504, span_micro_f1: 0.9559, micro_p: 0.9719, micro_r: 0.9399, micro_f1: 0.9556
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.2812, span_acc: 0.9840, attr_start_acc: 0.9637, attr_end_acc: 0.9694, span_micro_p: 0.9618, span_micro_r: 0.9503, span_micro_f1: 0.9561, micro_p: 0.9718, micro_r: 0.9388, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.2714, span_acc: 0.9842, attr_start_acc: 0.9642, attr_end_acc: 0.9700, span_micro_p: 0.9618, span_micro_r: 0.9507, span_micro_f1: 0.9562, micro_p: 0.9718, micro_r: 0.9397, micro_f1: 0.9555
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.2632, span_acc: 0.9844, attr_start_acc: 0.9643, attr_end_acc: 0.9701, span_micro_p: 0.9623, span_micro_r: 0.9512, span_micro_f1: 0.9567, micro_p: 0.9723, micro_r: 0.9401, micro_f1: 0.9559
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.2595, span_acc: 0.9843, attr_start_acc: 0.9640, attr_end_acc: 0.9692, span_micro_p: 0.9611, span_micro_r: 0.9505, span_micro_f1: 0.9558, micro_p: 0.9723, micro_r: 0.9390, micro_f1: 0.9554
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.2504, span_acc: 0.9844, attr_start_acc: 0.9642, attr_end_acc: 0.9693, span_micro_p: 0.9613, span_micro_r: 0.9514, span_micro_f1: 0.9563, micro_p: 0.9729, micro_r: 0.9393, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.2507, span_acc: 0.9837, attr_start_acc: 0.9643, attr_end_acc: 0.9691, span_micro_p: 0.9604, span_micro_r: 0.9507, span_micro_f1: 0.9555, micro_p: 0.9729, micro_r: 0.9391, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.2434, span_acc: 0.9837, attr_start_acc: 0.9633, attr_end_acc: 0.9685, span_micro_p: 0.9595, span_micro_r: 0.9499, span_micro_f1: 0.9547, micro_p: 0.9722, micro_r: 0.9380, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.2398, span_acc: 0.9836, attr_start_acc: 0.9627, attr_end_acc: 0.9686, span_micro_p: 0.9597, span_micro_r: 0.9495, span_micro_f1: 0.9546, micro_p: 0.9724, micro_r: 0.9378, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.2297, span_acc: 0.9841, attr_start_acc: 0.9633, attr_end_acc: 0.9690, span_micro_p: 0.9604, span_micro_r: 0.9506, span_micro_f1: 0.9555, micro_p: 0.9728, micro_r: 0.9388, micro_f1: 0.9555
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.2224, span_acc: 0.9843, attr_start_acc: 0.9639, attr_end_acc: 0.9692, span_micro_p: 0.9608, span_micro_r: 0.9512, span_micro_f1: 0.9560, micro_p: 0.9728, micro_r: 0.9395, micro_f1: 0.9559
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.2151, span_acc: 0.9839, attr_start_acc: 0.9634, attr_end_acc: 0.9693, span_micro_p: 0.9605, span_micro_r: 0.9509, span_micro_f1: 0.9557, micro_p: 0.9722, micro_r: 0.9388, micro_f1: 0.9552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.2206, span_acc: 0.9840, attr_start_acc: 0.9637, attr_end_acc: 0.9697, span_micro_p: 0.9599, span_micro_r: 0.9508, span_micro_f1: 0.9553, micro_p: 0.9717, micro_r: 0.9392, micro_f1: 0.9552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.2148, span_acc: 0.9835, attr_start_acc: 0.9643, attr_end_acc: 0.9705, span_micro_p: 0.9587, span_micro_r: 0.9511, span_micro_f1: 0.9549, micro_p: 0.9716, micro_r: 0.9402, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.2072, span_acc: 0.9835, attr_start_acc: 0.9647, attr_end_acc: 0.9709, span_micro_p: 0.9585, span_micro_r: 0.9513, span_micro_f1: 0.9549, micro_p: 0.9716, micro_r: 0.9406, micro_f1: 0.9559
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.2010, span_acc: 0.9835, attr_start_acc: 0.9647, attr_end_acc: 0.9711, span_micro_p: 0.9583, span_micro_r: 0.9514, span_micro_f1: 0.9548, micro_p: 0.9714, micro_r: 0.9406, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.1912, span_acc: 0.9836, attr_start_acc: 0.9652, attr_end_acc: 0.9715, span_micro_p: 0.9589, span_micro_r: 0.9525, span_micro_f1: 0.9557, micro_p: 0.9721, micro_r: 0.9415, micro_f1: 0.9565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.1921, span_acc: 0.9839, attr_start_acc: 0.9655, attr_end_acc: 0.9718, span_micro_p: 0.9595, span_micro_r: 0.9529, span_micro_f1: 0.9562, micro_p: 0.9724, micro_r: 0.9420, micro_f1: 0.9569
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.1883, span_acc: 0.9841, attr_start_acc: 0.9657, attr_end_acc: 0.9715, span_micro_p: 0.9599, span_micro_r: 0.9528, span_micro_f1: 0.9564, micro_p: 0.9724, micro_r: 0.9418, micro_f1: 0.9569
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.1903, span_acc: 0.9839, attr_start_acc: 0.9650, attr_end_acc: 0.9711, span_micro_p: 0.9596, span_micro_r: 0.9523, span_micro_f1: 0.9559, micro_p: 0.9723, micro_r: 0.9408, micro_f1: 0.9563
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.35000000000001 / 96.71 / 97.11), p: (96.41999999999999 / 96.7), r: (95.32000000000001 / 94.67999999999999), f1: (95.87 / 95.67999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.10466128961056406, 'span_acc': 0.9835386072951208, 'attr_start_acc': 0.9670698924731183, 'attr_end_acc': 0.9711021505376344, 'span_micro_p': 0.9641891891891892, 'span_micro_r': 0.9532398129592519, 'span_micro_f1': 0.9586832381592206, 'micro_p': 0.9670103092783505, 'micro_r': 0.9468371467025573, 'micro_f1': 0.9568174090445427, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9547, 0.9309, 0.9426), 'TITLE': (0.9702, 0.9449, 0.9574), 'EDU': (0.981, 0.9717, 0.9763), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9568174090445427 / 0.9451156368657232
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.49 / 95.52000000000001 / 96.32), p: (96.39999999999999 / 97.57000000000001), r: (93.74 / 93.62), f1: (95.05 / 95.55)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.1650970032754934, 'span_acc': 0.9748738647830474, 'attr_start_acc': 0.9552147239263804, 'attr_end_acc': 0.9631901840490797, 'span_micro_p': 0.9640378548895899, 'span_micro_r': 0.9374233128834356, 'span_micro_f1': 0.9505443234836704, 'micro_p': 0.9757033248081841, 'micro_r': 0.9361963190184049, 'micro_f1': 0.9555416405760803, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'PRO': (0.9677, 0.9091, 0.9375), 'ORG': (0.9694, 0.9168, 0.9424), 'TITLE': (0.9731, 0.9365, 0.9544), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9555416405760803 / 0.9462705436156763
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: -0.2282, span_acc: 1.0000, attr_start_acc: 0.9870, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9870, micro_f1: 0.9935
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: -0.1761, span_acc: 0.9879, attr_start_acc: 0.9660, attr_end_acc: 0.9703, span_micro_p: 0.9702, span_micro_r: 0.9600, span_micro_f1: 0.9651, micro_p: 0.9823, micro_r: 0.9406, micro_f1: 0.9610
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: -0.0329, span_acc: 0.9843, attr_start_acc: 0.9627, attr_end_acc: 0.9729, span_micro_p: 0.9582, span_micro_r: 0.9496, span_micro_f1: 0.9539, micro_p: 0.9684, micro_r: 0.9376, micro_f1: 0.9528
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: -0.0981, span_acc: 0.9876, attr_start_acc: 0.9646, attr_end_acc: 0.9783, span_micro_p: 0.9640, span_micro_r: 0.9609, span_micro_f1: 0.9624, micro_p: 0.9742, micro_r: 0.9435, micro_f1: 0.9586
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: -0.0928, span_acc: 0.9882, attr_start_acc: 0.9696, attr_end_acc: 0.9809, span_micro_p: 0.9650, span_micro_r: 0.9628, span_micro_f1: 0.9639, micro_p: 0.9743, micro_r: 0.9505, micro_f1: 0.9623
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: -0.1215, span_acc: 0.9886, attr_start_acc: 0.9717, attr_end_acc: 0.9816, span_micro_p: 0.9653, span_micro_r: 0.9648, span_micro_f1: 0.9650, micro_p: 0.9739, micro_r: 0.9537, micro_f1: 0.9637
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: -0.1115, span_acc: 0.9885, attr_start_acc: 0.9723, attr_end_acc: 0.9813, span_micro_p: 0.9682, span_micro_r: 0.9659, span_micro_f1: 0.9670, micro_p: 0.9757, micro_r: 0.9559, micro_f1: 0.9657
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: -0.1343, span_acc: 0.9894, attr_start_acc: 0.9728, attr_end_acc: 0.9819, span_micro_p: 0.9696, span_micro_r: 0.9680, span_micro_f1: 0.9688, micro_p: 0.9781, micro_r: 0.9571, micro_f1: 0.9674
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: -0.1360, span_acc: 0.9889, attr_start_acc: 0.9726, attr_end_acc: 0.9814, span_micro_p: 0.9675, span_micro_r: 0.9652, span_micro_f1: 0.9664, micro_p: 0.9774, micro_r: 0.9563, micro_f1: 0.9667
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: -0.1067, span_acc: 0.9893, attr_start_acc: 0.9729, attr_end_acc: 0.9825, span_micro_p: 0.9676, span_micro_r: 0.9654, span_micro_f1: 0.9665, micro_p: 0.9778, micro_r: 0.9566, micro_f1: 0.9671
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: -0.1180, span_acc: 0.9898, attr_start_acc: 0.9742, attr_end_acc: 0.9831, span_micro_p: 0.9696, span_micro_r: 0.9664, span_micro_f1: 0.9680, micro_p: 0.9793, micro_r: 0.9582, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: -0.1066, span_acc: 0.9894, attr_start_acc: 0.9702, attr_end_acc: 0.9805, span_micro_p: 0.9679, span_micro_r: 0.9650, span_micro_f1: 0.9665, micro_p: 0.9763, micro_r: 0.9532, micro_f1: 0.9646
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: -0.0696, span_acc: 0.9895, attr_start_acc: 0.9698, attr_end_acc: 0.9797, span_micro_p: 0.9675, span_micro_r: 0.9645, span_micro_f1: 0.9660, micro_p: 0.9759, micro_r: 0.9524, micro_f1: 0.9640
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: -0.0634, span_acc: 0.9896, attr_start_acc: 0.9695, attr_end_acc: 0.9797, span_micro_p: 0.9683, span_micro_r: 0.9644, span_micro_f1: 0.9663, micro_p: 0.9758, micro_r: 0.9519, micro_f1: 0.9637
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: -0.0689, span_acc: 0.9892, attr_start_acc: 0.9698, attr_end_acc: 0.9802, span_micro_p: 0.9688, span_micro_r: 0.9644, span_micro_f1: 0.9666, micro_p: 0.9765, micro_r: 0.9526, micro_f1: 0.9644
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: -0.0764, span_acc: 0.9891, attr_start_acc: 0.9701, attr_end_acc: 0.9802, span_micro_p: 0.9687, span_micro_r: 0.9646, span_micro_f1: 0.9667, micro_p: 0.9765, micro_r: 0.9531, micro_f1: 0.9647
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: -0.0765, span_acc: 0.9893, attr_start_acc: 0.9706, attr_end_acc: 0.9807, span_micro_p: 0.9683, span_micro_r: 0.9644, span_micro_f1: 0.9663, micro_p: 0.9764, micro_r: 0.9537, micro_f1: 0.9649
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: -0.0758, span_acc: 0.9892, attr_start_acc: 0.9707, attr_end_acc: 0.9810, span_micro_p: 0.9679, span_micro_r: 0.9645, span_micro_f1: 0.9662, micro_p: 0.9757, micro_r: 0.9535, micro_f1: 0.9645
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: -0.0850, span_acc: 0.9895, attr_start_acc: 0.9710, attr_end_acc: 0.9816, span_micro_p: 0.9688, span_micro_r: 0.9656, span_micro_f1: 0.9672, micro_p: 0.9764, micro_r: 0.9545, micro_f1: 0.9653
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: -0.0891, span_acc: 0.9893, attr_start_acc: 0.9711, attr_end_acc: 0.9814, span_micro_p: 0.9682, span_micro_r: 0.9655, span_micro_f1: 0.9669, micro_p: 0.9762, micro_r: 0.9542, micro_f1: 0.9651
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: -0.0820, span_acc: 0.9889, attr_start_acc: 0.9713, attr_end_acc: 0.9803, span_micro_p: 0.9691, span_micro_r: 0.9658, span_micro_f1: 0.9674, micro_p: 0.9767, micro_r: 0.9539, micro_f1: 0.9652
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: -0.0928, span_acc: 0.9891, attr_start_acc: 0.9720, attr_end_acc: 0.9807, span_micro_p: 0.9700, span_micro_r: 0.9669, span_micro_f1: 0.9684, micro_p: 0.9771, micro_r: 0.9551, micro_f1: 0.9660
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: -0.0987, span_acc: 0.9891, attr_start_acc: 0.9722, attr_end_acc: 0.9808, span_micro_p: 0.9701, span_micro_r: 0.9674, span_micro_f1: 0.9687, micro_p: 0.9775, micro_r: 0.9556, micro_f1: 0.9664
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: -0.1081, span_acc: 0.9891, attr_start_acc: 0.9719, attr_end_acc: 0.9806, span_micro_p: 0.9697, span_micro_r: 0.9669, span_micro_f1: 0.9683, micro_p: 0.9777, micro_r: 0.9550, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: -0.1151, span_acc: 0.9893, attr_start_acc: 0.9722, attr_end_acc: 0.9808, span_micro_p: 0.9696, span_micro_r: 0.9675, span_micro_f1: 0.9685, micro_p: 0.9774, micro_r: 0.9553, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: -0.1189, span_acc: 0.9894, attr_start_acc: 0.9726, attr_end_acc: 0.9810, span_micro_p: 0.9700, span_micro_r: 0.9677, span_micro_f1: 0.9689, micro_p: 0.9773, micro_r: 0.9557, micro_f1: 0.9664
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: -0.0975, span_acc: 0.9893, attr_start_acc: 0.9726, attr_end_acc: 0.9811, span_micro_p: 0.9699, span_micro_r: 0.9680, span_micro_f1: 0.9689, micro_p: 0.9768, micro_r: 0.9558, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: -0.0997, span_acc: 0.9895, attr_start_acc: 0.9725, attr_end_acc: 0.9811, span_micro_p: 0.9704, span_micro_r: 0.9683, span_micro_f1: 0.9693, micro_p: 0.9770, micro_r: 0.9559, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: -0.0991, span_acc: 0.9894, attr_start_acc: 0.9730, attr_end_acc: 0.9812, span_micro_p: 0.9702, span_micro_r: 0.9682, span_micro_f1: 0.9692, micro_p: 0.9770, micro_r: 0.9561, micro_f1: 0.9665
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: -0.0991, span_acc: 0.9895, attr_start_acc: 0.9734, attr_end_acc: 0.9811, span_micro_p: 0.9702, span_micro_r: 0.9679, span_micro_f1: 0.9691, micro_p: 0.9774, micro_r: 0.9566, micro_f1: 0.9669
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: -0.0917, span_acc: 0.9893, attr_start_acc: 0.9733, attr_end_acc: 0.9812, span_micro_p: 0.9697, span_micro_r: 0.9675, span_micro_f1: 0.9686, micro_p: 0.9774, micro_r: 0.9566, micro_f1: 0.9669
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: -0.0896, span_acc: 0.9894, attr_start_acc: 0.9733, attr_end_acc: 0.9813, span_micro_p: 0.9698, span_micro_r: 0.9673, span_micro_f1: 0.9686, micro_p: 0.9776, micro_r: 0.9567, micro_f1: 0.9670
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.74000000000001 / 97.50999999999999 / 98.19), p: (95.7 / 96.87), r: (96.66 / 95.83), f1: (96.17999999999999 / 96.35000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': -0.10218636752719755, 'span_acc': 0.987446707721459, 'attr_start_acc': 0.9751344086021505, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.957010582010582, 'span_micro_r': 0.9665998663994656, 'span_micro_f1': 0.961781322698571, 'micro_p': 0.9687074829931973, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9634641407307172, 'category-p/r/f1': {'PRO': (0.9444, 0.9444, 0.9444), 'ORG': (0.9591, 0.9443, 0.9516), 'TITLE': (0.9721, 0.958, 0.965), 'EDU': (0.9626, 0.9717, 0.9671), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9634641407307172 / 0.9568174090445427
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.17 / 97.06 / 97.48), p: (94.95 / 96.46000000000001), r: (95.83 / 95.39999999999999), f1: (95.39 / 95.93)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.2043109506181201, 'span_acc': 0.9817356205852674, 'attr_start_acc': 0.9705521472392638, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.9495440729483283, 'span_micro_r': 0.9582822085889571, 'span_micro_f1': 0.9538931297709923, 'micro_p': 0.9646401985111662, 'micro_r': 0.9539877300613497, 'micro_f1': 0.959284392350401, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9543, 0.9439, 0.9491), 'PRO': (0.9412, 0.9697, 0.9552), 'TITLE': (0.9619, 0.9495, 0.9557), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 0.9911, 0.9955), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.959284392350401 / 0.9555416405760803
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.3734, span_acc: 0.9876, attr_start_acc: 0.9913, attr_end_acc: 0.9739, span_micro_p: 0.9739, span_micro_r: 0.9655, span_micro_f1: 0.9697, micro_p: 0.9825, micro_r: 0.9739, micro_f1: 0.9782
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -0.2418, span_acc: 0.9916, attr_start_acc: 0.9776, attr_end_acc: 0.9793, span_micro_p: 0.9810, span_micro_r: 0.9676, span_micro_f1: 0.9742, micro_p: 0.9876, micro_r: 0.9638, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.3838, span_acc: 0.9934, attr_start_acc: 0.9761, attr_end_acc: 0.9834, span_micro_p: 0.9816, span_micro_r: 0.9735, span_micro_f1: 0.9776, micro_p: 0.9859, micro_r: 0.9659, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.4379, span_acc: 0.9941, attr_start_acc: 0.9725, attr_end_acc: 0.9815, span_micro_p: 0.9828, span_micro_r: 0.9755, span_micro_f1: 0.9791, micro_p: 0.9866, micro_r: 0.9615, micro_f1: 0.9739
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -0.4519, span_acc: 0.9941, attr_start_acc: 0.9725, attr_end_acc: 0.9805, span_micro_p: 0.9820, span_micro_r: 0.9743, span_micro_f1: 0.9781, micro_p: 0.9864, micro_r: 0.9593, micro_f1: 0.9727
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -0.3701, span_acc: 0.9932, attr_start_acc: 0.9715, attr_end_acc: 0.9780, span_micro_p: 0.9801, span_micro_r: 0.9738, span_micro_f1: 0.9770, micro_p: 0.9848, micro_r: 0.9559, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -0.3667, span_acc: 0.9935, attr_start_acc: 0.9719, attr_end_acc: 0.9793, span_micro_p: 0.9804, span_micro_r: 0.9746, span_micro_f1: 0.9775, micro_p: 0.9840, micro_r: 0.9566, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -0.3771, span_acc: 0.9936, attr_start_acc: 0.9729, attr_end_acc: 0.9796, span_micro_p: 0.9803, span_micro_r: 0.9741, span_micro_f1: 0.9772, micro_p: 0.9853, micro_r: 0.9589, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -0.4013, span_acc: 0.9938, attr_start_acc: 0.9728, attr_end_acc: 0.9810, span_micro_p: 0.9815, span_micro_r: 0.9755, span_micro_f1: 0.9785, micro_p: 0.9865, micro_r: 0.9596, micro_f1: 0.9729
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: -0.3689, span_acc: 0.9936, attr_start_acc: 0.9731, attr_end_acc: 0.9808, span_micro_p: 0.9803, span_micro_r: 0.9748, span_micro_f1: 0.9775, micro_p: 0.9859, micro_r: 0.9594, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: -0.2881, span_acc: 0.9935, attr_start_acc: 0.9739, attr_end_acc: 0.9816, span_micro_p: 0.9794, span_micro_r: 0.9745, span_micro_f1: 0.9769, micro_p: 0.9859, micro_r: 0.9604, micro_f1: 0.9730
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: -0.2516, span_acc: 0.9932, attr_start_acc: 0.9737, attr_end_acc: 0.9813, span_micro_p: 0.9785, span_micro_r: 0.9743, span_micro_f1: 0.9764, micro_p: 0.9848, micro_r: 0.9603, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: -0.2102, span_acc: 0.9928, attr_start_acc: 0.9735, attr_end_acc: 0.9819, span_micro_p: 0.9790, span_micro_r: 0.9746, span_micro_f1: 0.9768, micro_p: 0.9847, micro_r: 0.9605, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: -0.1892, span_acc: 0.9929, attr_start_acc: 0.9739, attr_end_acc: 0.9821, span_micro_p: 0.9787, span_micro_r: 0.9742, span_micro_f1: 0.9765, micro_p: 0.9847, micro_r: 0.9609, micro_f1: 0.9726
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: -0.2031, span_acc: 0.9931, attr_start_acc: 0.9748, attr_end_acc: 0.9826, span_micro_p: 0.9791, span_micro_r: 0.9748, span_micro_f1: 0.9770, micro_p: 0.9853, micro_r: 0.9621, micro_f1: 0.9736
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: -0.1911, span_acc: 0.9929, attr_start_acc: 0.9749, attr_end_acc: 0.9828, span_micro_p: 0.9787, span_micro_r: 0.9745, span_micro_f1: 0.9766, micro_p: 0.9849, micro_r: 0.9621, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: -0.1651, span_acc: 0.9930, attr_start_acc: 0.9746, attr_end_acc: 0.9828, span_micro_p: 0.9785, span_micro_r: 0.9744, span_micro_f1: 0.9765, micro_p: 0.9842, micro_r: 0.9617, micro_f1: 0.9728
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: -0.1716, span_acc: 0.9930, attr_start_acc: 0.9747, attr_end_acc: 0.9826, span_micro_p: 0.9786, span_micro_r: 0.9744, span_micro_f1: 0.9765, micro_p: 0.9840, micro_r: 0.9617, micro_f1: 0.9727
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: -0.2024, span_acc: 0.9933, attr_start_acc: 0.9755, attr_end_acc: 0.9832, span_micro_p: 0.9792, span_micro_r: 0.9755, span_micro_f1: 0.9774, micro_p: 0.9846, micro_r: 0.9630, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: -0.1821, span_acc: 0.9930, attr_start_acc: 0.9760, attr_end_acc: 0.9830, span_micro_p: 0.9792, span_micro_r: 0.9752, span_micro_f1: 0.9772, micro_p: 0.9850, micro_r: 0.9636, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: -0.1703, span_acc: 0.9928, attr_start_acc: 0.9761, attr_end_acc: 0.9831, span_micro_p: 0.9793, span_micro_r: 0.9750, span_micro_f1: 0.9771, micro_p: 0.9852, micro_r: 0.9639, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: -0.1786, span_acc: 0.9927, attr_start_acc: 0.9764, attr_end_acc: 0.9832, span_micro_p: 0.9782, span_micro_r: 0.9748, span_micro_f1: 0.9765, micro_p: 0.9850, micro_r: 0.9641, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: -0.1430, span_acc: 0.9921, attr_start_acc: 0.9765, attr_end_acc: 0.9832, span_micro_p: 0.9789, span_micro_r: 0.9748, span_micro_f1: 0.9768, micro_p: 0.9852, micro_r: 0.9643, micro_f1: 0.9746
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: -0.1059, span_acc: 0.9923, attr_start_acc: 0.9769, attr_end_acc: 0.9831, span_micro_p: 0.9790, span_micro_r: 0.9750, span_micro_f1: 0.9770, micro_p: 0.9853, micro_r: 0.9647, micro_f1: 0.9749
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: -0.0920, span_acc: 0.9922, attr_start_acc: 0.9771, attr_end_acc: 0.9834, span_micro_p: 0.9790, span_micro_r: 0.9749, span_micro_f1: 0.9769, micro_p: 0.9852, micro_r: 0.9651, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: -0.1066, span_acc: 0.9922, attr_start_acc: 0.9775, attr_end_acc: 0.9835, span_micro_p: 0.9787, span_micro_r: 0.9749, span_micro_f1: 0.9768, micro_p: 0.9851, micro_r: 0.9653, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: -0.0964, span_acc: 0.9923, attr_start_acc: 0.9777, attr_end_acc: 0.9835, span_micro_p: 0.9787, span_micro_r: 0.9751, span_micro_f1: 0.9769, micro_p: 0.9849, micro_r: 0.9655, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: -0.1121, span_acc: 0.9924, attr_start_acc: 0.9781, attr_end_acc: 0.9837, span_micro_p: 0.9789, span_micro_r: 0.9755, span_micro_f1: 0.9772, micro_p: 0.9851, micro_r: 0.9658, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: -0.1263, span_acc: 0.9923, attr_start_acc: 0.9779, attr_end_acc: 0.9838, span_micro_p: 0.9785, span_micro_r: 0.9756, span_micro_f1: 0.9771, micro_p: 0.9849, micro_r: 0.9655, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: -0.1345, span_acc: 0.9924, attr_start_acc: 0.9775, attr_end_acc: 0.9838, span_micro_p: 0.9784, span_micro_r: 0.9756, span_micro_f1: 0.9770, micro_p: 0.9844, micro_r: 0.9652, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: -0.1445, span_acc: 0.9926, attr_start_acc: 0.9778, attr_end_acc: 0.9843, span_micro_p: 0.9790, span_micro_r: 0.9764, span_micro_f1: 0.9777, micro_p: 0.9848, micro_r: 0.9659, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: -0.1627, span_acc: 0.9926, attr_start_acc: 0.9782, attr_end_acc: 0.9844, span_micro_p: 0.9789, span_micro_r: 0.9766, span_micro_f1: 0.9777, micro_p: 0.9846, micro_r: 0.9661, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.65 / 97.78 / 98.05), p: (96.22 / 96.54), r: (96.99 / 95.76), f1: (96.61 / 96.15)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.7115045778179787, 'span_acc': 0.9864992894362862, 'attr_start_acc': 0.9778225806451613, 'attr_end_acc': 0.980510752688172, 'span_micro_p': 0.9622266401590457, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.9660678642714571, 'micro_p': 0.9654002713704206, 'micro_r': 0.9576043068640646, 'micro_f1': 0.9614864864864865, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9457, 0.9367, 0.9412), 'TITLE': (0.9736, 0.9609, 0.9672), 'EDU': (0.9811, 0.9811, 0.9811), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9614864864864865 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.00999999999999 / 95.95 / 96.99), p: (96.03 / 96.78), r: (94.97 / 94.17), f1: (95.5 / 95.46)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.7921211659533423, 'span_acc': 0.9801210898082745, 'attr_start_acc': 0.9595092024539877, 'attr_end_acc': 0.9699386503067484, 'span_micro_p': 0.9602977667493796, 'span_micro_r': 0.9496932515337423, 'span_micro_f1': 0.9549660703269586, 'micro_p': 0.967843631778058, 'micro_r': 0.941717791411043, 'micro_f1': 0.9546019900497512, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.9394, 0.9394, 0.9394), 'ORG': (0.9644, 0.9313, 0.9476), 'TITLE': (0.9627, 0.9352, 0.9488), 'EDU': (0.9818, 0.9643, 0.973), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9546019900497512 / 0.959284392350401
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: 1.0935, span_acc: 0.9811, attr_start_acc: 0.9664, attr_end_acc: 0.9799, span_micro_p: 0.9600, span_micro_r: 0.9600, span_micro_f1: 0.9600, micro_p: 0.9658, micro_r: 0.9463, micro_f1: 0.9559
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: 1.1667, span_acc: 0.9849, attr_start_acc: 0.9706, attr_end_acc: 0.9804, span_micro_p: 0.9727, span_micro_r: 0.9689, span_micro_f1: 0.9708, micro_p: 0.9839, micro_r: 0.9569, micro_f1: 0.9702
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: 0.3942, span_acc: 0.9899, attr_start_acc: 0.9776, attr_end_acc: 0.9877, span_micro_p: 0.9799, span_micro_r: 0.9767, span_micro_f1: 0.9783, micro_p: 0.9874, micro_r: 0.9686, micro_f1: 0.9779
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.0569, span_acc: 0.9928, attr_start_acc: 0.9798, attr_end_acc: 0.9891, span_micro_p: 0.9837, span_micro_r: 0.9822, span_micro_f1: 0.9829, micro_p: 0.9865, micro_r: 0.9719, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.2008, span_acc: 0.9930, attr_start_acc: 0.9795, attr_end_acc: 0.9883, span_micro_p: 0.9860, span_micro_r: 0.9831, span_micro_f1: 0.9846, micro_p: 0.9857, micro_r: 0.9713, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.1906, span_acc: 0.9912, attr_start_acc: 0.9761, attr_end_acc: 0.9857, span_micro_p: 0.9803, span_micro_r: 0.9781, span_micro_f1: 0.9792, micro_p: 0.9822, micro_r: 0.9654, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.1065, span_acc: 0.9921, attr_start_acc: 0.9762, attr_end_acc: 0.9868, span_micro_p: 0.9805, span_micro_r: 0.9790, span_micro_f1: 0.9797, micro_p: 0.9819, micro_r: 0.9659, micro_f1: 0.9738
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.0244, span_acc: 0.9928, attr_start_acc: 0.9763, attr_end_acc: 0.9863, span_micro_p: 0.9818, span_micro_r: 0.9802, span_micro_f1: 0.9810, micro_p: 0.9830, micro_r: 0.9656, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: -0.0467, span_acc: 0.9931, attr_start_acc: 0.9766, attr_end_acc: 0.9870, span_micro_p: 0.9819, span_micro_r: 0.9799, span_micro_f1: 0.9809, micro_p: 0.9826, micro_r: 0.9662, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: -0.1316, span_acc: 0.9932, attr_start_acc: 0.9781, attr_end_acc: 0.9877, span_micro_p: 0.9803, span_micro_r: 0.9801, span_micro_f1: 0.9802, micro_p: 0.9840, micro_r: 0.9681, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: -0.1392, span_acc: 0.9936, attr_start_acc: 0.9791, attr_end_acc: 0.9884, span_micro_p: 0.9814, span_micro_r: 0.9811, span_micro_f1: 0.9813, micro_p: 0.9849, micro_r: 0.9696, micro_f1: 0.9772
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: -0.1131, span_acc: 0.9935, attr_start_acc: 0.9791, attr_end_acc: 0.9881, span_micro_p: 0.9813, span_micro_r: 0.9811, span_micro_f1: 0.9812, micro_p: 0.9847, micro_r: 0.9701, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: -0.1321, span_acc: 0.9938, attr_start_acc: 0.9799, attr_end_acc: 0.9883, span_micro_p: 0.9818, span_micro_r: 0.9814, span_micro_f1: 0.9816, micro_p: 0.9854, micro_r: 0.9709, micro_f1: 0.9781
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: -0.1801, span_acc: 0.9938, attr_start_acc: 0.9797, attr_end_acc: 0.9875, span_micro_p: 0.9819, span_micro_r: 0.9807, span_micro_f1: 0.9813, micro_p: 0.9855, micro_r: 0.9700, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: -0.1471, span_acc: 0.9940, attr_start_acc: 0.9799, attr_end_acc: 0.9871, span_micro_p: 0.9825, span_micro_r: 0.9807, span_micro_f1: 0.9816, micro_p: 0.9859, micro_r: 0.9696, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: -0.1197, span_acc: 0.9941, attr_start_acc: 0.9802, attr_end_acc: 0.9869, span_micro_p: 0.9827, span_micro_r: 0.9808, span_micro_f1: 0.9818, micro_p: 0.9862, micro_r: 0.9694, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: -0.1081, span_acc: 0.9940, attr_start_acc: 0.9802, attr_end_acc: 0.9862, span_micro_p: 0.9824, span_micro_r: 0.9801, span_micro_f1: 0.9812, micro_p: 0.9865, micro_r: 0.9686, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.0067, span_acc: 0.9937, attr_start_acc: 0.9798, attr_end_acc: 0.9864, span_micro_p: 0.9809, span_micro_r: 0.9794, span_micro_f1: 0.9802, micro_p: 0.9860, micro_r: 0.9684, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: -0.0246, span_acc: 0.9937, attr_start_acc: 0.9800, attr_end_acc: 0.9864, span_micro_p: 0.9811, span_micro_r: 0.9796, span_micro_f1: 0.9804, micro_p: 0.9860, micro_r: 0.9684, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: -0.0732, span_acc: 0.9939, attr_start_acc: 0.9804, attr_end_acc: 0.9861, span_micro_p: 0.9817, span_micro_r: 0.9803, span_micro_f1: 0.9810, micro_p: 0.9864, micro_r: 0.9686, micro_f1: 0.9774
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: -0.0801, span_acc: 0.9941, attr_start_acc: 0.9809, attr_end_acc: 0.9859, span_micro_p: 0.9822, span_micro_r: 0.9810, span_micro_f1: 0.9816, micro_p: 0.9867, micro_r: 0.9689, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: -0.0892, span_acc: 0.9943, attr_start_acc: 0.9813, attr_end_acc: 0.9860, span_micro_p: 0.9824, span_micro_r: 0.9811, span_micro_f1: 0.9818, micro_p: 0.9871, micro_r: 0.9695, micro_f1: 0.9782
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: -0.0744, span_acc: 0.9944, attr_start_acc: 0.9813, attr_end_acc: 0.9861, span_micro_p: 0.9828, span_micro_r: 0.9814, span_micro_f1: 0.9821, micro_p: 0.9875, micro_r: 0.9697, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: -0.0491, span_acc: 0.9945, attr_start_acc: 0.9813, attr_end_acc: 0.9860, span_micro_p: 0.9830, span_micro_r: 0.9817, span_micro_f1: 0.9824, micro_p: 0.9874, micro_r: 0.9698, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: -0.0336, span_acc: 0.9946, attr_start_acc: 0.9815, attr_end_acc: 0.9859, span_micro_p: 0.9836, span_micro_r: 0.9823, span_micro_f1: 0.9830, micro_p: 0.9877, micro_r: 0.9701, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: -0.0551, span_acc: 0.9946, attr_start_acc: 0.9820, attr_end_acc: 0.9859, span_micro_p: 0.9839, span_micro_r: 0.9825, span_micro_f1: 0.9832, micro_p: 0.9877, micro_r: 0.9704, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: -0.0676, span_acc: 0.9947, attr_start_acc: 0.9817, attr_end_acc: 0.9859, span_micro_p: 0.9839, span_micro_r: 0.9825, span_micro_f1: 0.9832, micro_p: 0.9876, micro_r: 0.9703, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.0183, span_acc: 0.9946, attr_start_acc: 0.9815, attr_end_acc: 0.9858, span_micro_p: 0.9833, span_micro_r: 0.9823, span_micro_f1: 0.9828, micro_p: 0.9870, micro_r: 0.9699, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: -0.0020, span_acc: 0.9946, attr_start_acc: 0.9816, attr_end_acc: 0.9861, span_micro_p: 0.9835, span_micro_r: 0.9824, span_micro_f1: 0.9829, micro_p: 0.9870, micro_r: 0.9701, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.0016, span_acc: 0.9945, attr_start_acc: 0.9813, attr_end_acc: 0.9858, span_micro_p: 0.9830, span_micro_r: 0.9819, span_micro_f1: 0.9825, micro_p: 0.9866, micro_r: 0.9695, micro_f1: 0.9779
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: -0.0072, span_acc: 0.9945, attr_start_acc: 0.9814, attr_end_acc: 0.9858, span_micro_p: 0.9831, span_micro_r: 0.9822, span_micro_f1: 0.9827, micro_p: 0.9865, micro_r: 0.9697, micro_f1: 0.9780
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: -0.0118, span_acc: 0.9945, attr_start_acc: 0.9814, attr_end_acc: 0.9859, span_micro_p: 0.9832, span_micro_r: 0.9822, span_micro_f1: 0.9827, micro_p: 0.9867, micro_r: 0.9700, micro_f1: 0.9782
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.27 / 97.58 / 98.11999999999999), p: (95.06 / 95.81), r: (96.39 / 95.49), f1: (95.72 / 95.65)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.796505816554405, 'span_acc': 0.9827096162955945, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9811827956989247, 'span_micro_p': 0.950592885375494, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.9572139303482587, 'micro_p': 0.9581363943281567, 'micro_r': 0.9549125168236877, 'micro_f1': 0.9565217391304348, 'category-p/r/f1': {'PRO': (0.7727, 0.9444, 0.85), 'ORG': (0.9403, 0.9367, 0.9385), 'TITLE': (0.9677, 0.9565, 0.9621), 'EDU': (0.9626, 0.9717, 0.9671), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9565217391304348 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.61999999999999 / 96.63000000000001 / 97.55), p: (94.64 / 96.2), r: (95.28 / 94.85), f1: (94.96 / 95.52000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.992755672841702, 'span_acc': 0.9761856710393542, 'attr_start_acc': 0.9662576687116564, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.9463741620962828, 'span_micro_r': 0.9527607361963191, 'span_micro_f1': 0.9495567104860899, 'micro_p': 0.9620410703173615, 'micro_r': 0.9484662576687116, 'micro_f1': 0.955205437133148, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.8919, 1.0, 0.9429), 'TITLE': (0.9589, 0.9365, 0.9476), 'ORG': (0.9542, 0.9421, 0.9481), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.955205437133148 / 0.959284392350401
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.8564, span_acc: 1.0000, attr_start_acc: 0.9947, attr_end_acc: 0.9947, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9947, micro_f1: 0.9973
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -0.3709, span_acc: 0.9937, attr_start_acc: 0.9886, attr_end_acc: 0.9837, span_micro_p: 0.9935, span_micro_r: 0.9887, span_micro_f1: 0.9911, micro_p: 0.9983, micro_r: 0.9789, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -0.0115, span_acc: 0.9938, attr_start_acc: 0.9855, attr_end_acc: 0.9864, span_micro_p: 0.9918, span_micro_r: 0.9874, span_micro_f1: 0.9896, micro_p: 0.9972, micro_r: 0.9764, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: 0.0061, span_acc: 0.9948, attr_start_acc: 0.9866, attr_end_acc: 0.9886, span_micro_p: 0.9933, span_micro_r: 0.9887, span_micro_f1: 0.9910, micro_p: 0.9966, micro_r: 0.9785, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: 0.1414, span_acc: 0.9951, attr_start_acc: 0.9849, attr_end_acc: 0.9865, span_micro_p: 0.9930, span_micro_r: 0.9893, span_micro_f1: 0.9911, micro_p: 0.9912, micro_r: 0.9757, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: 0.0081, span_acc: 0.9953, attr_start_acc: 0.9847, attr_end_acc: 0.9874, span_micro_p: 0.9915, span_micro_r: 0.9884, span_micro_f1: 0.9899, micro_p: 0.9895, micro_r: 0.9761, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.1363, span_acc: 0.9956, attr_start_acc: 0.9846, attr_end_acc: 0.9887, span_micro_p: 0.9909, span_micro_r: 0.9869, span_micro_f1: 0.9889, micro_p: 0.9903, micro_r: 0.9766, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.2616, span_acc: 0.9956, attr_start_acc: 0.9830, attr_end_acc: 0.9893, span_micro_p: 0.9899, span_micro_r: 0.9856, span_micro_f1: 0.9878, micro_p: 0.9901, micro_r: 0.9754, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.2662, span_acc: 0.9958, attr_start_acc: 0.9829, attr_end_acc: 0.9893, span_micro_p: 0.9893, span_micro_r: 0.9866, span_micro_f1: 0.9879, micro_p: 0.9902, micro_r: 0.9755, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.2331, span_acc: 0.9959, attr_start_acc: 0.9838, attr_end_acc: 0.9896, span_micro_p: 0.9887, span_micro_r: 0.9870, span_micro_f1: 0.9879, micro_p: 0.9895, micro_r: 0.9759, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: -0.1806, span_acc: 0.9959, attr_start_acc: 0.9842, attr_end_acc: 0.9899, span_micro_p: 0.9888, span_micro_r: 0.9873, span_micro_f1: 0.9881, micro_p: 0.9897, micro_r: 0.9762, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: -0.2040, span_acc: 0.9958, attr_start_acc: 0.9837, attr_end_acc: 0.9897, span_micro_p: 0.9888, span_micro_r: 0.9868, span_micro_f1: 0.9878, micro_p: 0.9896, micro_r: 0.9760, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: -0.2100, span_acc: 0.9956, attr_start_acc: 0.9840, attr_end_acc: 0.9896, span_micro_p: 0.9883, span_micro_r: 0.9865, span_micro_f1: 0.9874, micro_p: 0.9892, micro_r: 0.9761, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: -0.1512, span_acc: 0.9957, attr_start_acc: 0.9844, attr_end_acc: 0.9897, span_micro_p: 0.9882, span_micro_r: 0.9864, span_micro_f1: 0.9873, micro_p: 0.9894, micro_r: 0.9764, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: -0.1698, span_acc: 0.9954, attr_start_acc: 0.9844, attr_end_acc: 0.9896, span_micro_p: 0.9872, span_micro_r: 0.9859, span_micro_f1: 0.9865, micro_p: 0.9888, micro_r: 0.9760, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: -0.0584, span_acc: 0.9951, attr_start_acc: 0.9847, attr_end_acc: 0.9898, span_micro_p: 0.9872, span_micro_r: 0.9859, span_micro_f1: 0.9865, micro_p: 0.9888, micro_r: 0.9764, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: -0.0462, span_acc: 0.9954, attr_start_acc: 0.9847, attr_end_acc: 0.9896, span_micro_p: 0.9879, span_micro_r: 0.9865, span_micro_f1: 0.9872, micro_p: 0.9890, micro_r: 0.9766, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.1337, span_acc: 0.9953, attr_start_acc: 0.9849, attr_end_acc: 0.9896, span_micro_p: 0.9880, span_micro_r: 0.9867, span_micro_f1: 0.9874, micro_p: 0.9894, micro_r: 0.9769, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.0952, span_acc: 0.9954, attr_start_acc: 0.9847, attr_end_acc: 0.9900, span_micro_p: 0.9884, span_micro_r: 0.9871, span_micro_f1: 0.9878, micro_p: 0.9895, micro_r: 0.9772, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.1039, span_acc: 0.9954, attr_start_acc: 0.9848, attr_end_acc: 0.9901, span_micro_p: 0.9882, span_micro_r: 0.9871, span_micro_f1: 0.9877, micro_p: 0.9893, micro_r: 0.9776, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.0666, span_acc: 0.9956, attr_start_acc: 0.9850, attr_end_acc: 0.9903, span_micro_p: 0.9885, span_micro_r: 0.9875, span_micro_f1: 0.9880, micro_p: 0.9897, micro_r: 0.9781, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: 0.0923, span_acc: 0.9957, attr_start_acc: 0.9851, attr_end_acc: 0.9903, span_micro_p: 0.9888, span_micro_r: 0.9876, span_micro_f1: 0.9882, micro_p: 0.9899, micro_r: 0.9784, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: 0.1270, span_acc: 0.9958, attr_start_acc: 0.9857, attr_end_acc: 0.9907, span_micro_p: 0.9891, span_micro_r: 0.9880, span_micro_f1: 0.9886, micro_p: 0.9903, micro_r: 0.9792, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: 0.1534, span_acc: 0.9958, attr_start_acc: 0.9850, attr_end_acc: 0.9906, span_micro_p: 0.9886, span_micro_r: 0.9877, span_micro_f1: 0.9882, micro_p: 0.9900, micro_r: 0.9783, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: 0.1667, span_acc: 0.9957, attr_start_acc: 0.9842, attr_end_acc: 0.9907, span_micro_p: 0.9884, span_micro_r: 0.9871, span_micro_f1: 0.9877, micro_p: 0.9894, micro_r: 0.9771, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: 0.1269, span_acc: 0.9957, attr_start_acc: 0.9843, attr_end_acc: 0.9906, span_micro_p: 0.9884, span_micro_r: 0.9869, span_micro_f1: 0.9876, micro_p: 0.9894, micro_r: 0.9769, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: 0.1172, span_acc: 0.9958, attr_start_acc: 0.9844, attr_end_acc: 0.9908, span_micro_p: 0.9884, span_micro_r: 0.9870, span_micro_f1: 0.9877, micro_p: 0.9895, micro_r: 0.9771, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: 0.1012, span_acc: 0.9957, attr_start_acc: 0.9844, attr_end_acc: 0.9907, span_micro_p: 0.9881, span_micro_r: 0.9870, span_micro_f1: 0.9875, micro_p: 0.9896, micro_r: 0.9769, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: 0.0788, span_acc: 0.9958, attr_start_acc: 0.9843, attr_end_acc: 0.9906, span_micro_p: 0.9883, span_micro_r: 0.9870, span_micro_f1: 0.9877, micro_p: 0.9897, micro_r: 0.9769, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: 0.0867, span_acc: 0.9958, attr_start_acc: 0.9841, attr_end_acc: 0.9906, span_micro_p: 0.9880, span_micro_r: 0.9870, span_micro_f1: 0.9875, micro_p: 0.9895, micro_r: 0.9769, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: 0.0800, span_acc: 0.9959, attr_start_acc: 0.9841, attr_end_acc: 0.9906, span_micro_p: 0.9880, span_micro_r: 0.9870, span_micro_f1: 0.9875, micro_p: 0.9898, micro_r: 0.9768, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: 0.1470, span_acc: 0.9958, attr_start_acc: 0.9841, attr_end_acc: 0.9905, span_micro_p: 0.9882, span_micro_r: 0.9872, span_micro_f1: 0.9877, micro_p: 0.9898, micro_r: 0.9769, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.74000000000001 / 97.04 / 97.65), p: (95.67 / 96.72), r: (95.86 / 95.15), f1: (95.76 / 95.93)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 5.354167976209463, 'span_acc': 0.987446707721459, 'attr_start_acc': 0.9704301075268817, 'attr_end_acc': 0.9764784946236559, 'span_micro_p': 0.9566666666666667, 'span_micro_r': 0.9585838343353373, 'span_micro_f1': 0.9576242909576242, 'micro_p': 0.9671682626538988, 'micro_r': 0.9515477792732167, 'micro_f1': 0.9592944369063773, 'category-p/r/f1': {'PRO': (0.8571, 1.0, 0.9231), 'ORG': (0.9513, 0.9367, 0.9439), 'TITLE': (0.9719, 0.9507, 0.9612), 'CONT': (1.0, 0.9394, 0.9688), 'EDU': (1.0, 0.9717, 0.9856), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9592944369063773 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.58 / 96.87 / 97.55), p: (95.6 / 97.0), r: (95.89 / 95.28), f1: (95.74000000000001 / 96.13000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 2.824640137594451, 'span_acc': 0.9857719475277498, 'attr_start_acc': 0.9687116564417177, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.9559633027522936, 'span_micro_r': 0.9588957055214724, 'span_micro_f1': 0.957427258805513, 'micro_p': 0.9700187382885697, 'micro_r': 0.9527607361963191, 'micro_f1': 0.9613122872175797, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9596, 0.9439, 0.9517), 'TITLE': (0.9682, 0.9456, 0.9568), 'EDU': (0.9909, 0.9732, 0.982), 'PRO': (0.9706, 1.0, 0.9851), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9613122872175797 / 0.959284392350401
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: 0.2252, span_acc: 0.9961, attr_start_acc: 0.9766, attr_end_acc: 0.9688, span_micro_p: 0.9844, span_micro_r: 0.9767, span_micro_f1: 0.9805, micro_p: 0.9879, micro_r: 0.9570, micro_f1: 0.9722
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -0.5119, span_acc: 0.9970, attr_start_acc: 0.9823, attr_end_acc: 0.9838, span_micro_p: 0.9897, span_micro_r: 0.9883, span_micro_f1: 0.9890, micro_p: 0.9910, micro_r: 0.9720, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -0.8306, span_acc: 0.9981, attr_start_acc: 0.9844, attr_end_acc: 0.9870, span_micro_p: 0.9940, span_micro_r: 0.9931, span_micro_f1: 0.9935, micro_p: 0.9929, micro_r: 0.9766, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.6761, span_acc: 0.9980, attr_start_acc: 0.9871, attr_end_acc: 0.9877, span_micro_p: 0.9955, span_micro_r: 0.9936, span_micro_f1: 0.9945, micro_p: 0.9948, micro_r: 0.9794, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.7861, span_acc: 0.9980, attr_start_acc: 0.9886, attr_end_acc: 0.9891, span_micro_p: 0.9936, span_micro_r: 0.9936, span_micro_f1: 0.9936, micro_p: 0.9945, micro_r: 0.9807, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -0.3545, span_acc: 0.9976, attr_start_acc: 0.9898, attr_end_acc: 0.9910, span_micro_p: 0.9935, span_micro_r: 0.9935, span_micro_f1: 0.9935, micro_p: 0.9950, micro_r: 0.9828, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: -0.2145, span_acc: 0.9976, attr_start_acc: 0.9903, attr_end_acc: 0.9910, span_micro_p: 0.9935, span_micro_r: 0.9931, span_micro_f1: 0.9933, micro_p: 0.9951, micro_r: 0.9834, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: -0.2302, span_acc: 0.9975, attr_start_acc: 0.9894, attr_end_acc: 0.9913, span_micro_p: 0.9919, span_micro_r: 0.9928, span_micro_f1: 0.9924, micro_p: 0.9930, micro_r: 0.9828, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: 0.2662, span_acc: 0.9975, attr_start_acc: 0.9895, attr_end_acc: 0.9916, span_micro_p: 0.9917, span_micro_r: 0.9928, span_micro_f1: 0.9922, micro_p: 0.9924, micro_r: 0.9833, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: 0.4738, span_acc: 0.9976, attr_start_acc: 0.9892, attr_end_acc: 0.9912, span_micro_p: 0.9920, span_micro_r: 0.9932, span_micro_f1: 0.9926, micro_p: 0.9928, micro_r: 0.9828, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: 0.9340, span_acc: 0.9976, attr_start_acc: 0.9888, attr_end_acc: 0.9913, span_micro_p: 0.9922, span_micro_r: 0.9927, span_micro_f1: 0.9925, micro_p: 0.9930, micro_r: 0.9826, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: 1.2128, span_acc: 0.9973, attr_start_acc: 0.9877, attr_end_acc: 0.9906, span_micro_p: 0.9916, span_micro_r: 0.9914, span_micro_f1: 0.9915, micro_p: 0.9921, micro_r: 0.9811, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: 1.3095, span_acc: 0.9972, attr_start_acc: 0.9876, attr_end_acc: 0.9903, span_micro_p: 0.9915, span_micro_r: 0.9909, span_micro_f1: 0.9912, micro_p: 0.9919, micro_r: 0.9810, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: 1.6946, span_acc: 0.9972, attr_start_acc: 0.9881, attr_end_acc: 0.9884, span_micro_p: 0.9917, span_micro_r: 0.9905, span_micro_f1: 0.9911, micro_p: 0.9917, micro_r: 0.9795, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: 2.4119, span_acc: 0.9971, attr_start_acc: 0.9878, attr_end_acc: 0.9876, span_micro_p: 0.9920, span_micro_r: 0.9895, span_micro_f1: 0.9907, micro_p: 0.9918, micro_r: 0.9784, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: 2.2862, span_acc: 0.9968, attr_start_acc: 0.9867, attr_end_acc: 0.9862, span_micro_p: 0.9912, span_micro_r: 0.9883, span_micro_f1: 0.9898, micro_p: 0.9915, micro_r: 0.9760, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: 2.3427, span_acc: 0.9966, attr_start_acc: 0.9858, attr_end_acc: 0.9858, span_micro_p: 0.9901, span_micro_r: 0.9878, span_micro_f1: 0.9889, micro_p: 0.9904, micro_r: 0.9749, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: 2.2078, span_acc: 0.9968, attr_start_acc: 0.9859, attr_end_acc: 0.9857, span_micro_p: 0.9907, span_micro_r: 0.9885, span_micro_f1: 0.9896, micro_p: 0.9903, micro_r: 0.9751, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: 2.1774, span_acc: 0.9969, attr_start_acc: 0.9864, attr_end_acc: 0.9860, span_micro_p: 0.9907, span_micro_r: 0.9889, span_micro_f1: 0.9898, micro_p: 0.9905, micro_r: 0.9757, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 2.1497, span_acc: 0.9969, attr_start_acc: 0.9867, attr_end_acc: 0.9859, span_micro_p: 0.9909, span_micro_r: 0.9891, span_micro_f1: 0.9900, micro_p: 0.9907, micro_r: 0.9760, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 2.0443, span_acc: 0.9969, attr_start_acc: 0.9868, attr_end_acc: 0.9860, span_micro_p: 0.9911, span_micro_r: 0.9893, span_micro_f1: 0.9902, micro_p: 0.9909, micro_r: 0.9758, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 2.0282, span_acc: 0.9971, attr_start_acc: 0.9862, attr_end_acc: 0.9859, span_micro_p: 0.9915, span_micro_r: 0.9897, span_micro_f1: 0.9906, micro_p: 0.9911, micro_r: 0.9751, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 1.9040, span_acc: 0.9971, attr_start_acc: 0.9862, attr_end_acc: 0.9857, span_micro_p: 0.9917, span_micro_r: 0.9899, span_micro_f1: 0.9908, micro_p: 0.9910, micro_r: 0.9750, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 1.8854, span_acc: 0.9971, attr_start_acc: 0.9860, attr_end_acc: 0.9852, span_micro_p: 0.9916, span_micro_r: 0.9898, span_micro_f1: 0.9907, micro_p: 0.9907, micro_r: 0.9743, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 1.8183, span_acc: 0.9972, attr_start_acc: 0.9856, attr_end_acc: 0.9849, span_micro_p: 0.9919, span_micro_r: 0.9898, span_micro_f1: 0.9909, micro_p: 0.9908, micro_r: 0.9738, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: 1.7512, span_acc: 0.9972, attr_start_acc: 0.9855, attr_end_acc: 0.9845, span_micro_p: 0.9919, span_micro_r: 0.9900, span_micro_f1: 0.9909, micro_p: 0.9908, micro_r: 0.9735, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 1.6989, span_acc: 0.9972, attr_start_acc: 0.9853, attr_end_acc: 0.9844, span_micro_p: 0.9917, span_micro_r: 0.9899, span_micro_f1: 0.9908, micro_p: 0.9903, micro_r: 0.9732, micro_f1: 0.9816
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 1.6503, span_acc: 0.9972, attr_start_acc: 0.9858, attr_end_acc: 0.9843, span_micro_p: 0.9916, span_micro_r: 0.9901, span_micro_f1: 0.9908, micro_p: 0.9905, micro_r: 0.9733, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: 1.5693, span_acc: 0.9973, attr_start_acc: 0.9863, attr_end_acc: 0.9848, span_micro_p: 0.9916, span_micro_r: 0.9902, span_micro_f1: 0.9909, micro_p: 0.9907, micro_r: 0.9741, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: 1.5188, span_acc: 0.9973, attr_start_acc: 0.9862, attr_end_acc: 0.9848, span_micro_p: 0.9917, span_micro_r: 0.9903, span_micro_f1: 0.9910, micro_p: 0.9910, micro_r: 0.9739, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 1.4889, span_acc: 0.9972, attr_start_acc: 0.9859, attr_end_acc: 0.9847, span_micro_p: 0.9913, span_micro_r: 0.9897, span_micro_f1: 0.9905, micro_p: 0.9909, micro_r: 0.9736, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 1.4751, span_acc: 0.9971, attr_start_acc: 0.9860, attr_end_acc: 0.9848, span_micro_p: 0.9911, span_micro_r: 0.9896, span_micro_f1: 0.9903, micro_p: 0.9909, micro_r: 0.9737, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.5 / 97.18 / 97.50999999999999), p: (95.94 / 96.84), r: (96.19 / 95.02000000000001), f1: (96.06 / 95.92)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 4.591372417129142, 'span_acc': 0.9849597347228801, 'attr_start_acc': 0.9717741935483871, 'attr_end_acc': 0.9751344086021505, 'span_micro_p': 0.9593604263824117, 'span_micro_r': 0.9619238476953907, 'span_micro_f1': 0.9606404269513008, 'micro_p': 0.9684499314128944, 'micro_r': 0.9502018842530283, 'micro_f1': 0.9592391304347826, 'category-p/r/f1': {'LOC': (1.0, 0.5, 0.6667), 'PRO': (0.9286, 0.7222, 0.8125), 'ORG': (0.9497, 0.9424, 0.946), 'TITLE': (0.9733, 0.9493, 0.9612), 'EDU': (0.9904, 0.9717, 0.981), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9592391304347826 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.00999999999999 / 96.2 / 96.63000000000001), p: (95.23 / 96.28), r: (95.46 / 93.8), f1: (95.34 / 95.03)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 2.739866958286777, 'span_acc': 0.9801210898082745, 'attr_start_acc': 0.9619631901840491, 'attr_end_acc': 0.9662576687116564, 'span_micro_p': 0.9522643818849449, 'span_micro_r': 0.9546012269938651, 'span_micro_f1': 0.9534313725490197, 'micro_p': 0.9628463476070529, 'micro_r': 0.938036809815951, 'micro_f1': 0.9502796768178993, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.963, 0.7879, 0.8667), 'ORG': (0.9386, 0.9403, 0.9394), 'TITLE': (0.9691, 0.9352, 0.9518), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 0.9911, 0.9955), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9502796768178993 / 0.9613122872175797
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -1.1407, span_acc: 1.0000, attr_start_acc: 1.0000, attr_end_acc: 0.9892, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9892, micro_f1: 0.9946
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: -0.5672, span_acc: 0.9988, attr_start_acc: 0.9928, attr_end_acc: 0.9857, span_micro_p: 0.9972, span_micro_r: 0.9957, span_micro_f1: 0.9964, micro_p: 0.9956, micro_r: 0.9814, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: -0.6438, span_acc: 0.9982, attr_start_acc: 0.9939, attr_end_acc: 0.9808, span_micro_p: 0.9939, span_micro_r: 0.9931, span_micro_f1: 0.9935, micro_p: 0.9938, micro_r: 0.9747, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: -0.4619, span_acc: 0.9984, attr_start_acc: 0.9897, attr_end_acc: 0.9833, span_micro_p: 0.9949, span_micro_r: 0.9930, span_micro_f1: 0.9939, micro_p: 0.9941, micro_r: 0.9742, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: -0.1676, span_acc: 0.9987, attr_start_acc: 0.9901, attr_end_acc: 0.9839, span_micro_p: 0.9959, span_micro_r: 0.9943, span_micro_f1: 0.9951, micro_p: 0.9942, micro_r: 0.9761, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: -0.2760, span_acc: 0.9987, attr_start_acc: 0.9868, attr_end_acc: 0.9830, span_micro_p: 0.9954, span_micro_r: 0.9945, span_micro_f1: 0.9949, micro_p: 0.9930, micro_r: 0.9732, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: 0.4213, span_acc: 0.9986, attr_start_acc: 0.9873, attr_end_acc: 0.9836, span_micro_p: 0.9946, span_micro_r: 0.9939, span_micro_f1: 0.9942, micro_p: 0.9922, micro_r: 0.9734, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 0.9712, span_acc: 0.9977, attr_start_acc: 0.9860, attr_end_acc: 0.9835, span_micro_p: 0.9921, span_micro_r: 0.9918, span_micro_f1: 0.9920, micro_p: 0.9906, micro_r: 0.9730, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 0.7764, span_acc: 0.9979, attr_start_acc: 0.9852, attr_end_acc: 0.9832, span_micro_p: 0.9927, span_micro_r: 0.9924, span_micro_f1: 0.9925, micro_p: 0.9904, micro_r: 0.9726, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 0.7444, span_acc: 0.9978, attr_start_acc: 0.9858, attr_end_acc: 0.9832, span_micro_p: 0.9922, span_micro_r: 0.9924, span_micro_f1: 0.9923, micro_p: 0.9902, micro_r: 0.9730, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 0.8586, span_acc: 0.9980, attr_start_acc: 0.9858, attr_end_acc: 0.9826, span_micro_p: 0.9927, span_micro_r: 0.9927, span_micro_f1: 0.9927, micro_p: 0.9907, micro_r: 0.9725, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 0.7158, span_acc: 0.9981, attr_start_acc: 0.9861, attr_end_acc: 0.9825, span_micro_p: 0.9931, span_micro_r: 0.9933, span_micro_f1: 0.9932, micro_p: 0.9914, micro_r: 0.9726, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 0.5473, span_acc: 0.9982, attr_start_acc: 0.9855, attr_end_acc: 0.9824, span_micro_p: 0.9934, span_micro_r: 0.9934, span_micro_f1: 0.9934, micro_p: 0.9914, micro_r: 0.9722, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 1.1591, span_acc: 0.9980, attr_start_acc: 0.9859, attr_end_acc: 0.9823, span_micro_p: 0.9936, span_micro_r: 0.9934, span_micro_f1: 0.9935, micro_p: 0.9917, micro_r: 0.9724, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 1.1037, span_acc: 0.9976, attr_start_acc: 0.9856, attr_end_acc: 0.9821, span_micro_p: 0.9922, span_micro_r: 0.9914, span_micro_f1: 0.9918, micro_p: 0.9913, micro_r: 0.9717, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 1.3130, span_acc: 0.9974, attr_start_acc: 0.9856, attr_end_acc: 0.9816, span_micro_p: 0.9909, span_micro_r: 0.9910, span_micro_f1: 0.9909, micro_p: 0.9909, micro_r: 0.9712, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 1.2007, span_acc: 0.9975, attr_start_acc: 0.9860, attr_end_acc: 0.9814, span_micro_p: 0.9911, span_micro_r: 0.9912, span_micro_f1: 0.9912, micro_p: 0.9913, micro_r: 0.9712, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 1.1600, span_acc: 0.9975, attr_start_acc: 0.9856, attr_end_acc: 0.9815, span_micro_p: 0.9914, span_micro_r: 0.9911, span_micro_f1: 0.9912, micro_p: 0.9913, micro_r: 0.9716, micro_f1: 0.9813
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 1.1401, span_acc: 0.9976, attr_start_acc: 0.9857, attr_end_acc: 0.9822, span_micro_p: 0.9914, span_micro_r: 0.9914, span_micro_f1: 0.9914, micro_p: 0.9912, micro_r: 0.9720, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 1.1133, span_acc: 0.9977, attr_start_acc: 0.9861, attr_end_acc: 0.9827, span_micro_p: 0.9918, span_micro_r: 0.9918, span_micro_f1: 0.9918, micro_p: 0.9917, micro_r: 0.9728, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 1.0090, span_acc: 0.9978, attr_start_acc: 0.9863, attr_end_acc: 0.9831, span_micro_p: 0.9921, span_micro_r: 0.9921, span_micro_f1: 0.9921, micro_p: 0.9920, micro_r: 0.9735, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 1.0007, span_acc: 0.9977, attr_start_acc: 0.9861, attr_end_acc: 0.9831, span_micro_p: 0.9918, span_micro_r: 0.9919, span_micro_f1: 0.9918, micro_p: 0.9915, micro_r: 0.9731, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 0.9702, span_acc: 0.9978, attr_start_acc: 0.9857, attr_end_acc: 0.9833, span_micro_p: 0.9920, span_micro_r: 0.9920, span_micro_f1: 0.9920, micro_p: 0.9917, micro_r: 0.9731, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 0.9316, span_acc: 0.9979, attr_start_acc: 0.9858, attr_end_acc: 0.9838, span_micro_p: 0.9922, span_micro_r: 0.9923, span_micro_f1: 0.9923, micro_p: 0.9920, micro_r: 0.9734, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 0.9845, span_acc: 0.9979, attr_start_acc: 0.9858, attr_end_acc: 0.9839, span_micro_p: 0.9925, span_micro_r: 0.9925, span_micro_f1: 0.9925, micro_p: 0.9921, micro_r: 0.9737, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 0.9354, span_acc: 0.9980, attr_start_acc: 0.9860, attr_end_acc: 0.9841, span_micro_p: 0.9925, span_micro_r: 0.9926, span_micro_f1: 0.9925, micro_p: 0.9923, micro_r: 0.9741, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 0.9656, span_acc: 0.9979, attr_start_acc: 0.9858, attr_end_acc: 0.9843, span_micro_p: 0.9924, span_micro_r: 0.9923, span_micro_f1: 0.9923, micro_p: 0.9922, micro_r: 0.9735, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 0.9354, span_acc: 0.9978, attr_start_acc: 0.9855, attr_end_acc: 0.9838, span_micro_p: 0.9921, span_micro_r: 0.9919, span_micro_f1: 0.9920, micro_p: 0.9920, micro_r: 0.9730, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 0.9696, span_acc: 0.9978, attr_start_acc: 0.9857, attr_end_acc: 0.9834, span_micro_p: 0.9920, span_micro_r: 0.9920, span_micro_f1: 0.9920, micro_p: 0.9917, micro_r: 0.9725, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 0.9551, span_acc: 0.9978, attr_start_acc: 0.9857, attr_end_acc: 0.9835, span_micro_p: 0.9919, span_micro_r: 0.9918, span_micro_f1: 0.9918, micro_p: 0.9917, micro_r: 0.9725, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 0.9143, span_acc: 0.9978, attr_start_acc: 0.9858, attr_end_acc: 0.9839, span_micro_p: 0.9918, span_micro_r: 0.9916, span_micro_f1: 0.9917, micro_p: 0.9916, micro_r: 0.9729, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 0.8857, span_acc: 0.9978, attr_start_acc: 0.9857, attr_end_acc: 0.9841, span_micro_p: 0.9920, span_micro_r: 0.9918, span_micro_f1: 0.9919, micro_p: 0.9918, micro_r: 0.9729, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 97.72 / 97.65), p: (95.19999999999999 / 96.39999999999999), r: (96.73 / 95.49), f1: (95.96000000000001 / 95.94)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 10.884631215624882, 'span_acc': 0.9851965892941734, 'attr_start_acc': 0.9771505376344086, 'attr_end_acc': 0.9764784946236559, 'span_micro_p': 0.9520052596975674, 'span_micro_r': 0.9672678690714763, 'span_micro_f1': 0.9595758780649437, 'micro_p': 0.9639945652173914, 'micro_r': 0.9549125168236877, 'micro_f1': 0.9594320486815415, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'CONT': (1.0, 0.8788, 0.9355), 'ORG': (0.9459, 0.9405, 0.9432), 'TITLE': (0.9706, 0.958, 0.9643), 'EDU': (0.9811, 0.9811, 0.9811), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9594320486815415 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.31 / 96.99 / 97.3), p: (94.91000000000001 / 96.22), r: (96.00999999999999 / 95.15), f1: (95.46 / 95.67999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 5.3106595525201765, 'span_acc': 0.9831483350151362, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9730061349693252, 'span_micro_p': 0.9490600363856883, 'span_micro_r': 0.9601226993865031, 'span_micro_f1': 0.9545593168648978, 'micro_p': 0.9621588089330024, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9568167797655767, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.951, 0.9476, 0.9493), 'TITLE': (0.9604, 0.943, 0.9516), 'PRO': (0.9412, 0.9697, 0.9552), 'CONT': (1.0, 0.9286, 0.963), 'EDU': (0.9821, 0.9821, 0.9821), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9568167797655767 / 0.9613122872175797
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: -0.1257, span_acc: 0.9986, attr_start_acc: 1.0000, attr_end_acc: 0.9939, span_micro_p: 0.9939, span_micro_r: 0.9939, span_micro_f1: 0.9939, micro_p: 0.9969, micro_r: 0.9908, micro_f1: 0.9939
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: 0.2539, span_acc: 0.9991, attr_start_acc: 0.9944, attr_end_acc: 0.9930, span_micro_p: 0.9959, span_micro_r: 0.9959, span_micro_f1: 0.9959, micro_p: 0.9958, micro_r: 0.9889, micro_f1: 0.9923
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 0.2709, span_acc: 0.9991, attr_start_acc: 0.9947, attr_end_acc: 0.9929, span_micro_p: 0.9965, span_micro_r: 0.9965, span_micro_f1: 0.9965, micro_p: 0.9955, micro_r: 0.9893, micro_f1: 0.9924
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: -0.1242, span_acc: 0.9993, attr_start_acc: 0.9930, attr_end_acc: 0.9899, span_micro_p: 0.9975, span_micro_r: 0.9969, span_micro_f1: 0.9972, micro_p: 0.9955, micro_r: 0.9855, micro_f1: 0.9905
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 0.3239, span_acc: 0.9987, attr_start_acc: 0.9929, attr_end_acc: 0.9899, span_micro_p: 0.9970, span_micro_r: 0.9965, span_micro_f1: 0.9967, micro_p: 0.9954, micro_r: 0.9854, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 0.4962, span_acc: 0.9985, attr_start_acc: 0.9908, attr_end_acc: 0.9887, span_micro_p: 0.9963, span_micro_r: 0.9950, span_micro_f1: 0.9956, micro_p: 0.9941, micro_r: 0.9832, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 0.3394, span_acc: 0.9981, attr_start_acc: 0.9887, attr_end_acc: 0.9873, span_micro_p: 0.9951, span_micro_r: 0.9933, span_micro_f1: 0.9942, micro_p: 0.9932, micro_r: 0.9802, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 0.3583, span_acc: 0.9980, attr_start_acc: 0.9893, attr_end_acc: 0.9878, span_micro_p: 0.9954, span_micro_r: 0.9936, span_micro_f1: 0.9945, micro_p: 0.9941, micro_r: 0.9810, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 0.3058, span_acc: 0.9981, attr_start_acc: 0.9893, attr_end_acc: 0.9861, span_micro_p: 0.9952, span_micro_r: 0.9936, span_micro_f1: 0.9944, micro_p: 0.9932, micro_r: 0.9794, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 0.1641, span_acc: 0.9981, attr_start_acc: 0.9899, attr_end_acc: 0.9866, span_micro_p: 0.9950, span_micro_r: 0.9936, span_micro_f1: 0.9943, micro_p: 0.9937, micro_r: 0.9803, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 0.2035, span_acc: 0.9983, attr_start_acc: 0.9899, attr_end_acc: 0.9862, span_micro_p: 0.9954, span_micro_r: 0.9939, span_micro_f1: 0.9947, micro_p: 0.9942, micro_r: 0.9803, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 1.0548, span_acc: 0.9981, attr_start_acc: 0.9896, attr_end_acc: 0.9856, span_micro_p: 0.9952, span_micro_r: 0.9937, span_micro_f1: 0.9944, micro_p: 0.9939, micro_r: 0.9796, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 1.2196, span_acc: 0.9982, attr_start_acc: 0.9899, attr_end_acc: 0.9854, span_micro_p: 0.9955, span_micro_r: 0.9939, span_micro_f1: 0.9947, micro_p: 0.9941, micro_r: 0.9798, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 1.7523, span_acc: 0.9983, attr_start_acc: 0.9903, attr_end_acc: 0.9853, span_micro_p: 0.9957, span_micro_r: 0.9940, span_micro_f1: 0.9949, micro_p: 0.9944, micro_r: 0.9800, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 2.0726, span_acc: 0.9983, attr_start_acc: 0.9902, attr_end_acc: 0.9852, span_micro_p: 0.9953, span_micro_r: 0.9941, span_micro_f1: 0.9947, micro_p: 0.9944, micro_r: 0.9797, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 2.0717, span_acc: 0.9982, attr_start_acc: 0.9905, attr_end_acc: 0.9850, span_micro_p: 0.9948, span_micro_r: 0.9939, span_micro_f1: 0.9943, micro_p: 0.9944, micro_r: 0.9796, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 2.3507, span_acc: 0.9980, attr_start_acc: 0.9905, attr_end_acc: 0.9840, span_micro_p: 0.9947, span_micro_r: 0.9938, span_micro_f1: 0.9942, micro_p: 0.9947, micro_r: 0.9785, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 2.1416, span_acc: 0.9981, attr_start_acc: 0.9907, attr_end_acc: 0.9840, span_micro_p: 0.9947, span_micro_r: 0.9937, span_micro_f1: 0.9942, micro_p: 0.9950, micro_r: 0.9786, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 2.1925, span_acc: 0.9981, attr_start_acc: 0.9904, attr_end_acc: 0.9836, span_micro_p: 0.9947, span_micro_r: 0.9939, span_micro_f1: 0.9943, micro_p: 0.9950, micro_r: 0.9775, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 2.2881, span_acc: 0.9982, attr_start_acc: 0.9906, attr_end_acc: 0.9834, span_micro_p: 0.9950, span_micro_r: 0.9942, span_micro_f1: 0.9946, micro_p: 0.9951, micro_r: 0.9773, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 2.3455, span_acc: 0.9982, attr_start_acc: 0.9907, attr_end_acc: 0.9839, span_micro_p: 0.9949, span_micro_r: 0.9942, span_micro_f1: 0.9945, micro_p: 0.9951, micro_r: 0.9775, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 2.4321, span_acc: 0.9982, attr_start_acc: 0.9905, attr_end_acc: 0.9836, span_micro_p: 0.9948, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9950, micro_r: 0.9770, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 2.3778, span_acc: 0.9983, attr_start_acc: 0.9904, attr_end_acc: 0.9829, span_micro_p: 0.9949, span_micro_r: 0.9942, span_micro_f1: 0.9946, micro_p: 0.9950, micro_r: 0.9765, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 2.2596, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9829, span_micro_p: 0.9950, span_micro_r: 0.9943, span_micro_f1: 0.9946, micro_p: 0.9951, micro_r: 0.9766, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 2.1634, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9828, span_micro_p: 0.9950, span_micro_r: 0.9944, span_micro_f1: 0.9947, micro_p: 0.9951, micro_r: 0.9766, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 2.0925, span_acc: 0.9984, attr_start_acc: 0.9905, attr_end_acc: 0.9826, span_micro_p: 0.9951, span_micro_r: 0.9945, span_micro_f1: 0.9948, micro_p: 0.9950, micro_r: 0.9762, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 2.2912, span_acc: 0.9984, attr_start_acc: 0.9906, attr_end_acc: 0.9828, span_micro_p: 0.9952, span_micro_r: 0.9945, span_micro_f1: 0.9948, micro_p: 0.9949, micro_r: 0.9765, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 2.6253, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9830, span_micro_p: 0.9951, span_micro_r: 0.9942, span_micro_f1: 0.9947, micro_p: 0.9950, micro_r: 0.9767, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 2.6852, span_acc: 0.9983, attr_start_acc: 0.9904, attr_end_acc: 0.9832, span_micro_p: 0.9950, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9947, micro_r: 0.9767, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 2.8286, span_acc: 0.9983, attr_start_acc: 0.9903, attr_end_acc: 0.9834, span_micro_p: 0.9950, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9946, micro_r: 0.9768, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 2.7567, span_acc: 0.9984, attr_start_acc: 0.9901, attr_end_acc: 0.9835, span_micro_p: 0.9951, span_micro_r: 0.9942, span_micro_f1: 0.9946, micro_p: 0.9945, micro_r: 0.9769, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 2.8859, span_acc: 0.9982, attr_start_acc: 0.9900, attr_end_acc: 0.9831, span_micro_p: 0.9948, span_micro_r: 0.9940, span_micro_f1: 0.9944, micro_p: 0.9943, micro_r: 0.9764, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.18 / 96.71 / 96.91), p: (95.47 / 95.57), r: (95.72 / 94.28), f1: (95.6 / 94.92)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 28.29698198763392, 'span_acc': 0.9817621980104216, 'attr_start_acc': 0.9670698924731183, 'attr_end_acc': 0.9690860215053764, 'span_micro_p': 0.9546968687541639, 'span_micro_r': 0.957247828991316, 'span_micro_f1': 0.9559706470980655, 'micro_p': 0.9556616643929059, 'micro_r': 0.9427994616419919, 'micro_f1': 0.9491869918699187, 'category-p/r/f1': {'PRO': (0.8095, 0.9444, 0.8718), 'ORG': (0.9395, 0.9232, 0.9313), 'EDU': (0.9364, 0.9717, 0.9537), 'TITLE': (0.9673, 0.942, 0.9545), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9491869918699187 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.78999999999999 / 96.63000000000001 / 96.63000000000001), p: (95.63000000000001 / 95.94), r: (95.34 / 94.23), f1: (95.48 / 95.08)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 19.431998743201202, 'span_acc': 0.9779011099899092, 'attr_start_acc': 0.9662576687116564, 'attr_end_acc': 0.9662576687116564, 'span_micro_p': 0.9563076923076923, 'span_micro_r': 0.9533742331288344, 'span_micro_f1': 0.9548387096774194, 'micro_p': 0.9594003747657714, 'micro_r': 0.9423312883435583, 'micro_f1': 0.9507892293407614, 'category-p/r/f1': {'PRO': (0.8649, 0.9697, 0.9143), 'ORG': (0.9519, 0.9313, 0.9415), 'TITLE': (0.9574, 0.9326, 0.9448), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9507892293407614 / 0.9613122872175797
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: 0.6439, span_acc: 0.9977, attr_start_acc: 0.9892, attr_end_acc: 0.9865, span_micro_p: 0.9893, span_micro_r: 0.9893, span_micro_f1: 0.9893, micro_p: 0.9945, micro_r: 0.9811, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: 2.2669, span_acc: 0.9973, attr_start_acc: 0.9880, attr_end_acc: 0.9906, span_micro_p: 0.9855, span_micro_r: 0.9894, span_micro_f1: 0.9874, micro_p: 0.9892, micro_r: 0.9799, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 1.5253, span_acc: 0.9982, attr_start_acc: 0.9834, attr_end_acc: 0.9913, span_micro_p: 0.9905, span_micro_r: 0.9931, span_micro_f1: 0.9918, micro_p: 0.9894, micro_r: 0.9765, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 2.0253, span_acc: 0.9983, attr_start_acc: 0.9814, attr_end_acc: 0.9913, span_micro_p: 0.9920, span_micro_r: 0.9926, span_micro_f1: 0.9923, micro_p: 0.9905, micro_r: 0.9740, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 2.1443, span_acc: 0.9987, attr_start_acc: 0.9839, attr_end_acc: 0.9907, span_micro_p: 0.9937, span_micro_r: 0.9942, span_micro_f1: 0.9940, micro_p: 0.9921, micro_r: 0.9761, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 1.7213, span_acc: 0.9989, attr_start_acc: 0.9857, attr_end_acc: 0.9901, span_micro_p: 0.9949, span_micro_r: 0.9953, span_micro_f1: 0.9951, micro_p: 0.9931, micro_r: 0.9777, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 2.7169, span_acc: 0.9990, attr_start_acc: 0.9856, attr_end_acc: 0.9887, span_micro_p: 0.9949, span_micro_r: 0.9956, span_micro_f1: 0.9952, micro_p: 0.9927, micro_r: 0.9767, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 2.9454, span_acc: 0.9988, attr_start_acc: 0.9858, attr_end_acc: 0.9892, span_micro_p: 0.9946, span_micro_r: 0.9949, span_micro_f1: 0.9948, micro_p: 0.9933, micro_r: 0.9777, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 3.0626, span_acc: 0.9984, attr_start_acc: 0.9857, attr_end_acc: 0.9884, span_micro_p: 0.9925, span_micro_r: 0.9939, span_micro_f1: 0.9932, micro_p: 0.9921, micro_r: 0.9771, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 2.7236, span_acc: 0.9985, attr_start_acc: 0.9867, attr_end_acc: 0.9879, span_micro_p: 0.9934, span_micro_r: 0.9943, span_micro_f1: 0.9939, micro_p: 0.9925, micro_r: 0.9776, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 2.8206, span_acc: 0.9986, attr_start_acc: 0.9874, attr_end_acc: 0.9872, span_micro_p: 0.9937, span_micro_r: 0.9948, span_micro_f1: 0.9943, micro_p: 0.9929, micro_r: 0.9776, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 4.0175, span_acc: 0.9982, attr_start_acc: 0.9870, attr_end_acc: 0.9870, span_micro_p: 0.9933, span_micro_r: 0.9940, span_micro_f1: 0.9936, micro_p: 0.9927, micro_r: 0.9770, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 3.9537, span_acc: 0.9982, attr_start_acc: 0.9874, attr_end_acc: 0.9878, span_micro_p: 0.9932, span_micro_r: 0.9939, span_micro_f1: 0.9936, micro_p: 0.9932, micro_r: 0.9778, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 3.6952, span_acc: 0.9984, attr_start_acc: 0.9878, attr_end_acc: 0.9883, span_micro_p: 0.9937, span_micro_r: 0.9944, span_micro_f1: 0.9940, micro_p: 0.9937, micro_r: 0.9787, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 3.8553, span_acc: 0.9985, attr_start_acc: 0.9883, attr_end_acc: 0.9880, span_micro_p: 0.9936, span_micro_r: 0.9947, span_micro_f1: 0.9942, micro_p: 0.9938, micro_r: 0.9790, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 3.6809, span_acc: 0.9985, attr_start_acc: 0.9889, attr_end_acc: 0.9875, span_micro_p: 0.9937, span_micro_r: 0.9949, span_micro_f1: 0.9943, micro_p: 0.9937, micro_r: 0.9788, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 3.4249, span_acc: 0.9986, attr_start_acc: 0.9889, attr_end_acc: 0.9876, span_micro_p: 0.9940, span_micro_r: 0.9951, span_micro_f1: 0.9946, micro_p: 0.9940, micro_r: 0.9792, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 3.4379, span_acc: 0.9987, attr_start_acc: 0.9890, attr_end_acc: 0.9882, span_micro_p: 0.9943, span_micro_r: 0.9954, span_micro_f1: 0.9949, micro_p: 0.9942, micro_r: 0.9798, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 3.2480, span_acc: 0.9987, attr_start_acc: 0.9880, attr_end_acc: 0.9866, span_micro_p: 0.9944, span_micro_r: 0.9955, span_micro_f1: 0.9949, micro_p: 0.9937, micro_r: 0.9776, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 3.1125, span_acc: 0.9987, attr_start_acc: 0.9881, attr_end_acc: 0.9867, span_micro_p: 0.9946, span_micro_r: 0.9957, span_micro_f1: 0.9952, micro_p: 0.9936, micro_r: 0.9778, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 3.5531, span_acc: 0.9987, attr_start_acc: 0.9882, attr_end_acc: 0.9867, span_micro_p: 0.9948, span_micro_r: 0.9954, span_micro_f1: 0.9951, micro_p: 0.9938, micro_r: 0.9778, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 3.5385, span_acc: 0.9987, attr_start_acc: 0.9882, attr_end_acc: 0.9865, span_micro_p: 0.9947, span_micro_r: 0.9955, span_micro_f1: 0.9951, micro_p: 0.9939, micro_r: 0.9778, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 3.3907, span_acc: 0.9987, attr_start_acc: 0.9883, attr_end_acc: 0.9864, span_micro_p: 0.9949, span_micro_r: 0.9956, span_micro_f1: 0.9952, micro_p: 0.9939, micro_r: 0.9779, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 3.6903, span_acc: 0.9987, attr_start_acc: 0.9883, attr_end_acc: 0.9865, span_micro_p: 0.9948, span_micro_r: 0.9955, span_micro_f1: 0.9952, micro_p: 0.9940, micro_r: 0.9782, micro_f1: 0.9860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 3.7456, span_acc: 0.9988, attr_start_acc: 0.9882, attr_end_acc: 0.9865, span_micro_p: 0.9950, span_micro_r: 0.9957, span_micro_f1: 0.9953, micro_p: 0.9938, micro_r: 0.9781, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 3.6738, span_acc: 0.9988, attr_start_acc: 0.9882, attr_end_acc: 0.9866, span_micro_p: 0.9951, span_micro_r: 0.9957, span_micro_f1: 0.9954, micro_p: 0.9940, micro_r: 0.9783, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 3.8407, span_acc: 0.9987, attr_start_acc: 0.9881, attr_end_acc: 0.9867, span_micro_p: 0.9950, span_micro_r: 0.9954, span_micro_f1: 0.9952, micro_p: 0.9939, micro_r: 0.9785, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 3.8787, span_acc: 0.9988, attr_start_acc: 0.9885, attr_end_acc: 0.9871, span_micro_p: 0.9951, span_micro_r: 0.9954, span_micro_f1: 0.9952, micro_p: 0.9942, micro_r: 0.9792, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 3.9382, span_acc: 0.9988, attr_start_acc: 0.9887, attr_end_acc: 0.9872, span_micro_p: 0.9952, span_micro_r: 0.9956, span_micro_f1: 0.9954, micro_p: 0.9941, micro_r: 0.9796, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 3.9065, span_acc: 0.9988, attr_start_acc: 0.9889, attr_end_acc: 0.9875, span_micro_p: 0.9952, span_micro_r: 0.9956, span_micro_f1: 0.9954, micro_p: 0.9942, micro_r: 0.9800, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 3.9375, span_acc: 0.9988, attr_start_acc: 0.9889, attr_end_acc: 0.9877, span_micro_p: 0.9952, span_micro_r: 0.9957, span_micro_f1: 0.9955, micro_p: 0.9944, micro_r: 0.9801, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 3.8567, span_acc: 0.9988, attr_start_acc: 0.9887, attr_end_acc: 0.9878, span_micro_p: 0.9951, span_micro_r: 0.9955, span_micro_f1: 0.9953, micro_p: 0.9944, micro_r: 0.9801, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.69 / 97.45 / 97.58), p: (95.17999999999999 / 95.75), r: (96.19 / 95.63000000000001), f1: (95.67999999999999 / 95.69)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 35.133516210974165, 'span_acc': 0.986854571293226, 'attr_start_acc': 0.9744623655913979, 'attr_end_acc': 0.9758064516129032, 'span_micro_p': 0.9517514871116987, 'span_micro_r': 0.9619238476953907, 'span_micro_f1': 0.9568106312292359, 'micro_p': 0.9575471698113207, 'micro_r': 0.9562584118438762, 'micro_f1': 0.9569023569023569, 'category-p/r/f1': {'PRO': (0.8095, 0.9444, 0.8718), 'ORG': (0.9367, 0.9367, 0.9367), 'TITLE': (0.9636, 0.958, 0.9608), 'EDU': (1.0, 0.9811, 0.9905), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9569023569023569 / 0.9634641407307172
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 97.06 / 97.24000000000001), p: (95.24000000000001 / 95.56), r: (95.83 / 95.03), f1: (95.54 / 95.28999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 21.648321378156073, 'span_acc': 0.9851664984863774, 'attr_start_acc': 0.9705521472392638, 'attr_end_acc': 0.9723926380368099, 'span_micro_p': 0.9524390243902439, 'span_micro_r': 0.9582822085889571, 'span_micro_f1': 0.9553516819571866, 'micro_p': 0.9555829734731647, 'micro_r': 0.9503067484662576, 'micro_f1': 0.9529375576745617, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.8649, 0.9697, 0.9143), 'ORG': (0.9437, 0.9403, 0.942), 'TITLE': (0.9554, 0.943, 0.9492), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9529375576745617 / 0.9613122872175797
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.963464
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.961312
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9817356205852674
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9705521472392638
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9705521472392638
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9495440729483283
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9582822085889571
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9538931297709923
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9646401985111662
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9539877300613497
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.959284392350401
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9543, 0.9439, 0.9491), 'PRO': (0.9412, 0.9697, 0.9552), 'TITLE': (0.9619, 0.9495, 0.9557), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 0.9911, 0.9955), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 1.9310, span_acc: 0.6175, attr_start_acc: 0.0025, attr_end_acc: 0.0355, span_micro_p: 0.3034, span_micro_r: 0.0682, span_micro_f1: 0.1113, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.5852, span_acc: 0.7764, attr_start_acc: 0.0477, attr_end_acc: 0.3507, span_micro_p: 0.6833, span_micro_r: 0.3884, span_micro_f1: 0.4953, micro_p: 0.4872, micro_r: 0.0433, micro_f1: 0.0795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.4220, span_acc: 0.8296, attr_start_acc: 0.2515, attr_end_acc: 0.4909, span_micro_p: 0.7558, span_micro_r: 0.5208, span_micro_f1: 0.6167, micro_p: 0.7668, micro_r: 0.2185, micro_f1: 0.3401
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.3115, span_acc: 0.8622, attr_start_acc: 0.3789, attr_end_acc: 0.5661, span_micro_p: 0.8075, span_micro_r: 0.6045, span_micro_f1: 0.6914, micro_p: 0.8428, micro_r: 0.3347, micro_f1: 0.4791
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.2504, span_acc: 0.8818, attr_start_acc: 0.4664, attr_end_acc: 0.6202, span_micro_p: 0.8347, span_micro_r: 0.6544, span_micro_f1: 0.7337, micro_p: 0.8788, micro_r: 0.4168, micro_f1: 0.5655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.1921, span_acc: 0.8971, attr_start_acc: 0.5203, attr_end_acc: 0.6585, span_micro_p: 0.8574, span_micro_r: 0.6961, span_micro_f1: 0.7684, micro_p: 0.9011, micro_r: 0.4714, micro_f1: 0.6190
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.1546, span_acc: 0.9047, attr_start_acc: 0.5554, attr_end_acc: 0.6885, span_micro_p: 0.8672, span_micro_r: 0.7175, span_micro_f1: 0.7852, micro_p: 0.9067, micro_r: 0.5046, micro_f1: 0.6484
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.1221, span_acc: 0.9104, attr_start_acc: 0.5833, attr_end_acc: 0.7098, span_micro_p: 0.8698, span_micro_r: 0.7327, span_micro_f1: 0.7954, micro_p: 0.9085, micro_r: 0.5314, micro_f1: 0.6706
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 1.0912, span_acc: 0.9174, attr_start_acc: 0.6122, attr_end_acc: 0.7324, span_micro_p: 0.8787, span_micro_r: 0.7536, span_micro_f1: 0.8113, micro_p: 0.9157, micro_r: 0.5627, micro_f1: 0.6970
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 1.0686, span_acc: 0.9230, attr_start_acc: 0.6381, attr_end_acc: 0.7520, span_micro_p: 0.8858, span_micro_r: 0.7698, span_micro_f1: 0.8237, micro_p: 0.9229, micro_r: 0.5901, micro_f1: 0.7199
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 1.0460, span_acc: 0.9280, attr_start_acc: 0.6610, attr_end_acc: 0.7638, span_micro_p: 0.8879, span_micro_r: 0.7803, span_micro_f1: 0.8306, micro_p: 0.9273, micro_r: 0.6126, micro_f1: 0.7378
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 1.0244, span_acc: 0.9326, attr_start_acc: 0.6828, attr_end_acc: 0.7793, span_micro_p: 0.8939, span_micro_r: 0.7936, span_micro_f1: 0.8407, micro_p: 0.9313, micro_r: 0.6366, micro_f1: 0.7563
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 1.0082, span_acc: 0.9365, attr_start_acc: 0.7007, attr_end_acc: 0.7913, span_micro_p: 0.8997, span_micro_r: 0.8050, span_micro_f1: 0.8497, micro_p: 0.9357, micro_r: 0.6557, micro_f1: 0.7711
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 0.9966, span_acc: 0.9385, attr_start_acc: 0.7170, attr_end_acc: 0.8008, span_micro_p: 0.9020, span_micro_r: 0.8107, span_micro_f1: 0.8539, micro_p: 0.9375, micro_r: 0.6708, micro_f1: 0.7820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 0.9823, span_acc: 0.9411, attr_start_acc: 0.7305, attr_end_acc: 0.8094, span_micro_p: 0.9046, span_micro_r: 0.8177, span_micro_f1: 0.8590, micro_p: 0.9400, micro_r: 0.6858, micro_f1: 0.7930
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 0.9707, span_acc: 0.9423, attr_start_acc: 0.7418, attr_end_acc: 0.8160, span_micro_p: 0.9048, span_micro_r: 0.8219, span_micro_f1: 0.8614, micro_p: 0.9419, micro_r: 0.6969, micro_f1: 0.8011
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 0.9578, span_acc: 0.9445, attr_start_acc: 0.7526, attr_end_acc: 0.8250, span_micro_p: 0.9065, span_micro_r: 0.8279, span_micro_f1: 0.8654, micro_p: 0.9427, micro_r: 0.7085, micro_f1: 0.8090
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 0.9460, span_acc: 0.9461, attr_start_acc: 0.7614, attr_end_acc: 0.8319, span_micro_p: 0.9087, span_micro_r: 0.8325, span_micro_f1: 0.8689, micro_p: 0.9447, micro_r: 0.7183, micro_f1: 0.8161
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 0.9373, span_acc: 0.9471, attr_start_acc: 0.7689, attr_end_acc: 0.8371, span_micro_p: 0.9067, span_micro_r: 0.8346, span_micro_f1: 0.8692, micro_p: 0.9423, micro_r: 0.7254, micro_f1: 0.8198
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 0.9258, span_acc: 0.9489, attr_start_acc: 0.7768, attr_end_acc: 0.8422, span_micro_p: 0.9085, span_micro_r: 0.8396, span_micro_f1: 0.8727, micro_p: 0.9428, micro_r: 0.7339, micro_f1: 0.8253
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 0.9157, span_acc: 0.9503, attr_start_acc: 0.7831, attr_end_acc: 0.8477, span_micro_p: 0.9111, span_micro_r: 0.8443, span_micro_f1: 0.8765, micro_p: 0.9439, micro_r: 0.7411, micro_f1: 0.8303
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 0.9087, span_acc: 0.9512, attr_start_acc: 0.7895, attr_end_acc: 0.8520, span_micro_p: 0.9115, span_micro_r: 0.8475, span_micro_f1: 0.8783, micro_p: 0.9449, micro_r: 0.7474, micro_f1: 0.8346
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 0.8981, span_acc: 0.9523, attr_start_acc: 0.7957, attr_end_acc: 0.8557, span_micro_p: 0.9132, span_micro_r: 0.8509, span_micro_f1: 0.8809, micro_p: 0.9461, micro_r: 0.7536, micro_f1: 0.8390
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 0.8914, span_acc: 0.9533, attr_start_acc: 0.8016, attr_end_acc: 0.8608, span_micro_p: 0.9142, span_micro_r: 0.8538, span_micro_f1: 0.8830, micro_p: 0.9465, micro_r: 0.7599, micro_f1: 0.8430
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 0.8817, span_acc: 0.9545, attr_start_acc: 0.8073, attr_end_acc: 0.8646, span_micro_p: 0.9161, span_micro_r: 0.8574, span_micro_f1: 0.8858, micro_p: 0.9474, micro_r: 0.7663, micro_f1: 0.8473
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 0.8719, span_acc: 0.9554, attr_start_acc: 0.8120, attr_end_acc: 0.8683, span_micro_p: 0.9163, span_micro_r: 0.8598, span_micro_f1: 0.8872, micro_p: 0.9468, micro_r: 0.7714, micro_f1: 0.8502
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 0.8622, span_acc: 0.9558, attr_start_acc: 0.8163, attr_end_acc: 0.8714, span_micro_p: 0.9167, span_micro_r: 0.8617, span_micro_f1: 0.8884, micro_p: 0.9467, micro_r: 0.7761, micro_f1: 0.8530
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 0.8545, span_acc: 0.9567, attr_start_acc: 0.8209, attr_end_acc: 0.8736, span_micro_p: 0.9176, span_micro_r: 0.8640, span_micro_f1: 0.8900, micro_p: 0.9473, micro_r: 0.7802, micro_f1: 0.8556
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 0.8456, span_acc: 0.9575, attr_start_acc: 0.8257, attr_end_acc: 0.8768, span_micro_p: 0.9189, span_micro_r: 0.8669, span_micro_f1: 0.8921, micro_p: 0.9478, micro_r: 0.7855, micro_f1: 0.8591
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 0.8371, span_acc: 0.9585, attr_start_acc: 0.8307, attr_end_acc: 0.8802, span_micro_p: 0.9210, span_micro_r: 0.8703, span_micro_f1: 0.8949, micro_p: 0.9490, micro_r: 0.7912, micro_f1: 0.8629
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 0.8280, span_acc: 0.9595, attr_start_acc: 0.8343, attr_end_acc: 0.8827, span_micro_p: 0.9223, span_micro_r: 0.8729, span_micro_f1: 0.8970, micro_p: 0.9498, micro_r: 0.7953, micro_f1: 0.8657
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 96.37 / 96.71), p: (96.3 / 97.48), r: (95.59 / 93.61), f1: (95.94 / 95.5)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.4729009587357935, 'span_acc': 0.9851965892941734, 'attr_start_acc': 0.9637096774193549, 'attr_end_acc': 0.9670698924731183, 'span_micro_p': 0.9629878869448183, 'span_micro_r': 0.9559118236472945, 'span_micro_f1': 0.9594368085819643, 'micro_p': 0.9747722494744219, 'micro_r': 0.9360699865410498, 'micro_f1': 0.955029179539993, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (1.0, 0.8889, 0.9412), 'ORG': (0.9641, 0.9271, 0.9452), 'TITLE': (0.9788, 0.9348, 0.9563), 'EDU': (0.9709, 0.9434, 0.957), 'CONT': (1.0, 0.9394, 0.9688), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.955029179539993 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.61999999999999 / 95.34 / 95.89), p: (95.89 / 97.42), r: (94.42 / 92.7), f1: (95.15 / 95.0)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.47183910574553145, 'span_acc': 0.9761856710393542, 'attr_start_acc': 0.9533742331288344, 'attr_end_acc': 0.9588957055214724, 'span_micro_p': 0.9588785046728971, 'span_micro_r': 0.9441717791411043, 'span_micro_f1': 0.951468315301391, 'micro_p': 0.9742101869761445, 'micro_r': 0.9269938650306748, 'micro_f1': 0.95001571832757, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.963, 0.7879, 0.8667), 'ORG': (0.9622, 0.9204, 0.9408), 'TITLE': (0.9742, 0.9301, 0.9516), 'EDU': (1.0, 0.9286, 0.963), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.95001571832757 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.6285, span_acc: 0.9509, attr_start_acc: 0.9143, attr_end_acc: 0.8857, span_micro_p: 0.8824, span_micro_r: 0.8571, span_micro_f1: 0.8696, micro_p: 1.0000, micro_r: 0.8000, micro_f1: 0.8889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.5302, span_acc: 0.9866, attr_start_acc: 0.9690, attr_end_acc: 0.9716, span_micro_p: 0.9557, span_micro_r: 0.9459, span_micro_f1: 0.9508, micro_p: 0.9837, micro_r: 0.9354, micro_f1: 0.9589
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.5256, span_acc: 0.9843, attr_start_acc: 0.9621, attr_end_acc: 0.9645, span_micro_p: 0.9542, span_micro_r: 0.9379, span_micro_f1: 0.9459, micro_p: 0.9704, micro_r: 0.9241, micro_f1: 0.9467
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.5106, span_acc: 0.9850, attr_start_acc: 0.9553, attr_end_acc: 0.9623, span_micro_p: 0.9586, span_micro_r: 0.9407, span_micro_f1: 0.9496, micro_p: 0.9727, micro_r: 0.9223, micro_f1: 0.9468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.5130, span_acc: 0.9843, attr_start_acc: 0.9601, attr_end_acc: 0.9678, span_micro_p: 0.9596, span_micro_r: 0.9437, span_micro_f1: 0.9516, micro_p: 0.9738, micro_r: 0.9321, micro_f1: 0.9525
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.5170, span_acc: 0.9816, attr_start_acc: 0.9541, attr_end_acc: 0.9641, span_micro_p: 0.9532, span_micro_r: 0.9387, span_micro_f1: 0.9459, micro_p: 0.9670, micro_r: 0.9249, micro_f1: 0.9455
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.5033, span_acc: 0.9813, attr_start_acc: 0.9570, attr_end_acc: 0.9658, span_micro_p: 0.9511, span_micro_r: 0.9379, span_micro_f1: 0.9445, micro_p: 0.9660, micro_r: 0.9280, micro_f1: 0.9466
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.4935, span_acc: 0.9812, attr_start_acc: 0.9587, attr_end_acc: 0.9673, span_micro_p: 0.9536, span_micro_r: 0.9415, span_micro_f1: 0.9475, micro_p: 0.9688, micro_r: 0.9312, micro_f1: 0.9496
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.4825, span_acc: 0.9816, attr_start_acc: 0.9606, attr_end_acc: 0.9682, span_micro_p: 0.9547, span_micro_r: 0.9444, span_micro_f1: 0.9495, micro_p: 0.9697, micro_r: 0.9342, micro_f1: 0.9516
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.4725, span_acc: 0.9822, attr_start_acc: 0.9594, attr_end_acc: 0.9680, span_micro_p: 0.9565, span_micro_r: 0.9446, span_micro_f1: 0.9505, micro_p: 0.9717, micro_r: 0.9338, micro_f1: 0.9523
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.4647, span_acc: 0.9830, attr_start_acc: 0.9618, attr_end_acc: 0.9702, span_micro_p: 0.9570, span_micro_r: 0.9465, span_micro_f1: 0.9518, micro_p: 0.9723, micro_r: 0.9375, micro_f1: 0.9546
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.4511, span_acc: 0.9831, attr_start_acc: 0.9614, attr_end_acc: 0.9704, span_micro_p: 0.9581, span_micro_r: 0.9465, span_micro_f1: 0.9523, micro_p: 0.9728, micro_r: 0.9372, micro_f1: 0.9547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.4441, span_acc: 0.9835, attr_start_acc: 0.9617, attr_end_acc: 0.9709, span_micro_p: 0.9580, span_micro_r: 0.9463, span_micro_f1: 0.9521, micro_p: 0.9725, micro_r: 0.9381, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.4364, span_acc: 0.9840, attr_start_acc: 0.9607, attr_end_acc: 0.9707, span_micro_p: 0.9578, span_micro_r: 0.9470, span_micro_f1: 0.9524, micro_p: 0.9727, micro_r: 0.9373, micro_f1: 0.9547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.4256, span_acc: 0.9842, attr_start_acc: 0.9611, attr_end_acc: 0.9709, span_micro_p: 0.9579, span_micro_r: 0.9481, span_micro_f1: 0.9530, micro_p: 0.9725, micro_r: 0.9378, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.4174, span_acc: 0.9844, attr_start_acc: 0.9609, attr_end_acc: 0.9712, span_micro_p: 0.9583, span_micro_r: 0.9490, span_micro_f1: 0.9536, micro_p: 0.9720, micro_r: 0.9381, micro_f1: 0.9548
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.4152, span_acc: 0.9844, attr_start_acc: 0.9605, attr_end_acc: 0.9709, span_micro_p: 0.9578, span_micro_r: 0.9493, span_micro_f1: 0.9535, micro_p: 0.9715, micro_r: 0.9378, micro_f1: 0.9544
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.4066, span_acc: 0.9844, attr_start_acc: 0.9610, attr_end_acc: 0.9705, span_micro_p: 0.9588, span_micro_r: 0.9497, span_micro_f1: 0.9542, micro_p: 0.9725, micro_r: 0.9379, micro_f1: 0.9549
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.4070, span_acc: 0.9839, attr_start_acc: 0.9607, attr_end_acc: 0.9704, span_micro_p: 0.9582, span_micro_r: 0.9495, span_micro_f1: 0.9538, micro_p: 0.9723, micro_r: 0.9374, micro_f1: 0.9545
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.4021, span_acc: 0.9837, attr_start_acc: 0.9594, attr_end_acc: 0.9695, span_micro_p: 0.9570, span_micro_r: 0.9479, span_micro_f1: 0.9524, micro_p: 0.9717, micro_r: 0.9359, micro_f1: 0.9535
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.3950, span_acc: 0.9836, attr_start_acc: 0.9594, attr_end_acc: 0.9694, span_micro_p: 0.9576, span_micro_r: 0.9474, span_micro_f1: 0.9524, micro_p: 0.9721, micro_r: 0.9358, micro_f1: 0.9536
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.3849, span_acc: 0.9840, attr_start_acc: 0.9600, attr_end_acc: 0.9700, span_micro_p: 0.9579, span_micro_r: 0.9484, span_micro_f1: 0.9531, micro_p: 0.9720, micro_r: 0.9368, micro_f1: 0.9541
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.3804, span_acc: 0.9842, attr_start_acc: 0.9605, attr_end_acc: 0.9705, span_micro_p: 0.9580, span_micro_r: 0.9485, span_micro_f1: 0.9533, micro_p: 0.9718, micro_r: 0.9376, micro_f1: 0.9544
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.3750, span_acc: 0.9837, attr_start_acc: 0.9599, attr_end_acc: 0.9710, span_micro_p: 0.9578, span_micro_r: 0.9483, span_micro_f1: 0.9530, micro_p: 0.9713, micro_r: 0.9372, micro_f1: 0.9540
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.3798, span_acc: 0.9839, attr_start_acc: 0.9601, attr_end_acc: 0.9713, span_micro_p: 0.9574, span_micro_r: 0.9489, span_micro_f1: 0.9531, micro_p: 0.9711, micro_r: 0.9374, micro_f1: 0.9539
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.3764, span_acc: 0.9833, attr_start_acc: 0.9608, attr_end_acc: 0.9717, span_micro_p: 0.9560, span_micro_r: 0.9496, span_micro_f1: 0.9528, micro_p: 0.9713, micro_r: 0.9380, micro_f1: 0.9544
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.3697, span_acc: 0.9834, attr_start_acc: 0.9617, attr_end_acc: 0.9717, span_micro_p: 0.9560, span_micro_r: 0.9497, span_micro_f1: 0.9528, micro_p: 0.9713, micro_r: 0.9385, micro_f1: 0.9546
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.3638, span_acc: 0.9833, attr_start_acc: 0.9617, attr_end_acc: 0.9721, span_micro_p: 0.9556, span_micro_r: 0.9494, span_micro_f1: 0.9525, micro_p: 0.9711, micro_r: 0.9385, micro_f1: 0.9545
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.3560, span_acc: 0.9835, attr_start_acc: 0.9622, attr_end_acc: 0.9727, span_micro_p: 0.9564, span_micro_r: 0.9503, span_micro_f1: 0.9534, micro_p: 0.9714, micro_r: 0.9392, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.3563, span_acc: 0.9834, attr_start_acc: 0.9626, attr_end_acc: 0.9727, span_micro_p: 0.9568, span_micro_r: 0.9501, span_micro_f1: 0.9534, micro_p: 0.9718, micro_r: 0.9397, micro_f1: 0.9555
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.3474, span_acc: 0.9834, attr_start_acc: 0.9629, attr_end_acc: 0.9727, span_micro_p: 0.9568, span_micro_r: 0.9500, span_micro_f1: 0.9534, micro_p: 0.9717, micro_r: 0.9400, micro_f1: 0.9556
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.3503, span_acc: 0.9833, attr_start_acc: 0.9624, attr_end_acc: 0.9726, span_micro_p: 0.9565, span_micro_r: 0.9488, span_micro_f1: 0.9526, micro_p: 0.9712, micro_r: 0.9393, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.58 / 94.96 / 97.31), p: (96.35000000000001 / 96.77), r: (95.26 / 92.60000000000001), f1: (95.8 / 94.64)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.07412820629630697, 'span_acc': 0.9857887257224064, 'attr_start_acc': 0.9495967741935484, 'attr_end_acc': 0.9731182795698925, 'span_micro_p': 0.9635135135135136, 'span_micro_r': 0.9525718102872411, 'span_micro_f1': 0.958011420893517, 'micro_p': 0.9676511954992968, 'micro_r': 0.9259757738896366, 'micro_f1': 0.9463548830811553, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (1.0, 0.2778, 0.4348), 'RACE': (1.0, 0.3571, 0.5263), 'ORG': (0.9562, 0.9213, 0.9384), 'EDU': (0.9703, 0.9245, 0.9468), 'TITLE': (0.9688, 0.9464, 0.9575), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9463548830811553 / 0.955029179539993
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.11999999999999 / 93.07 / 95.89), p: (95.97 / 96.6), r: (93.44 / 90.55), f1: (94.67999999999999 / 93.47999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': -0.00387788343729463, 'span_acc': 0.9812310797174572, 'attr_start_acc': 0.9306748466257668, 'attr_end_acc': 0.9588957055214724, 'span_micro_p': 0.9596723377441714, 'span_micro_r': 0.9343558282208589, 'span_micro_f1': 0.946844886540255, 'micro_p': 0.9659685863874345, 'micro_r': 0.905521472392638, 'micro_f1': 0.9347688410386321, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (1.0, 0.3636, 0.5333), 'RACE': (1.0, 0.4286, 0.6), 'ORG': (0.9575, 0.8969, 0.9262), 'EDU': (1.0, 0.8929, 0.9434), 'TITLE': (0.9601, 0.9352, 0.9475), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9347688410386321 / 0.95001571832757
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: 0.5224, span_acc: 1.0000, attr_start_acc: 0.9351, attr_end_acc: 0.9870, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9221, micro_f1: 0.9595
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: 0.0977, span_acc: 0.9861, attr_start_acc: 0.9533, attr_end_acc: 0.9745, span_micro_p: 0.9659, span_micro_r: 0.9537, span_micro_f1: 0.9597, micro_p: 0.9756, micro_r: 0.9342, micro_f1: 0.9544
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: 0.1649, span_acc: 0.9834, attr_start_acc: 0.9559, attr_end_acc: 0.9740, span_micro_p: 0.9601, span_micro_r: 0.9440, span_micro_f1: 0.9520, micro_p: 0.9707, micro_r: 0.9376, micro_f1: 0.9539
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: 0.1063, span_acc: 0.9865, attr_start_acc: 0.9565, attr_end_acc: 0.9783, span_micro_p: 0.9669, span_micro_r: 0.9553, span_micro_f1: 0.9611, micro_p: 0.9766, micro_r: 0.9419, micro_f1: 0.9589
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: 0.1026, span_acc: 0.9870, attr_start_acc: 0.9625, attr_end_acc: 0.9809, span_micro_p: 0.9672, span_micro_r: 0.9574, span_micro_f1: 0.9623, micro_p: 0.9755, micro_r: 0.9481, micro_f1: 0.9616
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: 0.0809, span_acc: 0.9881, attr_start_acc: 0.9646, attr_end_acc: 0.9825, span_micro_p: 0.9679, span_micro_r: 0.9625, span_micro_f1: 0.9652, micro_p: 0.9781, micro_r: 0.9522, micro_f1: 0.9650
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: 0.0745, span_acc: 0.9884, attr_start_acc: 0.9649, attr_end_acc: 0.9825, span_micro_p: 0.9696, span_micro_r: 0.9651, span_micro_f1: 0.9674, micro_p: 0.9788, micro_r: 0.9532, micro_f1: 0.9658
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: 0.0580, span_acc: 0.9894, attr_start_acc: 0.9661, attr_end_acc: 0.9826, span_micro_p: 0.9712, span_micro_r: 0.9677, span_micro_f1: 0.9695, micro_p: 0.9797, micro_r: 0.9547, micro_f1: 0.9670
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: 0.0424, span_acc: 0.9894, attr_start_acc: 0.9665, attr_end_acc: 0.9814, span_micro_p: 0.9695, span_micro_r: 0.9667, span_micro_f1: 0.9681, micro_p: 0.9790, micro_r: 0.9536, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: 0.0336, span_acc: 0.9899, attr_start_acc: 0.9680, attr_end_acc: 0.9807, span_micro_p: 0.9706, span_micro_r: 0.9664, span_micro_f1: 0.9685, micro_p: 0.9801, micro_r: 0.9543, micro_f1: 0.9670
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: 0.0504, span_acc: 0.9905, attr_start_acc: 0.9697, attr_end_acc: 0.9817, span_micro_p: 0.9719, span_micro_r: 0.9680, span_micro_f1: 0.9700, micro_p: 0.9810, micro_r: 0.9565, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: 0.0777, span_acc: 0.9898, attr_start_acc: 0.9668, attr_end_acc: 0.9786, span_micro_p: 0.9690, span_micro_r: 0.9661, span_micro_f1: 0.9675, micro_p: 0.9777, micro_r: 0.9517, micro_f1: 0.9645
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: 0.0739, span_acc: 0.9899, attr_start_acc: 0.9672, attr_end_acc: 0.9781, span_micro_p: 0.9695, span_micro_r: 0.9668, span_micro_f1: 0.9682, micro_p: 0.9775, micro_r: 0.9520, micro_f1: 0.9646
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: 0.0583, span_acc: 0.9903, attr_start_acc: 0.9678, attr_end_acc: 0.9786, span_micro_p: 0.9708, span_micro_r: 0.9673, span_micro_f1: 0.9691, micro_p: 0.9788, micro_r: 0.9532, micro_f1: 0.9658
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: 0.0446, span_acc: 0.9904, attr_start_acc: 0.9691, attr_end_acc: 0.9788, span_micro_p: 0.9709, span_micro_r: 0.9679, span_micro_f1: 0.9694, micro_p: 0.9789, micro_r: 0.9543, micro_f1: 0.9665
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: 0.0373, span_acc: 0.9901, attr_start_acc: 0.9687, attr_end_acc: 0.9791, span_micro_p: 0.9705, span_micro_r: 0.9677, span_micro_f1: 0.9691, micro_p: 0.9778, micro_r: 0.9541, micro_f1: 0.9658
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: 0.0462, span_acc: 0.9901, attr_start_acc: 0.9691, attr_end_acc: 0.9790, span_micro_p: 0.9698, span_micro_r: 0.9675, span_micro_f1: 0.9687, micro_p: 0.9770, micro_r: 0.9543, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: 0.0542, span_acc: 0.9897, attr_start_acc: 0.9690, attr_end_acc: 0.9795, span_micro_p: 0.9690, span_micro_r: 0.9670, span_micro_f1: 0.9680, micro_p: 0.9773, micro_r: 0.9542, micro_f1: 0.9656
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: 0.0472, span_acc: 0.9898, attr_start_acc: 0.9694, attr_end_acc: 0.9801, span_micro_p: 0.9692, span_micro_r: 0.9678, span_micro_f1: 0.9685, micro_p: 0.9779, micro_r: 0.9549, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: 0.0426, span_acc: 0.9895, attr_start_acc: 0.9696, attr_end_acc: 0.9802, span_micro_p: 0.9692, span_micro_r: 0.9675, span_micro_f1: 0.9684, micro_p: 0.9777, micro_r: 0.9552, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: 0.0557, span_acc: 0.9893, attr_start_acc: 0.9703, attr_end_acc: 0.9799, span_micro_p: 0.9693, span_micro_r: 0.9678, span_micro_f1: 0.9685, micro_p: 0.9779, micro_r: 0.9555, micro_f1: 0.9666
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: 0.0496, span_acc: 0.9890, attr_start_acc: 0.9709, attr_end_acc: 0.9800, span_micro_p: 0.9701, span_micro_r: 0.9686, span_micro_f1: 0.9693, micro_p: 0.9784, micro_r: 0.9565, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: 0.0511, span_acc: 0.9891, attr_start_acc: 0.9707, attr_end_acc: 0.9798, span_micro_p: 0.9703, span_micro_r: 0.9683, span_micro_f1: 0.9693, micro_p: 0.9785, micro_r: 0.9561, micro_f1: 0.9672
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: 0.0482, span_acc: 0.9893, attr_start_acc: 0.9707, attr_end_acc: 0.9801, span_micro_p: 0.9706, span_micro_r: 0.9686, span_micro_f1: 0.9696, micro_p: 0.9787, micro_r: 0.9561, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: 0.0425, span_acc: 0.9894, attr_start_acc: 0.9712, attr_end_acc: 0.9803, span_micro_p: 0.9709, span_micro_r: 0.9691, span_micro_f1: 0.9700, micro_p: 0.9786, micro_r: 0.9567, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: 0.0450, span_acc: 0.9894, attr_start_acc: 0.9715, attr_end_acc: 0.9806, span_micro_p: 0.9713, span_micro_r: 0.9690, span_micro_f1: 0.9701, micro_p: 0.9785, micro_r: 0.9572, micro_f1: 0.9678
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: 0.0577, span_acc: 0.9892, attr_start_acc: 0.9715, attr_end_acc: 0.9807, span_micro_p: 0.9706, span_micro_r: 0.9689, span_micro_f1: 0.9698, micro_p: 0.9779, micro_r: 0.9572, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: 0.0541, span_acc: 0.9894, attr_start_acc: 0.9717, attr_end_acc: 0.9811, span_micro_p: 0.9711, span_micro_r: 0.9692, span_micro_f1: 0.9701, micro_p: 0.9785, micro_r: 0.9578, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: 0.0549, span_acc: 0.9893, attr_start_acc: 0.9721, attr_end_acc: 0.9813, span_micro_p: 0.9711, span_micro_r: 0.9692, span_micro_f1: 0.9701, micro_p: 0.9785, micro_r: 0.9578, micro_f1: 0.9681
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: 0.0569, span_acc: 0.9894, attr_start_acc: 0.9722, attr_end_acc: 0.9814, span_micro_p: 0.9706, span_micro_r: 0.9690, span_micro_f1: 0.9698, micro_p: 0.9784, micro_r: 0.9579, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: 0.0492, span_acc: 0.9894, attr_start_acc: 0.9725, attr_end_acc: 0.9815, span_micro_p: 0.9706, span_micro_r: 0.9688, span_micro_f1: 0.9697, micro_p: 0.9786, micro_r: 0.9581, micro_f1: 0.9683
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: 0.0430, span_acc: 0.9892, attr_start_acc: 0.9728, attr_end_acc: 0.9816, span_micro_p: 0.9710, span_micro_r: 0.9691, span_micro_f1: 0.9701, micro_p: 0.9789, micro_r: 0.9586, micro_f1: 0.9687
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.72999999999999 / 97.65 / 98.05), p: (95.97 / 96.55), r: (97.13000000000001 / 95.96000000000001), f1: (96.55 / 96.25)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.5012745088042759, 'span_acc': 0.9873282804358124, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.980510752688172, 'span_micro_p': 0.9597359735973597, 'span_micro_r': 0.9712758851035405, 'span_micro_f1': 0.9654714475431607, 'micro_p': 0.965470548408937, 'micro_r': 0.9596231493943472, 'micro_f1': 0.9625379682753966, 'category-p/r/f1': {'ORG': (0.9521, 0.9539, 0.953), 'TITLE': (0.9719, 0.9522, 0.9619), 'EDU': (0.9537, 0.9717, 0.9626), 'PRO': (0.9474, 1.0, 0.973), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9625379682753966 / 0.955029179539993
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.32 / 96.99 / 97.48), p: (96.00999999999999 / 96.88), r: (95.95 / 95.39999999999999), f1: (95.98 / 96.14)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.03850480445525931, 'span_acc': 0.9832492431886983, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9748466257668712, 'span_micro_p': 0.960098219766728, 'span_micro_r': 0.9595092024539877, 'span_micro_f1': 0.9598036207425591, 'micro_p': 0.9688473520249221, 'micro_r': 0.9539877300613497, 'micro_f1': 0.9613601236476044, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9613, 0.9439, 0.9525), 'TITLE': (0.9669, 0.9469, 0.9568), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9613601236476044 / 0.95001571832757
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.4894, span_acc: 0.9917, attr_start_acc: 0.9913, attr_end_acc: 0.9739, span_micro_p: 0.9741, span_micro_r: 0.9741, span_micro_f1: 0.9741, micro_p: 0.9912, micro_r: 0.9739, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -0.4598, span_acc: 0.9947, attr_start_acc: 0.9845, attr_end_acc: 0.9862, span_micro_p: 0.9828, span_micro_r: 0.9778, span_micro_f1: 0.9803, micro_p: 0.9843, micro_r: 0.9741, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.4999, span_acc: 0.9948, attr_start_acc: 0.9797, attr_end_acc: 0.9871, span_micro_p: 0.9835, span_micro_r: 0.9799, span_micro_f1: 0.9817, micro_p: 0.9832, micro_r: 0.9705, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.5034, span_acc: 0.9950, attr_start_acc: 0.9766, attr_end_acc: 0.9863, span_micro_p: 0.9843, span_micro_r: 0.9802, span_micro_f1: 0.9822, micro_p: 0.9832, micro_r: 0.9677, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -0.4658, span_acc: 0.9946, attr_start_acc: 0.9778, attr_end_acc: 0.9879, span_micro_p: 0.9806, span_micro_r: 0.9790, span_micro_f1: 0.9798, micro_p: 0.9844, micro_r: 0.9678, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -0.2804, span_acc: 0.9927, attr_start_acc: 0.9758, attr_end_acc: 0.9853, span_micro_p: 0.9780, span_micro_r: 0.9721, span_micro_f1: 0.9750, micro_p: 0.9819, micro_r: 0.9641, micro_f1: 0.9729
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -0.2290, span_acc: 0.9924, attr_start_acc: 0.9756, attr_end_acc: 0.9844, span_micro_p: 0.9764, span_micro_r: 0.9720, span_micro_f1: 0.9742, micro_p: 0.9800, micro_r: 0.9629, micro_f1: 0.9714
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -0.2117, span_acc: 0.9934, attr_start_acc: 0.9780, attr_end_acc: 0.9857, span_micro_p: 0.9797, span_micro_r: 0.9756, span_micro_f1: 0.9777, micro_p: 0.9825, micro_r: 0.9665, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -0.2175, span_acc: 0.9935, attr_start_acc: 0.9773, attr_end_acc: 0.9863, span_micro_p: 0.9802, span_micro_r: 0.9758, span_micro_f1: 0.9780, micro_p: 0.9832, micro_r: 0.9664, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: -0.1447, span_acc: 0.9936, attr_start_acc: 0.9771, attr_end_acc: 0.9868, span_micro_p: 0.9804, span_micro_r: 0.9755, span_micro_f1: 0.9779, micro_p: 0.9843, micro_r: 0.9666, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: -0.0916, span_acc: 0.9935, attr_start_acc: 0.9771, attr_end_acc: 0.9870, span_micro_p: 0.9805, span_micro_r: 0.9752, span_micro_f1: 0.9778, micro_p: 0.9840, micro_r: 0.9665, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: -0.0737, span_acc: 0.9937, attr_start_acc: 0.9774, attr_end_acc: 0.9866, span_micro_p: 0.9811, span_micro_r: 0.9761, span_micro_f1: 0.9786, micro_p: 0.9845, micro_r: 0.9669, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: -0.0208, span_acc: 0.9933, attr_start_acc: 0.9777, attr_end_acc: 0.9868, span_micro_p: 0.9806, span_micro_r: 0.9757, span_micro_f1: 0.9781, micro_p: 0.9837, micro_r: 0.9668, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: -0.0069, span_acc: 0.9933, attr_start_acc: 0.9778, attr_end_acc: 0.9867, span_micro_p: 0.9806, span_micro_r: 0.9758, span_micro_f1: 0.9782, micro_p: 0.9841, micro_r: 0.9666, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: -0.0448, span_acc: 0.9937, attr_start_acc: 0.9781, attr_end_acc: 0.9872, span_micro_p: 0.9814, span_micro_r: 0.9773, span_micro_f1: 0.9794, micro_p: 0.9843, micro_r: 0.9674, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: -0.0413, span_acc: 0.9937, attr_start_acc: 0.9786, attr_end_acc: 0.9871, span_micro_p: 0.9814, span_micro_r: 0.9775, span_micro_f1: 0.9795, micro_p: 0.9840, micro_r: 0.9677, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: -0.0203, span_acc: 0.9937, attr_start_acc: 0.9775, attr_end_acc: 0.9861, span_micro_p: 0.9810, span_micro_r: 0.9775, span_micro_f1: 0.9792, micro_p: 0.9837, micro_r: 0.9659, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: -0.0014, span_acc: 0.9933, attr_start_acc: 0.9772, attr_end_acc: 0.9858, span_micro_p: 0.9805, span_micro_r: 0.9763, span_micro_f1: 0.9784, micro_p: 0.9834, micro_r: 0.9655, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: -0.0432, span_acc: 0.9935, attr_start_acc: 0.9780, attr_end_acc: 0.9861, span_micro_p: 0.9814, span_micro_r: 0.9773, span_micro_f1: 0.9794, micro_p: 0.9840, micro_r: 0.9669, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: -0.0125, span_acc: 0.9933, attr_start_acc: 0.9779, attr_end_acc: 0.9862, span_micro_p: 0.9811, span_micro_r: 0.9773, span_micro_f1: 0.9792, micro_p: 0.9839, micro_r: 0.9669, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: 0.0082, span_acc: 0.9929, attr_start_acc: 0.9776, attr_end_acc: 0.9862, span_micro_p: 0.9812, span_micro_r: 0.9772, span_micro_f1: 0.9792, micro_p: 0.9838, micro_r: 0.9671, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: 0.0014, span_acc: 0.9928, attr_start_acc: 0.9778, attr_end_acc: 0.9863, span_micro_p: 0.9803, span_micro_r: 0.9771, span_micro_f1: 0.9787, micro_p: 0.9832, micro_r: 0.9672, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: 0.0438, span_acc: 0.9923, attr_start_acc: 0.9778, attr_end_acc: 0.9861, span_micro_p: 0.9810, span_micro_r: 0.9772, span_micro_f1: 0.9791, micro_p: 0.9836, micro_r: 0.9672, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: 0.1026, span_acc: 0.9923, attr_start_acc: 0.9781, attr_end_acc: 0.9860, span_micro_p: 0.9803, span_micro_r: 0.9769, span_micro_f1: 0.9786, micro_p: 0.9836, micro_r: 0.9672, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: 0.1011, span_acc: 0.9923, attr_start_acc: 0.9784, attr_end_acc: 0.9862, span_micro_p: 0.9801, span_micro_r: 0.9770, span_micro_f1: 0.9786, micro_p: 0.9835, micro_r: 0.9675, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: 0.0925, span_acc: 0.9922, attr_start_acc: 0.9781, attr_end_acc: 0.9860, span_micro_p: 0.9799, span_micro_r: 0.9765, span_micro_f1: 0.9782, micro_p: 0.9833, micro_r: 0.9671, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: 0.1068, span_acc: 0.9922, attr_start_acc: 0.9779, attr_end_acc: 0.9859, span_micro_p: 0.9797, span_micro_r: 0.9761, span_micro_f1: 0.9779, micro_p: 0.9834, micro_r: 0.9668, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: 0.1015, span_acc: 0.9924, attr_start_acc: 0.9782, attr_end_acc: 0.9860, span_micro_p: 0.9800, span_micro_r: 0.9763, span_micro_f1: 0.9782, micro_p: 0.9837, micro_r: 0.9672, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: 0.0825, span_acc: 0.9924, attr_start_acc: 0.9783, attr_end_acc: 0.9860, span_micro_p: 0.9798, span_micro_r: 0.9764, span_micro_f1: 0.9781, micro_p: 0.9835, micro_r: 0.9671, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: 0.0773, span_acc: 0.9924, attr_start_acc: 0.9781, attr_end_acc: 0.9861, span_micro_p: 0.9794, span_micro_r: 0.9762, span_micro_f1: 0.9778, micro_p: 0.9830, micro_r: 0.9670, micro_f1: 0.9749
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: 0.0861, span_acc: 0.9924, attr_start_acc: 0.9785, attr_end_acc: 0.9862, span_micro_p: 0.9796, span_micro_r: 0.9764, span_micro_f1: 0.9780, micro_p: 0.9835, micro_r: 0.9675, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: 0.0854, span_acc: 0.9925, attr_start_acc: 0.9789, attr_end_acc: 0.9865, span_micro_p: 0.9794, span_micro_r: 0.9768, span_micro_f1: 0.9781, micro_p: 0.9837, micro_r: 0.9679, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.65 / 97.65 / 98.32), p: (96.46000000000001 / 96.67999999999999), r: (96.53 / 96.1), f1: (96.49 / 96.39)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.2486934566600791, 'span_acc': 0.9864992894362862, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9831989247311828, 'span_micro_p': 0.9646194926568759, 'span_micro_r': 0.9652638610554443, 'span_micro_f1': 0.9649415692821369, 'micro_p': 0.966824644549763, 'micro_r': 0.9609690444145357, 'micro_f1': 0.9638879514006075, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9538, 0.9501, 0.9519), 'TITLE': (0.9735, 0.9565, 0.9649), 'EDU': (0.9633, 0.9906, 0.9768), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9638879514006075 / 0.9625379682753966
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.09 / 96.99 / 97.42), p: (95.99 / 96.7), r: (95.34 / 95.21), f1: (95.66 / 95.95)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.6621219924410934, 'span_acc': 0.9809283551967709, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9598517603458925, 'span_micro_r': 0.9533742331288344, 'span_micro_f1': 0.9566020313942751, 'micro_p': 0.9669781931464174, 'micro_r': 0.9521472392638037, 'micro_f1': 0.9595054095826894, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9562, 0.9476, 0.9519), 'TITLE': (0.9668, 0.943, 0.9548), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9818, 0.9643, 0.973), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9595054095826894 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: -0.0855, span_acc: 0.9978, attr_start_acc: 0.9866, attr_end_acc: 0.9866, span_micro_p: 0.9933, span_micro_r: 0.9867, span_micro_f1: 0.9900, micro_p: 1.0000, micro_r: 0.9732, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: 0.3296, span_acc: 0.9869, attr_start_acc: 0.9785, attr_end_acc: 0.9843, span_micro_p: 0.9708, span_micro_r: 0.9670, span_micro_f1: 0.9689, micro_p: 0.9960, micro_r: 0.9667, micro_f1: 0.9811
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: 0.1687, span_acc: 0.9909, attr_start_acc: 0.9832, attr_end_acc: 0.9888, span_micro_p: 0.9745, span_micro_r: 0.9767, span_micro_f1: 0.9756, micro_p: 0.9920, micro_r: 0.9731, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.2354, span_acc: 0.9932, attr_start_acc: 0.9821, attr_end_acc: 0.9875, span_micro_p: 0.9799, span_micro_r: 0.9806, span_micro_f1: 0.9803, micro_p: 0.9913, micro_r: 0.9735, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.2944, span_acc: 0.9939, attr_start_acc: 0.9819, attr_end_acc: 0.9877, span_micro_p: 0.9820, span_micro_r: 0.9826, span_micro_f1: 0.9823, micro_p: 0.9899, micro_r: 0.9736, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.2338, span_acc: 0.9928, attr_start_acc: 0.9770, attr_end_acc: 0.9862, span_micro_p: 0.9795, span_micro_r: 0.9786, span_micro_f1: 0.9790, micro_p: 0.9896, micro_r: 0.9673, micro_f1: 0.9783
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.1432, span_acc: 0.9935, attr_start_acc: 0.9777, attr_end_acc: 0.9871, span_micro_p: 0.9801, span_micro_r: 0.9790, span_micro_f1: 0.9795, micro_p: 0.9880, micro_r: 0.9678, micro_f1: 0.9778
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.0947, span_acc: 0.9939, attr_start_acc: 0.9787, attr_end_acc: 0.9873, span_micro_p: 0.9805, span_micro_r: 0.9802, span_micro_f1: 0.9803, micro_p: 0.9877, micro_r: 0.9686, micro_f1: 0.9781
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: 0.0812, span_acc: 0.9943, attr_start_acc: 0.9804, attr_end_acc: 0.9884, span_micro_p: 0.9813, span_micro_r: 0.9805, span_micro_f1: 0.9809, micro_p: 0.9879, micro_r: 0.9705, micro_f1: 0.9791
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: -0.0015, span_acc: 0.9940, attr_start_acc: 0.9815, attr_end_acc: 0.9892, span_micro_p: 0.9801, span_micro_r: 0.9796, span_micro_f1: 0.9798, micro_p: 0.9874, micro_r: 0.9714, micro_f1: 0.9794
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: -0.0501, span_acc: 0.9944, attr_start_acc: 0.9826, attr_end_acc: 0.9900, span_micro_p: 0.9811, span_micro_r: 0.9809, span_micro_f1: 0.9810, micro_p: 0.9878, micro_r: 0.9735, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: -0.0438, span_acc: 0.9944, attr_start_acc: 0.9820, attr_end_acc: 0.9898, span_micro_p: 0.9821, span_micro_r: 0.9813, span_micro_f1: 0.9817, micro_p: 0.9881, micro_r: 0.9732, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: -0.0182, span_acc: 0.9947, attr_start_acc: 0.9822, attr_end_acc: 0.9899, span_micro_p: 0.9829, span_micro_r: 0.9820, span_micro_f1: 0.9824, micro_p: 0.9887, micro_r: 0.9736, micro_f1: 0.9811
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: -0.0484, span_acc: 0.9948, attr_start_acc: 0.9820, attr_end_acc: 0.9895, span_micro_p: 0.9835, span_micro_r: 0.9825, span_micro_f1: 0.9830, micro_p: 0.9884, micro_r: 0.9734, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: -0.0406, span_acc: 0.9947, attr_start_acc: 0.9825, attr_end_acc: 0.9893, span_micro_p: 0.9831, span_micro_r: 0.9825, span_micro_f1: 0.9828, micro_p: 0.9881, micro_r: 0.9736, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: -0.0034, span_acc: 0.9948, attr_start_acc: 0.9826, attr_end_acc: 0.9889, span_micro_p: 0.9832, span_micro_r: 0.9823, span_micro_f1: 0.9828, micro_p: 0.9883, micro_r: 0.9734, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: -0.0274, span_acc: 0.9946, attr_start_acc: 0.9826, attr_end_acc: 0.9882, span_micro_p: 0.9827, span_micro_r: 0.9815, span_micro_f1: 0.9821, micro_p: 0.9882, micro_r: 0.9725, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.0608, span_acc: 0.9944, attr_start_acc: 0.9826, attr_end_acc: 0.9882, span_micro_p: 0.9822, span_micro_r: 0.9815, span_micro_f1: 0.9818, micro_p: 0.9875, micro_r: 0.9725, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: 0.0666, span_acc: 0.9943, attr_start_acc: 0.9822, attr_end_acc: 0.9879, span_micro_p: 0.9826, span_micro_r: 0.9814, span_micro_f1: 0.9820, micro_p: 0.9876, micro_r: 0.9722, micro_f1: 0.9798
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: 0.0223, span_acc: 0.9945, attr_start_acc: 0.9822, attr_end_acc: 0.9880, span_micro_p: 0.9829, span_micro_r: 0.9817, span_micro_f1: 0.9823, micro_p: 0.9877, micro_r: 0.9725, micro_f1: 0.9800
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: 0.0263, span_acc: 0.9943, attr_start_acc: 0.9820, attr_end_acc: 0.9878, span_micro_p: 0.9828, span_micro_r: 0.9809, span_micro_f1: 0.9818, micro_p: 0.9878, micro_r: 0.9721, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: 0.0048, span_acc: 0.9945, attr_start_acc: 0.9821, attr_end_acc: 0.9881, span_micro_p: 0.9834, span_micro_r: 0.9813, span_micro_f1: 0.9824, micro_p: 0.9881, micro_r: 0.9725, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: 0.0866, span_acc: 0.9946, attr_start_acc: 0.9824, attr_end_acc: 0.9880, span_micro_p: 0.9833, span_micro_r: 0.9815, span_micro_f1: 0.9824, micro_p: 0.9882, micro_r: 0.9727, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: 0.0721, span_acc: 0.9946, attr_start_acc: 0.9821, attr_end_acc: 0.9876, span_micro_p: 0.9834, span_micro_r: 0.9818, span_micro_f1: 0.9826, micro_p: 0.9879, micro_r: 0.9725, micro_f1: 0.9801
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: 0.0987, span_acc: 0.9948, attr_start_acc: 0.9820, attr_end_acc: 0.9875, span_micro_p: 0.9837, span_micro_r: 0.9824, span_micro_f1: 0.9830, micro_p: 0.9882, micro_r: 0.9724, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: 0.0951, span_acc: 0.9948, attr_start_acc: 0.9822, attr_end_acc: 0.9870, span_micro_p: 0.9837, span_micro_r: 0.9825, span_micro_f1: 0.9831, micro_p: 0.9883, micro_r: 0.9720, micro_f1: 0.9801
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: 0.1206, span_acc: 0.9947, attr_start_acc: 0.9817, attr_end_acc: 0.9866, span_micro_p: 0.9834, span_micro_r: 0.9822, span_micro_f1: 0.9828, micro_p: 0.9883, micro_r: 0.9715, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.1105, span_acc: 0.9946, attr_start_acc: 0.9817, attr_end_acc: 0.9862, span_micro_p: 0.9833, span_micro_r: 0.9820, span_micro_f1: 0.9827, micro_p: 0.9883, micro_r: 0.9713, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: 0.1013, span_acc: 0.9946, attr_start_acc: 0.9815, attr_end_acc: 0.9859, span_micro_p: 0.9834, span_micro_r: 0.9821, span_micro_f1: 0.9827, micro_p: 0.9879, micro_r: 0.9710, micro_f1: 0.9794
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.0971, span_acc: 0.9945, attr_start_acc: 0.9814, attr_end_acc: 0.9857, span_micro_p: 0.9830, span_micro_r: 0.9816, span_micro_f1: 0.9823, micro_p: 0.9876, micro_r: 0.9707, micro_f1: 0.9791
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: 0.0859, span_acc: 0.9946, attr_start_acc: 0.9814, attr_end_acc: 0.9856, span_micro_p: 0.9832, span_micro_r: 0.9819, span_micro_f1: 0.9825, micro_p: 0.9876, micro_r: 0.9706, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: 0.0953, span_acc: 0.9947, attr_start_acc: 0.9815, attr_end_acc: 0.9857, span_micro_p: 0.9835, span_micro_r: 0.9822, span_micro_f1: 0.9828, micro_p: 0.9876, micro_r: 0.9709, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.22 / 97.31 / 98.19), p: (95.24000000000001 / 96.15), r: (96.19 / 95.69), f1: (95.71 / 95.92)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.735874834122462, 'span_acc': 0.982235907153008, 'attr_start_acc': 0.9731182795698925, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9523809523809523, 'span_micro_r': 0.9619238476953907, 'span_micro_f1': 0.9571286141575274, 'micro_p': 0.9614604462474645, 'micro_r': 0.9569313593539704, 'micro_f1': 0.9591905564924115, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9465, 0.9501, 0.9483), 'TITLE': (0.9704, 0.9507, 0.9604), 'EDU': (0.9541, 0.9811, 0.9674), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9591905564924115 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.67 / 96.26 / 97.18), p: (94.8 / 96.25), r: (95.03 / 94.54), f1: (94.91000000000001 / 95.39)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 3.180486462963452, 'span_acc': 0.9766902119071644, 'attr_start_acc': 0.9625766871165644, 'attr_end_acc': 0.9717791411042945, 'span_micro_p': 0.9479804161566707, 'span_micro_r': 0.9503067484662576, 'span_micro_f1': 0.9491421568627451, 'micro_p': 0.962523422860712, 'micro_r': 0.945398773006135, 'micro_f1': 0.9538842463633551, 'category-p/r/f1': {'PRO': (0.9091, 0.9091, 0.9091), 'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9523, 0.9385, 0.9453), 'TITLE': (0.9602, 0.9365, 0.9482), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9538842463633551 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.2835, span_acc: 0.9952, attr_start_acc: 0.9734, attr_end_acc: 0.9787, span_micro_p: 0.9947, span_micro_r: 0.9841, span_micro_f1: 0.9894, micro_p: 0.9891, micro_r: 0.9628, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -0.5168, span_acc: 0.9954, attr_start_acc: 0.9886, attr_end_acc: 0.9772, span_micro_p: 0.9967, span_micro_r: 0.9903, span_micro_f1: 0.9935, micro_p: 0.9950, micro_r: 0.9724, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -0.4408, span_acc: 0.9965, attr_start_acc: 0.9882, attr_end_acc: 0.9827, span_micro_p: 0.9955, span_micro_r: 0.9910, span_micro_f1: 0.9932, micro_p: 0.9935, micro_r: 0.9755, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -0.4346, span_acc: 0.9966, attr_start_acc: 0.9893, attr_end_acc: 0.9859, span_micro_p: 0.9926, span_micro_r: 0.9893, span_micro_f1: 0.9910, micro_p: 0.9945, micro_r: 0.9785, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: -0.3768, span_acc: 0.9966, attr_start_acc: 0.9876, attr_end_acc: 0.9854, span_micro_p: 0.9909, span_micro_r: 0.9898, span_micro_f1: 0.9903, micro_p: 0.9913, micro_r: 0.9784, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.3471, span_acc: 0.9964, attr_start_acc: 0.9874, attr_end_acc: 0.9856, span_micro_p: 0.9893, span_micro_r: 0.9893, span_micro_f1: 0.9893, micro_p: 0.9900, micro_r: 0.9779, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.2803, span_acc: 0.9966, attr_start_acc: 0.9868, attr_end_acc: 0.9872, span_micro_p: 0.9891, span_micro_r: 0.9891, span_micro_f1: 0.9891, micro_p: 0.9911, micro_r: 0.9784, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.2810, span_acc: 0.9966, attr_start_acc: 0.9862, attr_end_acc: 0.9880, span_micro_p: 0.9897, span_micro_r: 0.9887, span_micro_f1: 0.9892, micro_p: 0.9911, micro_r: 0.9786, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.2996, span_acc: 0.9967, attr_start_acc: 0.9865, attr_end_acc: 0.9882, span_micro_p: 0.9890, span_micro_r: 0.9888, span_micro_f1: 0.9889, micro_p: 0.9913, micro_r: 0.9785, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.1856, span_acc: 0.9970, attr_start_acc: 0.9867, attr_end_acc: 0.9882, span_micro_p: 0.9899, span_micro_r: 0.9899, span_micro_f1: 0.9899, micro_p: 0.9905, micro_r: 0.9783, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: -0.0599, span_acc: 0.9965, attr_start_acc: 0.9853, attr_end_acc: 0.9875, span_micro_p: 0.9886, span_micro_r: 0.9875, span_micro_f1: 0.9881, micro_p: 0.9900, micro_r: 0.9760, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: -0.0948, span_acc: 0.9963, attr_start_acc: 0.9845, attr_end_acc: 0.9877, span_micro_p: 0.9872, span_micro_r: 0.9868, span_micro_f1: 0.9870, micro_p: 0.9896, micro_r: 0.9752, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: -0.1603, span_acc: 0.9965, attr_start_acc: 0.9851, attr_end_acc: 0.9879, span_micro_p: 0.9880, span_micro_r: 0.9874, span_micro_f1: 0.9877, micro_p: 0.9898, micro_r: 0.9760, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: -0.1677, span_acc: 0.9968, attr_start_acc: 0.9861, attr_end_acc: 0.9887, span_micro_p: 0.9886, span_micro_r: 0.9883, span_micro_f1: 0.9884, micro_p: 0.9903, micro_r: 0.9776, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: -0.1572, span_acc: 0.9964, attr_start_acc: 0.9852, attr_end_acc: 0.9883, span_micro_p: 0.9880, span_micro_r: 0.9867, span_micro_f1: 0.9874, micro_p: 0.9896, micro_r: 0.9765, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: -0.0974, span_acc: 0.9964, attr_start_acc: 0.9858, attr_end_acc: 0.9885, span_micro_p: 0.9880, span_micro_r: 0.9866, span_micro_f1: 0.9873, micro_p: 0.9898, micro_r: 0.9771, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: -0.0172, span_acc: 0.9964, attr_start_acc: 0.9858, attr_end_acc: 0.9884, span_micro_p: 0.9879, span_micro_r: 0.9865, span_micro_f1: 0.9872, micro_p: 0.9899, micro_r: 0.9772, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.3418, span_acc: 0.9962, attr_start_acc: 0.9858, attr_end_acc: 0.9884, span_micro_p: 0.9878, span_micro_r: 0.9864, span_micro_f1: 0.9871, micro_p: 0.9902, micro_r: 0.9772, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.3280, span_acc: 0.9964, attr_start_acc: 0.9863, attr_end_acc: 0.9886, span_micro_p: 0.9884, span_micro_r: 0.9871, span_micro_f1: 0.9878, micro_p: 0.9903, micro_r: 0.9777, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.3013, span_acc: 0.9963, attr_start_acc: 0.9863, attr_end_acc: 0.9884, span_micro_p: 0.9880, span_micro_r: 0.9869, span_micro_f1: 0.9874, micro_p: 0.9904, micro_r: 0.9774, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.2432, span_acc: 0.9963, attr_start_acc: 0.9862, attr_end_acc: 0.9883, span_micro_p: 0.9881, span_micro_r: 0.9868, span_micro_f1: 0.9875, micro_p: 0.9903, micro_r: 0.9774, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: 0.2079, span_acc: 0.9965, attr_start_acc: 0.9864, attr_end_acc: 0.9886, span_micro_p: 0.9886, span_micro_r: 0.9874, span_micro_f1: 0.9880, micro_p: 0.9906, micro_r: 0.9779, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: 0.1782, span_acc: 0.9966, attr_start_acc: 0.9865, attr_end_acc: 0.9890, span_micro_p: 0.9888, span_micro_r: 0.9877, span_micro_f1: 0.9883, micro_p: 0.9908, micro_r: 0.9783, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: 0.1766, span_acc: 0.9966, attr_start_acc: 0.9864, attr_end_acc: 0.9884, span_micro_p: 0.9891, span_micro_r: 0.9878, span_micro_f1: 0.9885, micro_p: 0.9910, micro_r: 0.9777, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: 0.1997, span_acc: 0.9966, attr_start_acc: 0.9862, attr_end_acc: 0.9883, span_micro_p: 0.9889, span_micro_r: 0.9875, span_micro_f1: 0.9882, micro_p: 0.9907, micro_r: 0.9773, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: 0.2227, span_acc: 0.9966, attr_start_acc: 0.9860, attr_end_acc: 0.9884, span_micro_p: 0.9887, span_micro_r: 0.9871, span_micro_f1: 0.9879, micro_p: 0.9910, micro_r: 0.9771, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: 0.2530, span_acc: 0.9966, attr_start_acc: 0.9860, attr_end_acc: 0.9885, span_micro_p: 0.9888, span_micro_r: 0.9872, span_micro_f1: 0.9880, micro_p: 0.9912, micro_r: 0.9773, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: 0.2526, span_acc: 0.9966, attr_start_acc: 0.9863, attr_end_acc: 0.9888, span_micro_p: 0.9888, span_micro_r: 0.9873, span_micro_f1: 0.9880, micro_p: 0.9911, micro_r: 0.9776, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: 0.2612, span_acc: 0.9965, attr_start_acc: 0.9864, attr_end_acc: 0.9885, span_micro_p: 0.9885, span_micro_r: 0.9870, span_micro_f1: 0.9877, micro_p: 0.9910, micro_r: 0.9775, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: 0.2509, span_acc: 0.9964, attr_start_acc: 0.9863, attr_end_acc: 0.9885, span_micro_p: 0.9880, span_micro_r: 0.9867, span_micro_f1: 0.9874, micro_p: 0.9907, micro_r: 0.9775, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: 0.2587, span_acc: 0.9965, attr_start_acc: 0.9865, attr_end_acc: 0.9888, span_micro_p: 0.9882, span_micro_r: 0.9870, span_micro_f1: 0.9876, micro_p: 0.9908, micro_r: 0.9778, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: 0.2698, span_acc: 0.9965, attr_start_acc: 0.9863, attr_end_acc: 0.9887, span_micro_p: 0.9882, span_micro_r: 0.9870, span_micro_f1: 0.9876, micro_p: 0.9908, micro_r: 0.9777, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.87 / 97.65 / 97.98), p: (96.14 / 96.41999999999999), r: (96.59 / 96.03), f1: (96.37 / 96.22)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 4.728960876137855, 'span_acc': 0.9887494078635718, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9798387096774194, 'span_micro_p': 0.961436170212766, 'span_micro_r': 0.9659318637274549, 'span_micro_f1': 0.9636787737420859, 'micro_p': 0.9641891891891892, 'micro_r': 0.9602960969044414, 'micro_f1': 0.9622387053270397, 'category-p/r/f1': {'LOC': (0.5, 1.0, 0.6667), 'PRO': (0.8571, 1.0, 0.9231), 'ORG': (0.9555, 0.9482, 0.9518), 'CONT': (1.0, 0.9091, 0.9524), 'TITLE': (0.9679, 0.9609, 0.9644), 'EDU': (0.972, 0.9811, 0.9765), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9622387053270397 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.31 / 96.81 / 97.06), p: (95.33 / 96.75), r: (95.28 / 94.85), f1: (95.30999999999999 / 95.78999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 2.340657599129767, 'span_acc': 0.9831483350151362, 'attr_start_acc': 0.9680981595092024, 'attr_end_acc': 0.9705521472392638, 'span_micro_p': 0.9533456108041743, 'span_micro_r': 0.9527607361963191, 'span_micro_f1': 0.953053083768027, 'micro_p': 0.967459324155194, 'micro_r': 0.9484662576687116, 'micro_f1': 0.9578686493184634, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'ORG': (0.9593, 0.9385, 0.9488), 'TITLE': (0.9642, 0.9417, 0.9528), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9578686493184634 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: -0.3488, span_acc: 0.9928, attr_start_acc: 0.9688, attr_end_acc: 0.9648, span_micro_p: 0.9804, span_micro_r: 0.9690, span_micro_f1: 0.9747, micro_p: 0.9798, micro_r: 0.9453, micro_f1: 0.9622
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -0.2001, span_acc: 0.9960, attr_start_acc: 0.9853, attr_end_acc: 0.9853, span_micro_p: 0.9853, span_micro_r: 0.9853, span_micro_f1: 0.9853, micro_p: 0.9851, micro_r: 0.9750, micro_f1: 0.9800
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -0.4818, span_acc: 0.9975, attr_start_acc: 0.9870, attr_end_acc: 0.9896, span_micro_p: 0.9905, span_micro_r: 0.9905, span_micro_f1: 0.9905, micro_p: 0.9886, micro_r: 0.9801, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.4461, span_acc: 0.9979, attr_start_acc: 0.9877, attr_end_acc: 0.9884, span_micro_p: 0.9929, span_micro_r: 0.9923, span_micro_f1: 0.9926, micro_p: 0.9902, micro_r: 0.9806, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.5378, span_acc: 0.9979, attr_start_acc: 0.9896, attr_end_acc: 0.9901, span_micro_p: 0.9921, span_micro_r: 0.9921, span_micro_f1: 0.9921, micro_p: 0.9910, micro_r: 0.9827, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -0.5579, span_acc: 0.9982, attr_start_acc: 0.9910, attr_end_acc: 0.9918, span_micro_p: 0.9935, span_micro_r: 0.9931, span_micro_f1: 0.9933, micro_p: 0.9918, micro_r: 0.9853, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: -0.4964, span_acc: 0.9981, attr_start_acc: 0.9900, attr_end_acc: 0.9917, span_micro_p: 0.9931, span_micro_r: 0.9931, span_micro_f1: 0.9931, micro_p: 0.9910, micro_r: 0.9841, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: -0.2730, span_acc: 0.9979, attr_start_acc: 0.9882, attr_end_acc: 0.9913, span_micro_p: 0.9913, span_micro_r: 0.9925, span_micro_f1: 0.9919, micro_p: 0.9882, micro_r: 0.9831, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: -0.0762, span_acc: 0.9976, attr_start_acc: 0.9881, attr_end_acc: 0.9914, span_micro_p: 0.9906, span_micro_r: 0.9917, span_micro_f1: 0.9912, micro_p: 0.9883, micro_r: 0.9827, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: -0.0050, span_acc: 0.9976, attr_start_acc: 0.9877, attr_end_acc: 0.9914, span_micro_p: 0.9915, span_micro_r: 0.9922, span_micro_f1: 0.9918, micro_p: 0.9894, micro_r: 0.9821, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: 0.0190, span_acc: 0.9975, attr_start_acc: 0.9871, attr_end_acc: 0.9911, span_micro_p: 0.9916, span_micro_r: 0.9916, span_micro_f1: 0.9916, micro_p: 0.9899, micro_r: 0.9817, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: 0.0081, span_acc: 0.9972, attr_start_acc: 0.9863, attr_end_acc: 0.9902, span_micro_p: 0.9908, span_micro_r: 0.9902, span_micro_f1: 0.9905, micro_p: 0.9896, micro_r: 0.9805, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: -0.0395, span_acc: 0.9972, attr_start_acc: 0.9857, attr_end_acc: 0.9892, span_micro_p: 0.9909, span_micro_r: 0.9900, span_micro_f1: 0.9905, micro_p: 0.9894, micro_r: 0.9794, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: -0.0731, span_acc: 0.9973, attr_start_acc: 0.9861, attr_end_acc: 0.9895, span_micro_p: 0.9913, span_micro_r: 0.9903, span_micro_f1: 0.9908, micro_p: 0.9899, micro_r: 0.9801, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: 0.0046, span_acc: 0.9974, attr_start_acc: 0.9863, attr_end_acc: 0.9901, span_micro_p: 0.9916, span_micro_r: 0.9907, span_micro_f1: 0.9912, micro_p: 0.9907, micro_r: 0.9805, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: -0.0124, span_acc: 0.9974, attr_start_acc: 0.9855, attr_end_acc: 0.9896, span_micro_p: 0.9915, span_micro_r: 0.9899, span_micro_f1: 0.9907, micro_p: 0.9909, micro_r: 0.9796, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: 0.0365, span_acc: 0.9972, attr_start_acc: 0.9844, attr_end_acc: 0.9890, span_micro_p: 0.9908, span_micro_r: 0.9891, span_micro_f1: 0.9899, micro_p: 0.9902, micro_r: 0.9786, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: 0.0456, span_acc: 0.9972, attr_start_acc: 0.9841, attr_end_acc: 0.9888, span_micro_p: 0.9908, span_micro_r: 0.9891, span_micro_f1: 0.9899, micro_p: 0.9899, micro_r: 0.9785, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: 0.0488, span_acc: 0.9971, attr_start_acc: 0.9843, attr_end_acc: 0.9891, span_micro_p: 0.9901, span_micro_r: 0.9884, span_micro_f1: 0.9893, micro_p: 0.9897, micro_r: 0.9785, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 0.1365, span_acc: 0.9970, attr_start_acc: 0.9847, attr_end_acc: 0.9893, span_micro_p: 0.9904, span_micro_r: 0.9886, span_micro_f1: 0.9895, micro_p: 0.9898, micro_r: 0.9790, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 0.2287, span_acc: 0.9970, attr_start_acc: 0.9846, attr_end_acc: 0.9893, span_micro_p: 0.9905, span_micro_r: 0.9885, span_micro_f1: 0.9895, micro_p: 0.9899, micro_r: 0.9790, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 0.2007, span_acc: 0.9971, attr_start_acc: 0.9850, attr_end_acc: 0.9894, span_micro_p: 0.9908, span_micro_r: 0.9886, span_micro_f1: 0.9897, micro_p: 0.9903, micro_r: 0.9792, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 0.1680, span_acc: 0.9971, attr_start_acc: 0.9849, attr_end_acc: 0.9895, span_micro_p: 0.9909, span_micro_r: 0.9887, span_micro_f1: 0.9898, micro_p: 0.9904, micro_r: 0.9793, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 0.1911, span_acc: 0.9971, attr_start_acc: 0.9852, attr_end_acc: 0.9889, span_micro_p: 0.9908, span_micro_r: 0.9888, span_micro_f1: 0.9898, micro_p: 0.9901, micro_r: 0.9790, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.1675, span_acc: 0.9970, attr_start_acc: 0.9851, attr_end_acc: 0.9888, span_micro_p: 0.9908, span_micro_r: 0.9886, span_micro_f1: 0.9897, micro_p: 0.9901, micro_r: 0.9789, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: 0.1494, span_acc: 0.9971, attr_start_acc: 0.9849, attr_end_acc: 0.9887, span_micro_p: 0.9910, span_micro_r: 0.9888, span_micro_f1: 0.9899, micro_p: 0.9900, micro_r: 0.9785, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 0.2688, span_acc: 0.9969, attr_start_acc: 0.9850, attr_end_acc: 0.9888, span_micro_p: 0.9911, span_micro_r: 0.9887, span_micro_f1: 0.9899, micro_p: 0.9902, micro_r: 0.9787, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 0.2360, span_acc: 0.9970, attr_start_acc: 0.9853, attr_end_acc: 0.9889, span_micro_p: 0.9913, span_micro_r: 0.9889, span_micro_f1: 0.9901, micro_p: 0.9904, micro_r: 0.9792, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: 0.2212, span_acc: 0.9971, attr_start_acc: 0.9858, attr_end_acc: 0.9894, span_micro_p: 0.9917, span_micro_r: 0.9894, span_micro_f1: 0.9905, micro_p: 0.9908, micro_r: 0.9800, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: 0.2349, span_acc: 0.9972, attr_start_acc: 0.9863, attr_end_acc: 0.9897, span_micro_p: 0.9918, span_micro_r: 0.9897, span_micro_f1: 0.9907, micro_p: 0.9910, micro_r: 0.9805, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 0.2715, span_acc: 0.9970, attr_start_acc: 0.9860, attr_end_acc: 0.9896, span_micro_p: 0.9913, span_micro_r: 0.9892, span_micro_f1: 0.9903, micro_p: 0.9905, micro_r: 0.9801, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 0.2995, span_acc: 0.9969, attr_start_acc: 0.9861, attr_end_acc: 0.9895, span_micro_p: 0.9912, span_micro_r: 0.9890, span_micro_f1: 0.9901, micro_p: 0.9905, micro_r: 0.9802, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.5 / 97.58 / 98.45), p: (94.69 / 96.09), r: (96.46000000000001 / 96.03), f1: (95.57 / 96.06)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 9.048462267570825, 'span_acc': 0.9849597347228801, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9845430107526881, 'span_micro_p': 0.9468852459016394, 'span_micro_r': 0.9645958583834335, 'span_micro_f1': 0.9556585043017869, 'micro_p': 0.960942760942761, 'micro_r': 0.9602960969044414, 'micro_f1': 0.9606193200942443, 'category-p/r/f1': {'PRO': (0.9444, 0.9444, 0.9444), 'ORG': (0.9451, 0.9578, 0.9514), 'TITLE': (0.9648, 0.9522, 0.9585), 'EDU': (0.972, 0.9811, 0.9765), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9606193200942443 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.27 / 97.11999999999999 / 97.67), p: (94.49 / 95.88), r: (95.71 / 95.58), f1: (95.09 / 95.73)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 5.463888350897615, 'span_acc': 0.982744702320888, 'attr_start_acc': 0.9711656441717792, 'attr_end_acc': 0.9766871165644172, 'span_micro_p': 0.9448818897637795, 'span_micro_r': 0.9570552147239264, 'span_micro_f1': 0.9509295946357819, 'micro_p': 0.9587692307692308, 'micro_r': 0.9558282208588957, 'micro_f1': 0.9572964669738864, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9327, 0.953, 0.9427), 'TITLE': (0.9656, 0.9456, 0.9555), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9572964669738864 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: 0.7144, span_acc: 1.0000, attr_start_acc: 0.9928, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9928, micro_f1: 0.9964
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: 0.3975, span_acc: 0.9993, attr_start_acc: 0.9928, attr_end_acc: 0.9957, span_micro_p: 0.9972, span_micro_r: 0.9972, span_micro_f1: 0.9972, micro_p: 0.9971, micro_r: 0.9886, micro_f1: 0.9928
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: 0.1254, span_acc: 0.9993, attr_start_acc: 0.9913, attr_end_acc: 0.9939, span_micro_p: 0.9974, span_micro_r: 0.9965, span_micro_f1: 0.9970, micro_p: 0.9956, micro_r: 0.9878, micro_f1: 0.9917
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: 0.0557, span_acc: 0.9995, attr_start_acc: 0.9904, attr_end_acc: 0.9942, span_micro_p: 0.9981, span_micro_r: 0.9975, span_micro_f1: 0.9978, micro_p: 0.9961, micro_r: 0.9878, micro_f1: 0.9919
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: 0.2554, span_acc: 0.9996, attr_start_acc: 0.9922, attr_end_acc: 0.9953, span_micro_p: 0.9985, span_micro_r: 0.9979, span_micro_f1: 0.9982, micro_p: 0.9969, micro_r: 0.9901, micro_f1: 0.9935
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: 0.2476, span_acc: 0.9996, attr_start_acc: 0.9911, attr_end_acc: 0.9936, span_micro_p: 0.9983, span_micro_r: 0.9979, span_micro_f1: 0.9981, micro_p: 0.9957, micro_r: 0.9889, micro_f1: 0.9923
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: 1.1430, span_acc: 0.9988, attr_start_acc: 0.9902, attr_end_acc: 0.9924, span_micro_p: 0.9978, span_micro_r: 0.9957, span_micro_f1: 0.9968, micro_p: 0.9956, micro_r: 0.9880, micro_f1: 0.9918
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 1.7782, span_acc: 0.9981, attr_start_acc: 0.9876, attr_end_acc: 0.9911, span_micro_p: 0.9950, span_micro_r: 0.9943, span_micro_f1: 0.9947, micro_p: 0.9936, micro_r: 0.9854, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 1.4865, span_acc: 0.9982, attr_start_acc: 0.9883, attr_end_acc: 0.9912, span_micro_p: 0.9952, span_micro_r: 0.9946, span_micro_f1: 0.9949, micro_p: 0.9937, micro_r: 0.9857, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 1.4439, span_acc: 0.9983, attr_start_acc: 0.9888, attr_end_acc: 0.9914, span_micro_p: 0.9955, span_micro_r: 0.9950, span_micro_f1: 0.9952, micro_p: 0.9936, micro_r: 0.9863, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 1.1873, span_acc: 0.9984, attr_start_acc: 0.9895, attr_end_acc: 0.9911, span_micro_p: 0.9955, span_micro_r: 0.9952, span_micro_f1: 0.9953, micro_p: 0.9938, micro_r: 0.9862, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 1.7000, span_acc: 0.9983, attr_start_acc: 0.9901, attr_end_acc: 0.9914, span_micro_p: 0.9952, span_micro_r: 0.9946, span_micro_f1: 0.9949, micro_p: 0.9941, micro_r: 0.9865, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 1.5683, span_acc: 0.9983, attr_start_acc: 0.9902, attr_end_acc: 0.9916, span_micro_p: 0.9950, span_micro_r: 0.9946, span_micro_f1: 0.9948, micro_p: 0.9937, micro_r: 0.9865, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 1.9358, span_acc: 0.9984, attr_start_acc: 0.9906, attr_end_acc: 0.9921, span_micro_p: 0.9952, span_micro_r: 0.9946, span_micro_f1: 0.9949, micro_p: 0.9936, micro_r: 0.9868, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 1.8637, span_acc: 0.9981, attr_start_acc: 0.9904, attr_end_acc: 0.9921, span_micro_p: 0.9940, span_micro_r: 0.9932, span_micro_f1: 0.9936, micro_p: 0.9931, micro_r: 0.9861, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 1.7638, span_acc: 0.9980, attr_start_acc: 0.9905, attr_end_acc: 0.9916, span_micro_p: 0.9935, span_micro_r: 0.9932, span_micro_f1: 0.9933, micro_p: 0.9929, micro_r: 0.9858, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 1.7990, span_acc: 0.9981, attr_start_acc: 0.9909, attr_end_acc: 0.9919, span_micro_p: 0.9934, span_micro_r: 0.9931, span_micro_f1: 0.9933, micro_p: 0.9932, micro_r: 0.9863, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 1.6628, span_acc: 0.9980, attr_start_acc: 0.9903, attr_end_acc: 0.9916, span_micro_p: 0.9930, span_micro_r: 0.9927, span_micro_f1: 0.9929, micro_p: 0.9928, micro_r: 0.9859, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 1.5438, span_acc: 0.9980, attr_start_acc: 0.9906, attr_end_acc: 0.9921, span_micro_p: 0.9930, span_micro_r: 0.9928, span_micro_f1: 0.9929, micro_p: 0.9929, micro_r: 0.9865, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 1.4471, span_acc: 0.9981, attr_start_acc: 0.9907, attr_end_acc: 0.9921, span_micro_p: 0.9933, span_micro_r: 0.9929, span_micro_f1: 0.9931, micro_p: 0.9929, micro_r: 0.9865, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 1.4119, span_acc: 0.9981, attr_start_acc: 0.9908, attr_end_acc: 0.9923, span_micro_p: 0.9933, span_micro_r: 0.9929, span_micro_f1: 0.9931, micro_p: 0.9932, micro_r: 0.9867, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 1.5410, span_acc: 0.9980, attr_start_acc: 0.9905, attr_end_acc: 0.9922, span_micro_p: 0.9931, span_micro_r: 0.9927, span_micro_f1: 0.9929, micro_p: 0.9930, micro_r: 0.9863, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 1.6559, span_acc: 0.9978, attr_start_acc: 0.9900, attr_end_acc: 0.9922, span_micro_p: 0.9925, span_micro_r: 0.9923, span_micro_f1: 0.9924, micro_p: 0.9928, micro_r: 0.9858, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 1.5932, span_acc: 0.9979, attr_start_acc: 0.9905, attr_end_acc: 0.9926, span_micro_p: 0.9926, span_micro_r: 0.9924, span_micro_f1: 0.9925, micro_p: 0.9929, micro_r: 0.9863, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 1.5662, span_acc: 0.9979, attr_start_acc: 0.9904, attr_end_acc: 0.9925, span_micro_p: 0.9928, span_micro_r: 0.9925, span_micro_f1: 0.9926, micro_p: 0.9929, micro_r: 0.9861, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 1.5258, span_acc: 0.9979, attr_start_acc: 0.9904, attr_end_acc: 0.9926, span_micro_p: 0.9928, span_micro_r: 0.9924, span_micro_f1: 0.9926, micro_p: 0.9931, micro_r: 0.9862, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 1.5342, span_acc: 0.9977, attr_start_acc: 0.9904, attr_end_acc: 0.9924, span_micro_p: 0.9926, span_micro_r: 0.9916, span_micro_f1: 0.9921, micro_p: 0.9930, micro_r: 0.9858, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 1.5238, span_acc: 0.9977, attr_start_acc: 0.9903, attr_end_acc: 0.9922, span_micro_p: 0.9926, span_micro_r: 0.9916, span_micro_f1: 0.9921, micro_p: 0.9929, micro_r: 0.9856, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 1.5670, span_acc: 0.9977, attr_start_acc: 0.9902, attr_end_acc: 0.9917, span_micro_p: 0.9925, span_micro_r: 0.9916, span_micro_f1: 0.9921, micro_p: 0.9927, micro_r: 0.9850, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 1.5164, span_acc: 0.9976, attr_start_acc: 0.9902, attr_end_acc: 0.9915, span_micro_p: 0.9923, span_micro_r: 0.9915, span_micro_f1: 0.9919, micro_p: 0.9926, micro_r: 0.9848, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 1.4720, span_acc: 0.9977, attr_start_acc: 0.9903, attr_end_acc: 0.9915, span_micro_p: 0.9924, span_micro_r: 0.9916, span_micro_f1: 0.9920, micro_p: 0.9927, micro_r: 0.9849, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 1.4602, span_acc: 0.9977, attr_start_acc: 0.9901, attr_end_acc: 0.9915, span_micro_p: 0.9925, span_micro_r: 0.9916, span_micro_f1: 0.9921, micro_p: 0.9927, micro_r: 0.9848, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.63 / 97.85000000000001 / 98.25), p: (95.71 / 96.17), r: (96.86 / 96.43), f1: (96.28 / 96.3)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 12.964640366335924, 'span_acc': 0.9862624348649929, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9825268817204301, 'span_micro_p': 0.9570957095709571, 'span_micro_r': 0.9686038744154977, 'span_micro_f1': 0.9628154050464808, 'micro_p': 0.961744966442953, 'micro_r': 0.9643337819650067, 'micro_f1': 0.9630376344086021, 'category-p/r/f1': {'PRO': (0.8571, 1.0, 0.9231), 'ORG': (0.9484, 0.952, 0.9502), 'TITLE': (0.9666, 0.9638, 0.9652), 'EDU': (0.981, 0.9717, 0.9763), 'NAME': (0.9808, 1.0, 0.9903), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9630376344086021 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.92 / 96.87 / 97.55), p: (95.6 / 96.47), r: (96.00999999999999 / 95.52000000000001), f1: (95.81 / 95.99)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 9.35504743288148, 'span_acc': 0.979212916246216, 'attr_start_acc': 0.9687116564417177, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.9560171044593769, 'span_micro_r': 0.9601226993865031, 'span_micro_f1': 0.958065503520049, 'micro_p': 0.9646840148698885, 'micro_r': 0.9552147239263804, 'micro_f1': 0.9599260172626387, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.9143, 0.9697, 0.9412), 'ORG': (0.9544, 0.9458, 0.9501), 'TITLE': (0.9634, 0.9534, 0.9584), 'EDU': (0.9907, 0.9554, 0.9727), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9599260172626387 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: 0.7995, span_acc: 0.9995, attr_start_acc: 0.9969, attr_end_acc: 0.9939, span_micro_p: 1.0000, span_micro_r: 0.9970, span_micro_f1: 0.9985, micro_p: 1.0000, micro_r: 0.9908, micro_f1: 0.9954
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: 0.5530, span_acc: 0.9980, attr_start_acc: 0.9930, attr_end_acc: 0.9903, span_micro_p: 0.9972, span_micro_r: 0.9903, span_micro_f1: 0.9938, micro_p: 0.9958, micro_r: 0.9875, micro_f1: 0.9916
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 1.5967, span_acc: 0.9973, attr_start_acc: 0.9893, attr_end_acc: 0.9885, span_micro_p: 0.9938, span_micro_r: 0.9859, span_micro_f1: 0.9898, micro_p: 0.9937, micro_r: 0.9813, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: 0.8839, span_acc: 0.9978, attr_start_acc: 0.9873, attr_end_acc: 0.9867, span_micro_p: 0.9949, span_micro_r: 0.9887, span_micro_f1: 0.9918, micro_p: 0.9929, micro_r: 0.9798, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 1.4431, span_acc: 0.9974, attr_start_acc: 0.9889, attr_end_acc: 0.9884, span_micro_p: 0.9950, span_micro_r: 0.9895, span_micro_f1: 0.9922, micro_p: 0.9918, micro_r: 0.9813, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 1.5933, span_acc: 0.9973, attr_start_acc: 0.9887, attr_end_acc: 0.9895, span_micro_p: 0.9937, span_micro_r: 0.9892, span_micro_f1: 0.9915, micro_p: 0.9907, micro_r: 0.9824, micro_f1: 0.9865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 1.3134, span_acc: 0.9970, attr_start_acc: 0.9884, attr_end_acc: 0.9887, span_micro_p: 0.9923, span_micro_r: 0.9870, span_micro_f1: 0.9896, micro_p: 0.9911, micro_r: 0.9809, micro_f1: 0.9860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 1.7582, span_acc: 0.9973, attr_start_acc: 0.9896, attr_end_acc: 0.9896, span_micro_p: 0.9930, span_micro_r: 0.9884, span_micro_f1: 0.9907, micro_p: 0.9917, micro_r: 0.9822, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 1.6132, span_acc: 0.9975, attr_start_acc: 0.9896, attr_end_acc: 0.9901, span_micro_p: 0.9936, span_micro_r: 0.9896, span_micro_f1: 0.9916, micro_p: 0.9922, micro_r: 0.9826, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 1.4208, span_acc: 0.9976, attr_start_acc: 0.9897, attr_end_acc: 0.9906, span_micro_p: 0.9938, span_micro_r: 0.9897, span_micro_f1: 0.9918, micro_p: 0.9925, micro_r: 0.9834, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 1.3832, span_acc: 0.9978, attr_start_acc: 0.9899, attr_end_acc: 0.9906, span_micro_p: 0.9943, span_micro_r: 0.9906, span_micro_f1: 0.9925, micro_p: 0.9931, micro_r: 0.9840, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 1.2604, span_acc: 0.9980, attr_start_acc: 0.9900, attr_end_acc: 0.9908, span_micro_p: 0.9944, span_micro_r: 0.9913, span_micro_f1: 0.9928, micro_p: 0.9930, micro_r: 0.9844, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 1.2104, span_acc: 0.9980, attr_start_acc: 0.9899, attr_end_acc: 0.9908, span_micro_p: 0.9940, span_micro_r: 0.9915, span_micro_f1: 0.9927, micro_p: 0.9925, micro_r: 0.9845, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 1.1150, span_acc: 0.9981, attr_start_acc: 0.9903, attr_end_acc: 0.9914, span_micro_p: 0.9945, span_micro_r: 0.9921, span_micro_f1: 0.9933, micro_p: 0.9930, micro_r: 0.9852, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 1.0683, span_acc: 0.9980, attr_start_acc: 0.9903, attr_end_acc: 0.9902, span_micro_p: 0.9944, span_micro_r: 0.9920, span_micro_f1: 0.9932, micro_p: 0.9930, micro_r: 0.9842, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 1.1938, span_acc: 0.9981, attr_start_acc: 0.9902, attr_end_acc: 0.9904, span_micro_p: 0.9945, span_micro_r: 0.9924, span_micro_f1: 0.9934, micro_p: 0.9932, micro_r: 0.9842, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 1.2463, span_acc: 0.9980, attr_start_acc: 0.9894, attr_end_acc: 0.9903, span_micro_p: 0.9942, span_micro_r: 0.9921, span_micro_f1: 0.9932, micro_p: 0.9933, micro_r: 0.9833, micro_f1: 0.9883
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 1.1851, span_acc: 0.9981, attr_start_acc: 0.9898, attr_end_acc: 0.9906, span_micro_p: 0.9946, span_micro_r: 0.9925, span_micro_f1: 0.9935, micro_p: 0.9937, micro_r: 0.9838, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 1.1589, span_acc: 0.9981, attr_start_acc: 0.9902, attr_end_acc: 0.9903, span_micro_p: 0.9946, span_micro_r: 0.9927, span_micro_f1: 0.9937, micro_p: 0.9939, micro_r: 0.9838, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 1.0756, span_acc: 0.9982, attr_start_acc: 0.9902, attr_end_acc: 0.9906, span_micro_p: 0.9949, span_micro_r: 0.9931, span_micro_f1: 0.9940, micro_p: 0.9941, micro_r: 0.9841, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 1.1138, span_acc: 0.9983, attr_start_acc: 0.9903, attr_end_acc: 0.9907, span_micro_p: 0.9950, span_micro_r: 0.9933, span_micro_f1: 0.9941, micro_p: 0.9942, micro_r: 0.9842, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 1.1490, span_acc: 0.9983, attr_start_acc: 0.9905, attr_end_acc: 0.9899, span_micro_p: 0.9952, span_micro_r: 0.9933, span_micro_f1: 0.9942, micro_p: 0.9944, micro_r: 0.9836, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 1.1429, span_acc: 0.9983, attr_start_acc: 0.9905, attr_end_acc: 0.9900, span_micro_p: 0.9952, span_micro_r: 0.9934, span_micro_f1: 0.9943, micro_p: 0.9940, micro_r: 0.9838, micro_f1: 0.9889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 1.1121, span_acc: 0.9982, attr_start_acc: 0.9904, attr_end_acc: 0.9899, span_micro_p: 0.9949, span_micro_r: 0.9931, span_micro_f1: 0.9940, micro_p: 0.9939, micro_r: 0.9835, micro_f1: 0.9887
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 1.1351, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9902, span_micro_p: 0.9950, span_micro_r: 0.9933, span_micro_f1: 0.9942, micro_p: 0.9941, micro_r: 0.9841, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 1.0942, span_acc: 0.9983, attr_start_acc: 0.9908, attr_end_acc: 0.9905, span_micro_p: 0.9951, span_micro_r: 0.9932, span_micro_f1: 0.9942, micro_p: 0.9942, micro_r: 0.9843, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 1.1110, span_acc: 0.9983, attr_start_acc: 0.9908, attr_end_acc: 0.9907, span_micro_p: 0.9953, span_micro_r: 0.9935, span_micro_f1: 0.9944, micro_p: 0.9943, micro_r: 0.9846, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 1.1566, span_acc: 0.9984, attr_start_acc: 0.9907, attr_end_acc: 0.9908, span_micro_p: 0.9953, span_micro_r: 0.9934, span_micro_f1: 0.9944, micro_p: 0.9943, micro_r: 0.9846, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 1.2599, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9909, span_micro_p: 0.9951, span_micro_r: 0.9932, span_micro_f1: 0.9942, micro_p: 0.9941, micro_r: 0.9846, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 1.4273, span_acc: 0.9983, attr_start_acc: 0.9907, attr_end_acc: 0.9908, span_micro_p: 0.9951, span_micro_r: 0.9932, span_micro_f1: 0.9942, micro_p: 0.9941, micro_r: 0.9846, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 1.4112, span_acc: 0.9983, attr_start_acc: 0.9906, attr_end_acc: 0.9907, span_micro_p: 0.9950, span_micro_r: 0.9932, span_micro_f1: 0.9941, micro_p: 0.9938, micro_r: 0.9845, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 1.4552, span_acc: 0.9983, attr_start_acc: 0.9906, attr_end_acc: 0.9906, span_micro_p: 0.9950, span_micro_r: 0.9933, span_micro_f1: 0.9941, micro_p: 0.9938, micro_r: 0.9843, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.76 / 97.38 / 98.25), p: (95.88 / 96.04), r: (96.46000000000001 / 96.3), f1: (96.17 / 96.17)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 23.733263525798048, 'span_acc': 0.9875651350071056, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9825268817204301, 'span_micro_p': 0.9588313413014609, 'span_micro_r': 0.9645958583834335, 'span_micro_f1': 0.9617049617049618, 'micro_p': 0.9604026845637584, 'micro_r': 0.9629878869448183, 'micro_f1': 0.9616935483870968, 'category-p/r/f1': {'PRO': (0.9444, 0.9444, 0.9444), 'ORG': (0.9484, 0.952, 0.9502), 'TITLE': (0.9637, 0.9609, 0.9623), 'EDU': (0.9545, 0.9906, 0.9722), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9616935483870968 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.41 / 96.87 / 97.61), p: (95.52000000000001 / 96.05), r: (95.58 / 95.39999999999999), f1: (95.55 / 95.72)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 16.292014876251702, 'span_acc': 0.9840565085771947, 'attr_start_acc': 0.9687116564417177, 'attr_end_acc': 0.9760736196319019, 'span_micro_p': 0.9552421827099938, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9555351119288562, 'micro_p': 0.9604694255713403, 'micro_r': 0.9539877300613497, 'micro_f1': 0.9572176054170515, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9418, 0.9367, 0.9392), 'PRO': (0.9412, 0.9697, 0.9552), 'TITLE': (0.962, 0.9521, 0.957), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9572176054170515 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: 1.5316, span_acc: 0.9991, attr_start_acc: 0.9892, attr_end_acc: 0.9919, span_micro_p: 0.9973, span_micro_r: 0.9947, span_micro_f1: 0.9960, micro_p: 0.9946, micro_r: 0.9892, micro_f1: 0.9919
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: 3.9144, span_acc: 0.9984, attr_start_acc: 0.9880, attr_end_acc: 0.9933, span_micro_p: 0.9921, span_micro_r: 0.9934, span_micro_f1: 0.9927, micro_p: 0.9893, micro_r: 0.9866, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 2.3395, span_acc: 0.9985, attr_start_acc: 0.9904, attr_end_acc: 0.9948, span_micro_p: 0.9931, span_micro_r: 0.9948, span_micro_f1: 0.9940, micro_p: 0.9904, micro_r: 0.9887, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 2.3143, span_acc: 0.9985, attr_start_acc: 0.9913, attr_end_acc: 0.9944, span_micro_p: 0.9926, span_micro_r: 0.9939, span_micro_f1: 0.9933, micro_p: 0.9913, micro_r: 0.9876, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 2.4400, span_acc: 0.9987, attr_start_acc: 0.9917, attr_end_acc: 0.9951, span_micro_p: 0.9937, span_micro_r: 0.9942, span_micro_f1: 0.9940, micro_p: 0.9927, micro_r: 0.9883, micro_f1: 0.9905
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 2.0542, span_acc: 0.9989, attr_start_acc: 0.9924, attr_end_acc: 0.9948, span_micro_p: 0.9949, span_micro_r: 0.9953, span_micro_f1: 0.9951, micro_p: 0.9932, micro_r: 0.9893, micro_f1: 0.9912
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 1.7518, span_acc: 0.9990, attr_start_acc: 0.9932, attr_end_acc: 0.9928, span_micro_p: 0.9949, span_micro_r: 0.9956, span_micro_f1: 0.9952, micro_p: 0.9938, micro_r: 0.9880, micro_f1: 0.9909
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 1.6884, span_acc: 0.9991, attr_start_acc: 0.9937, attr_end_acc: 0.9925, span_micro_p: 0.9955, span_micro_r: 0.9961, span_micro_f1: 0.9958, micro_p: 0.9945, micro_r: 0.9879, micro_f1: 0.9912
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 2.1104, span_acc: 0.9990, attr_start_acc: 0.9925, attr_end_acc: 0.9917, span_micro_p: 0.9955, span_micro_r: 0.9955, span_micro_f1: 0.9955, micro_p: 0.9943, micro_r: 0.9871, micro_f1: 0.9907
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 2.2061, span_acc: 0.9990, attr_start_acc: 0.9929, attr_end_acc: 0.9919, span_micro_p: 0.9960, span_micro_r: 0.9957, span_micro_f1: 0.9959, micro_p: 0.9950, micro_r: 0.9876, micro_f1: 0.9913
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 2.0685, span_acc: 0.9990, attr_start_acc: 0.9926, attr_end_acc: 0.9913, span_micro_p: 0.9959, span_micro_r: 0.9955, span_micro_f1: 0.9957, micro_p: 0.9954, micro_r: 0.9870, micro_f1: 0.9912
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 3.0552, span_acc: 0.9984, attr_start_acc: 0.9916, attr_end_acc: 0.9914, span_micro_p: 0.9946, span_micro_r: 0.9944, span_micro_f1: 0.9945, micro_p: 0.9943, micro_r: 0.9860, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 2.8644, span_acc: 0.9984, attr_start_acc: 0.9917, attr_end_acc: 0.9915, span_micro_p: 0.9945, span_micro_r: 0.9941, span_micro_f1: 0.9943, micro_p: 0.9946, micro_r: 0.9860, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 2.6959, span_acc: 0.9985, attr_start_acc: 0.9918, attr_end_acc: 0.9919, span_micro_p: 0.9949, span_micro_r: 0.9946, span_micro_f1: 0.9947, micro_p: 0.9948, micro_r: 0.9863, micro_f1: 0.9905
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 2.4681, span_acc: 0.9985, attr_start_acc: 0.9912, attr_end_acc: 0.9918, span_micro_p: 0.9949, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9950, micro_r: 0.9856, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 2.3285, span_acc: 0.9985, attr_start_acc: 0.9911, attr_end_acc: 0.9919, span_micro_p: 0.9949, span_micro_r: 0.9943, span_micro_f1: 0.9946, micro_p: 0.9953, micro_r: 0.9854, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 2.2511, span_acc: 0.9985, attr_start_acc: 0.9906, attr_end_acc: 0.9920, span_micro_p: 0.9948, span_micro_r: 0.9944, span_micro_f1: 0.9946, micro_p: 0.9952, micro_r: 0.9851, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 2.2203, span_acc: 0.9986, attr_start_acc: 0.9908, attr_end_acc: 0.9923, span_micro_p: 0.9950, span_micro_r: 0.9946, span_micro_f1: 0.9948, micro_p: 0.9952, micro_r: 0.9856, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 2.0534, span_acc: 0.9986, attr_start_acc: 0.9907, attr_end_acc: 0.9919, span_micro_p: 0.9950, span_micro_r: 0.9947, span_micro_f1: 0.9949, micro_p: 0.9950, micro_r: 0.9853, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 2.1065, span_acc: 0.9986, attr_start_acc: 0.9908, attr_end_acc: 0.9918, span_micro_p: 0.9950, span_micro_r: 0.9946, span_micro_f1: 0.9948, micro_p: 0.9950, micro_r: 0.9854, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 2.1459, span_acc: 0.9986, attr_start_acc: 0.9908, attr_end_acc: 0.9919, span_micro_p: 0.9950, span_micro_r: 0.9945, span_micro_f1: 0.9948, micro_p: 0.9950, micro_r: 0.9855, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 2.0072, span_acc: 0.9987, attr_start_acc: 0.9911, attr_end_acc: 0.9920, span_micro_p: 0.9952, span_micro_r: 0.9948, span_micro_f1: 0.9950, micro_p: 0.9950, micro_r: 0.9858, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 1.8543, span_acc: 0.9987, attr_start_acc: 0.9910, attr_end_acc: 0.9921, span_micro_p: 0.9954, span_micro_r: 0.9950, span_micro_f1: 0.9952, micro_p: 0.9950, micro_r: 0.9859, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 2.0035, span_acc: 0.9987, attr_start_acc: 0.9907, attr_end_acc: 0.9922, span_micro_p: 0.9955, span_micro_r: 0.9951, span_micro_f1: 0.9953, micro_p: 0.9950, micro_r: 0.9857, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 2.2756, span_acc: 0.9987, attr_start_acc: 0.9901, attr_end_acc: 0.9921, span_micro_p: 0.9954, span_micro_r: 0.9950, span_micro_f1: 0.9952, micro_p: 0.9949, micro_r: 0.9853, micro_f1: 0.9901
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 2.3309, span_acc: 0.9987, attr_start_acc: 0.9901, attr_end_acc: 0.9919, span_micro_p: 0.9955, span_micro_r: 0.9950, span_micro_f1: 0.9953, micro_p: 0.9950, micro_r: 0.9851, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 2.6415, span_acc: 0.9988, attr_start_acc: 0.9899, attr_end_acc: 0.9917, span_micro_p: 0.9957, span_micro_r: 0.9952, span_micro_f1: 0.9954, micro_p: 0.9948, micro_r: 0.9849, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 2.5270, span_acc: 0.9988, attr_start_acc: 0.9900, attr_end_acc: 0.9919, span_micro_p: 0.9957, span_micro_r: 0.9953, span_micro_f1: 0.9955, micro_p: 0.9950, micro_r: 0.9851, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 2.5912, span_acc: 0.9988, attr_start_acc: 0.9896, attr_end_acc: 0.9917, span_micro_p: 0.9959, span_micro_r: 0.9954, span_micro_f1: 0.9956, micro_p: 0.9950, micro_r: 0.9847, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 2.5696, span_acc: 0.9988, attr_start_acc: 0.9895, attr_end_acc: 0.9918, span_micro_p: 0.9957, span_micro_r: 0.9954, span_micro_f1: 0.9956, micro_p: 0.9951, micro_r: 0.9846, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 2.5438, span_acc: 0.9989, attr_start_acc: 0.9888, attr_end_acc: 0.9917, span_micro_p: 0.9959, span_micro_r: 0.9956, span_micro_f1: 0.9957, micro_p: 0.9952, micro_r: 0.9838, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 2.4646, span_acc: 0.9988, attr_start_acc: 0.9885, attr_end_acc: 0.9917, span_micro_p: 0.9958, span_micro_r: 0.9954, span_micro_f1: 0.9956, micro_p: 0.9952, micro_r: 0.9835, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.56 / 96.84 / 97.24000000000001), p: (95.97 / 96.89999999999999), r: (95.39 / 94.67999999999999), f1: (95.67999999999999 / 95.78)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 28.824613312150696, 'span_acc': 0.9855518711511132, 'attr_start_acc': 0.9684139784946236, 'attr_end_acc': 0.9724462365591398, 'span_micro_p': 0.9596774193548387, 'span_micro_r': 0.9539078156312625, 'span_micro_f1': 0.95678391959799, 'micro_p': 0.96900826446281, 'micro_r': 0.9468371467025573, 'micro_f1': 0.9577944179714092, 'category-p/r/f1': {'PRO': (0.9412, 0.8889, 0.9143), 'ORG': (0.9495, 0.9386, 0.944), 'EDU': (0.9533, 0.9623, 0.9578), 'TITLE': (0.9818, 0.9406, 0.9608), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9577944179714092 / 0.9638879514006075
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.55000000000001 / 96.5 / 97.42), p: (95.35 / 96.63000000000001), r: (95.64 / 94.85), f1: (95.5 / 95.73)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 21.708396127388912, 'span_acc': 0.9854692230070635, 'attr_start_acc': 0.9650306748466257, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9535168195718654, 'span_micro_r': 0.9564417177914111, 'span_micro_f1': 0.9549770290964777, 'micro_p': 0.96625, 'micro_r': 0.9484662576687116, 'micro_f1': 0.9572755417956657, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'PRO': (0.9394, 0.9394, 0.9394), 'ORG': (0.9458, 0.9458, 0.9458), 'TITLE': (0.9718, 0.9378, 0.9545), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9572755417956657 / 0.9613601236476044
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.963888
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.961360
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9809283551967709
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9699386503067484
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9699386503067484
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9598517603458925
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9533742331288344
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9566020313942751
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9669781931464174
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9521472392638037
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.9595054095826894
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9562, 0.9476, 0.9519), 'TITLE': (0.9668, 0.943, 0.9548), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9818, 0.9643, 0.973), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 1.9701, span_acc: 0.6232, attr_start_acc: 0.0025, attr_end_acc: 0.0533, span_micro_p: 0.3761, span_micro_r: 0.1035, span_micro_f1: 0.1624, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.6536, span_acc: 0.7790, attr_start_acc: 0.1180, attr_end_acc: 0.3201, span_micro_p: 0.7066, span_micro_r: 0.4145, span_micro_f1: 0.5225, micro_p: 0.4688, micro_r: 0.0854, micro_f1: 0.1445
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.4923, span_acc: 0.8319, attr_start_acc: 0.3133, attr_end_acc: 0.4649, span_micro_p: 0.7671, span_micro_r: 0.5368, span_micro_f1: 0.6316, micro_p: 0.6992, micro_r: 0.2574, micro_f1: 0.3763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.3990, span_acc: 0.8602, attr_start_acc: 0.4256, attr_end_acc: 0.5395, span_micro_p: 0.8035, span_micro_r: 0.6056, span_micro_f1: 0.6907, micro_p: 0.7886, micro_r: 0.3601, micro_f1: 0.4944
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.3369, span_acc: 0.8808, attr_start_acc: 0.4949, attr_end_acc: 0.5903, span_micro_p: 0.8312, span_micro_r: 0.6586, span_micro_f1: 0.7349, micro_p: 0.8330, micro_r: 0.4243, micro_f1: 0.5622
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.2822, span_acc: 0.8963, attr_start_acc: 0.5428, attr_end_acc: 0.6274, span_micro_p: 0.8508, span_micro_r: 0.6985, span_micro_f1: 0.7671, micro_p: 0.8544, micro_r: 0.4726, micro_f1: 0.6085
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.2457, span_acc: 0.9057, attr_start_acc: 0.5764, attr_end_acc: 0.6637, span_micro_p: 0.8649, span_micro_r: 0.7272, span_micro_f1: 0.7901, micro_p: 0.8688, micro_r: 0.5080, micro_f1: 0.6411
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.2142, span_acc: 0.9115, attr_start_acc: 0.5972, attr_end_acc: 0.6859, span_micro_p: 0.8692, span_micro_r: 0.7423, span_micro_f1: 0.8007, micro_p: 0.8736, micro_r: 0.5305, micro_f1: 0.6601
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 1.1875, span_acc: 0.9182, attr_start_acc: 0.6214, attr_end_acc: 0.7067, span_micro_p: 0.8783, span_micro_r: 0.7606, span_micro_f1: 0.8152, micro_p: 0.8827, micro_r: 0.5575, micro_f1: 0.6834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 1.1668, span_acc: 0.9231, attr_start_acc: 0.6457, attr_end_acc: 0.7267, span_micro_p: 0.8841, span_micro_r: 0.7740, span_micro_f1: 0.8254, micro_p: 0.8929, micro_r: 0.5828, micro_f1: 0.7053
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 1.1455, span_acc: 0.9282, attr_start_acc: 0.6670, attr_end_acc: 0.7414, span_micro_p: 0.8871, span_micro_r: 0.7843, span_micro_f1: 0.8325, micro_p: 0.9003, micro_r: 0.6054, micro_f1: 0.7240
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 1.1249, span_acc: 0.9324, attr_start_acc: 0.6875, attr_end_acc: 0.7571, span_micro_p: 0.8924, span_micro_r: 0.7962, span_micro_f1: 0.8415, micro_p: 0.9064, micro_r: 0.6285, micro_f1: 0.7423
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 1.1099, span_acc: 0.9357, attr_start_acc: 0.7031, attr_end_acc: 0.7702, span_micro_p: 0.8974, span_micro_r: 0.8056, span_micro_f1: 0.8490, micro_p: 0.9129, micro_r: 0.6458, micro_f1: 0.7565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 1.0982, span_acc: 0.9376, attr_start_acc: 0.7185, attr_end_acc: 0.7819, span_micro_p: 0.8982, span_micro_r: 0.8118, span_micro_f1: 0.8528, micro_p: 0.9179, micro_r: 0.6612, micro_f1: 0.7687
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 1.0849, span_acc: 0.9403, attr_start_acc: 0.7318, attr_end_acc: 0.7933, span_micro_p: 0.9009, span_micro_r: 0.8188, span_micro_f1: 0.8579, micro_p: 0.9218, micro_r: 0.6766, micro_f1: 0.7804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 1.0742, span_acc: 0.9415, attr_start_acc: 0.7427, attr_end_acc: 0.8018, span_micro_p: 0.9036, span_micro_r: 0.8245, span_micro_f1: 0.8622, micro_p: 0.9247, micro_r: 0.6878, micro_f1: 0.7889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 1.0617, span_acc: 0.9439, attr_start_acc: 0.7535, attr_end_acc: 0.8106, span_micro_p: 0.9059, span_micro_r: 0.8295, span_micro_f1: 0.8660, micro_p: 0.9272, micro_r: 0.6990, micro_f1: 0.7971
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 1.0503, span_acc: 0.9457, attr_start_acc: 0.7627, attr_end_acc: 0.8180, span_micro_p: 0.9086, span_micro_r: 0.8346, span_micro_f1: 0.8701, micro_p: 0.9303, micro_r: 0.7093, micro_f1: 0.8049
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 1.0411, span_acc: 0.9467, attr_start_acc: 0.7699, attr_end_acc: 0.8242, span_micro_p: 0.9068, span_micro_r: 0.8353, span_micro_f1: 0.8696, micro_p: 0.9297, micro_r: 0.7166, micro_f1: 0.8094
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 1.0298, span_acc: 0.9481, attr_start_acc: 0.7773, attr_end_acc: 0.8299, span_micro_p: 0.9091, span_micro_r: 0.8399, span_micro_f1: 0.8732, micro_p: 0.9317, micro_r: 0.7249, micro_f1: 0.8154
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 1.0192, span_acc: 0.9494, attr_start_acc: 0.7834, attr_end_acc: 0.8358, span_micro_p: 0.9109, span_micro_r: 0.8437, span_micro_f1: 0.8760, micro_p: 0.9329, micro_r: 0.7318, micro_f1: 0.8202
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 1.0134, span_acc: 0.9501, attr_start_acc: 0.7896, attr_end_acc: 0.8402, span_micro_p: 0.9110, span_micro_r: 0.8461, span_micro_f1: 0.8774, micro_p: 0.9338, micro_r: 0.7380, micro_f1: 0.8244
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 1.0037, span_acc: 0.9511, attr_start_acc: 0.7954, attr_end_acc: 0.8443, span_micro_p: 0.9124, span_micro_r: 0.8494, span_micro_f1: 0.8798, micro_p: 0.9356, micro_r: 0.7445, micro_f1: 0.8292
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 0.9976, span_acc: 0.9524, attr_start_acc: 0.8012, attr_end_acc: 0.8503, span_micro_p: 0.9133, span_micro_r: 0.8530, span_micro_f1: 0.8821, micro_p: 0.9367, micro_r: 0.7515, micro_f1: 0.8340
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 0.9879, span_acc: 0.9537, attr_start_acc: 0.8066, attr_end_acc: 0.8547, span_micro_p: 0.9159, span_micro_r: 0.8567, span_micro_f1: 0.8853, micro_p: 0.9382, micro_r: 0.7581, micro_f1: 0.8386
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 0.9788, span_acc: 0.9546, attr_start_acc: 0.8107, attr_end_acc: 0.8587, span_micro_p: 0.9162, span_micro_r: 0.8592, span_micro_f1: 0.8868, micro_p: 0.9388, micro_r: 0.7626, micro_f1: 0.8416
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 0.9716, span_acc: 0.9548, attr_start_acc: 0.8150, attr_end_acc: 0.8626, span_micro_p: 0.9165, span_micro_r: 0.8609, span_micro_f1: 0.8878, micro_p: 0.9392, micro_r: 0.7679, micro_f1: 0.8450
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 0.9646, span_acc: 0.9558, attr_start_acc: 0.8192, attr_end_acc: 0.8653, span_micro_p: 0.9174, span_micro_r: 0.8633, span_micro_f1: 0.8895, micro_p: 0.9396, micro_r: 0.7721, micro_f1: 0.8476
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 0.9553, span_acc: 0.9566, attr_start_acc: 0.8237, attr_end_acc: 0.8685, span_micro_p: 0.9186, span_micro_r: 0.8660, span_micro_f1: 0.8915, micro_p: 0.9403, micro_r: 0.7772, micro_f1: 0.8510
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 0.9474, span_acc: 0.9577, attr_start_acc: 0.8284, attr_end_acc: 0.8717, span_micro_p: 0.9205, span_micro_r: 0.8691, span_micro_f1: 0.8941, micro_p: 0.9421, micro_r: 0.7825, micro_f1: 0.8549
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 0.9389, span_acc: 0.9587, attr_start_acc: 0.8320, attr_end_acc: 0.8745, span_micro_p: 0.9221, span_micro_r: 0.8718, span_micro_f1: 0.8962, micro_p: 0.9434, micro_r: 0.7869, micro_f1: 0.8581
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.72999999999999 / 94.08999999999999 / 94.28999999999999), p: (95.61 / 97.0), r: (93.19 / 89.3), f1: (94.38 / 92.99)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.6003161465375007, 'span_acc': 0.9772619611558503, 'attr_start_acc': 0.9408602150537635, 'attr_end_acc': 0.9428763440860215, 'span_micro_p': 0.9561343385880741, 'span_micro_r': 0.9318637274549099, 'span_micro_f1': 0.9438430311231393, 'micro_p': 0.9700292397660819, 'micro_r': 0.8930013458950202, 'micro_f1': 0.9299229152067274, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'ORG': (0.9616, 0.8656, 0.9111), 'TITLE': (0.9716, 0.8928, 0.9305), 'PRO': (1.0, 0.8889, 0.9412), 'EDU': (0.9703, 0.9245, 0.9468), 'CONT': (1.0, 0.9091, 0.9524), 'RACE': (0.9333, 1.0, 0.9655), 'NAME': (0.9903, 1.0, 0.9951)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9299229152067274 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.28 / 94.17 / 95.09), p: (96.15 / 97.96000000000001), r: (93.5 / 91.29), f1: (94.81 / 94.51)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.5956303113661472, 'span_acc': 0.9727547931382442, 'attr_start_acc': 0.941717791411043, 'attr_end_acc': 0.950920245398773, 'span_micro_p': 0.9615141955835962, 'span_micro_r': 0.9349693251533743, 'span_micro_f1': 0.9480559875583204, 'micro_p': 0.9795918367346939, 'micro_r': 0.912883435582822, 'micro_f1': 0.9450619244204509, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'ORG': (0.9726, 0.8987, 0.9342), 'PRO': (0.9394, 0.9394, 0.9394), 'EDU': (0.9902, 0.9018, 0.9439), 'TITLE': (0.9805, 0.9132, 0.9457), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9450619244204509 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.7707, span_acc: 0.9448, attr_start_acc: 0.8571, attr_end_acc: 0.8857, span_micro_p: 0.9355, span_micro_r: 0.8286, span_micro_f1: 0.8788, micro_p: 0.9667, micro_r: 0.8286, micro_f1: 0.8923
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.6671, span_acc: 0.9825, attr_start_acc: 0.9638, attr_end_acc: 0.9742, span_micro_p: 0.9529, span_micro_r: 0.9381, span_micro_f1: 0.9455, micro_p: 0.9758, micro_r: 0.9380, micro_f1: 0.9565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.6690, span_acc: 0.9830, attr_start_acc: 0.9572, attr_end_acc: 0.9682, span_micro_p: 0.9566, span_micro_r: 0.9391, span_micro_f1: 0.9478, micro_p: 0.9693, micro_r: 0.9266, micro_f1: 0.9474
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.6515, span_acc: 0.9850, attr_start_acc: 0.9600, attr_end_acc: 0.9639, span_micro_p: 0.9627, span_micro_r: 0.9477, span_micro_f1: 0.9552, micro_p: 0.9721, micro_r: 0.9294, micro_f1: 0.9502
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.6542, span_acc: 0.9834, attr_start_acc: 0.9619, attr_end_acc: 0.9672, span_micro_p: 0.9610, span_micro_r: 0.9479, span_micro_f1: 0.9544, micro_p: 0.9702, micro_r: 0.9327, micro_f1: 0.9511
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.6543, span_acc: 0.9819, attr_start_acc: 0.9560, attr_end_acc: 0.9651, span_micro_p: 0.9585, span_micro_r: 0.9439, span_micro_f1: 0.9511, micro_p: 0.9661, micro_r: 0.9268, micro_f1: 0.9461
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.6394, span_acc: 0.9816, attr_start_acc: 0.9566, attr_end_acc: 0.9650, span_micro_p: 0.9566, span_micro_r: 0.9419, span_micro_f1: 0.9492, micro_p: 0.9664, micro_r: 0.9272, micro_f1: 0.9464
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.6279, span_acc: 0.9814, attr_start_acc: 0.9566, attr_end_acc: 0.9670, span_micro_p: 0.9587, span_micro_r: 0.9439, span_micro_f1: 0.9512, micro_p: 0.9688, micro_r: 0.9284, micro_f1: 0.9481
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.6149, span_acc: 0.9820, attr_start_acc: 0.9573, attr_end_acc: 0.9673, span_micro_p: 0.9612, span_micro_r: 0.9471, span_micro_f1: 0.9541, micro_p: 0.9708, micro_r: 0.9300, micro_f1: 0.9500
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.6039, span_acc: 0.9820, attr_start_acc: 0.9581, attr_end_acc: 0.9666, span_micro_p: 0.9623, span_micro_r: 0.9472, span_micro_f1: 0.9547, micro_p: 0.9721, micro_r: 0.9308, micro_f1: 0.9510
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.6036, span_acc: 0.9825, attr_start_acc: 0.9601, attr_end_acc: 0.9680, span_micro_p: 0.9627, span_micro_r: 0.9482, span_micro_f1: 0.9554, micro_p: 0.9729, micro_r: 0.9339, micro_f1: 0.9530
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.5907, span_acc: 0.9830, attr_start_acc: 0.9612, attr_end_acc: 0.9695, span_micro_p: 0.9629, span_micro_r: 0.9496, span_micro_f1: 0.9562, micro_p: 0.9728, micro_r: 0.9361, micro_f1: 0.9541
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.5810, span_acc: 0.9835, attr_start_acc: 0.9613, attr_end_acc: 0.9697, span_micro_p: 0.9634, span_micro_r: 0.9500, span_micro_f1: 0.9567, micro_p: 0.9730, micro_r: 0.9371, micro_f1: 0.9547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.5743, span_acc: 0.9835, attr_start_acc: 0.9604, attr_end_acc: 0.9694, span_micro_p: 0.9627, span_micro_r: 0.9496, span_micro_f1: 0.9561, micro_p: 0.9723, micro_r: 0.9364, micro_f1: 0.9540
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.5641, span_acc: 0.9836, attr_start_acc: 0.9608, attr_end_acc: 0.9695, span_micro_p: 0.9626, span_micro_r: 0.9493, span_micro_f1: 0.9559, micro_p: 0.9721, micro_r: 0.9365, micro_f1: 0.9539
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.5531, span_acc: 0.9840, attr_start_acc: 0.9615, attr_end_acc: 0.9697, span_micro_p: 0.9635, span_micro_r: 0.9503, span_micro_f1: 0.9569, micro_p: 0.9724, micro_r: 0.9372, micro_f1: 0.9545
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.5478, span_acc: 0.9839, attr_start_acc: 0.9617, attr_end_acc: 0.9694, span_micro_p: 0.9626, span_micro_r: 0.9499, span_micro_f1: 0.9562, micro_p: 0.9726, micro_r: 0.9374, micro_f1: 0.9547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.5427, span_acc: 0.9842, attr_start_acc: 0.9627, attr_end_acc: 0.9700, span_micro_p: 0.9626, span_micro_r: 0.9505, span_micro_f1: 0.9565, micro_p: 0.9733, micro_r: 0.9383, micro_f1: 0.9555
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.5445, span_acc: 0.9837, attr_start_acc: 0.9623, attr_end_acc: 0.9701, span_micro_p: 0.9618, span_micro_r: 0.9500, span_micro_f1: 0.9559, micro_p: 0.9728, micro_r: 0.9379, micro_f1: 0.9551
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.5335, span_acc: 0.9840, attr_start_acc: 0.9622, attr_end_acc: 0.9704, span_micro_p: 0.9616, span_micro_r: 0.9500, span_micro_f1: 0.9557, micro_p: 0.9726, micro_r: 0.9383, micro_f1: 0.9551
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.5268, span_acc: 0.9838, attr_start_acc: 0.9617, attr_end_acc: 0.9702, span_micro_p: 0.9612, span_micro_r: 0.9495, span_micro_f1: 0.9553, micro_p: 0.9726, micro_r: 0.9378, micro_f1: 0.9549
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.5179, span_acc: 0.9842, attr_start_acc: 0.9619, attr_end_acc: 0.9706, span_micro_p: 0.9618, span_micro_r: 0.9503, span_micro_f1: 0.9560, micro_p: 0.9725, micro_r: 0.9385, micro_f1: 0.9552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.5071, span_acc: 0.9842, attr_start_acc: 0.9619, attr_end_acc: 0.9708, span_micro_p: 0.9617, span_micro_r: 0.9502, span_micro_f1: 0.9559, micro_p: 0.9723, micro_r: 0.9389, micro_f1: 0.9553
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.4998, span_acc: 0.9839, attr_start_acc: 0.9613, attr_end_acc: 0.9706, span_micro_p: 0.9618, span_micro_r: 0.9496, span_micro_f1: 0.9557, micro_p: 0.9725, micro_r: 0.9383, micro_f1: 0.9551
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.5025, span_acc: 0.9842, attr_start_acc: 0.9612, attr_end_acc: 0.9709, span_micro_p: 0.9614, span_micro_r: 0.9500, span_micro_f1: 0.9557, micro_p: 0.9724, micro_r: 0.9386, micro_f1: 0.9552
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.4962, span_acc: 0.9837, attr_start_acc: 0.9613, attr_end_acc: 0.9710, span_micro_p: 0.9599, span_micro_r: 0.9503, span_micro_f1: 0.9551, micro_p: 0.9722, micro_r: 0.9385, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.4899, span_acc: 0.9838, attr_start_acc: 0.9619, attr_end_acc: 0.9710, span_micro_p: 0.9598, span_micro_r: 0.9508, span_micro_f1: 0.9553, micro_p: 0.9717, micro_r: 0.9389, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.4833, span_acc: 0.9838, attr_start_acc: 0.9618, attr_end_acc: 0.9712, span_micro_p: 0.9599, span_micro_r: 0.9509, span_micro_f1: 0.9554, micro_p: 0.9715, micro_r: 0.9389, micro_f1: 0.9550
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.4751, span_acc: 0.9838, attr_start_acc: 0.9623, attr_end_acc: 0.9716, span_micro_p: 0.9603, span_micro_r: 0.9516, span_micro_f1: 0.9559, micro_p: 0.9715, micro_r: 0.9395, micro_f1: 0.9553
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.4791, span_acc: 0.9841, attr_start_acc: 0.9627, attr_end_acc: 0.9717, span_micro_p: 0.9606, span_micro_r: 0.9519, span_micro_f1: 0.9562, micro_p: 0.9719, micro_r: 0.9400, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.4722, span_acc: 0.9842, attr_start_acc: 0.9632, attr_end_acc: 0.9717, span_micro_p: 0.9605, span_micro_r: 0.9520, span_micro_f1: 0.9562, micro_p: 0.9719, micro_r: 0.9402, micro_f1: 0.9558
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.4719, span_acc: 0.9839, attr_start_acc: 0.9628, attr_end_acc: 0.9716, span_micro_p: 0.9602, span_micro_r: 0.9514, span_micro_f1: 0.9558, micro_p: 0.9718, micro_r: 0.9395, micro_f1: 0.9554
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.85000000000001 / 97.38 / 98.19), p: (94.95 / 95.67999999999999), r: (96.73 / 95.36), f1: (95.83 / 95.52000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.2745965907177194, 'span_acc': 0.9885125532922785, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9495081967213115, 'span_micro_r': 0.9672678690714763, 'span_micro_f1': 0.9583057577763071, 'micro_p': 0.9567859554355166, 'micro_r': 0.9535666218034994, 'micro_f1': 0.9551735760026964, 'category-p/r/f1': {'PRO': (0.7619, 0.8889, 0.8205), 'ORG': (0.9446, 0.9482, 0.9464), 'TITLE': (0.9632, 0.9478, 0.9554), 'EDU': (0.9623, 0.9623, 0.9623), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9551735760026964 / 0.9299229152067274
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.3 / 96.26 / 97.11999999999999), p: (94.51 / 96.24000000000001), r: (95.09 / 94.17), f1: (94.8 / 95.19)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.08562588935378213, 'span_acc': 0.9830474268415742, 'attr_start_acc': 0.9625766871165644, 'attr_end_acc': 0.9711656441717792, 'span_micro_p': 0.9451219512195121, 'span_micro_r': 0.950920245398773, 'span_micro_f1': 0.948012232415902, 'micro_p': 0.9623824451410659, 'micro_r': 0.941717791411043, 'micro_f1': 0.9519379844961241, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9496, 0.9204, 0.9348), 'TITLE': (0.9603, 0.9391, 0.9496), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9519379844961241 / 0.9450619244204509
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: 0.1600, span_acc: 1.0000, attr_start_acc: 0.9740, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9740, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: 0.0864, span_acc: 0.9801, attr_start_acc: 0.9597, attr_end_acc: 0.9639, span_micro_p: 0.9613, span_micro_r: 0.9411, span_micro_f1: 0.9511, micro_p: 0.9800, micro_r: 0.9342, micro_f1: 0.9565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: 0.2120, span_acc: 0.9819, attr_start_acc: 0.9581, attr_end_acc: 0.9683, span_micro_p: 0.9557, span_micro_r: 0.9429, span_micro_f1: 0.9493, micro_p: 0.9694, micro_r: 0.9331, micro_f1: 0.9509
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: 0.2217, span_acc: 0.9857, attr_start_acc: 0.9622, attr_end_acc: 0.9726, span_micro_p: 0.9622, span_micro_r: 0.9545, span_micro_f1: 0.9583, micro_p: 0.9742, micro_r: 0.9427, micro_f1: 0.9582
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: 0.2378, span_acc: 0.9860, attr_start_acc: 0.9661, attr_end_acc: 0.9768, span_micro_p: 0.9602, span_micro_r: 0.9551, span_micro_f1: 0.9576, micro_p: 0.9713, micro_r: 0.9475, micro_f1: 0.9593
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: 0.2339, span_acc: 0.9859, attr_start_acc: 0.9679, attr_end_acc: 0.9797, span_micro_p: 0.9600, span_micro_r: 0.9573, span_micro_f1: 0.9587, micro_p: 0.9720, micro_r: 0.9513, micro_f1: 0.9615
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: 0.2232, span_acc: 0.9866, attr_start_acc: 0.9673, attr_end_acc: 0.9793, span_micro_p: 0.9635, span_micro_r: 0.9613, span_micro_f1: 0.9624, micro_p: 0.9737, micro_r: 0.9520, micro_f1: 0.9627
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: 0.2151, span_acc: 0.9873, attr_start_acc: 0.9682, attr_end_acc: 0.9802, span_micro_p: 0.9636, span_micro_r: 0.9623, span_micro_f1: 0.9630, micro_p: 0.9733, micro_r: 0.9524, micro_f1: 0.9627
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: 0.1983, span_acc: 0.9871, attr_start_acc: 0.9685, attr_end_acc: 0.9793, span_micro_p: 0.9617, span_micro_r: 0.9612, span_micro_f1: 0.9615, micro_p: 0.9729, micro_r: 0.9513, micro_f1: 0.9620
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: 0.1850, span_acc: 0.9875, attr_start_acc: 0.9691, attr_end_acc: 0.9794, span_micro_p: 0.9630, span_micro_r: 0.9610, span_micro_f1: 0.9620, micro_p: 0.9741, micro_r: 0.9525, micro_f1: 0.9632
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: 0.1788, span_acc: 0.9882, attr_start_acc: 0.9711, attr_end_acc: 0.9805, span_micro_p: 0.9647, span_micro_r: 0.9627, span_micro_f1: 0.9637, micro_p: 0.9753, micro_r: 0.9549, micro_f1: 0.9650
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: 0.1873, span_acc: 0.9882, attr_start_acc: 0.9691, attr_end_acc: 0.9788, span_micro_p: 0.9643, span_micro_r: 0.9618, span_micro_f1: 0.9631, micro_p: 0.9730, micro_r: 0.9517, micro_f1: 0.9622
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: 0.1935, span_acc: 0.9883, attr_start_acc: 0.9696, attr_end_acc: 0.9789, span_micro_p: 0.9648, span_micro_r: 0.9627, span_micro_f1: 0.9638, micro_p: 0.9731, micro_r: 0.9522, micro_f1: 0.9626
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: 0.1730, span_acc: 0.9887, attr_start_acc: 0.9700, attr_end_acc: 0.9795, span_micro_p: 0.9665, span_micro_r: 0.9637, span_micro_f1: 0.9651, micro_p: 0.9742, micro_r: 0.9535, micro_f1: 0.9638
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: 0.1617, span_acc: 0.9890, attr_start_acc: 0.9710, attr_end_acc: 0.9795, span_micro_p: 0.9667, span_micro_r: 0.9646, span_micro_f1: 0.9656, micro_p: 0.9744, micro_r: 0.9547, micro_f1: 0.9644
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: 0.1616, span_acc: 0.9890, attr_start_acc: 0.9718, attr_end_acc: 0.9801, span_micro_p: 0.9666, span_micro_r: 0.9648, span_micro_f1: 0.9657, micro_p: 0.9740, micro_r: 0.9557, micro_f1: 0.9648
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: 0.1662, span_acc: 0.9891, attr_start_acc: 0.9721, attr_end_acc: 0.9801, span_micro_p: 0.9661, span_micro_r: 0.9649, span_micro_f1: 0.9655, micro_p: 0.9741, micro_r: 0.9557, micro_f1: 0.9648
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: 0.1677, span_acc: 0.9886, attr_start_acc: 0.9720, attr_end_acc: 0.9801, span_micro_p: 0.9640, span_micro_r: 0.9640, span_micro_f1: 0.9640, micro_p: 0.9734, micro_r: 0.9550, micro_f1: 0.9641
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: 0.1749, span_acc: 0.9890, attr_start_acc: 0.9726, attr_end_acc: 0.9808, span_micro_p: 0.9646, span_micro_r: 0.9655, span_micro_f1: 0.9651, micro_p: 0.9741, micro_r: 0.9565, micro_f1: 0.9652
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: 0.1684, span_acc: 0.9886, attr_start_acc: 0.9727, attr_end_acc: 0.9805, span_micro_p: 0.9640, span_micro_r: 0.9652, span_micro_f1: 0.9646, micro_p: 0.9740, micro_r: 0.9564, micro_f1: 0.9651
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: 0.1842, span_acc: 0.9882, attr_start_acc: 0.9731, attr_end_acc: 0.9801, span_micro_p: 0.9650, span_micro_r: 0.9657, span_micro_f1: 0.9653, micro_p: 0.9746, micro_r: 0.9566, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: 0.1764, span_acc: 0.9882, attr_start_acc: 0.9736, attr_end_acc: 0.9804, span_micro_p: 0.9659, span_micro_r: 0.9664, span_micro_f1: 0.9662, micro_p: 0.9753, micro_r: 0.9576, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: 0.1763, span_acc: 0.9883, attr_start_acc: 0.9738, attr_end_acc: 0.9804, span_micro_p: 0.9667, span_micro_r: 0.9670, span_micro_f1: 0.9669, micro_p: 0.9761, micro_r: 0.9580, micro_f1: 0.9669
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: 0.1788, span_acc: 0.9886, attr_start_acc: 0.9734, attr_end_acc: 0.9803, span_micro_p: 0.9675, span_micro_r: 0.9675, span_micro_f1: 0.9675, micro_p: 0.9765, micro_r: 0.9574, micro_f1: 0.9668
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: 0.1785, span_acc: 0.9887, attr_start_acc: 0.9736, attr_end_acc: 0.9803, span_micro_p: 0.9678, span_micro_r: 0.9678, span_micro_f1: 0.9678, micro_p: 0.9767, micro_r: 0.9576, micro_f1: 0.9671
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: 0.1746, span_acc: 0.9888, attr_start_acc: 0.9740, attr_end_acc: 0.9805, span_micro_p: 0.9680, span_micro_r: 0.9677, span_micro_f1: 0.9679, micro_p: 0.9772, micro_r: 0.9581, micro_f1: 0.9676
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: 0.1881, span_acc: 0.9887, attr_start_acc: 0.9738, attr_end_acc: 0.9803, span_micro_p: 0.9680, span_micro_r: 0.9676, span_micro_f1: 0.9678, micro_p: 0.9769, micro_r: 0.9580, micro_f1: 0.9674
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: 0.1817, span_acc: 0.9888, attr_start_acc: 0.9735, attr_end_acc: 0.9805, span_micro_p: 0.9681, span_micro_r: 0.9676, span_micro_f1: 0.9679, micro_p: 0.9771, micro_r: 0.9577, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: 0.1851, span_acc: 0.9886, attr_start_acc: 0.9737, attr_end_acc: 0.9802, span_micro_p: 0.9684, span_micro_r: 0.9674, span_micro_f1: 0.9679, micro_p: 0.9775, micro_r: 0.9574, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: 0.1843, span_acc: 0.9888, attr_start_acc: 0.9739, attr_end_acc: 0.9802, span_micro_p: 0.9690, span_micro_r: 0.9678, span_micro_f1: 0.9684, micro_p: 0.9776, micro_r: 0.9575, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: 0.1775, span_acc: 0.9889, attr_start_acc: 0.9739, attr_end_acc: 0.9801, span_micro_p: 0.9691, span_micro_r: 0.9678, span_micro_f1: 0.9684, micro_p: 0.9777, micro_r: 0.9574, micro_f1: 0.9674
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: 0.1715, span_acc: 0.9889, attr_start_acc: 0.9741, attr_end_acc: 0.9801, span_micro_p: 0.9697, span_micro_r: 0.9681, span_micro_f1: 0.9689, micro_p: 0.9779, micro_r: 0.9576, micro_f1: 0.9677
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.82 / 97.85000000000001 / 98.19), p: (95.65 / 96.49), r: (96.86 / 96.16), f1: (96.25 / 96.33)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.5541814883635832, 'span_acc': 0.9881572714353387, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9564643799472295, 'span_micro_r': 0.9686038744154977, 'span_micro_f1': 0.9624958513109856, 'micro_p': 0.9648885887913572, 'micro_r': 0.9616419919246298, 'micro_f1': 0.9632625547691271, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9523, 0.9578, 0.955), 'TITLE': (0.9677, 0.9551, 0.9614), 'EDU': (0.9811, 0.9811, 0.9811), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9632625547691271 / 0.9551735760026964
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.46000000000001 / 97.06 / 97.36), p: (95.05 / 96.16), r: (95.52000000000001 / 95.15), f1: (95.28999999999999 / 95.65)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.0857470284842845, 'span_acc': 0.984561049445005, 'attr_start_acc': 0.9705521472392638, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9505494505494505, 'span_micro_r': 0.9552147239263804, 'span_micro_f1': 0.9528763769889841, 'micro_p': 0.9615623062616243, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9565217391304347, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9526, 0.9439, 0.9482), 'TITLE': (0.9566, 0.943, 0.9498), 'PRO': (0.9412, 0.9697, 0.9552), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9565217391304347 / 0.9519379844961241
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.1217, span_acc: 0.9876, attr_start_acc: 0.9739, attr_end_acc: 0.9739, span_micro_p: 0.9737, span_micro_r: 0.9569, span_micro_f1: 0.9652, micro_p: 0.9735, micro_r: 0.9565, micro_f1: 0.9649
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -0.2889, span_acc: 0.9938, attr_start_acc: 0.9828, attr_end_acc: 0.9776, span_micro_p: 0.9862, span_micro_r: 0.9727, span_micro_f1: 0.9794, micro_p: 0.9877, micro_r: 0.9655, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.3030, span_acc: 0.9946, attr_start_acc: 0.9770, attr_end_acc: 0.9825, span_micro_p: 0.9826, span_micro_r: 0.9763, span_micro_f1: 0.9794, micro_p: 0.9840, micro_r: 0.9641, micro_f1: 0.9739
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.3251, span_acc: 0.9950, attr_start_acc: 0.9753, attr_end_acc: 0.9821, span_micro_p: 0.9835, span_micro_r: 0.9775, span_micro_f1: 0.9805, micro_p: 0.9846, micro_r: 0.9649, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -0.2758, span_acc: 0.9944, attr_start_acc: 0.9757, attr_end_acc: 0.9831, span_micro_p: 0.9805, span_micro_r: 0.9748, span_micro_f1: 0.9776, micro_p: 0.9828, micro_r: 0.9651, micro_f1: 0.9739
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -0.1777, span_acc: 0.9932, attr_start_acc: 0.9719, attr_end_acc: 0.9801, span_micro_p: 0.9792, span_micro_r: 0.9713, span_micro_f1: 0.9752, micro_p: 0.9784, micro_r: 0.9585, micro_f1: 0.9683
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -0.1149, span_acc: 0.9929, attr_start_acc: 0.9741, attr_end_acc: 0.9800, span_micro_p: 0.9782, span_micro_r: 0.9717, span_micro_f1: 0.9749, micro_p: 0.9788, micro_r: 0.9600, micro_f1: 0.9693
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -0.1489, span_acc: 0.9933, attr_start_acc: 0.9761, attr_end_acc: 0.9815, span_micro_p: 0.9793, span_micro_r: 0.9725, span_micro_f1: 0.9759, micro_p: 0.9809, micro_r: 0.9636, micro_f1: 0.9722
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -0.1325, span_acc: 0.9936, attr_start_acc: 0.9756, attr_end_acc: 0.9821, span_micro_p: 0.9788, span_micro_r: 0.9739, span_micro_f1: 0.9763, micro_p: 0.9820, micro_r: 0.9636, micro_f1: 0.9727
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: -0.0472, span_acc: 0.9912, attr_start_acc: 0.9743, attr_end_acc: 0.9818, span_micro_p: 0.9781, span_micro_r: 0.9715, span_micro_f1: 0.9748, micro_p: 0.9817, micro_r: 0.9613, micro_f1: 0.9714
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: 0.0198, span_acc: 0.9915, attr_start_acc: 0.9755, attr_end_acc: 0.9825, span_micro_p: 0.9776, span_micro_r: 0.9723, span_micro_f1: 0.9749, micro_p: 0.9816, micro_r: 0.9622, micro_f1: 0.9718
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: 0.0480, span_acc: 0.9915, attr_start_acc: 0.9759, attr_end_acc: 0.9817, span_micro_p: 0.9774, span_micro_r: 0.9732, span_micro_f1: 0.9753, micro_p: 0.9817, micro_r: 0.9623, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: 0.1113, span_acc: 0.9914, attr_start_acc: 0.9763, attr_end_acc: 0.9807, span_micro_p: 0.9781, span_micro_r: 0.9740, span_micro_f1: 0.9760, micro_p: 0.9815, micro_r: 0.9622, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: 0.1056, span_acc: 0.9914, attr_start_acc: 0.9762, attr_end_acc: 0.9803, span_micro_p: 0.9778, span_micro_r: 0.9740, span_micro_f1: 0.9759, micro_p: 0.9813, micro_r: 0.9621, micro_f1: 0.9716
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: 0.0801, span_acc: 0.9918, attr_start_acc: 0.9765, attr_end_acc: 0.9809, span_micro_p: 0.9782, span_micro_r: 0.9750, span_micro_f1: 0.9766, micro_p: 0.9824, micro_r: 0.9628, micro_f1: 0.9725
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: 0.0851, span_acc: 0.9917, attr_start_acc: 0.9769, attr_end_acc: 0.9809, span_micro_p: 0.9778, span_micro_r: 0.9748, span_micro_f1: 0.9763, micro_p: 0.9819, micro_r: 0.9624, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: 0.1285, span_acc: 0.9915, attr_start_acc: 0.9769, attr_end_acc: 0.9809, span_micro_p: 0.9761, span_micro_r: 0.9743, span_micro_f1: 0.9752, micro_p: 0.9810, micro_r: 0.9621, micro_f1: 0.9715
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: 0.1175, span_acc: 0.9917, attr_start_acc: 0.9773, attr_end_acc: 0.9810, span_micro_p: 0.9764, span_micro_r: 0.9751, span_micro_f1: 0.9758, micro_p: 0.9810, micro_r: 0.9622, micro_f1: 0.9715
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: 0.0827, span_acc: 0.9921, attr_start_acc: 0.9781, attr_end_acc: 0.9817, span_micro_p: 0.9771, span_micro_r: 0.9760, span_micro_f1: 0.9765, micro_p: 0.9818, micro_r: 0.9638, micro_f1: 0.9727
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: 0.1392, span_acc: 0.9919, attr_start_acc: 0.9781, attr_end_acc: 0.9819, span_micro_p: 0.9773, span_micro_r: 0.9760, span_micro_f1: 0.9766, micro_p: 0.9817, micro_r: 0.9642, micro_f1: 0.9729
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: 0.1409, span_acc: 0.9920, attr_start_acc: 0.9781, attr_end_acc: 0.9820, span_micro_p: 0.9776, span_micro_r: 0.9761, span_micro_f1: 0.9769, micro_p: 0.9819, micro_r: 0.9646, micro_f1: 0.9732
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: 0.1564, span_acc: 0.9917, attr_start_acc: 0.9783, attr_end_acc: 0.9821, span_micro_p: 0.9760, span_micro_r: 0.9758, span_micro_f1: 0.9759, micro_p: 0.9812, micro_r: 0.9648, micro_f1: 0.9729
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: 0.1855, span_acc: 0.9913, attr_start_acc: 0.9786, attr_end_acc: 0.9822, span_micro_p: 0.9766, span_micro_r: 0.9761, span_micro_f1: 0.9764, micro_p: 0.9818, micro_r: 0.9653, micro_f1: 0.9735
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: 0.2053, span_acc: 0.9913, attr_start_acc: 0.9785, attr_end_acc: 0.9820, span_micro_p: 0.9761, span_micro_r: 0.9760, span_micro_f1: 0.9761, micro_p: 0.9817, micro_r: 0.9653, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: 0.1924, span_acc: 0.9913, attr_start_acc: 0.9789, attr_end_acc: 0.9822, span_micro_p: 0.9761, span_micro_r: 0.9761, span_micro_f1: 0.9761, micro_p: 0.9818, micro_r: 0.9656, micro_f1: 0.9736
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: 0.1777, span_acc: 0.9913, attr_start_acc: 0.9790, attr_end_acc: 0.9822, span_micro_p: 0.9761, span_micro_r: 0.9757, span_micro_f1: 0.9759, micro_p: 0.9817, micro_r: 0.9656, micro_f1: 0.9736
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: 0.2942, span_acc: 0.9913, attr_start_acc: 0.9786, attr_end_acc: 0.9823, span_micro_p: 0.9759, span_micro_r: 0.9753, span_micro_f1: 0.9756, micro_p: 0.9816, micro_r: 0.9654, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: 0.3989, span_acc: 0.9914, attr_start_acc: 0.9781, attr_end_acc: 0.9825, span_micro_p: 0.9764, span_micro_r: 0.9753, span_micro_f1: 0.9759, micro_p: 0.9815, micro_r: 0.9647, micro_f1: 0.9730
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: 0.5172, span_acc: 0.9913, attr_start_acc: 0.9771, attr_end_acc: 0.9828, span_micro_p: 0.9760, span_micro_r: 0.9752, span_micro_f1: 0.9756, micro_p: 0.9810, micro_r: 0.9637, micro_f1: 0.9722
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: 0.5661, span_acc: 0.9914, attr_start_acc: 0.9767, attr_end_acc: 0.9830, span_micro_p: 0.9761, span_micro_r: 0.9754, span_micro_f1: 0.9758, micro_p: 0.9807, micro_r: 0.9636, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: 0.5320, span_acc: 0.9916, attr_start_acc: 0.9767, attr_end_acc: 0.9825, span_micro_p: 0.9765, span_micro_r: 0.9757, span_micro_f1: 0.9761, micro_p: 0.9808, micro_r: 0.9630, micro_f1: 0.9718
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: 0.5147, span_acc: 0.9917, attr_start_acc: 0.9772, attr_end_acc: 0.9826, span_micro_p: 0.9766, span_micro_r: 0.9760, span_micro_f1: 0.9763, micro_p: 0.9810, micro_r: 0.9633, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.63 / 97.72 / 97.92), p: (96.07 / 96.54), r: (96.26 / 95.76), f1: (96.16 / 96.15)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.0146042680122425, 'span_acc': 0.9862624348649929, 'attr_start_acc': 0.9771505376344086, 'attr_end_acc': 0.9791666666666666, 'span_micro_p': 0.9606666666666667, 'span_micro_r': 0.9625918503674015, 'span_micro_f1': 0.9616282949616283, 'micro_p': 0.9654002713704206, 'micro_r': 0.9576043068640646, 'micro_f1': 0.9614864864864865, 'category-p/r/f1': {'LOC': (1.0, 0.5, 0.6667), 'PRO': (0.9, 1.0, 0.9474), 'ORG': (0.9553, 0.9424, 0.9488), 'TITLE': (0.9677, 0.9565, 0.9621), 'EDU': (0.9633, 0.9906, 0.9768), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9614864864864865 / 0.9632625547691271
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.57000000000001 / 97.06 / 97.3), p: (95.94 / 96.88), r: (95.58 / 95.09), f1: (95.76 / 95.98)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.27729508918036455, 'span_acc': 0.9856710393541877, 'attr_start_acc': 0.9705521472392638, 'attr_end_acc': 0.9730061349693252, 'span_micro_p': 0.9593596059113301, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9575906576521205, 'micro_p': 0.96875, 'micro_r': 0.950920245398773, 'micro_f1': 0.9597523219814241, 'category-p/r/f1': {'LOC': (1.0, 0.3333, 0.5), 'ORG': (0.9557, 0.9367, 0.9461), 'TITLE': (0.9683, 0.9495, 0.9588), 'PRO': (0.9706, 1.0, 0.9851), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9597523219814241 / 0.9565217391304347
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: -0.3337, span_acc: 0.9978, attr_start_acc: 0.9866, attr_end_acc: 0.9866, span_micro_p: 0.9933, span_micro_r: 0.9867, span_micro_f1: 0.9900, micro_p: 1.0000, micro_r: 0.9732, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: -0.3564, span_acc: 0.9956, attr_start_acc: 0.9746, attr_end_acc: 0.9863, span_micro_p: 0.9805, span_micro_r: 0.9786, span_micro_f1: 0.9796, micro_p: 0.9900, micro_r: 0.9686, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: -0.1235, span_acc: 0.9966, attr_start_acc: 0.9765, attr_end_acc: 0.9866, span_micro_p: 0.9855, span_micro_r: 0.9833, span_micro_f1: 0.9844, micro_p: 0.9908, micro_r: 0.9675, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.0674, span_acc: 0.9975, attr_start_acc: 0.9774, attr_end_acc: 0.9860, span_micro_p: 0.9884, span_micro_r: 0.9876, span_micro_f1: 0.9880, micro_p: 0.9912, micro_r: 0.9680, micro_f1: 0.9795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.7709, span_acc: 0.9962, attr_start_acc: 0.9754, attr_end_acc: 0.9865, span_micro_p: 0.9872, span_micro_r: 0.9849, span_micro_f1: 0.9860, micro_p: 0.9880, micro_r: 0.9660, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.6527, span_acc: 0.9949, attr_start_acc: 0.9747, attr_end_acc: 0.9862, span_micro_p: 0.9835, span_micro_r: 0.9799, span_micro_f1: 0.9817, micro_p: 0.9863, micro_r: 0.9650, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.5582, span_acc: 0.9947, attr_start_acc: 0.9747, attr_end_acc: 0.9864, span_micro_p: 0.9823, span_micro_r: 0.9797, span_micro_f1: 0.9810, micro_p: 0.9845, micro_r: 0.9640, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.4798, span_acc: 0.9947, attr_start_acc: 0.9750, attr_end_acc: 0.9857, span_micro_p: 0.9818, span_micro_r: 0.9798, span_micro_f1: 0.9808, micro_p: 0.9850, micro_r: 0.9636, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: 0.4761, span_acc: 0.9948, attr_start_acc: 0.9766, attr_end_acc: 0.9861, span_micro_p: 0.9819, span_micro_r: 0.9799, span_micro_f1: 0.9809, micro_p: 0.9849, micro_r: 0.9653, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: 0.4059, span_acc: 0.9943, attr_start_acc: 0.9771, attr_end_acc: 0.9859, span_micro_p: 0.9796, span_micro_r: 0.9778, span_micro_f1: 0.9787, micro_p: 0.9853, micro_r: 0.9655, micro_f1: 0.9753
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: 0.5382, span_acc: 0.9944, attr_start_acc: 0.9777, attr_end_acc: 0.9861, span_micro_p: 0.9800, span_micro_r: 0.9784, span_micro_f1: 0.9792, micro_p: 0.9863, micro_r: 0.9663, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: 0.4813, span_acc: 0.9941, attr_start_acc: 0.9778, attr_end_acc: 0.9856, span_micro_p: 0.9800, span_micro_r: 0.9780, span_micro_f1: 0.9790, micro_p: 0.9863, micro_r: 0.9667, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: 0.4275, span_acc: 0.9942, attr_start_acc: 0.9786, attr_end_acc: 0.9858, span_micro_p: 0.9800, span_micro_r: 0.9782, span_micro_f1: 0.9791, micro_p: 0.9869, micro_r: 0.9676, micro_f1: 0.9772
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: 0.4118, span_acc: 0.9945, attr_start_acc: 0.9790, attr_end_acc: 0.9857, span_micro_p: 0.9812, span_micro_r: 0.9793, span_micro_f1: 0.9803, micro_p: 0.9873, micro_r: 0.9681, micro_f1: 0.9776
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: 0.4439, span_acc: 0.9945, attr_start_acc: 0.9787, attr_end_acc: 0.9852, span_micro_p: 0.9810, span_micro_r: 0.9792, span_micro_f1: 0.9801, micro_p: 0.9872, micro_r: 0.9672, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: 0.4314, span_acc: 0.9945, attr_start_acc: 0.9789, attr_end_acc: 0.9852, span_micro_p: 0.9809, span_micro_r: 0.9791, span_micro_f1: 0.9800, micro_p: 0.9870, micro_r: 0.9669, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: 0.4048, span_acc: 0.9942, attr_start_acc: 0.9788, attr_end_acc: 0.9847, span_micro_p: 0.9799, span_micro_r: 0.9781, span_micro_f1: 0.9790, micro_p: 0.9868, micro_r: 0.9658, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.5552, span_acc: 0.9940, attr_start_acc: 0.9785, attr_end_acc: 0.9846, span_micro_p: 0.9797, span_micro_r: 0.9775, span_micro_f1: 0.9786, micro_p: 0.9864, micro_r: 0.9657, micro_f1: 0.9759
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: 0.6130, span_acc: 0.9936, attr_start_acc: 0.9783, attr_end_acc: 0.9823, span_micro_p: 0.9800, span_micro_r: 0.9771, span_micro_f1: 0.9785, micro_p: 0.9867, micro_r: 0.9639, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: 0.6755, span_acc: 0.9939, attr_start_acc: 0.9788, attr_end_acc: 0.9779, span_micro_p: 0.9807, span_micro_r: 0.9778, span_micro_f1: 0.9793, micro_p: 0.9872, micro_r: 0.9601, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: 0.6686, span_acc: 0.9939, attr_start_acc: 0.9788, attr_end_acc: 0.9758, span_micro_p: 0.9810, span_micro_r: 0.9782, span_micro_f1: 0.9796, micro_p: 0.9870, micro_r: 0.9582, micro_f1: 0.9724
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: 0.6552, span_acc: 0.9940, attr_start_acc: 0.9781, attr_end_acc: 0.9748, span_micro_p: 0.9812, span_micro_r: 0.9784, span_micro_f1: 0.9798, micro_p: 0.9868, micro_r: 0.9569, micro_f1: 0.9716
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: 0.6126, span_acc: 0.9941, attr_start_acc: 0.9779, attr_end_acc: 0.9736, span_micro_p: 0.9818, span_micro_r: 0.9790, span_micro_f1: 0.9804, micro_p: 0.9871, micro_r: 0.9561, micro_f1: 0.9713
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: 0.5719, span_acc: 0.9941, attr_start_acc: 0.9781, attr_end_acc: 0.9736, span_micro_p: 0.9816, span_micro_r: 0.9792, span_micro_f1: 0.9804, micro_p: 0.9869, micro_r: 0.9561, micro_f1: 0.9712
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: 0.5516, span_acc: 0.9942, attr_start_acc: 0.9787, attr_end_acc: 0.9734, span_micro_p: 0.9820, span_micro_r: 0.9796, span_micro_f1: 0.9808, micro_p: 0.9872, micro_r: 0.9565, micro_f1: 0.9716
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: 0.5227, span_acc: 0.9943, attr_start_acc: 0.9793, attr_end_acc: 0.9737, span_micro_p: 0.9823, span_micro_r: 0.9801, span_micro_f1: 0.9812, micro_p: 0.9874, micro_r: 0.9572, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: 0.5124, span_acc: 0.9943, attr_start_acc: 0.9794, attr_end_acc: 0.9741, span_micro_p: 0.9824, span_micro_r: 0.9802, span_micro_f1: 0.9813, micro_p: 0.9872, micro_r: 0.9578, micro_f1: 0.9723
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.5084, span_acc: 0.9940, attr_start_acc: 0.9790, attr_end_acc: 0.9743, span_micro_p: 0.9818, span_micro_r: 0.9797, span_micro_f1: 0.9807, micro_p: 0.9867, micro_r: 0.9575, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: 0.4938, span_acc: 0.9941, attr_start_acc: 0.9792, attr_end_acc: 0.9749, span_micro_p: 0.9818, span_micro_r: 0.9797, span_micro_f1: 0.9807, micro_p: 0.9868, micro_r: 0.9581, micro_f1: 0.9723
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.4921, span_acc: 0.9938, attr_start_acc: 0.9792, attr_end_acc: 0.9743, span_micro_p: 0.9811, span_micro_r: 0.9789, span_micro_f1: 0.9800, micro_p: 0.9862, micro_r: 0.9575, micro_f1: 0.9716
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: 0.5027, span_acc: 0.9940, attr_start_acc: 0.9794, attr_end_acc: 0.9741, span_micro_p: 0.9814, span_micro_r: 0.9793, span_micro_f1: 0.9803, micro_p: 0.9863, micro_r: 0.9575, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: 0.5146, span_acc: 0.9940, attr_start_acc: 0.9798, attr_end_acc: 0.9742, span_micro_p: 0.9815, span_micro_r: 0.9794, span_micro_f1: 0.9805, micro_p: 0.9864, micro_r: 0.9578, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.47 / 97.38 / 93.95), p: (95.37 / 95.99), r: (96.33 / 91.79), f1: (95.85000000000001 / 93.84)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.9033777124165974, 'span_acc': 0.9847228801515869, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9395161290322581, 'span_micro_p': 0.9537037037037037, 'span_micro_r': 0.9632598530394122, 'span_micro_f1': 0.9584579594549685, 'micro_p': 0.9598874032371569, 'micro_r': 0.917900403768506, 'micro_f1': 0.9384244926040591, 'category-p/r/f1': {'PRO': (0.7391, 0.9444, 0.8292), 'TITLE': (0.9635, 0.8812, 0.9205), 'ORG': (0.9509, 0.929, 0.9398), 'EDU': (0.9811, 0.9811, 0.9811), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9384244926040591 / 0.9632625547691271
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.07000000000001 / 96.75 / 93.37), p: (94.98 / 97.00999999999999), r: (95.15 / 91.60000000000001), f1: (95.07 / 94.23)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.6532850381713243, 'span_acc': 0.9807265388496468, 'attr_start_acc': 0.9674846625766871, 'attr_end_acc': 0.9337423312883436, 'span_micro_p': 0.9497856705450092, 'span_micro_r': 0.9515337423312883, 'span_micro_f1': 0.9506589028501378, 'micro_p': 0.9701104613385315, 'micro_r': 0.9159509202453988, 'micro_f1': 0.9422530766803408, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'TITLE': (0.9658, 0.8782, 0.9199), 'ORG': (0.9644, 0.9295, 0.9466), 'PRO': (0.9412, 0.9697, 0.9552), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9422530766803408 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.5599, span_acc: 0.9942, attr_start_acc: 0.9840, attr_end_acc: 0.9574, span_micro_p: 0.9947, span_micro_r: 0.9841, span_micro_f1: 0.9894, micro_p: 0.9944, micro_r: 0.9521, micro_f1: 0.9728
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -0.3521, span_acc: 0.9960, attr_start_acc: 0.9870, attr_end_acc: 0.9366, span_micro_p: 0.9968, span_micro_r: 0.9919, span_micro_f1: 0.9943, micro_p: 0.9896, micro_r: 0.9317, micro_f1: 0.9598
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -0.3892, span_acc: 0.9963, attr_start_acc: 0.9837, attr_end_acc: 0.9546, span_micro_p: 0.9910, span_micro_r: 0.9910, span_micro_f1: 0.9910, micro_p: 0.9895, micro_r: 0.9455, micro_f1: 0.9670
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -0.0240, span_acc: 0.9959, attr_start_acc: 0.9852, attr_end_acc: 0.9617, span_micro_p: 0.9926, span_micro_r: 0.9907, span_micro_f1: 0.9916, micro_p: 0.9923, micro_r: 0.9537, micro_f1: 0.9726
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: -0.1139, span_acc: 0.9960, attr_start_acc: 0.9828, attr_end_acc: 0.9639, span_micro_p: 0.9914, span_micro_r: 0.9903, span_micro_f1: 0.9909, micro_p: 0.9888, micro_r: 0.9547, micro_f1: 0.9715
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.1710, span_acc: 0.9962, attr_start_acc: 0.9829, attr_end_acc: 0.9671, span_micro_p: 0.9902, span_micro_r: 0.9906, span_micro_f1: 0.9904, micro_p: 0.9874, micro_r: 0.9572, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.0377, span_acc: 0.9961, attr_start_acc: 0.9832, attr_end_acc: 0.9700, span_micro_p: 0.9895, span_micro_r: 0.9895, span_micro_f1: 0.9895, micro_p: 0.9887, micro_r: 0.9601, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.0807, span_acc: 0.9962, attr_start_acc: 0.9814, attr_end_acc: 0.9726, span_micro_p: 0.9890, span_micro_r: 0.9884, span_micro_f1: 0.9887, micro_p: 0.9890, micro_r: 0.9609, micro_f1: 0.9748
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.1339, span_acc: 0.9958, attr_start_acc: 0.9818, attr_end_acc: 0.9747, span_micro_p: 0.9882, span_micro_r: 0.9866, span_micro_f1: 0.9874, micro_p: 0.9887, micro_r: 0.9628, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.1838, span_acc: 0.9960, attr_start_acc: 0.9831, attr_end_acc: 0.9773, span_micro_p: 0.9885, span_micro_r: 0.9868, span_micro_f1: 0.9876, micro_p: 0.9884, micro_r: 0.9660, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: -0.1160, span_acc: 0.9958, attr_start_acc: 0.9831, attr_end_acc: 0.9778, span_micro_p: 0.9880, span_micro_r: 0.9864, span_micro_f1: 0.9872, micro_p: 0.9876, micro_r: 0.9663, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: -0.1354, span_acc: 0.9958, attr_start_acc: 0.9837, attr_end_acc: 0.9785, span_micro_p: 0.9874, span_micro_r: 0.9864, span_micro_f1: 0.9869, micro_p: 0.9877, micro_r: 0.9672, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: -0.0771, span_acc: 0.9958, attr_start_acc: 0.9838, attr_end_acc: 0.9788, span_micro_p: 0.9870, span_micro_r: 0.9863, span_micro_f1: 0.9867, micro_p: 0.9867, micro_r: 0.9674, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: -0.0848, span_acc: 0.9959, attr_start_acc: 0.9845, attr_end_acc: 0.9797, span_micro_p: 0.9874, span_micro_r: 0.9869, span_micro_f1: 0.9871, micro_p: 0.9872, micro_r: 0.9687, micro_f1: 0.9779
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: -0.0907, span_acc: 0.9955, attr_start_acc: 0.9842, attr_end_acc: 0.9791, span_micro_p: 0.9864, span_micro_r: 0.9859, span_micro_f1: 0.9861, micro_p: 0.9865, micro_r: 0.9677, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: -0.0175, span_acc: 0.9955, attr_start_acc: 0.9843, attr_end_acc: 0.9791, span_micro_p: 0.9857, span_micro_r: 0.9859, span_micro_f1: 0.9858, micro_p: 0.9863, micro_r: 0.9670, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: 0.0094, span_acc: 0.9956, attr_start_acc: 0.9844, attr_end_acc: 0.9795, span_micro_p: 0.9861, span_micro_r: 0.9862, span_micro_f1: 0.9861, micro_p: 0.9866, micro_r: 0.9675, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.1554, span_acc: 0.9956, attr_start_acc: 0.9846, attr_end_acc: 0.9797, span_micro_p: 0.9863, span_micro_r: 0.9862, span_micro_f1: 0.9862, micro_p: 0.9868, micro_r: 0.9679, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.1563, span_acc: 0.9957, attr_start_acc: 0.9847, attr_end_acc: 0.9801, span_micro_p: 0.9866, span_micro_r: 0.9866, span_micro_f1: 0.9866, micro_p: 0.9869, micro_r: 0.9681, micro_f1: 0.9774
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.2405, span_acc: 0.9957, attr_start_acc: 0.9847, attr_end_acc: 0.9802, span_micro_p: 0.9866, span_micro_r: 0.9864, span_micro_f1: 0.9865, micro_p: 0.9872, micro_r: 0.9681, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.2250, span_acc: 0.9958, attr_start_acc: 0.9848, attr_end_acc: 0.9802, span_micro_p: 0.9868, span_micro_r: 0.9865, span_micro_f1: 0.9867, micro_p: 0.9876, micro_r: 0.9681, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: 0.2012, span_acc: 0.9960, attr_start_acc: 0.9850, attr_end_acc: 0.9809, span_micro_p: 0.9875, span_micro_r: 0.9871, span_micro_f1: 0.9873, micro_p: 0.9879, micro_r: 0.9689, micro_f1: 0.9783
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: 0.1683, span_acc: 0.9961, attr_start_acc: 0.9853, attr_end_acc: 0.9816, span_micro_p: 0.9879, span_micro_r: 0.9874, span_micro_f1: 0.9876, micro_p: 0.9881, micro_r: 0.9697, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: 0.2921, span_acc: 0.9962, attr_start_acc: 0.9850, attr_end_acc: 0.9816, span_micro_p: 0.9879, span_micro_r: 0.9876, span_micro_f1: 0.9878, micro_p: 0.9881, micro_r: 0.9697, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: 0.3367, span_acc: 0.9961, attr_start_acc: 0.9843, attr_end_acc: 0.9813, span_micro_p: 0.9875, span_micro_r: 0.9872, span_micro_f1: 0.9874, micro_p: 0.9878, micro_r: 0.9687, micro_f1: 0.9782
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: 0.3410, span_acc: 0.9960, attr_start_acc: 0.9844, attr_end_acc: 0.9812, span_micro_p: 0.9875, span_micro_r: 0.9867, span_micro_f1: 0.9871, micro_p: 0.9881, micro_r: 0.9689, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: 0.3549, span_acc: 0.9961, attr_start_acc: 0.9842, attr_end_acc: 0.9814, span_micro_p: 0.9875, span_micro_r: 0.9867, span_micro_f1: 0.9871, micro_p: 0.9883, micro_r: 0.9690, micro_f1: 0.9786
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: 0.3664, span_acc: 0.9959, attr_start_acc: 0.9840, attr_end_acc: 0.9818, span_micro_p: 0.9866, span_micro_r: 0.9863, span_micro_f1: 0.9865, micro_p: 0.9879, micro_r: 0.9689, micro_f1: 0.9783
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: 0.4014, span_acc: 0.9958, attr_start_acc: 0.9838, attr_end_acc: 0.9814, span_micro_p: 0.9860, span_micro_r: 0.9859, span_micro_f1: 0.9860, micro_p: 0.9875, micro_r: 0.9683, micro_f1: 0.9778
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: 0.5328, span_acc: 0.9955, attr_start_acc: 0.9836, attr_end_acc: 0.9795, span_micro_p: 0.9846, span_micro_r: 0.9852, span_micro_f1: 0.9849, micro_p: 0.9869, micro_r: 0.9660, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: 0.5166, span_acc: 0.9955, attr_start_acc: 0.9837, attr_end_acc: 0.9796, span_micro_p: 0.9848, span_micro_r: 0.9851, span_micro_f1: 0.9849, micro_p: 0.9871, micro_r: 0.9662, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: 0.5342, span_acc: 0.9954, attr_start_acc: 0.9835, attr_end_acc: 0.9797, span_micro_p: 0.9850, span_micro_r: 0.9852, span_micro_f1: 0.9851, micro_p: 0.9872, micro_r: 0.9663, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.65 / 97.85000000000001 / 98.19), p: (95.83 / 96.56), r: (96.78999999999999 / 96.3), f1: (96.31 / 96.43)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 3.805910418152037, 'span_acc': 0.9864992894362862, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9583333333333334, 'span_micro_r': 0.9679358717434869, 'span_micro_f1': 0.9631106679960119, 'micro_p': 0.9655870445344129, 'micro_r': 0.9629878869448183, 'micro_f1': 0.9642857142857142, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9466, 0.952, 0.9493), 'TITLE': (0.9736, 0.9609, 0.9672), 'EDU': (0.9722, 0.9906, 0.9813), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9642857142857142 / 0.9632625547691271
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.09 / 96.81 / 97.55), p: (95.59 / 95.92), r: (95.83 / 95.21), f1: (95.71 / 95.57)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 2.0218567375866874, 'span_acc': 0.9809283551967709, 'attr_start_acc': 0.9680981595092024, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.95593635250918, 'span_micro_r': 0.9582822085889571, 'span_micro_f1': 0.9571078431372549, 'micro_p': 0.9592088998763906, 'micro_r': 0.9521472392638037, 'micro_f1': 0.9556650246305419, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9488, 0.9385, 0.9436), 'TITLE': (0.9556, 0.9469, 0.9512), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9556650246305419 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: 0.5711, span_acc: 0.9954, attr_start_acc: 0.9766, attr_end_acc: 0.9727, span_micro_p: 0.9883, span_micro_r: 0.9806, span_micro_f1: 0.9844, micro_p: 0.9801, micro_r: 0.9609, micro_f1: 0.9704
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -0.1929, span_acc: 0.9970, attr_start_acc: 0.9853, attr_end_acc: 0.9867, span_micro_p: 0.9883, span_micro_r: 0.9897, span_micro_f1: 0.9890, micro_p: 0.9866, micro_r: 0.9764, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -0.3513, span_acc: 0.9981, attr_start_acc: 0.9879, attr_end_acc: 0.9879, span_micro_p: 0.9922, span_micro_r: 0.9940, span_micro_f1: 0.9931, micro_p: 0.9895, micro_r: 0.9809, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.3977, span_acc: 0.9981, attr_start_acc: 0.9865, attr_end_acc: 0.9877, span_micro_p: 0.9942, span_micro_r: 0.9942, span_micro_f1: 0.9942, micro_p: 0.9922, micro_r: 0.9800, micro_f1: 0.9860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.4268, span_acc: 0.9975, attr_start_acc: 0.9866, attr_end_acc: 0.9886, span_micro_p: 0.9936, span_micro_r: 0.9936, span_micro_f1: 0.9936, micro_p: 0.9915, micro_r: 0.9807, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -0.3991, span_acc: 0.9975, attr_start_acc: 0.9882, attr_end_acc: 0.9894, span_micro_p: 0.9939, span_micro_r: 0.9939, span_micro_f1: 0.9939, micro_p: 0.9922, micro_r: 0.9816, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: -0.2928, span_acc: 0.9972, attr_start_acc: 0.9879, attr_end_acc: 0.9879, span_micro_p: 0.9921, span_micro_r: 0.9928, span_micro_f1: 0.9925, micro_p: 0.9913, micro_r: 0.9796, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: -0.3003, span_acc: 0.9971, attr_start_acc: 0.9864, attr_end_acc: 0.9885, span_micro_p: 0.9904, span_micro_r: 0.9922, span_micro_f1: 0.9913, micro_p: 0.9899, micro_r: 0.9786, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: -0.1947, span_acc: 0.9971, attr_start_acc: 0.9863, attr_end_acc: 0.9887, span_micro_p: 0.9904, span_micro_r: 0.9917, span_micro_f1: 0.9910, micro_p: 0.9896, micro_r: 0.9784, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: -0.1527, span_acc: 0.9972, attr_start_acc: 0.9848, attr_end_acc: 0.9882, span_micro_p: 0.9908, span_micro_r: 0.9917, span_micro_f1: 0.9912, micro_p: 0.9898, micro_r: 0.9767, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: -0.1218, span_acc: 0.9974, attr_start_acc: 0.9855, attr_end_acc: 0.9884, span_micro_p: 0.9911, span_micro_r: 0.9920, span_micro_f1: 0.9916, micro_p: 0.9905, micro_r: 0.9772, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: -0.0803, span_acc: 0.9973, attr_start_acc: 0.9850, attr_end_acc: 0.9871, span_micro_p: 0.9908, span_micro_r: 0.9912, span_micro_f1: 0.9910, micro_p: 0.9904, micro_r: 0.9758, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: 0.0233, span_acc: 0.9972, attr_start_acc: 0.9844, attr_end_acc: 0.9852, span_micro_p: 0.9907, span_micro_r: 0.9907, span_micro_f1: 0.9907, micro_p: 0.9903, micro_r: 0.9734, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: -0.0240, span_acc: 0.9973, attr_start_acc: 0.9849, attr_end_acc: 0.9849, span_micro_p: 0.9912, span_micro_r: 0.9912, span_micro_f1: 0.9912, micro_p: 0.9908, micro_r: 0.9735, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: 0.0600, span_acc: 0.9975, attr_start_acc: 0.9847, attr_end_acc: 0.9850, span_micro_p: 0.9917, span_micro_r: 0.9917, span_micro_f1: 0.9917, micro_p: 0.9906, micro_r: 0.9736, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: 0.1177, span_acc: 0.9974, attr_start_acc: 0.9841, attr_end_acc: 0.9847, span_micro_p: 0.9913, span_micro_r: 0.9908, span_micro_f1: 0.9910, micro_p: 0.9906, micro_r: 0.9732, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: 0.4022, span_acc: 0.9973, attr_start_acc: 0.9835, attr_end_acc: 0.9845, span_micro_p: 0.9907, span_micro_r: 0.9902, span_micro_f1: 0.9904, micro_p: 0.9888, micro_r: 0.9716, micro_f1: 0.9801
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: 0.3970, span_acc: 0.9973, attr_start_acc: 0.9833, attr_end_acc: 0.9845, span_micro_p: 0.9905, span_micro_r: 0.9903, span_micro_f1: 0.9904, micro_p: 0.9880, micro_r: 0.9716, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: 0.3557, span_acc: 0.9973, attr_start_acc: 0.9837, attr_end_acc: 0.9851, span_micro_p: 0.9907, span_micro_r: 0.9903, span_micro_f1: 0.9905, micro_p: 0.9884, micro_r: 0.9723, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 0.4860, span_acc: 0.9972, attr_start_acc: 0.9843, attr_end_acc: 0.9855, span_micro_p: 0.9907, span_micro_r: 0.9903, span_micro_f1: 0.9905, micro_p: 0.9887, micro_r: 0.9731, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 0.5195, span_acc: 0.9972, attr_start_acc: 0.9844, attr_end_acc: 0.9857, span_micro_p: 0.9908, span_micro_r: 0.9904, span_micro_f1: 0.9906, micro_p: 0.9888, micro_r: 0.9733, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 0.4925, span_acc: 0.9971, attr_start_acc: 0.9845, attr_end_acc: 0.9860, span_micro_p: 0.9908, span_micro_r: 0.9902, span_micro_f1: 0.9905, micro_p: 0.9888, micro_r: 0.9734, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 0.4507, span_acc: 0.9973, attr_start_acc: 0.9849, attr_end_acc: 0.9860, span_micro_p: 0.9911, span_micro_r: 0.9906, span_micro_f1: 0.9909, micro_p: 0.9891, micro_r: 0.9739, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 0.5360, span_acc: 0.9972, attr_start_acc: 0.9846, attr_end_acc: 0.9854, span_micro_p: 0.9908, span_micro_r: 0.9905, span_micro_f1: 0.9907, micro_p: 0.9886, micro_r: 0.9733, micro_f1: 0.9809
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.4995, span_acc: 0.9972, attr_start_acc: 0.9845, attr_end_acc: 0.9853, span_micro_p: 0.9909, span_micro_r: 0.9903, span_micro_f1: 0.9906, micro_p: 0.9888, micro_r: 0.9732, micro_f1: 0.9809
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: 0.5095, span_acc: 0.9972, attr_start_acc: 0.9846, attr_end_acc: 0.9854, span_micro_p: 0.9908, span_micro_r: 0.9903, span_micro_f1: 0.9906, micro_p: 0.9890, micro_r: 0.9736, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 0.5893, span_acc: 0.9969, attr_start_acc: 0.9841, attr_end_acc: 0.9850, span_micro_p: 0.9904, span_micro_r: 0.9900, span_micro_f1: 0.9902, micro_p: 0.9889, micro_r: 0.9729, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 0.5640, span_acc: 0.9970, attr_start_acc: 0.9837, attr_end_acc: 0.9852, span_micro_p: 0.9907, span_micro_r: 0.9903, span_micro_f1: 0.9905, micro_p: 0.9891, micro_r: 0.9728, micro_f1: 0.9809
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: 0.5492, span_acc: 0.9971, attr_start_acc: 0.9837, attr_end_acc: 0.9852, span_micro_p: 0.9909, span_micro_r: 0.9903, span_micro_f1: 0.9906, micro_p: 0.9895, micro_r: 0.9727, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: 0.4990, span_acc: 0.9971, attr_start_acc: 0.9837, attr_end_acc: 0.9856, span_micro_p: 0.9912, span_micro_r: 0.9906, span_micro_f1: 0.9909, micro_p: 0.9898, micro_r: 0.9731, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 0.4941, span_acc: 0.9971, attr_start_acc: 0.9832, attr_end_acc: 0.9856, span_micro_p: 0.9912, span_micro_r: 0.9904, span_micro_f1: 0.9908, micro_p: 0.9898, micro_r: 0.9726, micro_f1: 0.9811
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 0.5360, span_acc: 0.9971, attr_start_acc: 0.9831, attr_end_acc: 0.9857, span_micro_p: 0.9907, span_micro_r: 0.9903, span_micro_f1: 0.9905, micro_p: 0.9896, micro_r: 0.9725, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.78 / 97.18 / 98.19), p: (95.6 / 96.55), r: (97.19 / 96.03), f1: (96.39 / 96.28999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 8.76600573863633, 'span_acc': 0.9878019895783988, 'attr_start_acc': 0.9717741935483871, 'attr_end_acc': 0.9818548387096774, 'span_micro_p': 0.9559789750328516, 'span_micro_r': 0.9719438877755511, 'span_micro_f1': 0.9638953295793309, 'micro_p': 0.9654939106901218, 'micro_r': 0.9602960969044414, 'micro_f1': 0.9628879892037786, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9522, 0.9559, 0.954), 'TITLE': (0.9705, 0.9551, 0.9627), 'EDU': (0.9722, 0.9906, 0.9813), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9628879892037786 / 0.9642857142857142
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.1 / 96.32 / 97.36), p: (95.35 / 96.73), r: (95.52000000000001 / 94.48), f1: (95.43 / 95.59)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 5.667806696217015, 'span_acc': 0.981029263370333, 'attr_start_acc': 0.9631901840490797, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9534598897734231, 'span_micro_r': 0.9552147239263804, 'span_micro_f1': 0.9543365001532332, 'micro_p': 0.9673366834170855, 'micro_r': 0.9447852760736196, 'micro_f1': 0.9559279950341403, 'category-p/r/f1': {'LOC': (1.0, 0.3333, 0.5), 'PRO': (0.9394, 0.9394, 0.9394), 'ORG': (0.9505, 0.9367, 0.9435), 'TITLE': (0.9706, 0.9417, 0.9559), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9559279950341403 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -0.0923, span_acc: 0.9987, attr_start_acc: 0.9892, attr_end_acc: 0.9964, span_micro_p: 0.9929, span_micro_r: 0.9964, span_micro_f1: 0.9947, micro_p: 0.9964, micro_r: 0.9892, micro_f1: 0.9928
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: -0.1238, span_acc: 0.9985, attr_start_acc: 0.9843, attr_end_acc: 0.9943, span_micro_p: 0.9929, span_micro_r: 0.9957, span_micro_f1: 0.9943, micro_p: 0.9956, micro_r: 0.9800, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: -0.2369, span_acc: 0.9979, attr_start_acc: 0.9851, attr_end_acc: 0.9948, span_micro_p: 0.9896, span_micro_r: 0.9931, span_micro_f1: 0.9913, micro_p: 0.9947, micro_r: 0.9790, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: -0.0201, span_acc: 0.9983, attr_start_acc: 0.9852, attr_end_acc: 0.9949, span_micro_p: 0.9917, span_micro_r: 0.9936, span_micro_f1: 0.9927, micro_p: 0.9954, micro_r: 0.9800, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: -0.1745, span_acc: 0.9986, attr_start_acc: 0.9865, attr_end_acc: 0.9953, span_micro_p: 0.9928, span_micro_r: 0.9948, span_micro_f1: 0.9938, micro_p: 0.9958, micro_r: 0.9823, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: -0.1422, span_acc: 0.9986, attr_start_acc: 0.9855, attr_end_acc: 0.9945, span_micro_p: 0.9929, span_micro_r: 0.9949, span_micro_f1: 0.9939, micro_p: 0.9948, micro_r: 0.9821, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: 0.4172, span_acc: 0.9988, attr_start_acc: 0.9873, attr_end_acc: 0.9942, span_micro_p: 0.9939, span_micro_r: 0.9957, span_micro_f1: 0.9948, micro_p: 0.9952, micro_r: 0.9836, micro_f1: 0.9894
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 1.4773, span_acc: 0.9980, attr_start_acc: 0.9860, attr_end_acc: 0.9937, span_micro_p: 0.9922, span_micro_r: 0.9943, span_micro_f1: 0.9933, micro_p: 0.9926, micro_r: 0.9816, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 1.3331, span_acc: 0.9980, attr_start_acc: 0.9857, attr_end_acc: 0.9932, span_micro_p: 0.9924, span_micro_r: 0.9941, span_micro_f1: 0.9932, micro_p: 0.9928, micro_r: 0.9809, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 1.7899, span_acc: 0.9975, attr_start_acc: 0.9830, attr_end_acc: 0.9914, span_micro_p: 0.9909, span_micro_r: 0.9919, span_micro_f1: 0.9914, micro_p: 0.9912, micro_r: 0.9771, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 1.5611, span_acc: 0.9976, attr_start_acc: 0.9824, attr_end_acc: 0.9906, span_micro_p: 0.9911, span_micro_r: 0.9920, span_micro_f1: 0.9916, micro_p: 0.9912, micro_r: 0.9764, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 1.4094, span_acc: 0.9978, attr_start_acc: 0.9830, attr_end_acc: 0.9905, span_micro_p: 0.9919, span_micro_r: 0.9927, span_micro_f1: 0.9923, micro_p: 0.9917, micro_r: 0.9768, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 1.3838, span_acc: 0.9976, attr_start_acc: 0.9830, attr_end_acc: 0.9896, span_micro_p: 0.9913, span_micro_r: 0.9924, span_micro_f1: 0.9919, micro_p: 0.9913, micro_r: 0.9761, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 1.5744, span_acc: 0.9977, attr_start_acc: 0.9830, attr_end_acc: 0.9895, span_micro_p: 0.9914, span_micro_r: 0.9925, span_micro_f1: 0.9920, micro_p: 0.9916, micro_r: 0.9762, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 1.7054, span_acc: 0.9974, attr_start_acc: 0.9831, attr_end_acc: 0.9888, span_micro_p: 0.9905, span_micro_r: 0.9915, span_micro_f1: 0.9910, micro_p: 0.9911, micro_r: 0.9753, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 1.5900, span_acc: 0.9974, attr_start_acc: 0.9823, attr_end_acc: 0.9880, span_micro_p: 0.9904, span_micro_r: 0.9916, span_micro_f1: 0.9910, micro_p: 0.9911, micro_r: 0.9742, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 1.5484, span_acc: 0.9975, attr_start_acc: 0.9831, attr_end_acc: 0.9876, span_micro_p: 0.9908, span_micro_r: 0.9918, span_micro_f1: 0.9913, micro_p: 0.9914, micro_r: 0.9743, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 1.5039, span_acc: 0.9975, attr_start_acc: 0.9826, attr_end_acc: 0.9868, span_micro_p: 0.9910, span_micro_r: 0.9914, span_micro_f1: 0.9912, micro_p: 0.9910, micro_r: 0.9739, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 1.5004, span_acc: 0.9974, attr_start_acc: 0.9834, attr_end_acc: 0.9871, span_micro_p: 0.9910, span_micro_r: 0.9914, span_micro_f1: 0.9912, micro_p: 0.9913, micro_r: 0.9748, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 1.4612, span_acc: 0.9975, attr_start_acc: 0.9835, attr_end_acc: 0.9875, span_micro_p: 0.9911, span_micro_r: 0.9917, span_micro_f1: 0.9914, micro_p: 0.9913, micro_r: 0.9751, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 1.4737, span_acc: 0.9975, attr_start_acc: 0.9826, attr_end_acc: 0.9873, span_micro_p: 0.9912, span_micro_r: 0.9914, span_micro_f1: 0.9913, micro_p: 0.9914, micro_r: 0.9743, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 1.4859, span_acc: 0.9973, attr_start_acc: 0.9826, attr_end_acc: 0.9872, span_micro_p: 0.9907, span_micro_r: 0.9910, span_micro_f1: 0.9908, micro_p: 0.9910, micro_r: 0.9742, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 1.4449, span_acc: 0.9971, attr_start_acc: 0.9823, attr_end_acc: 0.9873, span_micro_p: 0.9898, span_micro_r: 0.9904, span_micro_f1: 0.9901, micro_p: 0.9906, micro_r: 0.9738, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 1.3813, span_acc: 0.9972, attr_start_acc: 0.9827, attr_end_acc: 0.9876, span_micro_p: 0.9897, span_micro_r: 0.9906, span_micro_f1: 0.9901, micro_p: 0.9905, micro_r: 0.9742, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 1.3065, span_acc: 0.9972, attr_start_acc: 0.9825, attr_end_acc: 0.9877, span_micro_p: 0.9899, span_micro_r: 0.9905, span_micro_f1: 0.9902, micro_p: 0.9905, micro_r: 0.9743, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 1.2841, span_acc: 0.9973, attr_start_acc: 0.9824, attr_end_acc: 0.9873, span_micro_p: 0.9900, span_micro_r: 0.9906, span_micro_f1: 0.9903, micro_p: 0.9907, micro_r: 0.9739, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 1.2408, span_acc: 0.9973, attr_start_acc: 0.9823, attr_end_acc: 0.9870, span_micro_p: 0.9900, span_micro_r: 0.9907, span_micro_f1: 0.9903, micro_p: 0.9904, micro_r: 0.9734, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 1.2119, span_acc: 0.9973, attr_start_acc: 0.9822, attr_end_acc: 0.9868, span_micro_p: 0.9902, span_micro_r: 0.9908, span_micro_f1: 0.9905, micro_p: 0.9902, micro_r: 0.9728, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 1.2410, span_acc: 0.9972, attr_start_acc: 0.9817, attr_end_acc: 0.9864, span_micro_p: 0.9902, span_micro_r: 0.9907, span_micro_f1: 0.9905, micro_p: 0.9899, micro_r: 0.9720, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 1.1859, span_acc: 0.9972, attr_start_acc: 0.9819, attr_end_acc: 0.9861, span_micro_p: 0.9899, span_micro_r: 0.9907, span_micro_f1: 0.9903, micro_p: 0.9897, micro_r: 0.9717, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 1.1576, span_acc: 0.9972, attr_start_acc: 0.9820, attr_end_acc: 0.9858, span_micro_p: 0.9900, span_micro_r: 0.9909, span_micro_f1: 0.9904, micro_p: 0.9898, micro_r: 0.9715, micro_f1: 0.9805
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 1.1270, span_acc: 0.9973, attr_start_acc: 0.9814, attr_end_acc: 0.9856, span_micro_p: 0.9902, span_micro_r: 0.9911, span_micro_f1: 0.9907, micro_p: 0.9899, micro_r: 0.9708, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.29 / 93.62 / 96.91), p: (95.66 / 96.41), r: (95.72 / 92.19000000000001), f1: (95.69 / 94.26)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 13.961226999115995, 'span_acc': 0.9829464708668877, 'attr_start_acc': 0.9361559139784946, 'attr_end_acc': 0.9690860215053764, 'span_micro_p': 0.9566088117489987, 'span_micro_r': 0.957247828991316, 'span_micro_f1': 0.9569282136894826, 'micro_p': 0.9641097818437719, 'micro_r': 0.9219380888290714, 'micro_f1': 0.9425524595803234, 'category-p/r/f1': {'PRO': (0.8889, 0.4444, 0.5926), 'ORG': (0.9481, 0.8772, 0.9113), 'TITLE': (0.9674, 0.9449, 0.956), 'EDU': (0.981, 0.9717, 0.9763), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9425524595803234 / 0.9642857142857142
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.19 / 92.39 / 97.24000000000001), p: (96.1 / 96.17999999999999), r: (95.34 / 91.10000000000001), f1: (95.72 / 93.57)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 6.715991530403401, 'span_acc': 0.9819374369323915, 'attr_start_acc': 0.9239263803680982, 'attr_end_acc': 0.9723926380368099, 'span_micro_p': 0.961038961038961, 'span_micro_r': 0.9533742331288344, 'span_micro_f1': 0.9571912534647368, 'micro_p': 0.9617875647668394, 'micro_r': 0.911042944785276, 'micro_f1': 0.9357277882797731, 'category-p/r/f1': {'PRO': (0.9412, 0.4848, 0.64), 'ORG': (0.9567, 0.8788, 0.9161), 'LOC': (0.8571, 1.0, 0.9231), 'TITLE': (0.9576, 0.9365, 0.9469), 'EDU': (0.9722, 0.9375, 0.9545), 'NAME': (1.0, 0.9554, 0.9772), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9357277882797731 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: -0.9669, span_acc: 1.0000, attr_start_acc: 0.9817, attr_end_acc: 0.9939, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9969, micro_r: 0.9725, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: -0.1759, span_acc: 0.9993, attr_start_acc: 0.9791, attr_end_acc: 0.9875, span_micro_p: 0.9959, span_micro_r: 0.9972, span_micro_f1: 0.9965, micro_p: 0.9943, micro_r: 0.9694, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 0.6959, span_acc: 0.9978, attr_start_acc: 0.9742, attr_end_acc: 0.9796, span_micro_p: 0.9912, span_micro_r: 0.9912, span_micro_f1: 0.9912, micro_p: 0.9908, micro_r: 0.9600, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: 0.3839, span_acc: 0.9979, attr_start_acc: 0.9741, attr_end_acc: 0.9779, span_micro_p: 0.9906, span_micro_r: 0.9918, span_micro_f1: 0.9912, micro_p: 0.9908, micro_r: 0.9589, micro_f1: 0.9746
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 1.3700, span_acc: 0.9977, attr_start_acc: 0.9768, attr_end_acc: 0.9657, span_micro_p: 0.9925, span_micro_r: 0.9930, span_micro_f1: 0.9927, micro_p: 0.9874, micro_r: 0.9496, micro_f1: 0.9681
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 1.3484, span_acc: 0.9976, attr_start_acc: 0.9757, attr_end_acc: 0.9640, span_micro_p: 0.9913, span_micro_r: 0.9925, span_micro_f1: 0.9919, micro_p: 0.9852, micro_r: 0.9472, micro_f1: 0.9658
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 1.4788, span_acc: 0.9975, attr_start_acc: 0.9771, attr_end_acc: 0.9622, span_micro_p: 0.9905, span_micro_r: 0.9912, span_micro_f1: 0.9909, micro_p: 0.9857, micro_r: 0.9463, micro_f1: 0.9656
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 1.5356, span_acc: 0.9975, attr_start_acc: 0.9764, attr_end_acc: 0.9639, span_micro_p: 0.9912, span_micro_r: 0.9909, span_micro_f1: 0.9910, micro_p: 0.9869, micro_r: 0.9470, micro_f1: 0.9666
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 1.4350, span_acc: 0.9977, attr_start_acc: 0.9770, attr_end_acc: 0.9661, span_micro_p: 0.9920, span_micro_r: 0.9918, span_micro_f1: 0.9919, micro_p: 0.9875, micro_r: 0.9487, micro_f1: 0.9677
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 1.2479, span_acc: 0.9977, attr_start_acc: 0.9777, attr_end_acc: 0.9674, span_micro_p: 0.9921, span_micro_r: 0.9914, span_micro_f1: 0.9918, micro_p: 0.9878, micro_r: 0.9503, micro_f1: 0.9687
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 1.0529, span_acc: 0.9979, attr_start_acc: 0.9783, attr_end_acc: 0.9667, span_micro_p: 0.9928, span_micro_r: 0.9922, span_micro_f1: 0.9925, micro_p: 0.9884, micro_r: 0.9509, micro_f1: 0.9693
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 1.0555, span_acc: 0.9979, attr_start_acc: 0.9784, attr_end_acc: 0.9679, span_micro_p: 0.9930, span_micro_r: 0.9917, span_micro_f1: 0.9924, micro_p: 0.9888, micro_r: 0.9527, micro_f1: 0.9704
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 0.9743, span_acc: 0.9980, attr_start_acc: 0.9789, attr_end_acc: 0.9688, span_micro_p: 0.9929, span_micro_r: 0.9920, span_micro_f1: 0.9925, micro_p: 0.9889, micro_r: 0.9540, micro_f1: 0.9712
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 1.0248, span_acc: 0.9981, attr_start_acc: 0.9802, attr_end_acc: 0.9707, span_micro_p: 0.9933, span_micro_r: 0.9923, span_micro_f1: 0.9928, micro_p: 0.9898, micro_r: 0.9567, micro_f1: 0.9730
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 1.0015, span_acc: 0.9981, attr_start_acc: 0.9805, attr_end_acc: 0.9714, span_micro_p: 0.9933, span_micro_r: 0.9925, span_micro_f1: 0.9929, micro_p: 0.9900, micro_r: 0.9580, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 0.9054, span_acc: 0.9982, attr_start_acc: 0.9809, attr_end_acc: 0.9722, span_micro_p: 0.9937, span_micro_r: 0.9930, span_micro_f1: 0.9934, micro_p: 0.9904, micro_r: 0.9592, micro_f1: 0.9745
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 0.9585, span_acc: 0.9982, attr_start_acc: 0.9802, attr_end_acc: 0.9720, span_micro_p: 0.9937, span_micro_r: 0.9927, span_micro_f1: 0.9932, micro_p: 0.9902, micro_r: 0.9587, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 0.9348, span_acc: 0.9982, attr_start_acc: 0.9804, attr_end_acc: 0.9734, span_micro_p: 0.9938, span_micro_r: 0.9930, span_micro_f1: 0.9934, micro_p: 0.9907, micro_r: 0.9598, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 0.9607, span_acc: 0.9983, attr_start_acc: 0.9807, attr_end_acc: 0.9738, span_micro_p: 0.9938, span_micro_r: 0.9932, span_micro_f1: 0.9935, micro_p: 0.9909, micro_r: 0.9604, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 0.8699, span_acc: 0.9983, attr_start_acc: 0.9810, attr_end_acc: 0.9745, span_micro_p: 0.9940, span_micro_r: 0.9933, span_micro_f1: 0.9937, micro_p: 0.9911, micro_r: 0.9613, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 1.0122, span_acc: 0.9983, attr_start_acc: 0.9814, attr_end_acc: 0.9755, span_micro_p: 0.9940, span_micro_r: 0.9931, span_micro_f1: 0.9935, micro_p: 0.9914, micro_r: 0.9625, micro_f1: 0.9767
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 1.0011, span_acc: 0.9983, attr_start_acc: 0.9812, attr_end_acc: 0.9759, span_micro_p: 0.9940, span_micro_r: 0.9933, span_micro_f1: 0.9936, micro_p: 0.9911, micro_r: 0.9630, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 1.0137, span_acc: 0.9984, attr_start_acc: 0.9811, attr_end_acc: 0.9764, span_micro_p: 0.9942, span_micro_r: 0.9935, span_micro_f1: 0.9939, micro_p: 0.9911, micro_r: 0.9635, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 1.1162, span_acc: 0.9984, attr_start_acc: 0.9812, attr_end_acc: 0.9768, span_micro_p: 0.9942, span_micro_r: 0.9935, span_micro_f1: 0.9938, micro_p: 0.9912, micro_r: 0.9639, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 1.1756, span_acc: 0.9984, attr_start_acc: 0.9810, attr_end_acc: 0.9766, span_micro_p: 0.9943, span_micro_r: 0.9936, span_micro_f1: 0.9939, micro_p: 0.9910, micro_r: 0.9636, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 1.2509, span_acc: 0.9984, attr_start_acc: 0.9807, attr_end_acc: 0.9769, span_micro_p: 0.9943, span_micro_r: 0.9938, span_micro_f1: 0.9941, micro_p: 0.9909, micro_r: 0.9634, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 1.2764, span_acc: 0.9985, attr_start_acc: 0.9803, attr_end_acc: 0.9774, span_micro_p: 0.9945, span_micro_r: 0.9939, span_micro_f1: 0.9942, micro_p: 0.9909, micro_r: 0.9634, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 1.2966, span_acc: 0.9985, attr_start_acc: 0.9806, attr_end_acc: 0.9777, span_micro_p: 0.9946, span_micro_r: 0.9940, span_micro_f1: 0.9943, micro_p: 0.9911, micro_r: 0.9638, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 1.6721, span_acc: 0.9984, attr_start_acc: 0.9808, attr_end_acc: 0.9778, span_micro_p: 0.9943, span_micro_r: 0.9938, span_micro_f1: 0.9941, micro_p: 0.9911, micro_r: 0.9641, micro_f1: 0.9774
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 2.1248, span_acc: 0.9984, attr_start_acc: 0.9810, attr_end_acc: 0.9780, span_micro_p: 0.9939, span_micro_r: 0.9938, span_micro_f1: 0.9938, micro_p: 0.9912, micro_r: 0.9642, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 2.0756, span_acc: 0.9984, attr_start_acc: 0.9811, attr_end_acc: 0.9777, span_micro_p: 0.9937, span_micro_r: 0.9938, span_micro_f1: 0.9937, micro_p: 0.9910, micro_r: 0.9640, micro_f1: 0.9773
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 2.0669, span_acc: 0.9983, attr_start_acc: 0.9808, attr_end_acc: 0.9774, span_micro_p: 0.9936, span_micro_r: 0.9935, span_micro_f1: 0.9936, micro_p: 0.9910, micro_r: 0.9637, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.45 / 97.58 / 97.24000000000001), p: (95.37 / 95.99), r: (96.39 / 95.02000000000001), f1: (95.88 / 95.5)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 25.52837287118059, 'span_acc': 0.9844860255802937, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9724462365591398, 'span_micro_p': 0.9537343027098479, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.9588039867109635, 'micro_p': 0.9598912304554724, 'micro_r': 0.9502018842530283, 'micro_f1': 0.9550219817382483, 'category-p/r/f1': {'PRO': (0.9167, 0.6111, 0.7333), 'ORG': (0.9379, 0.9271, 0.9325), 'TITLE': (0.9693, 0.9594, 0.9643), 'EDU': (0.9633, 0.9906, 0.9768), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9550219817382483 / 0.9642857142857142
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.77 / 95.89 / 96.93), p: (95.41 / 95.99), r: (95.58 / 94.11), f1: (95.49 / 95.04)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 18.20011960785344, 'span_acc': 0.9776992936427851, 'attr_start_acc': 0.9588957055214724, 'attr_end_acc': 0.9693251533742331, 'span_micro_p': 0.9540722596448254, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9549494330370825, 'micro_p': 0.9599499374217773, 'micro_r': 0.9411042944785276, 'micro_f1': 0.9504337050805453, 'category-p/r/f1': {'PRO': (0.8636, 0.5758, 0.6909), 'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9557, 0.9367, 0.9461), 'EDU': (0.9397, 0.9732, 0.9562), 'TITLE': (0.9608, 0.9521, 0.9564), 'NAME': (1.0, 0.9464, 0.9725), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9504337050805453 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: 0.6055, span_acc: 0.9977, attr_start_acc: 0.9730, attr_end_acc: 0.9892, span_micro_p: 0.9920, span_micro_r: 0.9973, span_micro_f1: 0.9947, micro_p: 0.9945, micro_r: 0.9703, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: 0.7607, span_acc: 0.9977, attr_start_acc: 0.9773, attr_end_acc: 0.9920, span_micro_p: 0.9894, span_micro_r: 0.9947, span_micro_f1: 0.9921, micro_p: 0.9891, micro_r: 0.9719, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 3.1086, span_acc: 0.9981, attr_start_acc: 0.9747, attr_end_acc: 0.9887, span_micro_p: 0.9914, span_micro_r: 0.9957, span_micro_f1: 0.9935, micro_p: 0.9902, micro_r: 0.9695, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 3.1119, span_acc: 0.9983, attr_start_acc: 0.9746, attr_end_acc: 0.9882, span_micro_p: 0.9927, span_micro_r: 0.9951, span_micro_f1: 0.9939, micro_p: 0.9911, micro_r: 0.9696, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 3.0554, span_acc: 0.9983, attr_start_acc: 0.9781, attr_end_acc: 0.9883, span_micro_p: 0.9928, span_micro_r: 0.9937, span_micro_f1: 0.9932, micro_p: 0.9920, micro_r: 0.9722, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 4.3376, span_acc: 0.9986, attr_start_acc: 0.9781, attr_end_acc: 0.9861, span_micro_p: 0.9941, span_micro_r: 0.9949, span_micro_f1: 0.9945, micro_p: 0.9911, micro_r: 0.9721, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 4.4078, span_acc: 0.9987, attr_start_acc: 0.9781, attr_end_acc: 0.9853, span_micro_p: 0.9949, span_micro_r: 0.9952, span_micro_f1: 0.9951, micro_p: 0.9913, micro_r: 0.9716, micro_f1: 0.9813
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 3.8691, span_acc: 0.9987, attr_start_acc: 0.9792, attr_end_acc: 0.9855, span_micro_p: 0.9949, span_micro_r: 0.9955, span_micro_f1: 0.9952, micro_p: 0.9917, micro_r: 0.9720, micro_f1: 0.9817
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 4.8338, span_acc: 0.9986, attr_start_acc: 0.9787, attr_end_acc: 0.9841, span_micro_p: 0.9949, span_micro_r: 0.9947, span_micro_f1: 0.9948, micro_p: 0.9915, micro_r: 0.9698, micro_f1: 0.9805
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 4.5031, span_acc: 0.9987, attr_start_acc: 0.9795, attr_end_acc: 0.9843, span_micro_p: 0.9950, span_micro_r: 0.9950, span_micro_f1: 0.9950, micro_p: 0.9913, micro_r: 0.9712, micro_f1: 0.9811
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 4.2537, span_acc: 0.9986, attr_start_acc: 0.9787, attr_end_acc: 0.9837, span_micro_p: 0.9952, span_micro_r: 0.9952, span_micro_f1: 0.9952, micro_p: 0.9909, micro_r: 0.9702, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 4.9985, span_acc: 0.9982, attr_start_acc: 0.9770, attr_end_acc: 0.9834, span_micro_p: 0.9944, span_micro_r: 0.9942, span_micro_f1: 0.9943, micro_p: 0.9902, micro_r: 0.9676, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 4.7896, span_acc: 0.9983, attr_start_acc: 0.9771, attr_end_acc: 0.9836, span_micro_p: 0.9947, span_micro_r: 0.9943, span_micro_f1: 0.9945, micro_p: 0.9905, micro_r: 0.9677, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 4.5155, span_acc: 0.9982, attr_start_acc: 0.9775, attr_end_acc: 0.9841, span_micro_p: 0.9949, span_micro_r: 0.9940, span_micro_f1: 0.9945, micro_p: 0.9907, micro_r: 0.9684, micro_f1: 0.9794
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 4.2353, span_acc: 0.9982, attr_start_acc: 0.9780, attr_end_acc: 0.9840, span_micro_p: 0.9949, span_micro_r: 0.9941, span_micro_f1: 0.9945, micro_p: 0.9907, micro_r: 0.9687, micro_f1: 0.9796
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 3.9599, span_acc: 0.9982, attr_start_acc: 0.9788, attr_end_acc: 0.9837, span_micro_p: 0.9948, span_micro_r: 0.9937, span_micro_f1: 0.9942, micro_p: 0.9909, micro_r: 0.9690, micro_f1: 0.9798
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 3.9493, span_acc: 0.9983, attr_start_acc: 0.9788, attr_end_acc: 0.9843, span_micro_p: 0.9950, span_micro_r: 0.9940, span_micro_f1: 0.9945, micro_p: 0.9909, micro_r: 0.9696, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 4.0490, span_acc: 0.9983, attr_start_acc: 0.9782, attr_end_acc: 0.9842, span_micro_p: 0.9952, span_micro_r: 0.9941, span_micro_f1: 0.9946, micro_p: 0.9913, micro_r: 0.9690, micro_f1: 0.9800
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 4.2250, span_acc: 0.9982, attr_start_acc: 0.9764, attr_end_acc: 0.9832, span_micro_p: 0.9952, span_micro_r: 0.9941, span_micro_f1: 0.9947, micro_p: 0.9902, micro_r: 0.9674, micro_f1: 0.9786
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 4.1298, span_acc: 0.9982, attr_start_acc: 0.9765, attr_end_acc: 0.9830, span_micro_p: 0.9952, span_micro_r: 0.9941, span_micro_f1: 0.9947, micro_p: 0.9904, micro_r: 0.9673, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 4.0973, span_acc: 0.9982, attr_start_acc: 0.9768, attr_end_acc: 0.9830, span_micro_p: 0.9952, span_micro_r: 0.9942, span_micro_f1: 0.9947, micro_p: 0.9902, micro_r: 0.9673, micro_f1: 0.9786
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 4.0565, span_acc: 0.9983, attr_start_acc: 0.9775, attr_end_acc: 0.9828, span_micro_p: 0.9954, span_micro_r: 0.9944, span_micro_f1: 0.9949, micro_p: 0.9904, micro_r: 0.9674, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 3.8665, span_acc: 0.9983, attr_start_acc: 0.9775, attr_end_acc: 0.9826, span_micro_p: 0.9955, span_micro_r: 0.9945, span_micro_f1: 0.9950, micro_p: 0.9905, micro_r: 0.9673, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 4.1262, span_acc: 0.9983, attr_start_acc: 0.9775, attr_end_acc: 0.9830, span_micro_p: 0.9953, span_micro_r: 0.9944, span_micro_f1: 0.9949, micro_p: 0.9907, micro_r: 0.9674, micro_f1: 0.9789
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 4.2036, span_acc: 0.9983, attr_start_acc: 0.9771, attr_end_acc: 0.9830, span_micro_p: 0.9953, span_micro_r: 0.9942, span_micro_f1: 0.9948, micro_p: 0.9908, micro_r: 0.9669, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 4.1560, span_acc: 0.9983, attr_start_acc: 0.9774, attr_end_acc: 0.9831, span_micro_p: 0.9955, span_micro_r: 0.9944, span_micro_f1: 0.9949, micro_p: 0.9909, micro_r: 0.9674, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 3.9944, span_acc: 0.9984, attr_start_acc: 0.9776, attr_end_acc: 0.9830, span_micro_p: 0.9957, span_micro_r: 0.9946, span_micro_f1: 0.9951, micro_p: 0.9909, micro_r: 0.9675, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 3.9302, span_acc: 0.9985, attr_start_acc: 0.9782, attr_end_acc: 0.9833, span_micro_p: 0.9958, span_micro_r: 0.9948, span_micro_f1: 0.9953, micro_p: 0.9911, micro_r: 0.9682, micro_f1: 0.9795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 3.8044, span_acc: 0.9985, attr_start_acc: 0.9786, attr_end_acc: 0.9834, span_micro_p: 0.9960, span_micro_r: 0.9950, span_micro_f1: 0.9955, micro_p: 0.9911, micro_r: 0.9689, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 3.6880, span_acc: 0.9986, attr_start_acc: 0.9789, attr_end_acc: 0.9836, span_micro_p: 0.9961, span_micro_r: 0.9952, span_micro_f1: 0.9956, micro_p: 0.9913, micro_r: 0.9693, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 3.6683, span_acc: 0.9986, attr_start_acc: 0.9792, attr_end_acc: 0.9837, span_micro_p: 0.9962, span_micro_r: 0.9952, span_micro_f1: 0.9957, micro_p: 0.9915, micro_r: 0.9696, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 3.6810, span_acc: 0.9986, attr_start_acc: 0.9795, attr_end_acc: 0.9837, span_micro_p: 0.9961, span_micro_r: 0.9949, span_micro_f1: 0.9955, micro_p: 0.9915, micro_r: 0.9698, micro_f1: 0.9805
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.58 / 97.72 / 97.98), p: (94.76 / 95.82000000000001), r: (96.73 / 95.56), f1: (95.74000000000001 / 95.69)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 36.39665292071472, 'span_acc': 0.9857887257224064, 'attr_start_acc': 0.9771505376344086, 'attr_end_acc': 0.9798387096774194, 'span_micro_p': 0.9476439790575916, 'span_micro_r': 0.9672678690714763, 'span_micro_f1': 0.9573553719008264, 'micro_p': 0.9581646423751687, 'micro_r': 0.955585464333782, 'micro_f1': 0.9568733153638813, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9374, 0.9482, 0.9428), 'TITLE': (0.9648, 0.9522, 0.9585), 'EDU': (0.9902, 0.9528, 0.9711), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9568733153638813 / 0.9642857142857142
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.08 / 96.32 / 97.24000000000001), p: (94.43 / 95.48), r: (95.77 / 94.66), f1: (95.1 / 95.07)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 24.413836290251535, 'span_acc': 0.9808274470232089, 'attr_start_acc': 0.9631901840490797, 'attr_end_acc': 0.9723926380368099, 'span_micro_p': 0.9443436176648518, 'span_micro_r': 0.9576687116564417, 'span_micro_f1': 0.9509594882729212, 'micro_p': 0.9548267326732673, 'micro_r': 0.9466257668711656, 'micro_f1': 0.9507085643869378, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.932, 0.9421, 0.937), 'PRO': (0.9394, 0.9394, 0.9394), 'TITLE': (0.9581, 0.9469, 0.9525), 'RACE': (1.0, 0.9286, 0.963), 'NAME': (0.9907, 0.9464, 0.968), 'EDU': (1.0, 0.9643, 0.9818), 'CONT': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9507085643869378 / 0.9597523219814241
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.964286
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.959752
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9809283551967709
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9680981595092024
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9680981595092024
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.95593635250918
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9582822085889571
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9571078431372549
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9592088998763906
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9521472392638037
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.9556650246305419
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9488, 0.9385, 0.9436), 'TITLE': (0.9556, 0.9469, 0.9512), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 2.0334, span_acc: 0.6158, attr_start_acc: 0.0025, attr_end_acc: 0.0787, span_micro_p: 0.3095, span_micro_r: 0.0657, span_micro_f1: 0.1083, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.7140, span_acc: 0.7722, attr_start_acc: 0.1986, attr_end_acc: 0.3734, span_micro_p: 0.6793, span_micro_r: 0.3647, span_micro_f1: 0.4746, micro_p: 0.5410, micro_r: 0.1503, micro_f1: 0.2353
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.5711, span_acc: 0.8265, attr_start_acc: 0.3712, attr_end_acc: 0.5198, span_micro_p: 0.7568, span_micro_r: 0.5027, span_micro_f1: 0.6041, micro_p: 0.6802, micro_r: 0.3071, micro_f1: 0.4232
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.4694, span_acc: 0.8590, attr_start_acc: 0.4521, attr_end_acc: 0.5713, span_micro_p: 0.8072, span_micro_r: 0.5890, span_micro_f1: 0.6810, micro_p: 0.7500, micro_r: 0.3728, micro_f1: 0.4981
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.4110, span_acc: 0.8796, attr_start_acc: 0.5187, attr_end_acc: 0.6216, span_micro_p: 0.8382, span_micro_r: 0.6447, span_micro_f1: 0.7288, micro_p: 0.8040, micro_r: 0.4369, micro_f1: 0.5662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.3555, span_acc: 0.8955, attr_start_acc: 0.5641, attr_end_acc: 0.6542, span_micro_p: 0.8598, span_micro_r: 0.6887, span_micro_f1: 0.7648, micro_p: 0.8381, micro_r: 0.4864, micro_f1: 0.6155
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.3213, span_acc: 0.9040, attr_start_acc: 0.5913, attr_end_acc: 0.6851, span_micro_p: 0.8696, span_micro_r: 0.7127, span_micro_f1: 0.7834, micro_p: 0.8531, micro_r: 0.5144, micro_f1: 0.6418
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.2904, span_acc: 0.9099, attr_start_acc: 0.6187, attr_end_acc: 0.7058, span_micro_p: 0.8730, span_micro_r: 0.7287, span_micro_f1: 0.7944, micro_p: 0.8614, micro_r: 0.5429, micro_f1: 0.6660
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 1.2618, span_acc: 0.9170, attr_start_acc: 0.6444, attr_end_acc: 0.7265, span_micro_p: 0.8815, span_micro_r: 0.7501, span_micro_f1: 0.8105, micro_p: 0.8763, micro_r: 0.5730, micro_f1: 0.6929
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 1.2410, span_acc: 0.9223, attr_start_acc: 0.6680, attr_end_acc: 0.7458, span_micro_p: 0.8875, span_micro_r: 0.7657, span_micro_f1: 0.8221, micro_p: 0.8878, micro_r: 0.5997, micro_f1: 0.7159
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 1.2202, span_acc: 0.9276, attr_start_acc: 0.6863, attr_end_acc: 0.7582, span_micro_p: 0.8900, span_micro_r: 0.7771, span_micro_f1: 0.8297, micro_p: 0.8949, micro_r: 0.6189, micro_f1: 0.7317
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 1.2001, span_acc: 0.9321, attr_start_acc: 0.7043, attr_end_acc: 0.7726, span_micro_p: 0.8956, span_micro_r: 0.7907, span_micro_f1: 0.8399, micro_p: 0.9030, micro_r: 0.6405, micro_f1: 0.7494
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 1.1857, span_acc: 0.9360, attr_start_acc: 0.7206, attr_end_acc: 0.7846, span_micro_p: 0.9006, span_micro_r: 0.8030, span_micro_f1: 0.8490, micro_p: 0.9100, micro_r: 0.6588, micro_f1: 0.7643
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 1.1751, span_acc: 0.9381, attr_start_acc: 0.7324, attr_end_acc: 0.7934, span_micro_p: 0.9023, span_micro_r: 0.8093, span_micro_f1: 0.8533, micro_p: 0.9145, micro_r: 0.6713, micro_f1: 0.7743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 1.1619, span_acc: 0.9410, attr_start_acc: 0.7454, attr_end_acc: 0.8033, span_micro_p: 0.9058, span_micro_r: 0.8174, span_micro_f1: 0.8594, micro_p: 0.9185, micro_r: 0.6869, micro_f1: 0.7860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 1.1506, span_acc: 0.9424, attr_start_acc: 0.7555, attr_end_acc: 0.8118, span_micro_p: 0.9073, span_micro_r: 0.8230, span_micro_f1: 0.8631, micro_p: 0.9218, micro_r: 0.6989, micro_f1: 0.7950
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 1.1369, span_acc: 0.9450, attr_start_acc: 0.7653, attr_end_acc: 0.8212, span_micro_p: 0.9096, span_micro_r: 0.8298, span_micro_f1: 0.8679, micro_p: 0.9243, micro_r: 0.7098, micro_f1: 0.8029
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 1.1261, span_acc: 0.9467, attr_start_acc: 0.7738, attr_end_acc: 0.8283, span_micro_p: 0.9117, span_micro_r: 0.8349, span_micro_f1: 0.8716, micro_p: 0.9275, micro_r: 0.7199, micro_f1: 0.8106
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 1.1175, span_acc: 0.9478, attr_start_acc: 0.7797, attr_end_acc: 0.8345, span_micro_p: 0.9097, span_micro_r: 0.8369, span_micro_f1: 0.8718, micro_p: 0.9262, micro_r: 0.7264, micro_f1: 0.8143
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 1.1070, span_acc: 0.9493, attr_start_acc: 0.7876, attr_end_acc: 0.8400, span_micro_p: 0.9115, span_micro_r: 0.8417, span_micro_f1: 0.8752, micro_p: 0.9271, micro_r: 0.7353, micro_f1: 0.8201
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 1.0983, span_acc: 0.9506, attr_start_acc: 0.7940, attr_end_acc: 0.8455, span_micro_p: 0.9137, span_micro_r: 0.8460, span_micro_f1: 0.8786, micro_p: 0.9290, micro_r: 0.7428, micro_f1: 0.8256
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 1.0925, span_acc: 0.9514, attr_start_acc: 0.7998, attr_end_acc: 0.8497, span_micro_p: 0.9139, span_micro_r: 0.8488, span_micro_f1: 0.8802, micro_p: 0.9306, micro_r: 0.7486, micro_f1: 0.8298
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 1.0831, span_acc: 0.9526, attr_start_acc: 0.8052, attr_end_acc: 0.8534, span_micro_p: 0.9154, span_micro_r: 0.8525, span_micro_f1: 0.8828, micro_p: 0.9329, micro_r: 0.7544, micro_f1: 0.8342
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 1.0764, span_acc: 0.9537, attr_start_acc: 0.8106, attr_end_acc: 0.8589, span_micro_p: 0.9161, span_micro_r: 0.8555, span_micro_f1: 0.8847, micro_p: 0.9344, micro_r: 0.7611, micro_f1: 0.8389
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 1.0672, span_acc: 0.9549, attr_start_acc: 0.8152, attr_end_acc: 0.8628, span_micro_p: 0.9184, span_micro_r: 0.8592, span_micro_f1: 0.8878, micro_p: 0.9354, micro_r: 0.7666, micro_f1: 0.8426
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 1.0580, span_acc: 0.9557, attr_start_acc: 0.8195, attr_end_acc: 0.8659, span_micro_p: 0.9180, span_micro_r: 0.8616, span_micro_f1: 0.8889, micro_p: 0.9353, micro_r: 0.7708, micro_f1: 0.8451
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 1.0498, span_acc: 0.9562, attr_start_acc: 0.8238, attr_end_acc: 0.8691, span_micro_p: 0.9178, span_micro_r: 0.8634, span_micro_f1: 0.8898, micro_p: 0.9357, micro_r: 0.7755, micro_f1: 0.8481
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 1.0427, span_acc: 0.9570, attr_start_acc: 0.8274, attr_end_acc: 0.8718, span_micro_p: 0.9188, span_micro_r: 0.8657, span_micro_f1: 0.8915, micro_p: 0.9366, micro_r: 0.7794, micro_f1: 0.8508
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 1.0340, span_acc: 0.9578, attr_start_acc: 0.8314, attr_end_acc: 0.8748, span_micro_p: 0.9201, span_micro_r: 0.8684, span_micro_f1: 0.8935, micro_p: 0.9378, micro_r: 0.7842, micro_f1: 0.8542
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 1.0261, span_acc: 0.9588, attr_start_acc: 0.8362, attr_end_acc: 0.8779, span_micro_p: 0.9221, span_micro_r: 0.8715, span_micro_f1: 0.8961, micro_p: 0.9397, micro_r: 0.7896, micro_f1: 0.8581
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 1.0177, span_acc: 0.9597, attr_start_acc: 0.8398, attr_end_acc: 0.8805, span_micro_p: 0.9236, span_micro_r: 0.8740, span_micro_f1: 0.8981, micro_p: 0.9408, micro_r: 0.7939, micro_f1: 0.8611
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.02 / 94.49 / 95.3), p: (96.00999999999999 / 96.91), r: (94.92 / 90.71000000000001), f1: (95.47 / 93.71000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.6750675733352068, 'span_acc': 0.9802226432970156, 'attr_start_acc': 0.9448924731182796, 'attr_end_acc': 0.9529569892473119, 'span_micro_p': 0.9601351351351352, 'span_micro_r': 0.9492317969271877, 'span_micro_f1': 0.9546523345649984, 'micro_p': 0.9690869877785766, 'micro_r': 0.9071332436069987, 'micro_f1': 0.9370872436565868, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'ORG': (0.9586, 0.8887, 0.9223), 'TITLE': (0.9719, 0.9029, 0.9361), 'PRO': (0.9444, 0.9444, 0.9444), 'EDU': (0.9706, 0.934, 0.9519), 'CONT': (1.0, 0.9091, 0.9524), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9370872436565868 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.39999999999999 / 94.54 / 95.71), p: (96.06 / 97.72), r: (94.36 / 91.9), f1: (95.19999999999999 / 94.72)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.6800680220501978, 'span_acc': 0.9739656912209889, 'attr_start_acc': 0.945398773006135, 'attr_end_acc': 0.9570552147239264, 'span_micro_p': 0.9606495940037476, 'span_micro_r': 0.943558282208589, 'span_micro_f1': 0.9520272361497988, 'micro_p': 0.9771689497716894, 'micro_r': 0.9190184049079755, 'micro_f1': 0.9472020233955105, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9677, 0.9091, 0.9375), 'ORG': (0.9655, 0.9114, 0.9377), 'TITLE': (0.9792, 0.9158, 0.9464), 'EDU': (1.0, 0.9196, 0.9581), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9472020233955105 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.8025, span_acc: 0.9509, attr_start_acc: 0.9143, attr_end_acc: 0.8857, span_micro_p: 0.8824, span_micro_r: 0.8571, span_micro_f1: 0.8696, micro_p: 1.0000, micro_r: 0.8000, micro_f1: 0.8889
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.7209, span_acc: 0.9825, attr_start_acc: 0.9638, attr_end_acc: 0.9716, span_micro_p: 0.9432, span_micro_r: 0.9407, span_micro_f1: 0.9419, micro_p: 0.9730, micro_r: 0.9328, micro_f1: 0.9525
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.7194, span_acc: 0.9816, attr_start_acc: 0.9596, attr_end_acc: 0.9559, span_micro_p: 0.9505, span_micro_r: 0.9354, span_micro_f1: 0.9429, micro_p: 0.9690, micro_r: 0.9168, micro_f1: 0.9421
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.7126, span_acc: 0.9833, attr_start_acc: 0.9553, attr_end_acc: 0.9576, span_micro_p: 0.9556, span_micro_r: 0.9407, span_micro_f1: 0.9481, micro_p: 0.9677, micro_r: 0.9168, micro_f1: 0.9416
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.7132, span_acc: 0.9822, attr_start_acc: 0.9595, attr_end_acc: 0.9636, span_micro_p: 0.9561, span_micro_r: 0.9408, span_micro_f1: 0.9483, micro_p: 0.9670, micro_r: 0.9261, micro_f1: 0.9461
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.7160, span_acc: 0.9805, attr_start_acc: 0.9555, attr_end_acc: 0.9637, span_micro_p: 0.9490, span_micro_r: 0.9387, span_micro_f1: 0.9438, micro_p: 0.9606, micro_r: 0.9220, micro_f1: 0.9409
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.7042, span_acc: 0.9809, attr_start_acc: 0.9550, attr_end_acc: 0.9658, span_micro_p: 0.9500, span_micro_r: 0.9391, span_micro_f1: 0.9445, micro_p: 0.9623, micro_r: 0.9248, micro_f1: 0.9432
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.6956, span_acc: 0.9810, attr_start_acc: 0.9573, attr_end_acc: 0.9673, span_micro_p: 0.9533, span_micro_r: 0.9425, span_micro_f1: 0.9479, micro_p: 0.9660, micro_r: 0.9284, micro_f1: 0.9468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.6858, span_acc: 0.9811, attr_start_acc: 0.9594, attr_end_acc: 0.9676, span_micro_p: 0.9556, span_micro_r: 0.9459, span_micro_f1: 0.9508, micro_p: 0.9675, micro_r: 0.9306, micro_f1: 0.9487
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.6792, span_acc: 0.9811, attr_start_acc: 0.9597, attr_end_acc: 0.9672, span_micro_p: 0.9548, span_micro_r: 0.9417, span_micro_f1: 0.9482, micro_p: 0.9683, micro_r: 0.9300, micro_f1: 0.9488
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.6713, span_acc: 0.9820, attr_start_acc: 0.9611, attr_end_acc: 0.9690, span_micro_p: 0.9560, span_micro_r: 0.9439, span_micro_f1: 0.9499, micro_p: 0.9695, micro_r: 0.9332, micro_f1: 0.9510
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.6601, span_acc: 0.9826, attr_start_acc: 0.9625, attr_end_acc: 0.9708, span_micro_p: 0.9569, span_micro_r: 0.9459, span_micro_f1: 0.9513, micro_p: 0.9693, micro_r: 0.9357, micro_f1: 0.9522
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.6503, span_acc: 0.9831, attr_start_acc: 0.9619, attr_end_acc: 0.9707, span_micro_p: 0.9572, span_micro_r: 0.9457, span_micro_f1: 0.9514, micro_p: 0.9696, micro_r: 0.9357, micro_f1: 0.9523
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.6479, span_acc: 0.9832, attr_start_acc: 0.9607, attr_end_acc: 0.9702, span_micro_p: 0.9561, span_micro_r: 0.9446, span_micro_f1: 0.9503, micro_p: 0.9689, micro_r: 0.9346, micro_f1: 0.9514
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.6413, span_acc: 0.9832, attr_start_acc: 0.9605, attr_end_acc: 0.9711, span_micro_p: 0.9565, span_micro_r: 0.9452, span_micro_f1: 0.9508, micro_p: 0.9686, micro_r: 0.9347, micro_f1: 0.9514
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.6314, span_acc: 0.9834, attr_start_acc: 0.9609, attr_end_acc: 0.9714, span_micro_p: 0.9571, span_micro_r: 0.9460, span_micro_f1: 0.9515, micro_p: 0.9690, micro_r: 0.9357, micro_f1: 0.9521
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.6304, span_acc: 0.9833, attr_start_acc: 0.9610, attr_end_acc: 0.9715, span_micro_p: 0.9562, span_micro_r: 0.9458, span_micro_f1: 0.9509, micro_p: 0.9686, micro_r: 0.9360, micro_f1: 0.9520
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.6209, span_acc: 0.9837, attr_start_acc: 0.9613, attr_end_acc: 0.9715, span_micro_p: 0.9573, span_micro_r: 0.9472, span_micro_f1: 0.9522, micro_p: 0.9696, micro_r: 0.9362, micro_f1: 0.9526
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.6225, span_acc: 0.9833, attr_start_acc: 0.9618, attr_end_acc: 0.9712, span_micro_p: 0.9568, span_micro_r: 0.9471, span_micro_f1: 0.9520, micro_p: 0.9695, micro_r: 0.9363, micro_f1: 0.9526
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.6152, span_acc: 0.9834, attr_start_acc: 0.9609, attr_end_acc: 0.9704, span_micro_p: 0.9561, span_micro_r: 0.9464, span_micro_f1: 0.9512, micro_p: 0.9691, micro_r: 0.9359, micro_f1: 0.9522
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.6090, span_acc: 0.9832, attr_start_acc: 0.9605, attr_end_acc: 0.9704, span_micro_p: 0.9564, span_micro_r: 0.9460, span_micro_f1: 0.9511, micro_p: 0.9694, micro_r: 0.9358, micro_f1: 0.9523
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.5985, span_acc: 0.9838, attr_start_acc: 0.9614, attr_end_acc: 0.9708, span_micro_p: 0.9574, span_micro_r: 0.9476, span_micro_f1: 0.9525, micro_p: 0.9699, micro_r: 0.9369, micro_f1: 0.9531
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.5922, span_acc: 0.9839, attr_start_acc: 0.9617, attr_end_acc: 0.9710, span_micro_p: 0.9575, span_micro_r: 0.9479, span_micro_f1: 0.9527, micro_p: 0.9699, micro_r: 0.9373, micro_f1: 0.9533
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.5834, span_acc: 0.9835, attr_start_acc: 0.9613, attr_end_acc: 0.9712, span_micro_p: 0.9572, span_micro_r: 0.9475, span_micro_f1: 0.9523, micro_p: 0.9699, micro_r: 0.9373, micro_f1: 0.9533
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.5829, span_acc: 0.9837, attr_start_acc: 0.9612, attr_end_acc: 0.9716, span_micro_p: 0.9569, span_micro_r: 0.9479, span_micro_f1: 0.9524, micro_p: 0.9696, micro_r: 0.9376, micro_f1: 0.9533
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.5834, span_acc: 0.9829, attr_start_acc: 0.9620, attr_end_acc: 0.9713, span_micro_p: 0.9549, span_micro_r: 0.9479, span_micro_f1: 0.9514, micro_p: 0.9697, micro_r: 0.9378, micro_f1: 0.9535
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.5771, span_acc: 0.9830, attr_start_acc: 0.9625, attr_end_acc: 0.9715, span_micro_p: 0.9546, span_micro_r: 0.9480, span_micro_f1: 0.9513, micro_p: 0.9691, micro_r: 0.9380, micro_f1: 0.9533
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.5722, span_acc: 0.9830, attr_start_acc: 0.9626, attr_end_acc: 0.9720, span_micro_p: 0.9546, span_micro_r: 0.9484, span_micro_f1: 0.9515, micro_p: 0.9688, micro_r: 0.9380, micro_f1: 0.9532
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.5645, span_acc: 0.9832, attr_start_acc: 0.9633, attr_end_acc: 0.9726, span_micro_p: 0.9551, span_micro_r: 0.9492, span_micro_f1: 0.9522, micro_p: 0.9691, micro_r: 0.9390, micro_f1: 0.9538
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.5622, span_acc: 0.9833, attr_start_acc: 0.9633, attr_end_acc: 0.9725, span_micro_p: 0.9553, span_micro_r: 0.9490, span_micro_f1: 0.9521, micro_p: 0.9695, micro_r: 0.9390, micro_f1: 0.9540
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.5536, span_acc: 0.9834, attr_start_acc: 0.9632, attr_end_acc: 0.9723, span_micro_p: 0.9555, span_micro_r: 0.9491, span_micro_f1: 0.9523, micro_p: 0.9694, micro_r: 0.9389, micro_f1: 0.9539
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.5539, span_acc: 0.9832, attr_start_acc: 0.9632, attr_end_acc: 0.9724, span_micro_p: 0.9546, span_micro_r: 0.9485, span_micro_f1: 0.9516, micro_p: 0.9688, micro_r: 0.9385, micro_f1: 0.9534
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.87 / 97.31 / 98.32), p: (95.55 / 96.33), r: (96.13000000000001 / 95.42), f1: (95.84 / 95.88)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.407193769067204, 'span_acc': 0.9887494078635718, 'attr_start_acc': 0.9731182795698925, 'attr_end_acc': 0.9831989247311828, 'span_micro_p': 0.9555112881806109, 'span_micro_r': 0.9612558450233801, 'span_micro_f1': 0.9583749583749583, 'micro_p': 0.9633152173913043, 'micro_r': 0.9542395693135935, 'micro_f1': 0.9587559161595672, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'ORG': (0.9461, 0.9424, 0.9442), 'TITLE': (0.9676, 0.9522, 0.9598), 'EDU': (0.9717, 0.9717, 0.9717), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'PRO': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9587559161595672 / 0.9370872436565868
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.42999999999999 / 95.95 / 96.93), p: (95.17999999999999 / 96.77), r: (94.54 / 93.74), f1: (94.86 / 95.23)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.19988901435204273, 'span_acc': 0.9842583249243189, 'attr_start_acc': 0.9595092024539877, 'attr_end_acc': 0.9693251533742331, 'span_micro_p': 0.9518221124150711, 'span_micro_r': 0.945398773006135, 'span_micro_f1': 0.9485995690981841, 'micro_p': 0.967701076630779, 'micro_r': 0.9374233128834356, 'micro_f1': 0.9523215955126209, 'category-p/r/f1': {'LOC': (1.0, 0.3333, 0.5), 'ORG': (0.9585, 0.9186, 0.9381), 'TITLE': (0.9653, 0.9378, 0.9514), 'PRO': (0.9697, 0.9697, 0.9697), 'EDU': (0.9818, 0.9643, 0.973), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9523215955126209 / 0.9472020233955105
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: 0.1495, span_acc: 1.0000, attr_start_acc: 0.9740, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9740, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: 0.1855, span_acc: 0.9872, attr_start_acc: 0.9660, attr_end_acc: 0.9703, span_micro_p: 0.9722, span_micro_r: 0.9579, span_micro_f1: 0.9650, micro_p: 0.9736, micro_r: 0.9384, micro_f1: 0.9557
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: 0.3018, span_acc: 0.9814, attr_start_acc: 0.9593, attr_end_acc: 0.9740, span_micro_p: 0.9568, span_micro_r: 0.9418, span_micro_f1: 0.9492, micro_p: 0.9661, micro_r: 0.9376, micro_f1: 0.9517
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: 0.2721, span_acc: 0.9849, attr_start_acc: 0.9614, attr_end_acc: 0.9791, span_micro_p: 0.9613, span_micro_r: 0.9521, span_micro_f1: 0.9567, micro_p: 0.9717, micro_r: 0.9427, micro_f1: 0.9570
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: 0.2768, span_acc: 0.9858, attr_start_acc: 0.9661, attr_end_acc: 0.9821, span_micro_p: 0.9596, span_micro_r: 0.9551, span_micro_f1: 0.9573, micro_p: 0.9713, micro_r: 0.9481, micro_f1: 0.9596
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: 0.2913, span_acc: 0.9860, attr_start_acc: 0.9669, attr_end_acc: 0.9811, span_micro_p: 0.9582, span_micro_r: 0.9559, span_micro_f1: 0.9570, micro_p: 0.9733, micro_r: 0.9489, micro_f1: 0.9610
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: 0.2937, span_acc: 0.9862, attr_start_acc: 0.9661, attr_end_acc: 0.9797, span_micro_p: 0.9600, span_micro_r: 0.9586, span_micro_f1: 0.9593, micro_p: 0.9747, micro_r: 0.9481, micro_f1: 0.9612
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: 0.2761, span_acc: 0.9874, attr_start_acc: 0.9675, attr_end_acc: 0.9792, span_micro_p: 0.9626, span_micro_r: 0.9600, span_micro_f1: 0.9613, micro_p: 0.9769, micro_r: 0.9493, micro_f1: 0.9629
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: 0.2641, span_acc: 0.9876, attr_start_acc: 0.9677, attr_end_acc: 0.9787, span_micro_p: 0.9625, span_micro_r: 0.9597, span_micro_f1: 0.9611, micro_p: 0.9778, micro_r: 0.9504, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: 0.2493, span_acc: 0.9881, attr_start_acc: 0.9691, attr_end_acc: 0.9789, span_micro_p: 0.9647, span_micro_r: 0.9610, span_micro_f1: 0.9629, micro_p: 0.9796, micro_r: 0.9528, micro_f1: 0.9660
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: 0.2628, span_acc: 0.9888, attr_start_acc: 0.9702, attr_end_acc: 0.9801, span_micro_p: 0.9658, span_micro_r: 0.9631, span_micro_f1: 0.9645, micro_p: 0.9800, micro_r: 0.9549, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: 0.2660, span_acc: 0.9882, attr_start_acc: 0.9678, attr_end_acc: 0.9788, span_micro_p: 0.9638, span_micro_r: 0.9601, span_micro_f1: 0.9620, micro_p: 0.9782, micro_r: 0.9519, micro_f1: 0.9649
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: 0.2558, span_acc: 0.9883, attr_start_acc: 0.9682, attr_end_acc: 0.9781, span_micro_p: 0.9640, span_micro_r: 0.9615, span_micro_f1: 0.9628, micro_p: 0.9773, micro_r: 0.9516, micro_f1: 0.9643
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: 0.2470, span_acc: 0.9886, attr_start_acc: 0.9686, attr_end_acc: 0.9788, span_micro_p: 0.9657, span_micro_r: 0.9626, span_micro_f1: 0.9641, micro_p: 0.9782, micro_r: 0.9528, micro_f1: 0.9653
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: 0.2350, span_acc: 0.9888, attr_start_acc: 0.9693, attr_end_acc: 0.9796, span_micro_p: 0.9663, span_micro_r: 0.9639, span_micro_f1: 0.9651, micro_p: 0.9787, micro_r: 0.9542, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: 0.2313, span_acc: 0.9887, attr_start_acc: 0.9696, attr_end_acc: 0.9798, span_micro_p: 0.9666, span_micro_r: 0.9640, span_micro_f1: 0.9653, micro_p: 0.9783, micro_r: 0.9546, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: 0.2323, span_acc: 0.9886, attr_start_acc: 0.9698, attr_end_acc: 0.9801, span_micro_p: 0.9661, span_micro_r: 0.9637, span_micro_f1: 0.9649, micro_p: 0.9785, micro_r: 0.9549, micro_f1: 0.9666
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: 0.2306, span_acc: 0.9882, attr_start_acc: 0.9697, attr_end_acc: 0.9805, span_micro_p: 0.9650, span_micro_r: 0.9626, span_micro_f1: 0.9638, micro_p: 0.9781, micro_r: 0.9549, micro_f1: 0.9664
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: 0.2296, span_acc: 0.9885, attr_start_acc: 0.9698, attr_end_acc: 0.9813, span_micro_p: 0.9651, span_micro_r: 0.9637, span_micro_f1: 0.9644, micro_p: 0.9785, micro_r: 0.9553, micro_f1: 0.9668
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: 0.2255, span_acc: 0.9884, attr_start_acc: 0.9697, attr_end_acc: 0.9813, span_micro_p: 0.9654, span_micro_r: 0.9640, span_micro_f1: 0.9647, micro_p: 0.9784, micro_r: 0.9553, micro_f1: 0.9667
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: 0.2548, span_acc: 0.9880, attr_start_acc: 0.9699, attr_end_acc: 0.9803, span_micro_p: 0.9662, span_micro_r: 0.9640, span_micro_f1: 0.9651, micro_p: 0.9787, micro_r: 0.9548, micro_f1: 0.9666
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: 0.2474, span_acc: 0.9883, attr_start_acc: 0.9709, attr_end_acc: 0.9807, span_micro_p: 0.9672, span_micro_r: 0.9650, span_micro_f1: 0.9661, micro_p: 0.9791, micro_r: 0.9561, micro_f1: 0.9674
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: 0.2435, span_acc: 0.9885, attr_start_acc: 0.9711, attr_end_acc: 0.9810, span_micro_p: 0.9676, span_micro_r: 0.9651, span_micro_f1: 0.9664, micro_p: 0.9790, micro_r: 0.9568, micro_f1: 0.9678
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: 0.2527, span_acc: 0.9882, attr_start_acc: 0.9706, attr_end_acc: 0.9813, span_micro_p: 0.9674, span_micro_r: 0.9648, span_micro_f1: 0.9661, micro_p: 0.9788, micro_r: 0.9561, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: 0.2451, span_acc: 0.9883, attr_start_acc: 0.9709, attr_end_acc: 0.9815, span_micro_p: 0.9669, span_micro_r: 0.9652, span_micro_f1: 0.9660, micro_p: 0.9782, micro_r: 0.9563, micro_f1: 0.9671
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: 0.2426, span_acc: 0.9884, attr_start_acc: 0.9711, attr_end_acc: 0.9816, span_micro_p: 0.9672, span_micro_r: 0.9652, span_micro_f1: 0.9662, micro_p: 0.9785, micro_r: 0.9567, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: 0.2569, span_acc: 0.9883, attr_start_acc: 0.9710, attr_end_acc: 0.9813, span_micro_p: 0.9671, span_micro_r: 0.9650, span_micro_f1: 0.9660, micro_p: 0.9784, micro_r: 0.9565, micro_f1: 0.9673
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: 0.2597, span_acc: 0.9884, attr_start_acc: 0.9709, attr_end_acc: 0.9815, span_micro_p: 0.9674, span_micro_r: 0.9653, span_micro_f1: 0.9663, micro_p: 0.9787, micro_r: 0.9566, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: 0.2627, span_acc: 0.9884, attr_start_acc: 0.9713, attr_end_acc: 0.9817, span_micro_p: 0.9677, span_micro_r: 0.9651, span_micro_f1: 0.9664, micro_p: 0.9787, micro_r: 0.9569, micro_f1: 0.9677
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: 0.2630, span_acc: 0.9885, attr_start_acc: 0.9713, attr_end_acc: 0.9814, span_micro_p: 0.9680, span_micro_r: 0.9653, span_micro_f1: 0.9666, micro_p: 0.9788, micro_r: 0.9570, micro_f1: 0.9678
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: 0.2535, span_acc: 0.9886, attr_start_acc: 0.9714, attr_end_acc: 0.9813, span_micro_p: 0.9682, span_micro_r: 0.9651, span_micro_f1: 0.9667, micro_p: 0.9791, micro_r: 0.9569, micro_f1: 0.9679
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: 0.2605, span_acc: 0.9888, attr_start_acc: 0.9718, attr_end_acc: 0.9814, span_micro_p: 0.9689, span_micro_r: 0.9658, span_micro_f1: 0.9673, micro_p: 0.9793, micro_r: 0.9576, micro_f1: 0.9683
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.9 / 97.11 / 98.59), p: (96.99 / 97.53), r: (96.99 / 95.76), f1: (96.99 / 96.64)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.09117637770994694, 'span_acc': 0.988986262434865, 'attr_start_acc': 0.9711021505376344, 'attr_end_acc': 0.9858870967741935, 'span_micro_p': 0.969939879759519, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.969939879759519, 'micro_p': 0.9753255654557916, 'micro_r': 0.9576043068640646, 'micro_f1': 0.9663837011884551, 'category-p/r/f1': {'EDU': (0.9896, 0.8962, 0.9406), 'ORG': (0.9615, 0.9578, 0.9596), 'TITLE': (0.9807, 0.958, 0.9692), 'PRO': (0.9474, 1.0, 0.973), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9663837011884551 / 0.9587559161595672
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.09 / 96.56 / 97.67), p: (96.47 / 97.18), r: (95.46 / 95.09), f1: (95.96000000000001 / 96.12)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.1462047371849324, 'span_acc': 0.9809283551967709, 'attr_start_acc': 0.9656441717791411, 'attr_end_acc': 0.9766871165644172, 'span_micro_p': 0.9646621202727836, 'span_micro_r': 0.9546012269938651, 'span_micro_f1': 0.9596053037311132, 'micro_p': 0.9717868338557993, 'micro_r': 0.950920245398773, 'micro_f1': 0.9612403100775194, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9613, 0.9439, 0.9525), 'TITLE': (0.9707, 0.943, 0.9566), 'EDU': (0.9908, 0.9643, 0.9774), 'PRO': (0.9706, 1.0, 0.9851), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9612403100775194 / 0.9523215955126209
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: -0.1989, span_acc: 0.9849, attr_start_acc: 0.9913, attr_end_acc: 0.9652, span_micro_p: 0.9737, span_micro_r: 0.9569, span_micro_f1: 0.9652, micro_p: 0.9823, micro_r: 0.9652, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: -0.2395, span_acc: 0.9924, attr_start_acc: 0.9810, attr_end_acc: 0.9828, span_micro_p: 0.9793, span_micro_r: 0.9693, span_micro_f1: 0.9743, micro_p: 0.9929, micro_r: 0.9672, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.2285, span_acc: 0.9940, attr_start_acc: 0.9779, attr_end_acc: 0.9834, span_micro_p: 0.9807, span_micro_r: 0.9754, span_micro_f1: 0.9780, micro_p: 0.9868, micro_r: 0.9659, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.2210, span_acc: 0.9950, attr_start_acc: 0.9746, attr_end_acc: 0.9828, span_micro_p: 0.9829, span_micro_r: 0.9796, span_micro_f1: 0.9812, micro_p: 0.9866, micro_r: 0.9636, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: -0.2204, span_acc: 0.9948, attr_start_acc: 0.9731, attr_end_acc: 0.9836, span_micro_p: 0.9816, span_micro_r: 0.9780, span_micro_f1: 0.9798, micro_p: 0.9864, micro_r: 0.9609, micro_f1: 0.9735
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: -0.0589, span_acc: 0.9932, attr_start_acc: 0.9697, attr_end_acc: 0.9814, span_micro_p: 0.9788, span_micro_r: 0.9704, span_micro_f1: 0.9746, micro_p: 0.9844, micro_r: 0.9567, micro_f1: 0.9704
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: -0.0110, span_acc: 0.9930, attr_start_acc: 0.9704, attr_end_acc: 0.9807, span_micro_p: 0.9781, span_micro_r: 0.9713, span_micro_f1: 0.9747, micro_p: 0.9840, micro_r: 0.9566, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: -0.0320, span_acc: 0.9930, attr_start_acc: 0.9710, attr_end_acc: 0.9806, span_micro_p: 0.9774, span_micro_r: 0.9703, span_micro_f1: 0.9738, micro_p: 0.9852, micro_r: 0.9579, micro_f1: 0.9714
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: -0.0238, span_acc: 0.9923, attr_start_acc: 0.9709, attr_end_acc: 0.9815, span_micro_p: 0.9768, span_micro_r: 0.9711, span_micro_f1: 0.9739, micro_p: 0.9853, micro_r: 0.9585, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: 0.0033, span_acc: 0.9924, attr_start_acc: 0.9714, attr_end_acc: 0.9816, span_micro_p: 0.9766, span_micro_r: 0.9708, span_micro_f1: 0.9737, micro_p: 0.9851, micro_r: 0.9591, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: 0.0635, span_acc: 0.9926, attr_start_acc: 0.9724, attr_end_acc: 0.9814, span_micro_p: 0.9756, span_micro_r: 0.9714, span_micro_f1: 0.9735, micro_p: 0.9850, micro_r: 0.9591, micro_f1: 0.9719
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: 0.0915, span_acc: 0.9928, attr_start_acc: 0.9729, attr_end_acc: 0.9821, span_micro_p: 0.9760, span_micro_r: 0.9724, span_micro_f1: 0.9742, micro_p: 0.9850, micro_r: 0.9603, micro_f1: 0.9725
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: 0.1102, span_acc: 0.9924, attr_start_acc: 0.9727, attr_end_acc: 0.9822, span_micro_p: 0.9764, span_micro_r: 0.9729, span_micro_f1: 0.9746, micro_p: 0.9845, micro_r: 0.9601, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: 0.1271, span_acc: 0.9926, attr_start_acc: 0.9733, attr_end_acc: 0.9821, span_micro_p: 0.9766, span_micro_r: 0.9733, span_micro_f1: 0.9750, micro_p: 0.9849, micro_r: 0.9607, micro_f1: 0.9726
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: 0.0975, span_acc: 0.9930, attr_start_acc: 0.9740, attr_end_acc: 0.9824, span_micro_p: 0.9775, span_micro_r: 0.9745, span_micro_f1: 0.9760, micro_p: 0.9855, micro_r: 0.9618, micro_f1: 0.9735
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: 0.1023, span_acc: 0.9928, attr_start_acc: 0.9749, attr_end_acc: 0.9823, span_micro_p: 0.9770, span_micro_r: 0.9743, span_micro_f1: 0.9757, micro_p: 0.9852, micro_r: 0.9623, micro_f1: 0.9736
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: 0.1345, span_acc: 0.9926, attr_start_acc: 0.9750, attr_end_acc: 0.9822, span_micro_p: 0.9761, span_micro_r: 0.9744, span_micro_f1: 0.9753, micro_p: 0.9843, micro_r: 0.9623, micro_f1: 0.9732
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: 0.1314, span_acc: 0.9927, attr_start_acc: 0.9748, attr_end_acc: 0.9825, span_micro_p: 0.9763, span_micro_r: 0.9742, span_micro_f1: 0.9752, micro_p: 0.9840, micro_r: 0.9624, micro_f1: 0.9731
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: 0.1169, span_acc: 0.9930, attr_start_acc: 0.9759, attr_end_acc: 0.9830, span_micro_p: 0.9773, span_micro_r: 0.9754, span_micro_f1: 0.9763, micro_p: 0.9848, micro_r: 0.9640, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: 0.1476, span_acc: 0.9928, attr_start_acc: 0.9760, attr_end_acc: 0.9828, span_micro_p: 0.9776, span_micro_r: 0.9755, span_micro_f1: 0.9765, micro_p: 0.9847, micro_r: 0.9641, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: 0.1498, span_acc: 0.9928, attr_start_acc: 0.9760, attr_end_acc: 0.9828, span_micro_p: 0.9779, span_micro_r: 0.9752, span_micro_f1: 0.9766, micro_p: 0.9852, micro_r: 0.9641, micro_f1: 0.9745
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: 0.1520, span_acc: 0.9927, attr_start_acc: 0.9762, attr_end_acc: 0.9829, span_micro_p: 0.9775, span_micro_r: 0.9752, span_micro_f1: 0.9764, micro_p: 0.9848, micro_r: 0.9643, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: 0.1950, span_acc: 0.9923, attr_start_acc: 0.9766, attr_end_acc: 0.9826, span_micro_p: 0.9781, span_micro_r: 0.9755, span_micro_f1: 0.9768, micro_p: 0.9852, micro_r: 0.9648, micro_f1: 0.9749
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: 0.2099, span_acc: 0.9924, attr_start_acc: 0.9771, attr_end_acc: 0.9828, span_micro_p: 0.9779, span_micro_r: 0.9752, span_micro_f1: 0.9766, micro_p: 0.9853, micro_r: 0.9653, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: 0.2118, span_acc: 0.9923, attr_start_acc: 0.9774, attr_end_acc: 0.9832, span_micro_p: 0.9777, span_micro_r: 0.9753, span_micro_f1: 0.9765, micro_p: 0.9852, micro_r: 0.9658, micro_f1: 0.9754
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: 0.2011, span_acc: 0.9923, attr_start_acc: 0.9775, attr_end_acc: 0.9833, span_micro_p: 0.9776, span_micro_r: 0.9750, span_micro_f1: 0.9763, micro_p: 0.9849, micro_r: 0.9658, micro_f1: 0.9752
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: 0.2044, span_acc: 0.9923, attr_start_acc: 0.9775, attr_end_acc: 0.9833, span_micro_p: 0.9773, span_micro_r: 0.9746, span_micro_f1: 0.9759, micro_p: 0.9846, micro_r: 0.9658, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: 0.2152, span_acc: 0.9922, attr_start_acc: 0.9776, attr_end_acc: 0.9834, span_micro_p: 0.9775, span_micro_r: 0.9745, span_micro_f1: 0.9760, micro_p: 0.9845, micro_r: 0.9656, micro_f1: 0.9750
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: 0.2006, span_acc: 0.9922, attr_start_acc: 0.9775, attr_end_acc: 0.9836, span_micro_p: 0.9774, span_micro_r: 0.9745, span_micro_f1: 0.9759, micro_p: 0.9839, micro_r: 0.9654, micro_f1: 0.9745
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: 0.1933, span_acc: 0.9922, attr_start_acc: 0.9773, attr_end_acc: 0.9838, span_micro_p: 0.9773, span_micro_r: 0.9747, span_micro_f1: 0.9760, micro_p: 0.9831, micro_r: 0.9653, micro_f1: 0.9741
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: 0.1781, span_acc: 0.9924, attr_start_acc: 0.9777, attr_end_acc: 0.9842, span_micro_p: 0.9776, span_micro_r: 0.9751, span_micro_f1: 0.9764, micro_p: 0.9834, micro_r: 0.9661, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: 0.1790, span_acc: 0.9924, attr_start_acc: 0.9780, attr_end_acc: 0.9845, span_micro_p: 0.9775, span_micro_r: 0.9752, span_micro_f1: 0.9764, micro_p: 0.9833, micro_r: 0.9663, micro_f1: 0.9747
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.71 / 97.72 / 98.59), p: (96.16 / 96.82), r: (95.39 / 96.23), f1: (95.77 / 96.52)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.1180364427762206, 'span_acc': 0.9870914258645191, 'attr_start_acc': 0.9771505376344086, 'attr_end_acc': 0.9858870967741935, 'span_micro_p': 0.9616161616161616, 'span_micro_r': 0.9539078156312625, 'span_micro_f1': 0.9577464788732394, 'micro_p': 0.9681787406905891, 'micro_r': 0.9623149394347241, 'micro_f1': 0.9652379345258185, 'category-p/r/f1': {'PRO': (0.9, 1.0, 0.9474), 'ORG': (0.9485, 0.9539, 0.9512), 'EDU': (0.9714, 0.9623, 0.9668), 'TITLE': (0.9779, 0.9609, 0.9693), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9652379345258185 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.32 / 96.81 / 97.36), p: (96.27 / 96.63000000000001), r: (94.97 / 95.09), f1: (95.61 / 95.86)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.7046637782510722, 'span_acc': 0.9832492431886983, 'attr_start_acc': 0.9680981595092024, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9626865671641791, 'span_micro_r': 0.9496932515337423, 'span_micro_f1': 0.9561457689932056, 'micro_p': 0.9663341645885287, 'micro_r': 0.950920245398773, 'micro_f1': 0.9585652442795299, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.952, 0.9331, 0.9425), 'PRO': (0.9167, 1.0, 0.9565), 'TITLE': (0.9683, 0.9482, 0.9581), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9585652442795299 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: 0.0879, span_acc: 0.9956, attr_start_acc: 0.9866, attr_end_acc: 0.9799, span_micro_p: 0.9865, span_micro_r: 0.9733, span_micro_f1: 0.9799, micro_p: 0.9797, micro_r: 0.9732, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: 0.1034, span_acc: 0.9892, attr_start_acc: 0.9765, attr_end_acc: 0.9843, span_micro_p: 0.9692, span_micro_r: 0.9767, span_micro_f1: 0.9729, micro_p: 0.9840, micro_r: 0.9647, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: -0.0518, span_acc: 0.9923, attr_start_acc: 0.9798, attr_end_acc: 0.9888, span_micro_p: 0.9768, span_micro_r: 0.9811, span_micro_f1: 0.9789, micro_p: 0.9863, micro_r: 0.9709, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.0970, span_acc: 0.9943, attr_start_acc: 0.9813, attr_end_acc: 0.9875, span_micro_p: 0.9807, span_micro_r: 0.9853, span_micro_f1: 0.9830, micro_p: 0.9873, micro_r: 0.9719, micro_f1: 0.9796
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.4404, span_acc: 0.9936, attr_start_acc: 0.9807, attr_end_acc: 0.9877, span_micro_p: 0.9832, span_micro_r: 0.9837, span_micro_f1: 0.9834, micro_p: 0.9869, micro_r: 0.9719, micro_f1: 0.9793
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.4789, span_acc: 0.9924, attr_start_acc: 0.9770, attr_end_acc: 0.9839, span_micro_p: 0.9812, span_micro_r: 0.9763, span_micro_f1: 0.9787, micro_p: 0.9854, micro_r: 0.9664, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.4143, span_acc: 0.9926, attr_start_acc: 0.9747, attr_end_acc: 0.9837, span_micro_p: 0.9793, span_micro_r: 0.9756, span_micro_f1: 0.9774, micro_p: 0.9830, micro_r: 0.9633, micro_f1: 0.9730
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.4693, span_acc: 0.9927, attr_start_acc: 0.9740, attr_end_acc: 0.9837, span_micro_p: 0.9791, span_micro_r: 0.9742, span_micro_f1: 0.9766, micro_p: 0.9836, micro_r: 0.9619, micro_f1: 0.9727
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: 0.4163, span_acc: 0.9930, attr_start_acc: 0.9752, attr_end_acc: 0.9847, span_micro_p: 0.9793, span_micro_r: 0.9753, span_micro_f1: 0.9773, micro_p: 0.9852, micro_r: 0.9636, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: 0.3573, span_acc: 0.9931, attr_start_acc: 0.9763, attr_end_acc: 0.9848, span_micro_p: 0.9788, span_micro_r: 0.9755, span_micro_f1: 0.9771, micro_p: 0.9858, micro_r: 0.9647, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: 0.4365, span_acc: 0.9932, attr_start_acc: 0.9775, attr_end_acc: 0.9861, span_micro_p: 0.9786, span_micro_r: 0.9765, span_micro_f1: 0.9776, micro_p: 0.9865, micro_r: 0.9668, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: 0.4380, span_acc: 0.9931, attr_start_acc: 0.9776, attr_end_acc: 0.9858, span_micro_p: 0.9794, span_micro_r: 0.9761, span_micro_f1: 0.9778, micro_p: 0.9868, micro_r: 0.9669, micro_f1: 0.9767
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: 0.3817, span_acc: 0.9932, attr_start_acc: 0.9782, attr_end_acc: 0.9862, span_micro_p: 0.9798, span_micro_r: 0.9766, span_micro_f1: 0.9782, micro_p: 0.9873, micro_r: 0.9678, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: 0.3354, span_acc: 0.9935, attr_start_acc: 0.9784, attr_end_acc: 0.9857, span_micro_p: 0.9807, span_micro_r: 0.9775, span_micro_f1: 0.9791, micro_p: 0.9871, micro_r: 0.9681, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: 0.3573, span_acc: 0.9936, attr_start_acc: 0.9789, attr_end_acc: 0.9858, span_micro_p: 0.9813, span_micro_r: 0.9778, span_micro_f1: 0.9795, micro_p: 0.9874, micro_r: 0.9687, micro_f1: 0.9779
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: 0.3466, span_acc: 0.9939, attr_start_acc: 0.9796, attr_end_acc: 0.9860, span_micro_p: 0.9818, span_micro_r: 0.9783, span_micro_f1: 0.9801, micro_p: 0.9879, micro_r: 0.9692, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: 0.4392, span_acc: 0.9936, attr_start_acc: 0.9788, attr_end_acc: 0.9850, span_micro_p: 0.9810, span_micro_r: 0.9772, span_micro_f1: 0.9791, micro_p: 0.9878, micro_r: 0.9680, micro_f1: 0.9778
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.4668, span_acc: 0.9932, attr_start_acc: 0.9790, attr_end_acc: 0.9855, span_micro_p: 0.9795, span_micro_r: 0.9769, span_micro_f1: 0.9782, micro_p: 0.9873, micro_r: 0.9684, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: 0.4222, span_acc: 0.9930, attr_start_acc: 0.9788, attr_end_acc: 0.9855, span_micro_p: 0.9802, span_micro_r: 0.9769, span_micro_f1: 0.9786, micro_p: 0.9877, micro_r: 0.9685, micro_f1: 0.9780
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: 0.3851, span_acc: 0.9933, attr_start_acc: 0.9791, attr_end_acc: 0.9857, span_micro_p: 0.9807, span_micro_r: 0.9778, span_micro_f1: 0.9793, micro_p: 0.9879, micro_r: 0.9691, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: 0.3868, span_acc: 0.9935, attr_start_acc: 0.9789, attr_end_acc: 0.9862, span_micro_p: 0.9814, span_micro_r: 0.9783, span_micro_f1: 0.9798, micro_p: 0.9884, micro_r: 0.9694, micro_f1: 0.9788
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: 0.3693, span_acc: 0.9936, attr_start_acc: 0.9794, attr_end_acc: 0.9864, span_micro_p: 0.9815, span_micro_r: 0.9788, span_micro_f1: 0.9802, micro_p: 0.9885, micro_r: 0.9697, micro_f1: 0.9791
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: 0.3713, span_acc: 0.9938, attr_start_acc: 0.9797, attr_end_acc: 0.9868, span_micro_p: 0.9822, span_micro_r: 0.9796, span_micro_f1: 0.9809, micro_p: 0.9889, micro_r: 0.9703, micro_f1: 0.9795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: 0.3854, span_acc: 0.9938, attr_start_acc: 0.9800, attr_end_acc: 0.9870, span_micro_p: 0.9825, span_micro_r: 0.9798, span_micro_f1: 0.9811, micro_p: 0.9886, micro_r: 0.9707, micro_f1: 0.9796
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: 0.4204, span_acc: 0.9940, attr_start_acc: 0.9806, attr_end_acc: 0.9870, span_micro_p: 0.9831, span_micro_r: 0.9803, span_micro_f1: 0.9817, micro_p: 0.9889, micro_r: 0.9714, micro_f1: 0.9801
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: 0.4093, span_acc: 0.9940, attr_start_acc: 0.9813, attr_end_acc: 0.9872, span_micro_p: 0.9833, span_micro_r: 0.9807, span_micro_f1: 0.9820, micro_p: 0.9890, micro_r: 0.9720, micro_f1: 0.9805
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: 0.4224, span_acc: 0.9939, attr_start_acc: 0.9811, attr_end_acc: 0.9870, span_micro_p: 0.9833, span_micro_r: 0.9803, span_micro_f1: 0.9818, micro_p: 0.9889, micro_r: 0.9720, micro_f1: 0.9804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.4342, span_acc: 0.9937, attr_start_acc: 0.9811, attr_end_acc: 0.9869, span_micro_p: 0.9831, span_micro_r: 0.9801, span_micro_f1: 0.9816, micro_p: 0.9887, micro_r: 0.9719, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: 0.4416, span_acc: 0.9937, attr_start_acc: 0.9815, attr_end_acc: 0.9869, span_micro_p: 0.9832, span_micro_r: 0.9803, span_micro_f1: 0.9817, micro_p: 0.9886, micro_r: 0.9721, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.4417, span_acc: 0.9936, attr_start_acc: 0.9812, attr_end_acc: 0.9867, span_micro_p: 0.9828, span_micro_r: 0.9799, span_micro_f1: 0.9813, micro_p: 0.9881, micro_r: 0.9717, micro_f1: 0.9799
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: 0.4228, span_acc: 0.9936, attr_start_acc: 0.9814, attr_end_acc: 0.9868, span_micro_p: 0.9828, span_micro_r: 0.9801, span_micro_f1: 0.9815, micro_p: 0.9880, micro_r: 0.9716, micro_f1: 0.9797
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: 0.4279, span_acc: 0.9937, attr_start_acc: 0.9776, attr_end_acc: 0.9867, span_micro_p: 0.9830, span_micro_r: 0.9803, span_micro_f1: 0.9816, micro_p: 0.9880, micro_r: 0.9675, micro_f1: 0.9776
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.33 / 97.85000000000001 / 97.31), p: (94.5 / 96.0), r: (96.39 / 95.28999999999999), f1: (95.44 / 95.64)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.775656361237458, 'span_acc': 0.9833017527238276, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9731182795698925, 'span_micro_p': 0.9449901768172888, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.9543650793650794, 'micro_p': 0.96, 'micro_r': 0.9528936742934051, 'micro_f1': 0.9564336372847011, 'category-p/r/f1': {'ORG': (0.9451, 0.9251, 0.935), 'PRO': (0.9, 1.0, 0.9474), 'TITLE': (0.9608, 0.958, 0.9594), 'EDU': (0.9811, 0.9811, 0.9811), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9564336372847011 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.00999999999999 / 97.3 / 97.11999999999999), p: (94.31 / 96.56), r: (95.58 / 94.78999999999999), f1: (94.94 / 95.67)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.3040568386233828, 'span_acc': 0.9801210898082745, 'attr_start_acc': 0.9730061349693252, 'attr_end_acc': 0.9711656441717792, 'span_micro_p': 0.9430992736077481, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9494210847044485, 'micro_p': 0.965625, 'micro_r': 0.9478527607361963, 'micro_f1': 0.9566563467492261, 'category-p/r/f1': {'PRO': (0.9143, 0.9697, 0.9412), 'ORG': (0.9642, 0.9259, 0.9447), 'TITLE': (0.958, 0.9456, 0.9518), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9566563467492261 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.3326, span_acc: 0.9981, attr_start_acc: 0.9947, attr_end_acc: 0.9415, span_micro_p: 0.9947, span_micro_r: 0.9894, span_micro_f1: 0.9920, micro_p: 1.0000, micro_r: 0.9415, micro_f1: 0.9699
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: 0.1191, span_acc: 0.9974, attr_start_acc: 0.9902, attr_end_acc: 0.9496, span_micro_p: 0.9951, span_micro_r: 0.9919, span_micro_f1: 0.9935, micro_p: 0.9932, micro_r: 0.9431, micro_f1: 0.9675
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: 0.0147, span_acc: 0.9970, attr_start_acc: 0.9873, attr_end_acc: 0.9691, span_micro_p: 0.9910, span_micro_r: 0.9901, span_micro_f1: 0.9905, micro_p: 0.9943, micro_r: 0.9573, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -0.0081, span_acc: 0.9973, attr_start_acc: 0.9872, attr_end_acc: 0.9752, span_micro_p: 0.9926, span_micro_r: 0.9913, span_micro_f1: 0.9920, micro_p: 0.9938, micro_r: 0.9624, micro_f1: 0.9778
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: -0.1059, span_acc: 0.9970, attr_start_acc: 0.9865, attr_end_acc: 0.9747, span_micro_p: 0.9914, span_micro_r: 0.9893, span_micro_f1: 0.9903, micro_p: 0.9922, micro_r: 0.9633, micro_f1: 0.9776
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.1044, span_acc: 0.9972, attr_start_acc: 0.9874, attr_end_acc: 0.9784, span_micro_p: 0.9910, span_micro_r: 0.9901, span_micro_f1: 0.9906, micro_p: 0.9912, micro_r: 0.9671, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.0550, span_acc: 0.9973, attr_start_acc: 0.9879, attr_end_acc: 0.9803, span_micro_p: 0.9909, span_micro_r: 0.9898, span_micro_f1: 0.9904, micro_p: 0.9921, micro_r: 0.9693, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: -0.0043, span_acc: 0.9971, attr_start_acc: 0.9865, attr_end_acc: 0.9817, span_micro_p: 0.9903, span_micro_r: 0.9884, span_micro_f1: 0.9893, micro_p: 0.9913, micro_r: 0.9701, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.0523, span_acc: 0.9967, attr_start_acc: 0.9860, attr_end_acc: 0.9826, span_micro_p: 0.9896, span_micro_r: 0.9869, span_micro_f1: 0.9882, micro_p: 0.9910, micro_r: 0.9705, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.1116, span_acc: 0.9967, attr_start_acc: 0.9867, attr_end_acc: 0.9843, span_micro_p: 0.9892, span_micro_r: 0.9866, span_micro_f1: 0.9879, micro_p: 0.9907, micro_r: 0.9727, micro_f1: 0.9816
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: 0.0472, span_acc: 0.9963, attr_start_acc: 0.9864, attr_end_acc: 0.9840, span_micro_p: 0.9884, span_micro_r: 0.9856, span_micro_f1: 0.9870, micro_p: 0.9897, micro_r: 0.9723, micro_f1: 0.9809
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: 0.0708, span_acc: 0.9963, attr_start_acc: 0.9857, attr_end_acc: 0.9845, span_micro_p: 0.9882, span_micro_r: 0.9852, span_micro_f1: 0.9867, micro_p: 0.9895, micro_r: 0.9722, micro_f1: 0.9808
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: 0.1833, span_acc: 0.9961, attr_start_acc: 0.9857, attr_end_acc: 0.9842, span_micro_p: 0.9881, span_micro_r: 0.9852, span_micro_f1: 0.9867, micro_p: 0.9892, micro_r: 0.9722, micro_f1: 0.9806
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: 0.2005, span_acc: 0.9963, attr_start_acc: 0.9863, attr_end_acc: 0.9852, span_micro_p: 0.9884, span_micro_r: 0.9860, span_micro_f1: 0.9872, micro_p: 0.9899, micro_r: 0.9737, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: 0.2459, span_acc: 0.9960, attr_start_acc: 0.9862, attr_end_acc: 0.9850, span_micro_p: 0.9873, span_micro_r: 0.9856, span_micro_f1: 0.9865, micro_p: 0.9896, micro_r: 0.9734, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: 0.3120, span_acc: 0.9956, attr_start_acc: 0.9855, attr_end_acc: 0.9849, span_micro_p: 0.9869, span_micro_r: 0.9853, span_micro_f1: 0.9861, micro_p: 0.9900, micro_r: 0.9729, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: 0.3972, span_acc: 0.9958, attr_start_acc: 0.9848, attr_end_acc: 0.9851, span_micro_p: 0.9876, span_micro_r: 0.9861, span_micro_f1: 0.9868, micro_p: 0.9900, micro_r: 0.9725, micro_f1: 0.9812
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.6705, span_acc: 0.9958, attr_start_acc: 0.9853, attr_end_acc: 0.9853, span_micro_p: 0.9879, span_micro_r: 0.9864, span_micro_f1: 0.9872, micro_p: 0.9901, micro_r: 0.9731, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.6637, span_acc: 0.9959, attr_start_acc: 0.9858, attr_end_acc: 0.9860, span_micro_p: 0.9881, span_micro_r: 0.9869, span_micro_f1: 0.9875, micro_p: 0.9907, micro_r: 0.9742, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.6333, span_acc: 0.9960, attr_start_acc: 0.9860, attr_end_acc: 0.9864, span_micro_p: 0.9886, span_micro_r: 0.9871, span_micro_f1: 0.9879, micro_p: 0.9910, micro_r: 0.9746, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.6004, span_acc: 0.9960, attr_start_acc: 0.9857, attr_end_acc: 0.9868, span_micro_p: 0.9882, span_micro_r: 0.9870, span_micro_f1: 0.9876, micro_p: 0.9907, micro_r: 0.9744, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: 0.6222, span_acc: 0.9960, attr_start_acc: 0.9854, attr_end_acc: 0.9867, span_micro_p: 0.9884, span_micro_r: 0.9867, span_micro_f1: 0.9876, micro_p: 0.9907, micro_r: 0.9744, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: 0.5867, span_acc: 0.9961, attr_start_acc: 0.9859, attr_end_acc: 0.9872, span_micro_p: 0.9885, span_micro_r: 0.9872, span_micro_f1: 0.9878, micro_p: 0.9907, micro_r: 0.9751, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: 0.5978, span_acc: 0.9961, attr_start_acc: 0.9857, attr_end_acc: 0.9869, span_micro_p: 0.9884, span_micro_r: 0.9872, span_micro_f1: 0.9878, micro_p: 0.9906, micro_r: 0.9746, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: 0.6426, span_acc: 0.9960, attr_start_acc: 0.9854, attr_end_acc: 0.9868, span_micro_p: 0.9880, span_micro_r: 0.9862, span_micro_f1: 0.9871, micro_p: 0.9905, micro_r: 0.9744, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: 0.6200, span_acc: 0.9960, attr_start_acc: 0.9854, attr_end_acc: 0.9869, span_micro_p: 0.9883, span_micro_r: 0.9862, span_micro_f1: 0.9872, micro_p: 0.9909, micro_r: 0.9744, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: 0.5711, span_acc: 0.9961, attr_start_acc: 0.9856, attr_end_acc: 0.9872, span_micro_p: 0.9883, span_micro_r: 0.9863, span_micro_f1: 0.9873, micro_p: 0.9911, micro_r: 0.9748, micro_f1: 0.9828
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: 0.5982, span_acc: 0.9959, attr_start_acc: 0.9853, attr_end_acc: 0.9871, span_micro_p: 0.9880, span_micro_r: 0.9860, span_micro_f1: 0.9870, micro_p: 0.9908, micro_r: 0.9745, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: 0.5690, span_acc: 0.9959, attr_start_acc: 0.9850, attr_end_acc: 0.9870, span_micro_p: 0.9876, span_micro_r: 0.9856, span_micro_f1: 0.9866, micro_p: 0.9904, micro_r: 0.9742, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: 0.5560, span_acc: 0.9958, attr_start_acc: 0.9849, attr_end_acc: 0.9870, span_micro_p: 0.9874, span_micro_r: 0.9853, span_micro_f1: 0.9863, micro_p: 0.9902, micro_r: 0.9742, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: 0.5207, span_acc: 0.9959, attr_start_acc: 0.9851, attr_end_acc: 0.9871, span_micro_p: 0.9876, span_micro_r: 0.9856, span_micro_f1: 0.9866, micro_p: 0.9903, micro_r: 0.9745, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: 0.5220, span_acc: 0.9959, attr_start_acc: 0.9850, attr_end_acc: 0.9871, span_micro_p: 0.9877, span_micro_r: 0.9857, span_micro_f1: 0.9867, micro_p: 0.9901, micro_r: 0.9745, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.25 / 97.58 / 98.11999999999999), p: (95.5 / 95.96000000000001), r: (96.39 / 95.89999999999999), f1: (95.94 / 95.93)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 5.835667405736111, 'span_acc': 0.9824727617243013, 'attr_start_acc': 0.9758064516129032, 'attr_end_acc': 0.9811827956989247, 'span_micro_p': 0.9549966909331569, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.9594414893617021, 'micro_p': 0.9595959595959596, 'micro_r': 0.9589502018842531, 'micro_f1': 0.9592729720632783, 'category-p/r/f1': {'PRO': (0.7727, 0.9444, 0.85), 'ORG': (0.944, 0.9386, 0.9413), 'TITLE': (0.9666, 0.9652, 0.9659), 'CONT': (1.0, 0.9394, 0.9688), 'EDU': (0.9811, 0.9811, 0.9811), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9592729720632783 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.05 / 97.3 / 97.85000000000001), p: (95.53 / 96.28999999999999), r: (95.77 / 95.46), f1: (95.65 / 95.87)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 5.675104944960876, 'span_acc': 0.9805247225025226, 'attr_start_acc': 0.9730061349693252, 'attr_end_acc': 0.9785276073619632, 'span_micro_p': 0.9553243574051408, 'span_micro_r': 0.9576687116564417, 'span_micro_f1': 0.9564950980392158, 'micro_p': 0.9628712871287128, 'micro_r': 0.9546012269938651, 'micro_f1': 0.9587184226740604, 'category-p/r/f1': {'TITLE': (0.9554, 0.9443, 0.9498), 'ORG': (0.958, 0.9476, 0.9528), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9587184226740604 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: -0.2388, span_acc: 0.9967, attr_start_acc: 0.9648, attr_end_acc: 0.9883, span_micro_p: 0.9884, span_micro_r: 0.9884, span_micro_f1: 0.9884, micro_p: 0.9761, micro_r: 0.9570, micro_f1: 0.9665
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: -0.2944, span_acc: 0.9975, attr_start_acc: 0.9602, attr_end_acc: 0.9912, span_micro_p: 0.9912, span_micro_r: 0.9912, span_micro_f1: 0.9912, micro_p: 0.9848, micro_r: 0.9558, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -0.1878, span_acc: 0.9985, attr_start_acc: 0.9714, attr_end_acc: 0.9922, span_micro_p: 0.9948, span_micro_r: 0.9948, span_micro_f1: 0.9948, micro_p: 0.9894, micro_r: 0.9688, micro_f1: 0.9790
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.4220, span_acc: 0.9989, attr_start_acc: 0.9781, attr_end_acc: 0.9935, span_micro_p: 0.9962, span_micro_r: 0.9962, span_micro_f1: 0.9962, micro_p: 0.9921, micro_r: 0.9761, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.1667, span_acc: 0.9983, attr_start_acc: 0.9807, attr_end_acc: 0.9931, span_micro_p: 0.9951, span_micro_r: 0.9941, span_micro_f1: 0.9946, micro_p: 0.9915, micro_r: 0.9782, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: 0.1521, span_acc: 0.9984, attr_start_acc: 0.9829, attr_end_acc: 0.9935, span_micro_p: 0.9951, span_micro_r: 0.9947, span_micro_f1: 0.9949, micro_p: 0.9930, micro_r: 0.9800, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: 0.4878, span_acc: 0.9981, attr_start_acc: 0.9845, attr_end_acc: 0.9927, span_micro_p: 0.9938, span_micro_r: 0.9938, span_micro_f1: 0.9938, micro_p: 0.9916, micro_r: 0.9793, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: 0.6175, span_acc: 0.9979, attr_start_acc: 0.9843, attr_end_acc: 0.9928, span_micro_p: 0.9922, span_micro_r: 0.9934, span_micro_f1: 0.9928, micro_p: 0.9899, micro_r: 0.9789, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: 0.7110, span_acc: 0.9976, attr_start_acc: 0.9846, attr_end_acc: 0.9925, span_micro_p: 0.9909, span_micro_r: 0.9928, span_micro_f1: 0.9918, micro_p: 0.9894, micro_r: 0.9790, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: 0.8397, span_acc: 0.9973, attr_start_acc: 0.9841, attr_end_acc: 0.9924, span_micro_p: 0.9915, span_micro_r: 0.9925, span_micro_f1: 0.9920, micro_p: 0.9898, micro_r: 0.9784, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: 0.7445, span_acc: 0.9975, attr_start_acc: 0.9839, attr_end_acc: 0.9922, span_micro_p: 0.9918, span_micro_r: 0.9929, span_micro_f1: 0.9924, micro_p: 0.9903, micro_r: 0.9786, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: 0.9481, span_acc: 0.9973, attr_start_acc: 0.9840, attr_end_acc: 0.9922, span_micro_p: 0.9910, span_micro_r: 0.9919, span_micro_f1: 0.9914, micro_p: 0.9902, micro_r: 0.9787, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: 0.8972, span_acc: 0.9973, attr_start_acc: 0.9840, attr_end_acc: 0.9920, span_micro_p: 0.9911, span_micro_r: 0.9917, span_micro_f1: 0.9914, micro_p: 0.9902, micro_r: 0.9787, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: 0.8136, span_acc: 0.9975, attr_start_acc: 0.9849, attr_end_acc: 0.9922, span_micro_p: 0.9917, span_micro_r: 0.9922, span_micro_f1: 0.9920, micro_p: 0.9908, micro_r: 0.9795, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: 0.6991, span_acc: 0.9976, attr_start_acc: 0.9850, attr_end_acc: 0.9927, span_micro_p: 0.9921, span_micro_r: 0.9923, span_micro_f1: 0.9922, micro_p: 0.9915, micro_r: 0.9800, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: 0.7031, span_acc: 0.9974, attr_start_acc: 0.9847, attr_end_acc: 0.9923, span_micro_p: 0.9916, span_micro_r: 0.9916, span_micro_f1: 0.9916, micro_p: 0.9914, micro_r: 0.9796, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: 0.7810, span_acc: 0.9973, attr_start_acc: 0.9842, attr_end_acc: 0.9917, span_micro_p: 0.9911, span_micro_r: 0.9907, span_micro_f1: 0.9909, micro_p: 0.9906, micro_r: 0.9783, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: 0.8761, span_acc: 0.9974, attr_start_acc: 0.9844, attr_end_acc: 0.9914, span_micro_p: 0.9912, span_micro_r: 0.9908, span_micro_f1: 0.9910, micro_p: 0.9908, micro_r: 0.9782, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: 0.8439, span_acc: 0.9972, attr_start_acc: 0.9850, attr_end_acc: 0.9915, span_micro_p: 0.9905, span_micro_r: 0.9900, span_micro_f1: 0.9903, micro_p: 0.9907, micro_r: 0.9784, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 0.9580, span_acc: 0.9972, attr_start_acc: 0.9854, attr_end_acc: 0.9916, span_micro_p: 0.9910, span_micro_r: 0.9905, span_micro_f1: 0.9908, micro_p: 0.9909, micro_r: 0.9789, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 0.9346, span_acc: 0.9972, attr_start_acc: 0.9856, attr_end_acc: 0.9919, span_micro_p: 0.9910, span_micro_r: 0.9904, span_micro_f1: 0.9907, micro_p: 0.9911, micro_r: 0.9791, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 0.8624, span_acc: 0.9972, attr_start_acc: 0.9853, attr_end_acc: 0.9920, span_micro_p: 0.9913, span_micro_r: 0.9906, span_micro_f1: 0.9910, micro_p: 0.9912, micro_r: 0.9790, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 0.8028, span_acc: 0.9973, attr_start_acc: 0.9856, attr_end_acc: 0.9920, span_micro_p: 0.9915, span_micro_r: 0.9908, span_micro_f1: 0.9911, micro_p: 0.9913, micro_r: 0.9793, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 0.8962, span_acc: 0.9972, attr_start_acc: 0.9853, attr_end_acc: 0.9916, span_micro_p: 0.9906, span_micro_r: 0.9906, span_micro_f1: 0.9906, micro_p: 0.9905, micro_r: 0.9785, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.8449, span_acc: 0.9971, attr_start_acc: 0.9856, attr_end_acc: 0.9915, span_micro_p: 0.9907, span_micro_r: 0.9903, span_micro_f1: 0.9905, micro_p: 0.9907, micro_r: 0.9788, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: 0.8531, span_acc: 0.9972, attr_start_acc: 0.9857, attr_end_acc: 0.9917, span_micro_p: 0.9908, span_micro_r: 0.9905, span_micro_f1: 0.9907, micro_p: 0.9908, micro_r: 0.9791, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 0.8884, span_acc: 0.9971, attr_start_acc: 0.9857, attr_end_acc: 0.9916, span_micro_p: 0.9903, span_micro_r: 0.9902, span_micro_f1: 0.9902, micro_p: 0.9902, micro_r: 0.9789, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 0.9080, span_acc: 0.9972, attr_start_acc: 0.9861, attr_end_acc: 0.9917, span_micro_p: 0.9906, span_micro_r: 0.9904, span_micro_f1: 0.9905, micro_p: 0.9901, micro_r: 0.9792, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: 0.8770, span_acc: 0.9972, attr_start_acc: 0.9865, attr_end_acc: 0.9920, span_micro_p: 0.9908, span_micro_r: 0.9904, span_micro_f1: 0.9906, micro_p: 0.9904, micro_r: 0.9797, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: 0.8649, span_acc: 0.9973, attr_start_acc: 0.9867, attr_end_acc: 0.9921, span_micro_p: 0.9910, span_micro_r: 0.9907, span_micro_f1: 0.9908, micro_p: 0.9906, micro_r: 0.9799, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 0.9046, span_acc: 0.9972, attr_start_acc: 0.9868, attr_end_acc: 0.9921, span_micro_p: 0.9909, span_micro_r: 0.9903, span_micro_f1: 0.9906, micro_p: 0.9907, micro_r: 0.9800, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 0.9245, span_acc: 0.9972, attr_start_acc: 0.9867, attr_end_acc: 0.9920, span_micro_p: 0.9907, span_micro_r: 0.9900, span_micro_f1: 0.9904, micro_p: 0.9907, micro_r: 0.9799, micro_f1: 0.9853
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.59 / 97.98 / 98.86), p: (95.08 / 95.72), r: (96.78999999999999 / 96.37), f1: (95.93 / 96.04)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 10.804741701863497, 'span_acc': 0.9859071530080531, 'attr_start_acc': 0.9798387096774194, 'attr_end_acc': 0.9885752688172043, 'span_micro_p': 0.9507874015748031, 'span_micro_r': 0.9679358717434869, 'span_micro_f1': 0.9592850049652433, 'micro_p': 0.9572192513368984, 'micro_r': 0.9636608344549125, 'micro_f1': 0.960429242119383, 'category-p/r/f1': {'PRO': (0.7727, 0.9444, 0.85), 'ORG': (0.9376, 0.952, 0.9447), 'TITLE': (0.9665, 0.9609, 0.9637), 'EDU': (0.9813, 0.9906, 0.9859), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.960429242119383 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.21 / 97.24000000000001 / 97.91), p: (94.62 / 95.88), r: (96.00999999999999 / 95.71), f1: (95.30999999999999 / 95.78999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 5.260073743151419, 'span_acc': 0.9821392532795157, 'attr_start_acc': 0.9723926380368099, 'attr_end_acc': 0.9791411042944785, 'span_micro_p': 0.9461910519951633, 'span_micro_r': 0.9601226993865031, 'span_micro_f1': 0.9531059683313032, 'micro_p': 0.958819913952059, 'micro_r': 0.9570552147239264, 'micro_f1': 0.9579367516119128, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9424, 0.9476, 0.945), 'TITLE': (0.9582, 0.9495, 0.9538), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9579367516119128 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -0.9346, span_acc: 0.9975, attr_start_acc: 1.0000, attr_end_acc: 1.0000, span_micro_p: 0.9858, span_micro_r: 0.9929, span_micro_f1: 0.9893, micro_p: 0.9928, micro_r: 0.9928, micro_f1: 0.9928
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: -0.4116, span_acc: 0.9978, attr_start_acc: 0.9957, attr_end_acc: 0.9957, span_micro_p: 0.9915, span_micro_r: 0.9929, span_micro_f1: 0.9922, micro_p: 0.9928, micro_r: 0.9900, micro_f1: 0.9914
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: -0.4929, span_acc: 0.9981, attr_start_acc: 0.9921, attr_end_acc: 0.9956, span_micro_p: 0.9922, span_micro_r: 0.9931, span_micro_f1: 0.9926, micro_p: 0.9912, micro_r: 0.9860, micro_f1: 0.9886
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: 0.0799, span_acc: 0.9984, attr_start_acc: 0.9904, attr_end_acc: 0.9955, span_micro_p: 0.9936, span_micro_r: 0.9936, span_micro_f1: 0.9936, micro_p: 0.9922, micro_r: 0.9858, micro_f1: 0.9890
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: -0.0165, span_acc: 0.9987, attr_start_acc: 0.9912, attr_end_acc: 0.9958, span_micro_p: 0.9948, span_micro_r: 0.9948, span_micro_f1: 0.9948, micro_p: 0.9932, micro_r: 0.9875, micro_f1: 0.9903
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: -0.0217, span_acc: 0.9987, attr_start_acc: 0.9902, attr_end_acc: 0.9953, span_micro_p: 0.9949, span_micro_r: 0.9949, span_micro_f1: 0.9949, micro_p: 0.9923, micro_r: 0.9872, micro_f1: 0.9898
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: 0.1065, span_acc: 0.9988, attr_start_acc: 0.9913, attr_end_acc: 0.9956, span_micro_p: 0.9950, span_micro_r: 0.9953, span_micro_f1: 0.9951, micro_p: 0.9927, micro_r: 0.9884, micro_f1: 0.9905
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 0.6516, span_acc: 0.9979, attr_start_acc: 0.9902, attr_end_acc: 0.9952, span_micro_p: 0.9925, span_micro_r: 0.9931, span_micro_f1: 0.9928, micro_p: 0.9914, micro_r: 0.9870, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 0.6374, span_acc: 0.9978, attr_start_acc: 0.9897, attr_end_acc: 0.9946, span_micro_p: 0.9924, span_micro_r: 0.9921, span_micro_f1: 0.9922, micro_p: 0.9914, micro_r: 0.9863, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 0.7179, span_acc: 0.9978, attr_start_acc: 0.9898, attr_end_acc: 0.9939, span_micro_p: 0.9922, span_micro_r: 0.9922, span_micro_f1: 0.9922, micro_p: 0.9905, micro_r: 0.9855, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 0.9019, span_acc: 0.9979, attr_start_acc: 0.9883, attr_end_acc: 0.9931, span_micro_p: 0.9927, span_micro_r: 0.9925, span_micro_f1: 0.9926, micro_p: 0.9910, micro_r: 0.9835, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 1.0212, span_acc: 0.9977, attr_start_acc: 0.9882, attr_end_acc: 0.9918, span_micro_p: 0.9933, span_micro_r: 0.9925, span_micro_f1: 0.9929, micro_p: 0.9915, micro_r: 0.9823, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 0.8801, span_acc: 0.9976, attr_start_acc: 0.9887, attr_end_acc: 0.9918, span_micro_p: 0.9928, span_micro_r: 0.9924, span_micro_f1: 0.9926, micro_p: 0.9915, micro_r: 0.9826, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 0.9228, span_acc: 0.9977, attr_start_acc: 0.9881, attr_end_acc: 0.9922, span_micro_p: 0.9934, span_micro_r: 0.9927, span_micro_f1: 0.9930, micro_p: 0.9920, micro_r: 0.9823, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 0.9935, span_acc: 0.9977, attr_start_acc: 0.9881, attr_end_acc: 0.9920, span_micro_p: 0.9930, span_micro_r: 0.9927, span_micro_f1: 0.9929, micro_p: 0.9917, micro_r: 0.9817, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 1.0286, span_acc: 0.9976, attr_start_acc: 0.9883, attr_end_acc: 0.9917, span_micro_p: 0.9929, span_micro_r: 0.9926, span_micro_f1: 0.9927, micro_p: 0.9919, micro_r: 0.9819, micro_f1: 0.9869
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 0.9343, span_acc: 0.9977, attr_start_acc: 0.9888, attr_end_acc: 0.9920, span_micro_p: 0.9931, span_micro_r: 0.9927, span_micro_f1: 0.9929, micro_p: 0.9923, micro_r: 0.9826, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 0.9355, span_acc: 0.9978, attr_start_acc: 0.9884, attr_end_acc: 0.9917, span_micro_p: 0.9933, span_micro_r: 0.9926, span_micro_f1: 0.9929, micro_p: 0.9921, micro_r: 0.9823, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 0.8803, span_acc: 0.9979, attr_start_acc: 0.9889, attr_end_acc: 0.9921, span_micro_p: 0.9934, span_micro_r: 0.9929, span_micro_f1: 0.9932, micro_p: 0.9923, micro_r: 0.9831, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 0.8782, span_acc: 0.9980, attr_start_acc: 0.9890, attr_end_acc: 0.9924, span_micro_p: 0.9938, span_micro_r: 0.9933, span_micro_f1: 0.9935, micro_p: 0.9925, micro_r: 0.9833, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 0.9303, span_acc: 0.9979, attr_start_acc: 0.9888, attr_end_acc: 0.9924, span_micro_p: 0.9934, span_micro_r: 0.9931, span_micro_f1: 0.9932, micro_p: 0.9921, micro_r: 0.9828, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 1.2631, span_acc: 0.9977, attr_start_acc: 0.9885, attr_end_acc: 0.9923, span_micro_p: 0.9925, span_micro_r: 0.9925, span_micro_f1: 0.9925, micro_p: 0.9916, micro_r: 0.9824, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 1.3205, span_acc: 0.9977, attr_start_acc: 0.9884, attr_end_acc: 0.9921, span_micro_p: 0.9924, span_micro_r: 0.9919, span_micro_f1: 0.9921, micro_p: 0.9918, micro_r: 0.9824, micro_f1: 0.9871
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 1.2505, span_acc: 0.9977, attr_start_acc: 0.9886, attr_end_acc: 0.9923, span_micro_p: 0.9925, span_micro_r: 0.9921, span_micro_f1: 0.9923, micro_p: 0.9922, micro_r: 0.9827, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 1.2552, span_acc: 0.9977, attr_start_acc: 0.9884, attr_end_acc: 0.9921, span_micro_p: 0.9925, span_micro_r: 0.9918, span_micro_f1: 0.9921, micro_p: 0.9922, micro_r: 0.9824, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 1.2051, span_acc: 0.9977, attr_start_acc: 0.9888, attr_end_acc: 0.9924, span_micro_p: 0.9925, span_micro_r: 0.9920, span_micro_f1: 0.9922, micro_p: 0.9923, micro_r: 0.9830, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 1.1842, span_acc: 0.9975, attr_start_acc: 0.9888, attr_end_acc: 0.9920, span_micro_p: 0.9923, span_micro_r: 0.9916, span_micro_f1: 0.9920, micro_p: 0.9921, micro_r: 0.9825, micro_f1: 0.9873
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 1.1235, span_acc: 0.9975, attr_start_acc: 0.9882, attr_end_acc: 0.9918, span_micro_p: 0.9923, span_micro_r: 0.9916, span_micro_f1: 0.9919, micro_p: 0.9919, micro_r: 0.9821, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 1.1402, span_acc: 0.9974, attr_start_acc: 0.9877, attr_end_acc: 0.9911, span_micro_p: 0.9922, span_micro_r: 0.9914, span_micro_f1: 0.9918, micro_p: 0.9914, micro_r: 0.9813, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 1.0921, span_acc: 0.9974, attr_start_acc: 0.9873, attr_end_acc: 0.9909, span_micro_p: 0.9921, span_micro_r: 0.9914, span_micro_f1: 0.9917, micro_p: 0.9911, micro_r: 0.9809, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 1.1061, span_acc: 0.9974, attr_start_acc: 0.9870, attr_end_acc: 0.9911, span_micro_p: 0.9920, span_micro_r: 0.9915, span_micro_f1: 0.9917, micro_p: 0.9911, micro_r: 0.9807, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 1.1498, span_acc: 0.9975, attr_start_acc: 0.9862, attr_end_acc: 0.9911, span_micro_p: 0.9922, span_micro_r: 0.9916, span_micro_f1: 0.9919, micro_p: 0.9912, micro_r: 0.9799, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.78 / 97.11 / 97.85000000000001), p: (96.21 / 96.53), r: (96.53 / 95.56), f1: (96.37 / 96.04)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 16.58671350716, 'span_acc': 0.9878019895783988, 'attr_start_acc': 0.9711021505376344, 'attr_end_acc': 0.978494623655914, 'span_micro_p': 0.9620505992010653, 'span_micro_r': 0.9652638610554443, 'span_micro_f1': 0.9636545515171725, 'micro_p': 0.9653297076818491, 'micro_r': 0.955585464333782, 'micro_f1': 0.9604328711531959, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.953, 0.9347, 0.9438), 'TITLE': (0.9735, 0.9594, 0.9664), 'CONT': (1.0, 0.9394, 0.9688), 'EDU': (0.9545, 0.9906, 0.9722), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9604328711531959 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.27 / 96.2 / 97.3), p: (96.33 / 96.99), r: (94.97 / 94.97), f1: (95.64 / 95.97)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 9.686047119164616, 'span_acc': 0.982744702320888, 'attr_start_acc': 0.9619631901840491, 'attr_end_acc': 0.9730061349693252, 'span_micro_p': 0.9632856253889235, 'span_micro_r': 0.9496932515337423, 'span_micro_f1': 0.9564411492122336, 'micro_p': 0.9699248120300752, 'micro_r': 0.9496932515337423, 'micro_f1': 0.9597024178549286, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'TITLE': (0.9605, 0.9443, 0.9523), 'ORG': (0.9718, 0.9349, 0.953), 'PRO': (0.9429, 1.0, 0.9706), 'CONT': (1.0, 0.9643, 0.9818), 'EDU': (0.9911, 0.9911, 0.9911), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9597024178549286 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: 0.3664, span_acc: 1.0000, attr_start_acc: 1.0000, attr_end_acc: 1.0000, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 1.0000, micro_f1: 1.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: 1.6102, span_acc: 0.9963, attr_start_acc: 0.9861, attr_end_acc: 0.9930, span_micro_p: 0.9972, span_micro_r: 0.9931, span_micro_f1: 0.9952, micro_p: 0.9972, micro_r: 0.9833, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 1.5646, span_acc: 0.9964, attr_start_acc: 0.9876, attr_end_acc: 0.9938, span_micro_p: 0.9965, span_micro_r: 0.9938, span_micro_f1: 0.9952, micro_p: 0.9955, micro_r: 0.9849, micro_f1: 0.9902
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: 1.2215, span_acc: 0.9974, attr_start_acc: 0.9886, attr_end_acc: 0.9930, span_micro_p: 0.9975, span_micro_r: 0.9956, span_micro_f1: 0.9965, micro_p: 0.9962, micro_r: 0.9861, micro_f1: 0.9911
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 3.2225, span_acc: 0.9966, attr_start_acc: 0.9889, attr_end_acc: 0.9929, span_micro_p: 0.9955, span_micro_r: 0.9935, span_micro_f1: 0.9945, micro_p: 0.9949, micro_r: 0.9859, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 3.0534, span_acc: 0.9966, attr_start_acc: 0.9870, attr_end_acc: 0.9925, span_micro_p: 0.9938, span_micro_r: 0.9921, span_micro_f1: 0.9929, micro_p: 0.9932, micro_r: 0.9837, micro_f1: 0.9884
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 2.6059, span_acc: 0.9965, attr_start_acc: 0.9866, attr_end_acc: 0.9912, span_micro_p: 0.9923, span_micro_r: 0.9909, span_micro_f1: 0.9916, micro_p: 0.9918, micro_r: 0.9816, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 2.5892, span_acc: 0.9965, attr_start_acc: 0.9871, attr_end_acc: 0.9911, span_micro_p: 0.9921, span_micro_r: 0.9903, span_micro_f1: 0.9912, micro_p: 0.9916, micro_r: 0.9819, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 2.5368, span_acc: 0.9967, attr_start_acc: 0.9872, attr_end_acc: 0.9904, span_micro_p: 0.9923, span_micro_r: 0.9907, span_micro_f1: 0.9915, micro_p: 0.9916, micro_r: 0.9816, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 2.7080, span_acc: 0.9969, attr_start_acc: 0.9875, attr_end_acc: 0.9914, span_micro_p: 0.9926, span_micro_r: 0.9914, span_micro_f1: 0.9920, micro_p: 0.9920, micro_r: 0.9825, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 2.6353, span_acc: 0.9971, attr_start_acc: 0.9880, attr_end_acc: 0.9919, span_micro_p: 0.9928, span_micro_r: 0.9919, span_micro_f1: 0.9924, micro_p: 0.9925, micro_r: 0.9833, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 2.5068, span_acc: 0.9972, attr_start_acc: 0.9878, attr_end_acc: 0.9918, span_micro_p: 0.9931, span_micro_r: 0.9923, span_micro_f1: 0.9927, micro_p: 0.9923, micro_r: 0.9834, micro_f1: 0.9879
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 2.5694, span_acc: 0.9973, attr_start_acc: 0.9875, attr_end_acc: 0.9918, span_micro_p: 0.9931, span_micro_r: 0.9926, span_micro_f1: 0.9928, micro_p: 0.9921, micro_r: 0.9834, micro_f1: 0.9877
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 2.8007, span_acc: 0.9973, attr_start_acc: 0.9876, attr_end_acc: 0.9921, span_micro_p: 0.9930, span_micro_r: 0.9918, span_micro_f1: 0.9924, micro_p: 0.9925, micro_r: 0.9838, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 2.8287, span_acc: 0.9974, attr_start_acc: 0.9879, attr_end_acc: 0.9916, span_micro_p: 0.9929, span_micro_r: 0.9920, span_micro_f1: 0.9925, micro_p: 0.9925, micro_r: 0.9837, micro_f1: 0.9881
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 2.7588, span_acc: 0.9976, attr_start_acc: 0.9880, attr_end_acc: 0.9917, span_micro_p: 0.9933, span_micro_r: 0.9924, span_micro_f1: 0.9928, micro_p: 0.9927, micro_r: 0.9836, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 2.9465, span_acc: 0.9976, attr_start_acc: 0.9874, attr_end_acc: 0.9917, span_micro_p: 0.9934, span_micro_r: 0.9923, span_micro_f1: 0.9928, micro_p: 0.9930, micro_r: 0.9830, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 2.7071, span_acc: 0.9977, attr_start_acc: 0.9879, attr_end_acc: 0.9920, span_micro_p: 0.9936, span_micro_r: 0.9926, span_micro_f1: 0.9931, micro_p: 0.9933, micro_r: 0.9838, micro_f1: 0.9885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 2.6471, span_acc: 0.9978, attr_start_acc: 0.9884, attr_end_acc: 0.9919, span_micro_p: 0.9937, span_micro_r: 0.9928, span_micro_f1: 0.9933, micro_p: 0.9935, micro_r: 0.9841, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 2.6924, span_acc: 0.9979, attr_start_acc: 0.9890, attr_end_acc: 0.9922, span_micro_p: 0.9940, span_micro_r: 0.9932, span_micro_f1: 0.9936, micro_p: 0.9938, micro_r: 0.9847, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 2.5783, span_acc: 0.9979, attr_start_acc: 0.9892, attr_end_acc: 0.9926, span_micro_p: 0.9940, span_micro_r: 0.9933, span_micro_f1: 0.9936, micro_p: 0.9940, micro_r: 0.9852, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 3.0300, span_acc: 0.9980, attr_start_acc: 0.9894, attr_end_acc: 0.9928, span_micro_p: 0.9938, span_micro_r: 0.9934, span_micro_f1: 0.9936, micro_p: 0.9939, micro_r: 0.9853, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 3.6508, span_acc: 0.9980, attr_start_acc: 0.9894, attr_end_acc: 0.9926, span_micro_p: 0.9940, span_micro_r: 0.9936, span_micro_f1: 0.9938, micro_p: 0.9938, micro_r: 0.9852, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 4.0683, span_acc: 0.9980, attr_start_acc: 0.9895, attr_end_acc: 0.9924, span_micro_p: 0.9939, span_micro_r: 0.9935, span_micro_f1: 0.9937, micro_p: 0.9937, micro_r: 0.9850, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 3.9707, span_acc: 0.9980, attr_start_acc: 0.9896, attr_end_acc: 0.9926, span_micro_p: 0.9939, span_micro_r: 0.9936, span_micro_f1: 0.9937, micro_p: 0.9937, micro_r: 0.9852, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 3.9156, span_acc: 0.9980, attr_start_acc: 0.9897, attr_end_acc: 0.9928, span_micro_p: 0.9938, span_micro_r: 0.9937, span_micro_f1: 0.9937, micro_p: 0.9937, micro_r: 0.9854, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 3.7502, span_acc: 0.9981, attr_start_acc: 0.9899, attr_end_acc: 0.9928, span_micro_p: 0.9940, span_micro_r: 0.9939, span_micro_f1: 0.9940, micro_p: 0.9938, micro_r: 0.9857, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 3.8037, span_acc: 0.9981, attr_start_acc: 0.9903, attr_end_acc: 0.9930, span_micro_p: 0.9942, span_micro_r: 0.9940, span_micro_f1: 0.9941, micro_p: 0.9939, micro_r: 0.9861, micro_f1: 0.9900
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 3.9092, span_acc: 0.9981, attr_start_acc: 0.9902, attr_end_acc: 0.9931, span_micro_p: 0.9941, span_micro_r: 0.9940, span_micro_f1: 0.9941, micro_p: 0.9939, micro_r: 0.9860, micro_f1: 0.9899
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 4.1309, span_acc: 0.9981, attr_start_acc: 0.9896, attr_end_acc: 0.9930, span_micro_p: 0.9942, span_micro_r: 0.9941, span_micro_f1: 0.9941, micro_p: 0.9940, micro_r: 0.9854, micro_f1: 0.9897
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 4.0000, span_acc: 0.9981, attr_start_acc: 0.9891, attr_end_acc: 0.9929, span_micro_p: 0.9941, span_micro_r: 0.9941, span_micro_f1: 0.9941, micro_p: 0.9935, micro_r: 0.9848, micro_f1: 0.9891
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 4.4443, span_acc: 0.9981, attr_start_acc: 0.9892, attr_end_acc: 0.9930, span_micro_p: 0.9941, span_micro_r: 0.9940, span_micro_f1: 0.9941, micro_p: 0.9934, micro_r: 0.9850, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.83 / 97.85000000000001 / 98.72), p: (95.39999999999999 / 95.73), r: (96.99 / 96.57), f1: (96.19 / 96.15)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 35.65125880231095, 'span_acc': 0.9882756987209853, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9872311827956989, 'span_micro_p': 0.9540078843626807, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.9619079165286518, 'micro_p': 0.9573048699132756, 'micro_r': 0.9656796769851952, 'micro_f1': 0.9614740368509214, 'category-p/r/f1': {'PRO': (0.8095, 0.9444, 0.8718), 'ORG': (0.945, 0.9559, 0.9504), 'TITLE': (0.961, 0.9638, 0.9624), 'EDU': (0.9722, 0.9906, 0.9813), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9614740368509214 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.38 / 97.24000000000001 / 97.85000000000001), p: (95.48 / 95.82000000000001), r: (95.95 / 95.58), f1: (95.72 / 95.7)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 19.63958082409025, 'span_acc': 0.9837537840565086, 'attr_start_acc': 0.9723926380368099, 'attr_end_acc': 0.9785276073619632, 'span_micro_p': 0.9548229548229549, 'span_micro_r': 0.9595092024539877, 'span_micro_f1': 0.9571603427172584, 'micro_p': 0.958179581795818, 'micro_r': 0.9558282208588957, 'micro_f1': 0.9570024570024571, 'category-p/r/f1': {'ORG': (0.9476, 0.9476, 0.9476), 'TITLE': (0.9544, 0.9482, 0.9513), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9570024570024571 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: 0.3876, span_acc: 1.0000, attr_start_acc: 0.9919, attr_end_acc: 0.9919, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9892, micro_r: 0.9892, micro_f1: 0.9892
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: 3.5416, span_acc: 0.9989, attr_start_acc: 0.9920, attr_end_acc: 0.9960, span_micro_p: 0.9934, span_micro_r: 0.9960, span_micro_f1: 0.9947, micro_p: 0.9866, micro_r: 0.9893, micro_f1: 0.9880
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 2.7601, span_acc: 0.9987, attr_start_acc: 0.9922, attr_end_acc: 0.9956, span_micro_p: 0.9940, span_micro_r: 0.9957, span_micro_f1: 0.9948, micro_p: 0.9878, micro_r: 0.9878, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 3.2986, span_acc: 0.9984, attr_start_acc: 0.9926, attr_end_acc: 0.9957, span_micro_p: 0.9933, span_micro_r: 0.9945, span_micro_f1: 0.9939, micro_p: 0.9894, micro_r: 0.9882, micro_f1: 0.9888
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 2.6990, span_acc: 0.9984, attr_start_acc: 0.9937, attr_end_acc: 0.9956, span_micro_p: 0.9937, span_micro_r: 0.9947, span_micro_f1: 0.9942, micro_p: 0.9907, micro_r: 0.9883, micro_f1: 0.9895
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 2.2477, span_acc: 0.9985, attr_start_acc: 0.9916, attr_end_acc: 0.9940, span_micro_p: 0.9933, span_micro_r: 0.9949, span_micro_f1: 0.9941, micro_p: 0.9872, micro_r: 0.9861, micro_f1: 0.9867
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 2.0489, span_acc: 0.9984, attr_start_acc: 0.9921, attr_end_acc: 0.9928, span_micro_p: 0.9936, span_micro_r: 0.9949, span_micro_f1: 0.9942, micro_p: 0.9880, micro_r: 0.9856, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 2.0084, span_acc: 0.9982, attr_start_acc: 0.9925, attr_end_acc: 0.9934, span_micro_p: 0.9928, span_micro_r: 0.9931, span_micro_f1: 0.9930, micro_p: 0.9891, micro_r: 0.9864, micro_f1: 0.9878
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 2.4064, span_acc: 0.9978, attr_start_acc: 0.9898, attr_end_acc: 0.9930, span_micro_p: 0.9915, span_micro_r: 0.9917, span_micro_f1: 0.9916, micro_p: 0.9878, micro_r: 0.9838, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 2.2925, span_acc: 0.9979, attr_start_acc: 0.9898, attr_end_acc: 0.9931, span_micro_p: 0.9920, span_micro_r: 0.9922, span_micro_f1: 0.9921, micro_p: 0.9883, micro_r: 0.9843, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 2.1538, span_acc: 0.9980, attr_start_acc: 0.9896, attr_end_acc: 0.9926, span_micro_p: 0.9924, span_micro_r: 0.9924, span_micro_f1: 0.9924, micro_p: 0.9884, micro_r: 0.9841, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 2.4094, span_acc: 0.9977, attr_start_acc: 0.9892, attr_end_acc: 0.9922, span_micro_p: 0.9921, span_micro_r: 0.9921, span_micro_f1: 0.9921, micro_p: 0.9877, micro_r: 0.9834, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 2.2604, span_acc: 0.9978, attr_start_acc: 0.9897, attr_end_acc: 0.9924, span_micro_p: 0.9925, span_micro_r: 0.9923, span_micro_f1: 0.9924, micro_p: 0.9883, micro_r: 0.9839, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 2.1115, span_acc: 0.9978, attr_start_acc: 0.9902, attr_end_acc: 0.9926, span_micro_p: 0.9925, span_micro_r: 0.9923, span_micro_f1: 0.9924, micro_p: 0.9890, micro_r: 0.9846, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 2.1008, span_acc: 0.9980, attr_start_acc: 0.9905, attr_end_acc: 0.9926, span_micro_p: 0.9930, span_micro_r: 0.9927, span_micro_f1: 0.9928, micro_p: 0.9894, micro_r: 0.9851, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 1.9458, span_acc: 0.9979, attr_start_acc: 0.9910, attr_end_acc: 0.9926, span_micro_p: 0.9925, span_micro_r: 0.9927, span_micro_f1: 0.9926, micro_p: 0.9897, micro_r: 0.9852, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 1.8267, span_acc: 0.9980, attr_start_acc: 0.9907, attr_end_acc: 0.9926, span_micro_p: 0.9927, span_micro_r: 0.9927, span_micro_f1: 0.9927, micro_p: 0.9898, micro_r: 0.9854, micro_f1: 0.9876
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 1.8102, span_acc: 0.9981, attr_start_acc: 0.9904, attr_end_acc: 0.9923, span_micro_p: 0.9930, span_micro_r: 0.9930, span_micro_f1: 0.9930, micro_p: 0.9900, micro_r: 0.9851, micro_f1: 0.9875
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 1.8128, span_acc: 0.9981, attr_start_acc: 0.9886, attr_end_acc: 0.9918, span_micro_p: 0.9931, span_micro_r: 0.9932, span_micro_f1: 0.9932, micro_p: 0.9898, micro_r: 0.9833, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 1.8563, span_acc: 0.9982, attr_start_acc: 0.9878, attr_end_acc: 0.9913, span_micro_p: 0.9934, span_micro_r: 0.9935, span_micro_f1: 0.9935, micro_p: 0.9895, micro_r: 0.9826, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 1.8482, span_acc: 0.9982, attr_start_acc: 0.9867, attr_end_acc: 0.9913, span_micro_p: 0.9937, span_micro_r: 0.9937, span_micro_f1: 0.9937, micro_p: 0.9897, micro_r: 0.9815, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 1.7683, span_acc: 0.9983, attr_start_acc: 0.9863, attr_end_acc: 0.9914, span_micro_p: 0.9939, span_micro_r: 0.9940, span_micro_f1: 0.9939, micro_p: 0.9900, micro_r: 0.9812, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 1.6312, span_acc: 0.9984, attr_start_acc: 0.9858, attr_end_acc: 0.9913, span_micro_p: 0.9942, span_micro_r: 0.9943, span_micro_f1: 0.9942, micro_p: 0.9901, micro_r: 0.9807, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 1.6598, span_acc: 0.9984, attr_start_acc: 0.9854, attr_end_acc: 0.9910, span_micro_p: 0.9943, span_micro_r: 0.9944, span_micro_f1: 0.9944, micro_p: 0.9903, micro_r: 0.9801, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 1.7133, span_acc: 0.9985, attr_start_acc: 0.9854, attr_end_acc: 0.9907, span_micro_p: 0.9945, span_micro_r: 0.9945, span_micro_f1: 0.9945, micro_p: 0.9905, micro_r: 0.9799, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 1.6744, span_acc: 0.9984, attr_start_acc: 0.9857, attr_end_acc: 0.9907, span_micro_p: 0.9946, span_micro_r: 0.9945, span_micro_f1: 0.9945, micro_p: 0.9907, micro_r: 0.9798, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 1.6381, span_acc: 0.9985, attr_start_acc: 0.9858, attr_end_acc: 0.9904, span_micro_p: 0.9946, span_micro_r: 0.9946, span_micro_f1: 0.9946, micro_p: 0.9907, micro_r: 0.9795, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 1.5765, span_acc: 0.9985, attr_start_acc: 0.9862, attr_end_acc: 0.9906, span_micro_p: 0.9948, span_micro_r: 0.9948, span_micro_f1: 0.9948, micro_p: 0.9910, micro_r: 0.9801, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 1.5616, span_acc: 0.9986, attr_start_acc: 0.9864, attr_end_acc: 0.9907, span_micro_p: 0.9950, span_micro_r: 0.9950, span_micro_f1: 0.9950, micro_p: 0.9911, micro_r: 0.9805, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 1.5277, span_acc: 0.9986, attr_start_acc: 0.9863, attr_end_acc: 0.9909, span_micro_p: 0.9950, span_micro_r: 0.9949, span_micro_f1: 0.9950, micro_p: 0.9912, micro_r: 0.9805, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 1.5679, span_acc: 0.9986, attr_start_acc: 0.9860, attr_end_acc: 0.9910, span_micro_p: 0.9950, span_micro_r: 0.9949, span_micro_f1: 0.9950, micro_p: 0.9913, micro_r: 0.9803, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 1.6120, span_acc: 0.9985, attr_start_acc: 0.9858, attr_end_acc: 0.9911, span_micro_p: 0.9949, span_micro_r: 0.9946, span_micro_f1: 0.9947, micro_p: 0.9914, micro_r: 0.9800, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.95 / 97.85000000000001 / 98.32), p: (96.15 / 96.61999999999999), r: (96.66 / 96.23), f1: (96.39999999999999 / 96.43)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 44.76127647478174, 'span_acc': 0.9894599715774515, 'attr_start_acc': 0.978494623655914, 'attr_end_acc': 0.9831989247311828, 'span_micro_p': 0.9614617940199336, 'span_micro_r': 0.9665998663994656, 'span_micro_f1': 0.9640239840106596, 'micro_p': 0.9662162162162162, 'micro_r': 0.9623149394347241, 'micro_f1': 0.9642616318273769, 'category-p/r/f1': {'PRO': (0.9, 1.0, 0.9474), 'ORG': (0.9502, 0.952, 0.9511), 'TITLE': (0.9721, 0.9594, 0.9657), 'EDU': (0.981, 0.9717, 0.9763), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9642616318273769 / 0.9663837011884551
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.3 / 96.44 / 97.42), p: (95.23 / 96.33), r: (95.52000000000001 / 94.97), f1: (95.38 / 95.64)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 33.68029768661883, 'span_acc': 0.9830474268415742, 'attr_start_acc': 0.9644171779141104, 'attr_end_acc': 0.9742331288343559, 'span_micro_p': 0.9522935779816514, 'span_micro_r': 0.9552147239263804, 'span_micro_f1': 0.9537519142419602, 'micro_p': 0.9632856253889235, 'micro_r': 0.9496932515337423, 'micro_f1': 0.9564411492122336, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'PRO': (0.8919, 1.0, 0.9429), 'ORG': (0.9593, 0.9385, 0.9488), 'TITLE': (0.9592, 0.943, 0.951), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (0.9911, 0.9911, 0.9911), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9564411492122336 / 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.966384
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.961240
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9809283551967709
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9656441717791411
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9656441717791411
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9646621202727836
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9546012269938651
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9596053037311132
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9717868338557993
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.950920245398773
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.9612403100775194
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9613, 0.9439, 0.9525), 'TITLE': (0.9707, 0.943, 0.9566), 'EDU': (0.9908, 0.9643, 0.9774), 'PRO': (0.9706, 1.0, 0.9851), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 2.1782, span_acc: 0.5980, attr_start_acc: 0.0025, attr_end_acc: 0.0330, span_micro_p: 0.2578, span_micro_r: 0.0833, span_micro_f1: 0.1260, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.8273, span_acc: 0.7482, attr_start_acc: 0.1067, attr_end_acc: 0.3383, span_micro_p: 0.6068, span_micro_r: 0.3216, span_micro_f1: 0.4204, micro_p: 0.4211, micro_r: 0.0547, micro_f1: 0.0968
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.6674, span_acc: 0.8101, attr_start_acc: 0.3117, attr_end_acc: 0.4878, span_micro_p: 0.7151, span_micro_r: 0.4625, span_micro_f1: 0.5617, micro_p: 0.6840, micro_r: 0.2315, micro_f1: 0.3459
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.5689, span_acc: 0.8427, attr_start_acc: 0.4204, attr_end_acc: 0.5620, span_micro_p: 0.7740, span_micro_r: 0.5465, span_micro_f1: 0.6406, micro_p: 0.7555, micro_r: 0.3358, micro_f1: 0.4650
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.5045, span_acc: 0.8660, attr_start_acc: 0.4921, attr_end_acc: 0.6132, span_micro_p: 0.8069, span_micro_r: 0.6057, span_micro_f1: 0.6920, micro_p: 0.8078, micro_r: 0.4084, micro_f1: 0.5425
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.4458, span_acc: 0.8832, attr_start_acc: 0.5392, attr_end_acc: 0.6518, span_micro_p: 0.8342, span_micro_r: 0.6537, span_micro_f1: 0.7330, micro_p: 0.8386, micro_r: 0.4595, micro_f1: 0.5937
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.4074, span_acc: 0.8943, attr_start_acc: 0.5829, attr_end_acc: 0.6854, span_micro_p: 0.8491, span_micro_r: 0.6848, span_micro_f1: 0.7581, micro_p: 0.8499, micro_r: 0.5015, micro_f1: 0.6308
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.3750, span_acc: 0.9005, attr_start_acc: 0.6069, attr_end_acc: 0.7013, span_micro_p: 0.8539, span_micro_r: 0.7023, span_micro_f1: 0.7707, micro_p: 0.8611, micro_r: 0.5266, micro_f1: 0.6535
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 1.3452, span_acc: 0.9081, attr_start_acc: 0.6333, attr_end_acc: 0.7200, span_micro_p: 0.8645, span_micro_r: 0.7242, span_micro_f1: 0.7881, micro_p: 0.8738, micro_r: 0.5559, micro_f1: 0.6795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 1.3231, span_acc: 0.9141, attr_start_acc: 0.6577, attr_end_acc: 0.7400, span_micro_p: 0.8726, span_micro_r: 0.7413, span_micro_f1: 0.8016, micro_p: 0.8841, micro_r: 0.5835, micro_f1: 0.7030
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 1.3009, span_acc: 0.9201, attr_start_acc: 0.6791, attr_end_acc: 0.7539, span_micro_p: 0.8769, span_micro_r: 0.7555, span_micro_f1: 0.8117, micro_p: 0.8897, micro_r: 0.6059, micro_f1: 0.7208
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 1.2811, span_acc: 0.9255, attr_start_acc: 0.6968, attr_end_acc: 0.7689, span_micro_p: 0.8834, span_micro_r: 0.7717, span_micro_f1: 0.8238, micro_p: 0.8985, micro_r: 0.6271, micro_f1: 0.7386
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 1.2661, span_acc: 0.9299, attr_start_acc: 0.7141, attr_end_acc: 0.7814, span_micro_p: 0.8890, span_micro_r: 0.7841, span_micro_f1: 0.8333, micro_p: 0.9056, micro_r: 0.6469, micro_f1: 0.7547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 1.2541, span_acc: 0.9327, attr_start_acc: 0.7261, attr_end_acc: 0.7922, span_micro_p: 0.8918, span_micro_r: 0.7919, span_micro_f1: 0.8388, micro_p: 0.9091, micro_r: 0.6600, micro_f1: 0.7647
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 1.2409, span_acc: 0.9360, attr_start_acc: 0.7388, attr_end_acc: 0.8015, span_micro_p: 0.8961, span_micro_r: 0.8014, span_micro_f1: 0.8461, micro_p: 0.9144, micro_r: 0.6750, micro_f1: 0.7767
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 1.2302, span_acc: 0.9375, attr_start_acc: 0.7500, attr_end_acc: 0.8112, span_micro_p: 0.8975, span_micro_r: 0.8071, span_micro_f1: 0.8499, micro_p: 0.9180, micro_r: 0.6880, micro_f1: 0.7865
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 1.2165, span_acc: 0.9403, attr_start_acc: 0.7606, attr_end_acc: 0.8199, span_micro_p: 0.9000, span_micro_r: 0.8148, span_micro_f1: 0.8553, micro_p: 0.9203, micro_r: 0.6993, micro_f1: 0.7947
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 1.2044, span_acc: 0.9424, attr_start_acc: 0.7695, attr_end_acc: 0.8275, span_micro_p: 0.9036, span_micro_r: 0.8216, span_micro_f1: 0.8606, micro_p: 0.9240, micro_r: 0.7102, micro_f1: 0.8031
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 1.1958, span_acc: 0.9436, attr_start_acc: 0.7763, attr_end_acc: 0.8314, span_micro_p: 0.9028, span_micro_r: 0.8233, span_micro_f1: 0.8612, micro_p: 0.9231, micro_r: 0.7157, micro_f1: 0.8063
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 1.1848, span_acc: 0.9454, attr_start_acc: 0.7843, attr_end_acc: 0.8366, span_micro_p: 0.9051, span_micro_r: 0.8283, span_micro_f1: 0.8650, micro_p: 0.9256, micro_r: 0.7239, micro_f1: 0.8124
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 1.1743, span_acc: 0.9470, attr_start_acc: 0.7910, attr_end_acc: 0.8423, span_micro_p: 0.9075, span_micro_r: 0.8327, span_micro_f1: 0.8685, micro_p: 0.9275, micro_r: 0.7320, micro_f1: 0.8182
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 1.1690, span_acc: 0.9477, attr_start_acc: 0.7977, attr_end_acc: 0.8471, span_micro_p: 0.9076, span_micro_r: 0.8355, span_micro_f1: 0.8700, micro_p: 0.9287, micro_r: 0.7391, micro_f1: 0.8231
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 1.1589, span_acc: 0.9488, attr_start_acc: 0.8024, attr_end_acc: 0.8510, span_micro_p: 0.9095, span_micro_r: 0.8393, span_micro_f1: 0.8730, micro_p: 0.9308, micro_r: 0.7450, micro_f1: 0.8276
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 1.1522, span_acc: 0.9501, attr_start_acc: 0.8087, attr_end_acc: 0.8562, span_micro_p: 0.9111, span_micro_r: 0.8426, span_micro_f1: 0.8755, micro_p: 0.9319, micro_r: 0.7522, micro_f1: 0.8325
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 1.1435, span_acc: 0.9512, attr_start_acc: 0.8133, attr_end_acc: 0.8595, span_micro_p: 0.9131, span_micro_r: 0.8465, span_micro_f1: 0.8786, micro_p: 0.9335, micro_r: 0.7577, micro_f1: 0.8365
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 1.1340, span_acc: 0.9521, attr_start_acc: 0.8175, attr_end_acc: 0.8628, span_micro_p: 0.9134, span_micro_r: 0.8493, span_micro_f1: 0.8802, micro_p: 0.9338, micro_r: 0.7621, micro_f1: 0.8393
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 1.1259, span_acc: 0.9529, attr_start_acc: 0.8222, attr_end_acc: 0.8664, span_micro_p: 0.9140, span_micro_r: 0.8519, span_micro_f1: 0.8819, micro_p: 0.9336, micro_r: 0.7675, micro_f1: 0.8424
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 1.1186, span_acc: 0.9539, attr_start_acc: 0.8263, attr_end_acc: 0.8692, span_micro_p: 0.9155, span_micro_r: 0.8547, span_micro_f1: 0.8841, micro_p: 0.9345, micro_r: 0.7719, micro_f1: 0.8455
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 1.1095, span_acc: 0.9547, attr_start_acc: 0.8306, attr_end_acc: 0.8721, span_micro_p: 0.9167, span_micro_r: 0.8577, span_micro_f1: 0.8862, micro_p: 0.9358, micro_r: 0.7770, micro_f1: 0.8490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 1.1011, span_acc: 0.9558, attr_start_acc: 0.8351, attr_end_acc: 0.8752, span_micro_p: 0.9186, span_micro_r: 0.8613, span_micro_f1: 0.8890, micro_p: 0.9373, micro_r: 0.7824, micro_f1: 0.8529
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 1.0923, span_acc: 0.9568, attr_start_acc: 0.8381, attr_end_acc: 0.8777, span_micro_p: 0.9200, span_micro_r: 0.8640, span_micro_f1: 0.8911, micro_p: 0.9382, micro_r: 0.7860, micro_f1: 0.8554
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.21 / 95.36 / 95.03), p: (96.03 / 96.92), r: (95.46 / 91.18), f1: (95.75 / 93.97)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.7380653274754468, 'span_acc': 0.9821174798673614, 'attr_start_acc': 0.9536290322580645, 'attr_end_acc': 0.9502688172043011, 'span_micro_p': 0.9603494623655914, 'span_micro_r': 0.9545758183032732, 'span_micro_f1': 0.9574539363484087, 'micro_p': 0.969241773962804, 'micro_r': 0.9118438761776582, 'micro_f1': 0.9396671289875174, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (1.0, 0.7778, 0.875), 'CONT': (1.0, 0.8182, 0.9), 'ORG': (0.9588, 0.8925, 0.9245), 'TITLE': (0.9709, 0.9203, 0.9449), 'EDU': (0.98, 0.9245, 0.9514), 'RACE': (0.9333, 1.0, 0.9655), 'NAME': (0.9903, 1.0, 0.9951)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9396671289875174 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.39 / 94.78999999999999 / 95.64), p: (95.52000000000001 / 97.15), r: (94.17 / 92.09), f1: (94.84 / 94.55)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.7479943588094892, 'span_acc': 0.9738647830474269, 'attr_start_acc': 0.9478527607361963, 'attr_end_acc': 0.9564417177914111, 'span_micro_p': 0.955196017423771, 'span_micro_r': 0.941717791411043, 'span_micro_f1': 0.9484090206981773, 'micro_p': 0.9715210355987055, 'micro_r': 0.9208588957055215, 'micro_f1': 0.945511811023622, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'CONT': (1.0, 0.8571, 0.9231), 'ORG': (0.9581, 0.9096, 0.9332), 'TITLE': (0.9754, 0.9236, 0.9488), 'PRO': (0.9412, 0.9697, 0.9552), 'EDU': (1.0, 0.9196, 0.9581), 'NAME': (0.9825, 1.0, 0.9912), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.945511811023622 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.8700, span_acc: 0.9693, attr_start_acc: 0.9143, attr_end_acc: 0.9143, span_micro_p: 0.9167, span_micro_r: 0.9429, span_micro_f1: 0.9296, micro_p: 1.0000, micro_r: 0.8286, micro_f1: 0.9062
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.7955, span_acc: 0.9857, attr_start_acc: 0.9664, attr_end_acc: 0.9716, span_micro_p: 0.9562, span_micro_r: 0.9562, span_micro_f1: 0.9562, micro_p: 0.9810, micro_r: 0.9354, micro_f1: 0.9577
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.7877, span_acc: 0.9854, attr_start_acc: 0.9584, attr_end_acc: 0.9584, span_micro_p: 0.9583, span_micro_r: 0.9513, span_micro_f1: 0.9548, micro_p: 0.9741, micro_r: 0.9192, micro_f1: 0.9458
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.7866, span_acc: 0.9855, attr_start_acc: 0.9513, attr_end_acc: 0.9568, span_micro_p: 0.9597, span_micro_r: 0.9493, span_micro_f1: 0.9545, micro_p: 0.9741, micro_r: 0.9144, micro_f1: 0.9433
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.7862, span_acc: 0.9841, attr_start_acc: 0.9559, attr_end_acc: 0.9601, span_micro_p: 0.9576, span_micro_r: 0.9496, span_micro_f1: 0.9536, micro_p: 0.9736, micro_r: 0.9213, micro_f1: 0.9467
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.7886, span_acc: 0.9818, attr_start_acc: 0.9536, attr_end_acc: 0.9593, span_micro_p: 0.9544, span_micro_r: 0.9448, span_micro_f1: 0.9496, micro_p: 0.9673, micro_r: 0.9187, micro_f1: 0.9424
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.7768, span_acc: 0.9815, attr_start_acc: 0.9550, attr_end_acc: 0.9610, span_micro_p: 0.9529, span_micro_r: 0.9431, span_micro_f1: 0.9479, micro_p: 0.9662, micro_r: 0.9224, micro_f1: 0.9438
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.7711, span_acc: 0.9805, attr_start_acc: 0.9556, attr_end_acc: 0.9615, span_micro_p: 0.9530, span_micro_r: 0.9422, span_micro_f1: 0.9475, micro_p: 0.9661, micro_r: 0.9229, micro_f1: 0.9440
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.7604, span_acc: 0.9809, attr_start_acc: 0.9576, attr_end_acc: 0.9607, span_micro_p: 0.9532, span_micro_r: 0.9438, span_micro_f1: 0.9485, micro_p: 0.9676, micro_r: 0.9246, micro_f1: 0.9456
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.7486, span_acc: 0.9803, attr_start_acc: 0.9557, attr_end_acc: 0.9605, span_micro_p: 0.9530, span_micro_r: 0.9419, span_micro_f1: 0.9475, micro_p: 0.9670, micro_r: 0.9234, micro_f1: 0.9447
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.7439, span_acc: 0.9816, attr_start_acc: 0.9579, attr_end_acc: 0.9632, span_micro_p: 0.9542, span_micro_r: 0.9446, span_micro_f1: 0.9494, micro_p: 0.9679, micro_r: 0.9279, micro_f1: 0.9475
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.7301, span_acc: 0.9820, attr_start_acc: 0.9586, attr_end_acc: 0.9645, span_micro_p: 0.9551, span_micro_r: 0.9450, span_micro_f1: 0.9500, micro_p: 0.9680, micro_r: 0.9293, micro_f1: 0.9483
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.7202, span_acc: 0.9826, attr_start_acc: 0.9585, attr_end_acc: 0.9653, span_micro_p: 0.9563, span_micro_r: 0.9461, span_micro_f1: 0.9512, micro_p: 0.9684, micro_r: 0.9303, micro_f1: 0.9490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.7137, span_acc: 0.9833, attr_start_acc: 0.9580, attr_end_acc: 0.9654, span_micro_p: 0.9573, span_micro_r: 0.9478, span_micro_f1: 0.9525, micro_p: 0.9687, micro_r: 0.9301, micro_f1: 0.9490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.7035, span_acc: 0.9834, attr_start_acc: 0.9575, attr_end_acc: 0.9658, span_micro_p: 0.9572, span_micro_r: 0.9480, span_micro_f1: 0.9526, micro_p: 0.9679, micro_r: 0.9287, micro_f1: 0.9479
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.6939, span_acc: 0.9837, attr_start_acc: 0.9580, attr_end_acc: 0.9660, span_micro_p: 0.9576, span_micro_r: 0.9487, span_micro_f1: 0.9531, micro_p: 0.9683, micro_r: 0.9296, micro_f1: 0.9486
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.6893, span_acc: 0.9835, attr_start_acc: 0.9575, attr_end_acc: 0.9662, span_micro_p: 0.9566, span_micro_r: 0.9483, span_micro_f1: 0.9524, micro_p: 0.9684, micro_r: 0.9296, micro_f1: 0.9486
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.6805, span_acc: 0.9838, attr_start_acc: 0.9571, attr_end_acc: 0.9672, span_micro_p: 0.9557, span_micro_r: 0.9481, span_micro_f1: 0.9519, micro_p: 0.9691, micro_r: 0.9296, micro_f1: 0.9490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.6819, span_acc: 0.9834, attr_start_acc: 0.9570, attr_end_acc: 0.9671, span_micro_p: 0.9560, span_micro_r: 0.9483, span_micro_f1: 0.9521, micro_p: 0.9691, micro_r: 0.9297, micro_f1: 0.9490
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.6770, span_acc: 0.9836, attr_start_acc: 0.9565, attr_end_acc: 0.9668, span_micro_p: 0.9554, span_micro_r: 0.9482, span_micro_f1: 0.9518, micro_p: 0.9690, micro_r: 0.9295, micro_f1: 0.9489
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.6727, span_acc: 0.9835, attr_start_acc: 0.9563, attr_end_acc: 0.9667, span_micro_p: 0.9552, span_micro_r: 0.9481, span_micro_f1: 0.9516, micro_p: 0.9695, micro_r: 0.9292, micro_f1: 0.9489
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.6642, span_acc: 0.9838, attr_start_acc: 0.9567, attr_end_acc: 0.9665, span_micro_p: 0.9558, span_micro_r: 0.9484, span_micro_f1: 0.9521, micro_p: 0.9695, micro_r: 0.9296, micro_f1: 0.9491
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.6581, span_acc: 0.9840, attr_start_acc: 0.9566, attr_end_acc: 0.9663, span_micro_p: 0.9555, span_micro_r: 0.9485, span_micro_f1: 0.9520, micro_p: 0.9701, micro_r: 0.9293, micro_f1: 0.9493
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.6515, span_acc: 0.9836, attr_start_acc: 0.9561, attr_end_acc: 0.9660, span_micro_p: 0.9554, span_micro_r: 0.9481, span_micro_f1: 0.9517, micro_p: 0.9704, micro_r: 0.9288, micro_f1: 0.9491
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.6543, span_acc: 0.9835, attr_start_acc: 0.9555, attr_end_acc: 0.9643, span_micro_p: 0.9551, span_micro_r: 0.9481, span_micro_f1: 0.9516, micro_p: 0.9700, micro_r: 0.9265, micro_f1: 0.9478
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.6531, span_acc: 0.9828, attr_start_acc: 0.9551, attr_end_acc: 0.9641, span_micro_p: 0.9534, span_micro_r: 0.9485, span_micro_f1: 0.9510, micro_p: 0.9702, micro_r: 0.9257, micro_f1: 0.9474
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.6464, span_acc: 0.9829, attr_start_acc: 0.9559, attr_end_acc: 0.9648, span_micro_p: 0.9531, span_micro_r: 0.9487, span_micro_f1: 0.9509, micro_p: 0.9699, micro_r: 0.9263, micro_f1: 0.9476
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.6390, span_acc: 0.9829, attr_start_acc: 0.9562, attr_end_acc: 0.9654, span_micro_p: 0.9530, span_micro_r: 0.9487, span_micro_f1: 0.9509, micro_p: 0.9701, micro_r: 0.9268, micro_f1: 0.9480
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.6297, span_acc: 0.9831, attr_start_acc: 0.9568, attr_end_acc: 0.9661, span_micro_p: 0.9537, span_micro_r: 0.9496, span_micro_f1: 0.9516, micro_p: 0.9703, micro_r: 0.9281, micro_f1: 0.9487
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.6340, span_acc: 0.9829, attr_start_acc: 0.9572, attr_end_acc: 0.9668, span_micro_p: 0.9540, span_micro_r: 0.9496, span_micro_f1: 0.9518, micro_p: 0.9703, micro_r: 0.9291, micro_f1: 0.9493
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.6278, span_acc: 0.9831, attr_start_acc: 0.9573, attr_end_acc: 0.9666, span_micro_p: 0.9542, span_micro_r: 0.9500, span_micro_f1: 0.9521, micro_p: 0.9703, micro_r: 0.9290, micro_f1: 0.9492
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.6226, span_acc: 0.9827, attr_start_acc: 0.9571, attr_end_acc: 0.9667, span_micro_p: 0.9542, span_micro_r: 0.9492, span_micro_f1: 0.9517, micro_p: 0.9700, micro_r: 0.9286, micro_f1: 0.9489
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 96.37 / 97.11), p: (96.32 / 97.28999999999999), r: (96.13000000000001 / 94.08), f1: (96.22 / 95.66)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.33428351577878257, 'span_acc': 0.9851965892941734, 'attr_start_acc': 0.9637096774193549, 'attr_end_acc': 0.9711021505376344, 'span_micro_p': 0.963186077643909, 'span_micro_r': 0.9612558450233801, 'span_micro_f1': 0.9622199933132732, 'micro_p': 0.9728601252609603, 'micro_r': 0.9407806191117093, 'micro_f1': 0.9565514881970578, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.9412, 0.8889, 0.9143), 'ORG': (0.9622, 0.929, 0.9453), 'EDU': (0.9709, 0.9434, 0.957), 'TITLE': (0.9774, 0.9406, 0.9586), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9565514881970578 / 0.9396671289875174
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.94 / 95.03 / 95.83), p: (95.83 / 96.97), r: (94.48 / 92.27), f1: (95.15 / 94.56)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.2339683808620621, 'span_acc': 0.9794147325933401, 'attr_start_acc': 0.9503067484662576, 'attr_end_acc': 0.9582822085889571, 'span_micro_p': 0.9583074051026758, 'span_micro_r': 0.9447852760736196, 'span_micro_f1': 0.9514983008958912, 'micro_p': 0.9696969696969697, 'micro_r': 0.9226993865030675, 'micro_f1': 0.9456145866079849, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'ORG': (0.9618, 0.9114, 0.9359), 'TITLE': (0.9647, 0.9197, 0.9417), 'EDU': (1.0, 0.9286, 0.963), 'PRO': (0.9697, 0.9697, 0.9697), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9456145866079849 / 0.945511811023622
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: 0.1699, span_acc: 1.0000, attr_start_acc: 1.0000, attr_end_acc: 0.9740, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9740, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: 0.2165, span_acc: 0.9872, attr_start_acc: 0.9618, attr_end_acc: 0.9554, span_micro_p: 0.9679, span_micro_r: 0.9516, span_micro_f1: 0.9597, micro_p: 0.9821, micro_r: 0.9299, micro_f1: 0.9553
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: 0.3613, span_acc: 0.9823, attr_start_acc: 0.9548, attr_end_acc: 0.9649, span_micro_p: 0.9568, span_micro_r: 0.9429, span_micro_f1: 0.9498, micro_p: 0.9727, micro_r: 0.9308, micro_f1: 0.9513
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: 0.3457, span_acc: 0.9856, attr_start_acc: 0.9581, attr_end_acc: 0.9718, span_micro_p: 0.9598, span_micro_r: 0.9537, span_micro_f1: 0.9568, micro_p: 0.9749, micro_r: 0.9403, micro_f1: 0.9573
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: 0.3639, span_acc: 0.9859, attr_start_acc: 0.9619, attr_end_acc: 0.9750, span_micro_p: 0.9602, span_micro_r: 0.9557, span_micro_f1: 0.9579, micro_p: 0.9748, micro_r: 0.9439, micro_f1: 0.9591
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: 0.3490, span_acc: 0.9864, attr_start_acc: 0.9650, attr_end_acc: 0.9764, span_micro_p: 0.9586, span_micro_r: 0.9568, span_micro_f1: 0.9577, micro_p: 0.9742, micro_r: 0.9466, micro_f1: 0.9602
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: 0.3906, span_acc: 0.9867, attr_start_acc: 0.9661, attr_end_acc: 0.9766, span_micro_p: 0.9619, span_micro_r: 0.9586, span_micro_f1: 0.9602, micro_p: 0.9759, micro_r: 0.9481, micro_f1: 0.9618
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: 0.3778, span_acc: 0.9875, attr_start_acc: 0.9668, attr_end_acc: 0.9772, span_micro_p: 0.9626, span_micro_r: 0.9593, span_micro_f1: 0.9609, micro_p: 0.9755, micro_r: 0.9490, micro_f1: 0.9621
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: 0.3630, span_acc: 0.9876, attr_start_acc: 0.9680, attr_end_acc: 0.9770, span_micro_p: 0.9614, span_micro_r: 0.9592, span_micro_f1: 0.9603, micro_p: 0.9751, micro_r: 0.9490, micro_f1: 0.9619
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: 0.3472, span_acc: 0.9880, attr_start_acc: 0.9678, attr_end_acc: 0.9773, span_micro_p: 0.9632, span_micro_r: 0.9598, span_micro_f1: 0.9615, micro_p: 0.9766, micro_r: 0.9489, micro_f1: 0.9626
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: 0.3399, span_acc: 0.9888, attr_start_acc: 0.9690, attr_end_acc: 0.9789, span_micro_p: 0.9658, span_micro_r: 0.9624, span_micro_f1: 0.9641, micro_p: 0.9783, micro_r: 0.9518, micro_f1: 0.9649
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: 0.3478, span_acc: 0.9884, attr_start_acc: 0.9661, attr_end_acc: 0.9771, span_micro_p: 0.9641, span_micro_r: 0.9608, span_micro_f1: 0.9624, micro_p: 0.9761, micro_r: 0.9483, micro_f1: 0.9620
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: 0.3331, span_acc: 0.9882, attr_start_acc: 0.9661, attr_end_acc: 0.9771, span_micro_p: 0.9634, span_micro_r: 0.9610, span_micro_f1: 0.9622, micro_p: 0.9760, micro_r: 0.9480, micro_f1: 0.9618
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: 0.3369, span_acc: 0.9887, attr_start_acc: 0.9669, attr_end_acc: 0.9783, span_micro_p: 0.9650, span_micro_r: 0.9620, span_micro_f1: 0.9635, micro_p: 0.9769, micro_r: 0.9495, micro_f1: 0.9630
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: 0.3297, span_acc: 0.9887, attr_start_acc: 0.9664, attr_end_acc: 0.9778, span_micro_p: 0.9650, span_micro_r: 0.9624, span_micro_f1: 0.9637, micro_p: 0.9769, micro_r: 0.9489, micro_f1: 0.9627
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: 0.3305, span_acc: 0.9885, attr_start_acc: 0.9673, attr_end_acc: 0.9780, span_micro_p: 0.9642, span_micro_r: 0.9627, span_micro_f1: 0.9635, micro_p: 0.9762, micro_r: 0.9498, micro_f1: 0.9628
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: 0.3271, span_acc: 0.9886, attr_start_acc: 0.9673, attr_end_acc: 0.9780, span_micro_p: 0.9639, span_micro_r: 0.9626, span_micro_f1: 0.9633, micro_p: 0.9757, micro_r: 0.9497, micro_f1: 0.9625
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: 0.3212, span_acc: 0.9885, attr_start_acc: 0.9665, attr_end_acc: 0.9774, span_micro_p: 0.9637, span_micro_r: 0.9629, span_micro_f1: 0.9633, micro_p: 0.9754, micro_r: 0.9481, micro_f1: 0.9615
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: 0.3260, span_acc: 0.9887, attr_start_acc: 0.9670, attr_end_acc: 0.9776, span_micro_p: 0.9640, span_micro_r: 0.9631, span_micro_f1: 0.9636, micro_p: 0.9763, micro_r: 0.9489, micro_f1: 0.9624
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: 0.3211, span_acc: 0.9883, attr_start_acc: 0.9673, attr_end_acc: 0.9772, span_micro_p: 0.9634, span_micro_r: 0.9626, span_micro_f1: 0.9630, micro_p: 0.9753, micro_r: 0.9487, micro_f1: 0.9618
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: 0.3347, span_acc: 0.9879, attr_start_acc: 0.9679, attr_end_acc: 0.9769, span_micro_p: 0.9643, span_micro_r: 0.9628, span_micro_f1: 0.9636, micro_p: 0.9759, micro_r: 0.9494, micro_f1: 0.9624
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: 0.3307, span_acc: 0.9878, attr_start_acc: 0.9687, attr_end_acc: 0.9773, span_micro_p: 0.9653, span_micro_r: 0.9635, span_micro_f1: 0.9644, micro_p: 0.9763, micro_r: 0.9505, micro_f1: 0.9633
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: 0.3249, span_acc: 0.9881, attr_start_acc: 0.9688, attr_end_acc: 0.9776, span_micro_p: 0.9662, span_micro_r: 0.9645, span_micro_f1: 0.9654, micro_p: 0.9764, micro_r: 0.9511, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: 0.3178, span_acc: 0.9882, attr_start_acc: 0.9682, attr_end_acc: 0.9771, span_micro_p: 0.9663, span_micro_r: 0.9643, span_micro_f1: 0.9653, micro_p: 0.9764, micro_r: 0.9503, micro_f1: 0.9632
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: 0.3139, span_acc: 0.9883, attr_start_acc: 0.9682, attr_end_acc: 0.9773, span_micro_p: 0.9665, span_micro_r: 0.9645, span_micro_f1: 0.9655, micro_p: 0.9763, micro_r: 0.9506, micro_f1: 0.9633
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: 0.3116, span_acc: 0.9884, attr_start_acc: 0.9687, attr_end_acc: 0.9778, span_micro_p: 0.9670, span_micro_r: 0.9645, span_micro_f1: 0.9658, micro_p: 0.9767, micro_r: 0.9514, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: 0.3292, span_acc: 0.9883, attr_start_acc: 0.9688, attr_end_acc: 0.9775, span_micro_p: 0.9669, span_micro_r: 0.9643, span_micro_f1: 0.9656, micro_p: 0.9765, micro_r: 0.9513, micro_f1: 0.9637
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: 0.3250, span_acc: 0.9885, attr_start_acc: 0.9687, attr_end_acc: 0.9776, span_micro_p: 0.9668, span_micro_r: 0.9649, span_micro_f1: 0.9659, micro_p: 0.9767, micro_r: 0.9514, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: 0.3301, span_acc: 0.9882, attr_start_acc: 0.9686, attr_end_acc: 0.9777, span_micro_p: 0.9667, span_micro_r: 0.9645, span_micro_f1: 0.9656, micro_p: 0.9761, micro_r: 0.9507, micro_f1: 0.9633
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: 0.3270, span_acc: 0.9884, attr_start_acc: 0.9687, attr_end_acc: 0.9778, span_micro_p: 0.9668, span_micro_r: 0.9644, span_micro_f1: 0.9656, micro_p: 0.9761, micro_r: 0.9507, micro_f1: 0.9632
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: 0.3232, span_acc: 0.9884, attr_start_acc: 0.9688, attr_end_acc: 0.9776, span_micro_p: 0.9670, span_micro_r: 0.9642, span_micro_f1: 0.9656, micro_p: 0.9764, micro_r: 0.9507, micro_f1: 0.9634
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: 0.3198, span_acc: 0.9885, attr_start_acc: 0.9692, attr_end_acc: 0.9778, span_micro_p: 0.9674, span_micro_r: 0.9645, span_micro_f1: 0.9659, micro_p: 0.9766, micro_r: 0.9512, micro_f1: 0.9638
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.87 / 97.04 / 97.98), p: (95.53 / 96.59), r: (96.99 / 95.28999999999999), f1: (96.25 / 95.93)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.4357801451796332, 'span_acc': 0.9887494078635718, 'attr_start_acc': 0.9704301075268817, 'attr_end_acc': 0.9798387096774194, 'span_micro_p': 0.9552631578947368, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.9625455750745774, 'micro_p': 0.965893587994543, 'micro_r': 0.9528936742934051, 'micro_f1': 0.9593495934959348, 'category-p/r/f1': {'PRO': (0.8095, 0.9444, 0.8718), 'EDU': (0.9524, 0.9434, 0.9479), 'ORG': (0.9559, 0.9559, 0.9559), 'TITLE': (0.9731, 0.942, 0.9573), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9593495934959348 / 0.9565514881970578
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.24000000000001 / 96.07 / 97.36), p: (94.77 / 96.85000000000001), r: (95.52000000000001 / 94.23), f1: (95.14 / 95.52000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.09480382548938007, 'span_acc': 0.9824419778002018, 'attr_start_acc': 0.9607361963190184, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9476567255021302, 'span_micro_r': 0.9552147239263804, 'span_micro_f1': 0.9514207149404217, 'micro_p': 0.9684741488020177, 'micro_r': 0.9423312883435583, 'micro_f1': 0.9552238805970149, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9592, 0.9349, 0.9469), 'TITLE': (0.9664, 0.9301, 0.9479), 'PRO': (0.9697, 0.9697, 0.9697), 'EDU': (0.9821, 0.9821, 0.9821), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9552238805970149 / 0.9456145866079849
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: 0.1166, span_acc: 0.9821, attr_start_acc: 0.9652, attr_end_acc: 0.9739, span_micro_p: 0.9737, span_micro_r: 0.9569, span_micro_f1: 0.9652, micro_p: 0.9820, micro_r: 0.9478, micro_f1: 0.9646
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: 0.0270, span_acc: 0.9922, attr_start_acc: 0.9759, attr_end_acc: 0.9828, span_micro_p: 0.9828, span_micro_r: 0.9744, span_micro_f1: 0.9786, micro_p: 0.9894, micro_r: 0.9621, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.0336, span_acc: 0.9928, attr_start_acc: 0.9761, attr_end_acc: 0.9853, span_micro_p: 0.9798, span_micro_r: 0.9754, span_micro_f1: 0.9776, micro_p: 0.9849, micro_r: 0.9641, micro_f1: 0.9744
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: 0.0133, span_acc: 0.9931, attr_start_acc: 0.9705, attr_end_acc: 0.9815, span_micro_p: 0.9788, span_micro_r: 0.9734, span_micro_f1: 0.9761, micro_p: 0.9838, micro_r: 0.9574, micro_f1: 0.9704
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: 0.0083, span_acc: 0.9922, attr_start_acc: 0.9720, attr_end_acc: 0.9836, span_micro_p: 0.9736, span_micro_r: 0.9690, span_micro_f1: 0.9713, micro_p: 0.9827, micro_r: 0.9583, micro_f1: 0.9703
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: 0.0767, span_acc: 0.9917, attr_start_acc: 0.9719, attr_end_acc: 0.9836, span_micro_p: 0.9737, span_micro_r: 0.9674, span_micro_f1: 0.9705, micro_p: 0.9814, micro_r: 0.9585, micro_f1: 0.9698
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: 0.0946, span_acc: 0.9910, attr_start_acc: 0.9719, attr_end_acc: 0.9822, span_micro_p: 0.9726, span_micro_r: 0.9673, span_micro_f1: 0.9699, micro_p: 0.9799, micro_r: 0.9577, micro_f1: 0.9687
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: 0.0841, span_acc: 0.9913, attr_start_acc: 0.9726, attr_end_acc: 0.9838, span_micro_p: 0.9736, span_micro_r: 0.9677, span_micro_f1: 0.9707, micro_p: 0.9811, micro_r: 0.9598, micro_f1: 0.9703
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: 0.0759, span_acc: 0.9918, attr_start_acc: 0.9725, attr_end_acc: 0.9849, span_micro_p: 0.9740, span_micro_r: 0.9700, span_micro_f1: 0.9720, micro_p: 0.9819, micro_r: 0.9605, micro_f1: 0.9711
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: 0.2864, span_acc: 0.9905, attr_start_acc: 0.9718, attr_end_acc: 0.9841, span_micro_p: 0.9726, span_micro_r: 0.9676, span_micro_f1: 0.9701, micro_p: 0.9799, micro_r: 0.9584, micro_f1: 0.9690
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: 0.2878, span_acc: 0.9907, attr_start_acc: 0.9719, attr_end_acc: 0.9843, span_micro_p: 0.9724, span_micro_r: 0.9676, span_micro_f1: 0.9700, micro_p: 0.9798, micro_r: 0.9584, micro_f1: 0.9690
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: 0.2730, span_acc: 0.9908, attr_start_acc: 0.9714, attr_end_acc: 0.9838, span_micro_p: 0.9733, span_micro_r: 0.9690, span_micro_f1: 0.9711, micro_p: 0.9804, micro_r: 0.9578, micro_f1: 0.9690
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: 0.2542, span_acc: 0.9910, attr_start_acc: 0.9717, attr_end_acc: 0.9840, span_micro_p: 0.9739, span_micro_r: 0.9698, span_micro_f1: 0.9719, micro_p: 0.9797, micro_r: 0.9580, micro_f1: 0.9687
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: 0.2626, span_acc: 0.9911, attr_start_acc: 0.9721, attr_end_acc: 0.9833, span_micro_p: 0.9734, span_micro_r: 0.9696, span_micro_f1: 0.9715, micro_p: 0.9795, micro_r: 0.9580, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: 0.2400, span_acc: 0.9914, attr_start_acc: 0.9725, attr_end_acc: 0.9837, span_micro_p: 0.9738, span_micro_r: 0.9709, span_micro_f1: 0.9723, micro_p: 0.9791, micro_r: 0.9585, micro_f1: 0.9687
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: 0.2773, span_acc: 0.9913, attr_start_acc: 0.9739, attr_end_acc: 0.9842, span_micro_p: 0.9733, span_micro_r: 0.9696, span_micro_f1: 0.9714, micro_p: 0.9791, micro_r: 0.9594, micro_f1: 0.9691
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: 0.2934, span_acc: 0.9912, attr_start_acc: 0.9733, attr_end_acc: 0.9844, span_micro_p: 0.9733, span_micro_r: 0.9694, span_micro_f1: 0.9714, micro_p: 0.9783, micro_r: 0.9589, micro_f1: 0.9685
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: 0.2904, span_acc: 0.9912, attr_start_acc: 0.9729, attr_end_acc: 0.9843, span_micro_p: 0.9735, span_micro_r: 0.9697, span_micro_f1: 0.9716, micro_p: 0.9782, micro_r: 0.9588, micro_f1: 0.9684
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: 0.2597, span_acc: 0.9915, attr_start_acc: 0.9741, attr_end_acc: 0.9845, span_micro_p: 0.9747, span_micro_r: 0.9709, span_micro_f1: 0.9728, micro_p: 0.9791, micro_r: 0.9603, micro_f1: 0.9696
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: 0.2951, span_acc: 0.9912, attr_start_acc: 0.9743, attr_end_acc: 0.9843, span_micro_p: 0.9751, span_micro_r: 0.9701, span_micro_f1: 0.9726, micro_p: 0.9797, micro_r: 0.9608, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: 0.2974, span_acc: 0.9914, attr_start_acc: 0.9741, attr_end_acc: 0.9840, span_micro_p: 0.9754, span_micro_r: 0.9706, span_micro_f1: 0.9730, micro_p: 0.9799, micro_r: 0.9606, micro_f1: 0.9702
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: 0.2793, span_acc: 0.9913, attr_start_acc: 0.9746, attr_end_acc: 0.9846, span_micro_p: 0.9744, span_micro_r: 0.9706, span_micro_f1: 0.9725, micro_p: 0.9797, micro_r: 0.9611, micro_f1: 0.9703
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: 0.3350, span_acc: 0.9908, attr_start_acc: 0.9750, attr_end_acc: 0.9840, span_micro_p: 0.9749, span_micro_r: 0.9710, span_micro_f1: 0.9729, micro_p: 0.9803, micro_r: 0.9613, micro_f1: 0.9707
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: 0.3585, span_acc: 0.9908, attr_start_acc: 0.9749, attr_end_acc: 0.9836, span_micro_p: 0.9747, span_micro_r: 0.9709, span_micro_f1: 0.9728, micro_p: 0.9801, micro_r: 0.9612, micro_f1: 0.9706
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: 0.3752, span_acc: 0.9908, attr_start_acc: 0.9752, attr_end_acc: 0.9837, span_micro_p: 0.9747, span_micro_r: 0.9709, span_micro_f1: 0.9728, micro_p: 0.9801, micro_r: 0.9614, micro_f1: 0.9706
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: 0.3578, span_acc: 0.9909, attr_start_acc: 0.9754, attr_end_acc: 0.9836, span_micro_p: 0.9747, span_micro_r: 0.9714, span_micro_f1: 0.9731, micro_p: 0.9801, micro_r: 0.9614, micro_f1: 0.9706
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: 0.3759, span_acc: 0.9909, attr_start_acc: 0.9749, attr_end_acc: 0.9834, span_micro_p: 0.9749, span_micro_r: 0.9716, span_micro_f1: 0.9732, micro_p: 0.9800, micro_r: 0.9609, micro_f1: 0.9704
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: 0.3543, span_acc: 0.9911, attr_start_acc: 0.9747, attr_end_acc: 0.9832, span_micro_p: 0.9754, span_micro_r: 0.9722, span_micro_f1: 0.9738, micro_p: 0.9800, micro_r: 0.9608, micro_f1: 0.9703
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: 0.3434, span_acc: 0.9910, attr_start_acc: 0.9745, attr_end_acc: 0.9831, span_micro_p: 0.9749, span_micro_r: 0.9722, span_micro_f1: 0.9736, micro_p: 0.9796, micro_r: 0.9607, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: 0.3336, span_acc: 0.9912, attr_start_acc: 0.9737, attr_end_acc: 0.9833, span_micro_p: 0.9749, span_micro_r: 0.9725, span_micro_f1: 0.9737, micro_p: 0.9794, micro_r: 0.9602, micro_f1: 0.9697
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: 0.3214, span_acc: 0.9914, attr_start_acc: 0.9739, attr_end_acc: 0.9835, span_micro_p: 0.9756, span_micro_r: 0.9732, span_micro_f1: 0.9744, micro_p: 0.9797, micro_r: 0.9607, micro_f1: 0.9701
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: 0.3283, span_acc: 0.9916, attr_start_acc: 0.9744, attr_end_acc: 0.9838, span_micro_p: 0.9759, span_micro_r: 0.9738, span_micro_f1: 0.9748, micro_p: 0.9800, micro_r: 0.9613, micro_f1: 0.9706
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.6 / 97.65 / 98.59), p: (95.45 / 96.09), r: (96.66 / 95.83), f1: (96.05 / 95.96000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.3649331199942603, 'span_acc': 0.9860255802936997, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9858870967741935, 'span_micro_p': 0.9544854881266491, 'span_micro_r': 0.9665998663994656, 'span_micro_f1': 0.9605044805841354, 'micro_p': 0.9608636977058029, 'micro_r': 0.9582772543741588, 'micro_f1': 0.9595687331536389, 'category-p/r/f1': {'PRO': (0.7083, 0.9444, 0.8095), 'ORG': (0.9448, 0.952, 0.9484), 'EDU': (0.9615, 0.9434, 0.9524), 'TITLE': (0.9749, 0.9565, 0.9656), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9595687331536389 / 0.9593495934959348
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.14 / 96.26 / 97.78999999999999), p: (94.17999999999999 / 96.00999999999999), r: (95.34 / 94.48), f1: (94.76 / 95.24000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.8578136949419225, 'span_acc': 0.9814328960645813, 'attr_start_acc': 0.9625766871165644, 'attr_end_acc': 0.9779141104294479, 'span_micro_p': 0.9418181818181818, 'span_micro_r': 0.9533742331288344, 'span_micro_f1': 0.9475609756097562, 'micro_p': 0.9600997506234414, 'micro_r': 0.9447852760736196, 'micro_f1': 0.9523809523809523, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'ORG': (0.9454, 0.9385, 0.9419), 'TITLE': (0.9601, 0.9352, 0.9475), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9523809523809523 / 0.9552238805970149
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: 0.1767, span_acc: 0.9911, attr_start_acc: 0.9866, attr_end_acc: 0.9664, span_micro_p: 0.9735, span_micro_r: 0.9800, span_micro_f1: 0.9767, micro_p: 0.9728, micro_r: 0.9597, micro_f1: 0.9662
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: 0.2930, span_acc: 0.9859, attr_start_acc: 0.9765, attr_end_acc: 0.9804, span_micro_p: 0.9767, span_micro_r: 0.9786, span_micro_f1: 0.9777, micro_p: 0.9820, micro_r: 0.9627, micro_f1: 0.9723
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: 0.2672, span_acc: 0.9903, attr_start_acc: 0.9798, attr_end_acc: 0.9854, span_micro_p: 0.9779, span_micro_r: 0.9833, span_micro_f1: 0.9806, micro_p: 0.9841, micro_r: 0.9686, micro_f1: 0.9763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.4204, span_acc: 0.9917, attr_start_acc: 0.9790, attr_end_acc: 0.9860, span_micro_p: 0.9815, span_micro_r: 0.9845, span_micro_f1: 0.9830, micro_p: 0.9849, micro_r: 0.9688, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.7610, span_acc: 0.9924, attr_start_acc: 0.9789, attr_end_acc: 0.9859, span_micro_p: 0.9826, span_micro_r: 0.9831, span_micro_f1: 0.9829, micro_p: 0.9845, micro_r: 0.9683, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.6837, span_acc: 0.9920, attr_start_acc: 0.9765, attr_end_acc: 0.9853, span_micro_p: 0.9799, span_micro_r: 0.9808, span_micro_f1: 0.9804, micro_p: 0.9836, micro_r: 0.9664, micro_f1: 0.9749
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.5943, span_acc: 0.9921, attr_start_acc: 0.9765, attr_end_acc: 0.9849, span_micro_p: 0.9783, span_micro_r: 0.9797, span_micro_f1: 0.9790, micro_p: 0.9823, micro_r: 0.9648, micro_f1: 0.9734
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.5873, span_acc: 0.9927, attr_start_acc: 0.9763, attr_end_acc: 0.9850, span_micro_p: 0.9802, span_micro_r: 0.9805, span_micro_f1: 0.9803, micro_p: 0.9833, micro_r: 0.9643, micro_f1: 0.9737
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: 0.5556, span_acc: 0.9925, attr_start_acc: 0.9772, attr_end_acc: 0.9847, span_micro_p: 0.9782, span_micro_r: 0.9791, span_micro_f1: 0.9787, micro_p: 0.9829, micro_r: 0.9644, micro_f1: 0.9736
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: 0.4546, span_acc: 0.9928, attr_start_acc: 0.9784, attr_end_acc: 0.9851, span_micro_p: 0.9783, span_micro_r: 0.9793, span_micro_f1: 0.9788, micro_p: 0.9835, micro_r: 0.9652, micro_f1: 0.9743
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: 0.4027, span_acc: 0.9932, attr_start_acc: 0.9794, attr_end_acc: 0.9856, span_micro_p: 0.9789, span_micro_r: 0.9800, span_micro_f1: 0.9794, micro_p: 0.9839, micro_r: 0.9663, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: 0.3864, span_acc: 0.9931, attr_start_acc: 0.9793, attr_end_acc: 0.9856, span_micro_p: 0.9797, span_micro_r: 0.9797, span_micro_f1: 0.9797, micro_p: 0.9838, micro_r: 0.9665, micro_f1: 0.9751
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: 0.3463, span_acc: 0.9932, attr_start_acc: 0.9795, attr_end_acc: 0.9858, span_micro_p: 0.9801, span_micro_r: 0.9795, span_micro_f1: 0.9798, micro_p: 0.9844, micro_r: 0.9672, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: 0.3454, span_acc: 0.9934, attr_start_acc: 0.9795, attr_end_acc: 0.9856, span_micro_p: 0.9803, span_micro_r: 0.9795, span_micro_f1: 0.9799, micro_p: 0.9847, micro_r: 0.9672, micro_f1: 0.9759
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: 0.3608, span_acc: 0.9935, attr_start_acc: 0.9792, attr_end_acc: 0.9852, span_micro_p: 0.9805, span_micro_r: 0.9792, span_micro_f1: 0.9799, micro_p: 0.9850, micro_r: 0.9667, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: 0.3499, span_acc: 0.9937, attr_start_acc: 0.9799, attr_end_acc: 0.9852, span_micro_p: 0.9808, span_micro_r: 0.9797, span_micro_f1: 0.9802, micro_p: 0.9856, micro_r: 0.9672, micro_f1: 0.9763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: 0.4021, span_acc: 0.9935, attr_start_acc: 0.9792, attr_end_acc: 0.9849, span_micro_p: 0.9808, span_micro_r: 0.9787, span_micro_f1: 0.9797, micro_p: 0.9858, micro_r: 0.9666, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.4547, span_acc: 0.9934, attr_start_acc: 0.9794, attr_end_acc: 0.9855, span_micro_p: 0.9806, span_micro_r: 0.9788, span_micro_f1: 0.9797, micro_p: 0.9853, micro_r: 0.9670, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: 0.4146, span_acc: 0.9933, attr_start_acc: 0.9790, attr_end_acc: 0.9858, span_micro_p: 0.9811, span_micro_r: 0.9791, span_micro_f1: 0.9801, micro_p: 0.9856, micro_r: 0.9672, micro_f1: 0.9763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: 0.3820, span_acc: 0.9935, attr_start_acc: 0.9784, attr_end_acc: 0.9859, span_micro_p: 0.9815, span_micro_r: 0.9797, span_micro_f1: 0.9806, micro_p: 0.9856, micro_r: 0.9673, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: 0.3553, span_acc: 0.9937, attr_start_acc: 0.9787, attr_end_acc: 0.9862, span_micro_p: 0.9821, span_micro_r: 0.9803, span_micro_f1: 0.9812, micro_p: 0.9860, micro_r: 0.9677, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: 0.3669, span_acc: 0.9938, attr_start_acc: 0.9790, attr_end_acc: 0.9865, span_micro_p: 0.9829, span_micro_r: 0.9807, span_micro_f1: 0.9818, micro_p: 0.9865, micro_r: 0.9685, micro_f1: 0.9774
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: 0.3697, span_acc: 0.9940, attr_start_acc: 0.9792, attr_end_acc: 0.9868, span_micro_p: 0.9829, span_micro_r: 0.9812, span_micro_f1: 0.9821, micro_p: 0.9868, micro_r: 0.9689, micro_f1: 0.9778
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: 0.3896, span_acc: 0.9939, attr_start_acc: 0.9790, attr_end_acc: 0.9865, span_micro_p: 0.9831, span_micro_r: 0.9813, span_micro_f1: 0.9822, micro_p: 0.9866, micro_r: 0.9688, micro_f1: 0.9776
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: 0.4017, span_acc: 0.9941, attr_start_acc: 0.9794, attr_end_acc: 0.9866, span_micro_p: 0.9836, span_micro_r: 0.9818, span_micro_f1: 0.9827, micro_p: 0.9868, micro_r: 0.9694, micro_f1: 0.9780
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: 0.3856, span_acc: 0.9941, attr_start_acc: 0.9798, attr_end_acc: 0.9866, span_micro_p: 0.9834, span_micro_r: 0.9818, span_micro_f1: 0.9826, micro_p: 0.9865, micro_r: 0.9693, micro_f1: 0.9779
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: 0.4117, span_acc: 0.9940, attr_start_acc: 0.9798, attr_end_acc: 0.9865, span_micro_p: 0.9831, span_micro_r: 0.9813, span_micro_f1: 0.9822, micro_p: 0.9863, micro_r: 0.9692, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.4707, span_acc: 0.9934, attr_start_acc: 0.9795, attr_end_acc: 0.9861, span_micro_p: 0.9821, span_micro_r: 0.9805, span_micro_f1: 0.9813, micro_p: 0.9857, micro_r: 0.9685, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: 0.4710, span_acc: 0.9935, attr_start_acc: 0.9798, attr_end_acc: 0.9862, span_micro_p: 0.9821, span_micro_r: 0.9808, span_micro_f1: 0.9814, micro_p: 0.9854, micro_r: 0.9686, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.4739, span_acc: 0.9933, attr_start_acc: 0.9797, attr_end_acc: 0.9861, span_micro_p: 0.9815, span_micro_r: 0.9803, span_micro_f1: 0.9809, micro_p: 0.9851, micro_r: 0.9684, micro_f1: 0.9767
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: 0.4737, span_acc: 0.9934, attr_start_acc: 0.9795, attr_end_acc: 0.9861, span_micro_p: 0.9815, span_micro_r: 0.9804, span_micro_f1: 0.9809, micro_p: 0.9851, micro_r: 0.9683, micro_f1: 0.9766
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: 0.4615, span_acc: 0.9935, attr_start_acc: 0.9797, attr_end_acc: 0.9862, span_micro_p: 0.9818, span_micro_r: 0.9804, span_micro_f1: 0.9811, micro_p: 0.9855, micro_r: 0.9685, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.26 / 97.65 / 98.32), p: (93.14 / 96.27), r: (96.13000000000001 / 95.63000000000001), f1: (94.61 / 95.95)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.2708964817724784, 'span_acc': 0.9825911890099479, 'attr_start_acc': 0.9764784946236559, 'attr_end_acc': 0.9831989247311828, 'span_micro_p': 0.9313915857605178, 'span_micro_r': 0.9612558450233801, 'span_micro_f1': 0.9460880999342538, 'micro_p': 0.9627371273712737, 'micro_r': 0.9562584118438762, 'micro_f1': 0.9594868332207968, 'category-p/r/f1': {'PRO': (0.8095, 0.9444, 0.8718), 'ORG': (0.9517, 0.9463, 0.949), 'EDU': (0.9712, 0.9528, 0.9619), 'TITLE': (0.9677, 0.9565, 0.9621), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9594868332207968 / 0.9595687331536389
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.35000000000001 / 96.99 / 97.55), p: (92.84 / 96.16), r: (94.72 / 95.15), f1: (93.77 / 95.65)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.3956154524905127, 'span_acc': 0.9734611503531786, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.9284425736620565, 'span_micro_r': 0.947239263803681, 'span_micro_f1': 0.9377467354995445, 'micro_p': 0.9615623062616243, 'micro_r': 0.9515337423312883, 'micro_f1': 0.9565217391304347, 'category-p/r/f1': {'ORG': (0.9559, 0.9403, 0.948), 'TITLE': (0.9541, 0.943, 0.9485), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9565217391304347 / 0.9552238805970149
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.3501, span_acc: 0.9981, attr_start_acc: 0.9894, attr_end_acc: 0.9947, span_micro_p: 0.9947, span_micro_r: 0.9894, span_micro_f1: 0.9920, micro_p: 0.9947, micro_r: 0.9894, micro_f1: 0.9920
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: -0.2899, span_acc: 0.9937, attr_start_acc: 0.9870, attr_end_acc: 0.9870, span_micro_p: 0.9903, span_micro_r: 0.9871, span_micro_f1: 0.9887, micro_p: 0.9983, micro_r: 0.9805, micro_f1: 0.9893
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: -0.0299, span_acc: 0.9946, attr_start_acc: 0.9846, attr_end_acc: 0.9882, span_micro_p: 0.9882, span_micro_r: 0.9847, span_micro_f1: 0.9864, micro_p: 0.9945, micro_r: 0.9782, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: -0.1116, span_acc: 0.9955, attr_start_acc: 0.9866, attr_end_acc: 0.9906, span_micro_p: 0.9899, span_micro_r: 0.9860, span_micro_f1: 0.9880, micro_p: 0.9952, micro_r: 0.9812, micro_f1: 0.9882
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: 0.0239, span_acc: 0.9956, attr_start_acc: 0.9838, attr_end_acc: 0.9881, span_micro_p: 0.9877, span_micro_r: 0.9866, span_micro_f1: 0.9871, micro_p: 0.9907, micro_r: 0.9779, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: -0.0383, span_acc: 0.9959, attr_start_acc: 0.9842, attr_end_acc: 0.9878, span_micro_p: 0.9875, span_micro_r: 0.9870, span_micro_f1: 0.9872, micro_p: 0.9904, micro_r: 0.9770, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: 0.0376, span_acc: 0.9962, attr_start_acc: 0.9839, attr_end_acc: 0.9883, span_micro_p: 0.9884, span_micro_r: 0.9876, span_micro_f1: 0.9880, micro_p: 0.9918, micro_r: 0.9769, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: 0.0037, span_acc: 0.9960, attr_start_acc: 0.9827, attr_end_acc: 0.9880, span_micro_p: 0.9872, span_micro_r: 0.9865, span_micro_f1: 0.9868, micro_p: 0.9910, micro_r: 0.9751, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: -0.0383, span_acc: 0.9961, attr_start_acc: 0.9826, attr_end_acc: 0.9882, span_micro_p: 0.9866, span_micro_r: 0.9866, span_micro_f1: 0.9866, micro_p: 0.9908, micro_r: 0.9752, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: -0.0594, span_acc: 0.9962, attr_start_acc: 0.9836, attr_end_acc: 0.9887, span_micro_p: 0.9863, span_micro_r: 0.9866, span_micro_f1: 0.9864, micro_p: 0.9907, micro_r: 0.9763, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: 0.0070, span_acc: 0.9959, attr_start_acc: 0.9829, attr_end_acc: 0.9886, span_micro_p: 0.9851, span_micro_r: 0.9860, span_micro_f1: 0.9856, micro_p: 0.9897, micro_r: 0.9751, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: 0.0478, span_acc: 0.9956, attr_start_acc: 0.9819, attr_end_acc: 0.9881, span_micro_p: 0.9846, span_micro_r: 0.9844, span_micro_f1: 0.9845, micro_p: 0.9890, micro_r: 0.9740, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: 0.0676, span_acc: 0.9956, attr_start_acc: 0.9825, attr_end_acc: 0.9877, span_micro_p: 0.9843, span_micro_r: 0.9845, span_micro_f1: 0.9844, micro_p: 0.9888, micro_r: 0.9741, micro_f1: 0.9814
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: 0.0965, span_acc: 0.9958, attr_start_acc: 0.9835, attr_end_acc: 0.9884, span_micro_p: 0.9848, span_micro_r: 0.9848, span_micro_f1: 0.9848, micro_p: 0.9894, micro_r: 0.9755, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: 0.0841, span_acc: 0.9954, attr_start_acc: 0.9831, attr_end_acc: 0.9881, span_micro_p: 0.9844, span_micro_r: 0.9843, span_micro_f1: 0.9844, micro_p: 0.9892, micro_r: 0.9751, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: 0.1179, span_acc: 0.9952, attr_start_acc: 0.9832, attr_end_acc: 0.9882, span_micro_p: 0.9848, span_micro_r: 0.9847, span_micro_f1: 0.9847, micro_p: 0.9888, micro_r: 0.9751, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: 0.1085, span_acc: 0.9953, attr_start_acc: 0.9835, attr_end_acc: 0.9886, span_micro_p: 0.9853, span_micro_r: 0.9851, span_micro_f1: 0.9852, micro_p: 0.9892, micro_r: 0.9757, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.3329, span_acc: 0.9952, attr_start_acc: 0.9840, attr_end_acc: 0.9881, span_micro_p: 0.9851, span_micro_r: 0.9852, span_micro_f1: 0.9851, micro_p: 0.9895, micro_r: 0.9756, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.3277, span_acc: 0.9952, attr_start_acc: 0.9842, attr_end_acc: 0.9886, span_micro_p: 0.9851, span_micro_r: 0.9855, span_micro_f1: 0.9853, micro_p: 0.9896, micro_r: 0.9759, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.2821, span_acc: 0.9953, attr_start_acc: 0.9846, attr_end_acc: 0.9888, span_micro_p: 0.9857, span_micro_r: 0.9859, span_micro_f1: 0.9858, micro_p: 0.9897, micro_r: 0.9762, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.2648, span_acc: 0.9955, attr_start_acc: 0.9846, attr_end_acc: 0.9890, span_micro_p: 0.9861, span_micro_r: 0.9864, span_micro_f1: 0.9863, micro_p: 0.9900, micro_r: 0.9764, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1810, loss: 0.2651, span_acc: 0.9956, attr_start_acc: 0.9846, attr_end_acc: 0.9889, span_micro_p: 0.9865, span_micro_r: 0.9866, span_micro_f1: 0.9866, micro_p: 0.9898, micro_r: 0.9763, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1820, loss: 0.2367, span_acc: 0.9957, attr_start_acc: 0.9852, attr_end_acc: 0.9892, span_micro_p: 0.9868, span_micro_r: 0.9869, span_micro_f1: 0.9869, micro_p: 0.9901, micro_r: 0.9770, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1830, loss: 0.2883, span_acc: 0.9957, attr_start_acc: 0.9848, attr_end_acc: 0.9886, span_micro_p: 0.9870, span_micro_r: 0.9868, span_micro_f1: 0.9869, micro_p: 0.9901, micro_r: 0.9763, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1840, loss: 0.3326, span_acc: 0.9957, attr_start_acc: 0.9840, attr_end_acc: 0.9884, span_micro_p: 0.9866, span_micro_r: 0.9863, span_micro_f1: 0.9864, micro_p: 0.9897, micro_r: 0.9753, micro_f1: 0.9824
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1850, loss: 0.3038, span_acc: 0.9957, attr_start_acc: 0.9839, attr_end_acc: 0.9884, span_micro_p: 0.9869, span_micro_r: 0.9863, span_micro_f1: 0.9866, micro_p: 0.9899, micro_r: 0.9752, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1860, loss: 0.2716, span_acc: 0.9958, attr_start_acc: 0.9839, attr_end_acc: 0.9886, span_micro_p: 0.9871, span_micro_r: 0.9866, span_micro_f1: 0.9869, micro_p: 0.9899, micro_r: 0.9754, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1870, loss: 0.3115, span_acc: 0.9958, attr_start_acc: 0.9840, attr_end_acc: 0.9889, span_micro_p: 0.9871, span_micro_r: 0.9866, span_micro_f1: 0.9868, micro_p: 0.9897, micro_r: 0.9755, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1880, loss: 0.3161, span_acc: 0.9958, attr_start_acc: 0.9839, attr_end_acc: 0.9886, span_micro_p: 0.9869, span_micro_r: 0.9863, span_micro_f1: 0.9866, micro_p: 0.9896, micro_r: 0.9751, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1890, loss: 0.3204, span_acc: 0.9957, attr_start_acc: 0.9836, attr_end_acc: 0.9884, span_micro_p: 0.9867, span_micro_r: 0.9862, span_micro_f1: 0.9864, micro_p: 0.9893, micro_r: 0.9748, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1900, loss: 0.3102, span_acc: 0.9958, attr_start_acc: 0.9837, attr_end_acc: 0.9885, span_micro_p: 0.9869, span_micro_r: 0.9861, span_micro_f1: 0.9865, micro_p: 0.9895, micro_r: 0.9750, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1910, loss: 0.3446, span_acc: 0.9958, attr_start_acc: 0.9835, attr_end_acc: 0.9884, span_micro_p: 0.9866, span_micro_r: 0.9861, span_micro_f1: 0.9864, micro_p: 0.9891, micro_r: 0.9746, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.61 / 97.38 / 97.31), p: (95.53 / 96.97), r: (95.59 / 94.67999999999999), f1: (95.56 / 95.81)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 4.666333891145611, 'span_acc': 0.9861440075793463, 'attr_start_acc': 0.9737903225806451, 'attr_end_acc': 0.9731182795698925, 'span_micro_p': 0.9552736982643525, 'span_micro_r': 0.9559118236472945, 'span_micro_f1': 0.9555926544240401, 'micro_p': 0.9696760854583046, 'micro_r': 0.9468371467025573, 'micro_f1': 0.9581205311542391, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9564, 0.9271, 0.9415), 'TITLE': (0.9733, 0.9493, 0.9612), 'EDU': (0.9903, 0.9623, 0.9761), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9581205311542391 / 0.9595687331536389
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.11999999999999 / 96.75 / 97.18), p: (95.56 / 96.8), r: (95.15 / 94.6), f1: (95.36 / 95.69)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 3.768141418133142, 'span_acc': 0.9812310797174572, 'attr_start_acc': 0.9674846625766871, 'attr_end_acc': 0.9717791411042945, 'span_micro_p': 0.955637707948244, 'span_micro_r': 0.9515337423312883, 'span_micro_f1': 0.9535813095604058, 'micro_p': 0.967984934086629, 'micro_r': 0.9460122699386503, 'micro_f1': 0.9568724790567794, 'category-p/r/f1': {'ORG': (0.9626, 0.9313, 0.9467), 'TITLE': (0.9629, 0.9404, 0.9515), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9568724790567794 / 0.9565217391304347
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1920, loss: 0.5711, span_acc: 0.9941, attr_start_acc: 0.9688, attr_end_acc: 0.9805, span_micro_p: 0.9882, span_micro_r: 0.9729, span_micro_f1: 0.9805, micro_p: 0.9879, micro_r: 0.9570, micro_f1: 0.9722
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1930, loss: 0.2203, span_acc: 0.9963, attr_start_acc: 0.9735, attr_end_acc: 0.9882, span_micro_p: 0.9897, span_micro_r: 0.9839, span_micro_f1: 0.9868, micro_p: 0.9909, micro_r: 0.9647, micro_f1: 0.9776
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1940, loss: -0.1218, span_acc: 0.9975, attr_start_acc: 0.9801, attr_end_acc: 0.9913, span_micro_p: 0.9922, span_micro_r: 0.9896, span_micro_f1: 0.9909, micro_p: 0.9920, micro_r: 0.9740, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1950, loss: -0.0913, span_acc: 0.9978, attr_start_acc: 0.9832, attr_end_acc: 0.9910, span_micro_p: 0.9942, span_micro_r: 0.9917, span_micro_f1: 0.9929, micro_p: 0.9934, micro_r: 0.9774, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1960, loss: -0.1193, span_acc: 0.9976, attr_start_acc: 0.9837, attr_end_acc: 0.9911, span_micro_p: 0.9926, span_micro_r: 0.9916, span_micro_f1: 0.9921, micro_p: 0.9935, micro_r: 0.9782, micro_f1: 0.9858
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1970, loss: -0.1351, span_acc: 0.9978, attr_start_acc: 0.9845, attr_end_acc: 0.9918, span_micro_p: 0.9931, span_micro_r: 0.9923, span_micro_f1: 0.9927, micro_p: 0.9942, micro_r: 0.9792, micro_f1: 0.9866
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1980, loss: 0.1248, span_acc: 0.9978, attr_start_acc: 0.9841, attr_end_acc: 0.9917, span_micro_p: 0.9928, span_micro_r: 0.9925, span_micro_f1: 0.9926, micro_p: 0.9940, micro_r: 0.9782, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 1990, loss: 0.4093, span_acc: 0.9975, attr_start_acc: 0.9828, attr_end_acc: 0.9919, span_micro_p: 0.9916, span_micro_r: 0.9916, span_micro_f1: 0.9916, micro_p: 0.9923, micro_r: 0.9771, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2000, loss: 0.6029, span_acc: 0.9971, attr_start_acc: 0.9825, attr_end_acc: 0.9911, span_micro_p: 0.9904, span_micro_r: 0.9912, span_micro_f1: 0.9908, micro_p: 0.9910, micro_r: 0.9755, micro_f1: 0.9832
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2010, loss: 0.6966, span_acc: 0.9971, attr_start_acc: 0.9824, attr_end_acc: 0.9909, span_micro_p: 0.9912, span_micro_r: 0.9917, span_micro_f1: 0.9915, micro_p: 0.9918, micro_r: 0.9755, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2020, loss: 0.8350, span_acc: 0.9972, attr_start_acc: 0.9826, attr_end_acc: 0.9906, span_micro_p: 0.9916, span_micro_r: 0.9918, span_micro_f1: 0.9917, micro_p: 0.9921, micro_r: 0.9759, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2030, loss: 0.7922, span_acc: 0.9971, attr_start_acc: 0.9822, attr_end_acc: 0.9906, span_micro_p: 0.9914, span_micro_r: 0.9912, span_micro_f1: 0.9913, micro_p: 0.9925, micro_r: 0.9756, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2040, loss: 0.7656, span_acc: 0.9971, attr_start_acc: 0.9821, attr_end_acc: 0.9907, span_micro_p: 0.9913, span_micro_r: 0.9911, span_micro_f1: 0.9912, micro_p: 0.9921, micro_r: 0.9754, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2050, loss: 0.7158, span_acc: 0.9973, attr_start_acc: 0.9829, attr_end_acc: 0.9907, span_micro_p: 0.9919, span_micro_r: 0.9917, span_micro_f1: 0.9918, micro_p: 0.9922, micro_r: 0.9765, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2060, loss: 0.7046, span_acc: 0.9975, attr_start_acc: 0.9827, attr_end_acc: 0.9913, span_micro_p: 0.9925, span_micro_r: 0.9923, span_micro_f1: 0.9924, micro_p: 0.9928, micro_r: 0.9766, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2070, loss: 0.6951, span_acc: 0.9974, attr_start_acc: 0.9810, attr_end_acc: 0.9912, span_micro_p: 0.9922, span_micro_r: 0.9917, span_micro_f1: 0.9919, micro_p: 0.9924, micro_r: 0.9748, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2080, loss: 0.7033, span_acc: 0.9972, attr_start_acc: 0.9793, attr_end_acc: 0.9907, span_micro_p: 0.9914, span_micro_r: 0.9905, span_micro_f1: 0.9909, micro_p: 0.9917, micro_r: 0.9731, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2090, loss: 0.8062, span_acc: 0.9973, attr_start_acc: 0.9791, attr_end_acc: 0.9907, span_micro_p: 0.9918, span_micro_r: 0.9907, span_micro_f1: 0.9912, micro_p: 0.9918, micro_r: 0.9729, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2100, loss: 0.7771, span_acc: 0.9971, attr_start_acc: 0.9790, attr_end_acc: 0.9910, span_micro_p: 0.9910, span_micro_r: 0.9899, span_micro_f1: 0.9905, micro_p: 0.9915, micro_r: 0.9730, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2110, loss: 0.8884, span_acc: 0.9971, attr_start_acc: 0.9797, attr_end_acc: 0.9912, span_micro_p: 0.9913, span_micro_r: 0.9902, span_micro_f1: 0.9907, micro_p: 0.9917, micro_r: 0.9739, micro_f1: 0.9827
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2120, loss: 0.8875, span_acc: 0.9970, attr_start_acc: 0.9799, attr_end_acc: 0.9912, span_micro_p: 0.9915, span_micro_r: 0.9903, span_micro_f1: 0.9909, micro_p: 0.9918, micro_r: 0.9742, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2130, loss: 0.8211, span_acc: 0.9971, attr_start_acc: 0.9803, attr_end_acc: 0.9915, span_micro_p: 0.9918, span_micro_r: 0.9906, span_micro_f1: 0.9912, micro_p: 0.9921, micro_r: 0.9748, micro_f1: 0.9834
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2140, loss: 0.7750, span_acc: 0.9971, attr_start_acc: 0.9806, attr_end_acc: 0.9914, span_micro_p: 0.9917, span_micro_r: 0.9905, span_micro_f1: 0.9911, micro_p: 0.9918, micro_r: 0.9749, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2150, loss: 0.8646, span_acc: 0.9970, attr_start_acc: 0.9806, attr_end_acc: 0.9904, span_micro_p: 0.9910, span_micro_r: 0.9903, span_micro_f1: 0.9907, micro_p: 0.9913, micro_r: 0.9740, micro_f1: 0.9826
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2160, loss: 0.8120, span_acc: 0.9971, attr_start_acc: 0.9804, attr_end_acc: 0.9902, span_micro_p: 0.9912, span_micro_r: 0.9902, span_micro_f1: 0.9907, micro_p: 0.9913, micro_r: 0.9740, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2170, loss: 0.8284, span_acc: 0.9971, attr_start_acc: 0.9808, attr_end_acc: 0.9891, span_micro_p: 0.9913, span_micro_r: 0.9904, span_micro_f1: 0.9909, micro_p: 0.9914, micro_r: 0.9733, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2180, loss: 0.9445, span_acc: 0.9970, attr_start_acc: 0.9801, attr_end_acc: 0.9891, span_micro_p: 0.9908, span_micro_r: 0.9900, span_micro_f1: 0.9904, micro_p: 0.9911, micro_r: 0.9727, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2190, loss: 0.9544, span_acc: 0.9970, attr_start_acc: 0.9805, attr_end_acc: 0.9891, span_micro_p: 0.9909, span_micro_r: 0.9901, span_micro_f1: 0.9905, micro_p: 0.9912, micro_r: 0.9731, micro_f1: 0.9821
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2200, loss: 0.9621, span_acc: 0.9971, attr_start_acc: 0.9811, attr_end_acc: 0.9893, span_micro_p: 0.9910, span_micro_r: 0.9902, span_micro_f1: 0.9906, micro_p: 0.9915, micro_r: 0.9738, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2210, loss: 1.0271, span_acc: 0.9971, attr_start_acc: 0.9814, attr_end_acc: 0.9897, span_micro_p: 0.9910, span_micro_r: 0.9903, span_micro_f1: 0.9907, micro_p: 0.9916, micro_r: 0.9744, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2220, loss: 1.0042, span_acc: 0.9972, attr_start_acc: 0.9816, attr_end_acc: 0.9896, span_micro_p: 0.9911, span_micro_r: 0.9903, span_micro_f1: 0.9907, micro_p: 0.9914, micro_r: 0.9746, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 6, steps: 2230, loss: 1.0523, span_acc: 0.9970, attr_start_acc: 0.9818, attr_end_acc: 0.9896, span_micro_p: 0.9907, span_micro_r: 0.9902, span_micro_f1: 0.9904, micro_p: 0.9914, micro_r: 0.9748, micro_f1: 0.9830
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.74000000000001 / 97.18 / 98.11999999999999), p: (95.56 / 96.27), r: (96.39 / 95.49), f1: (95.98 / 95.88)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 8.026790807880541, 'span_acc': 0.987446707721459, 'attr_start_acc': 0.9717741935483871, 'attr_end_acc': 0.9811827956989247, 'span_micro_p': 0.9556291390728476, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.959760558696375, 'micro_p': 0.9626865671641791, 'micro_r': 0.9549125168236877, 'micro_f1': 0.9587837837837837, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9482, 0.9482, 0.9482), 'EDU': (0.9528, 0.9528, 0.9528), 'TITLE': (0.9719, 0.9507, 0.9612), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9587837837837837 / 0.9595687331536389
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 6 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.92 / 96.75 / 97.61), p: (95.47 / 96.1), r: (95.64 / 95.21), f1: (95.56 / 95.65)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 7.460619246434866, 'span_acc': 0.979212916246216, 'attr_start_acc': 0.9674846625766871, 'attr_end_acc': 0.9760736196319019, 'span_micro_p': 0.9546846295162278, 'span_micro_r': 0.9564417177914111, 'span_micro_f1': 0.9555623659209316, 'micro_p': 0.9609907120743034, 'micro_r': 0.9521472392638037, 'micro_f1': 0.9565485362095532, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9437, 0.9403, 0.942), 'TITLE': (0.9631, 0.9456, 0.9543), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9565485362095532 / 0.9568724790567794
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2240, loss: -1.0044, span_acc: 1.0000, attr_start_acc: 0.9964, attr_end_acc: 0.9964, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9928, micro_f1: 0.9964
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2250, loss: 0.1472, span_acc: 0.9990, attr_start_acc: 0.9971, attr_end_acc: 0.9957, span_micro_p: 0.9971, span_micro_r: 0.9943, span_micro_f1: 0.9957, micro_p: 0.9986, micro_r: 0.9928, micro_f1: 0.9957
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2260, loss: 0.7034, span_acc: 0.9979, attr_start_acc: 0.9939, attr_end_acc: 0.9956, span_micro_p: 0.9913, span_micro_r: 0.9922, span_micro_f1: 0.9918, micro_p: 0.9947, micro_r: 0.9895, micro_f1: 0.9921
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2270, loss: 0.6238, span_acc: 0.9980, attr_start_acc: 0.9916, attr_end_acc: 0.9936, span_micro_p: 0.9924, span_micro_r: 0.9917, span_micro_f1: 0.9920, micro_p: 0.9942, micro_r: 0.9878, micro_f1: 0.9910
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2280, loss: 0.3487, span_acc: 0.9984, attr_start_acc: 0.9917, attr_end_acc: 0.9943, span_micro_p: 0.9938, span_micro_r: 0.9933, span_micro_f1: 0.9936, micro_p: 0.9948, micro_r: 0.9886, micro_f1: 0.9916
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2290, loss: 0.3604, span_acc: 0.9984, attr_start_acc: 0.9906, attr_end_acc: 0.9932, span_micro_p: 0.9933, span_micro_r: 0.9928, span_micro_f1: 0.9930, micro_p: 0.9932, micro_r: 0.9877, micro_f1: 0.9904
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2300, loss: 0.6480, span_acc: 0.9984, attr_start_acc: 0.9909, attr_end_acc: 0.9924, span_micro_p: 0.9935, span_micro_r: 0.9928, span_micro_f1: 0.9932, micro_p: 0.9927, micro_r: 0.9865, micro_f1: 0.9896
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2310, loss: 1.1971, span_acc: 0.9978, attr_start_acc: 0.9892, attr_end_acc: 0.9918, span_micro_p: 0.9921, span_micro_r: 0.9918, span_micro_f1: 0.9920, micro_p: 0.9904, micro_r: 0.9844, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2320, loss: 1.2762, span_acc: 0.9980, attr_start_acc: 0.9889, attr_end_acc: 0.9917, span_micro_p: 0.9927, span_micro_r: 0.9924, span_micro_f1: 0.9925, micro_p: 0.9905, micro_r: 0.9843, micro_f1: 0.9874
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2330, loss: 1.2408, span_acc: 0.9981, attr_start_acc: 0.9888, attr_end_acc: 0.9914, span_micro_p: 0.9932, span_micro_r: 0.9929, span_micro_f1: 0.9931, micro_p: 0.9908, micro_r: 0.9832, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2340, loss: 1.0251, span_acc: 0.9983, attr_start_acc: 0.9885, attr_end_acc: 0.9911, span_micro_p: 0.9939, span_micro_r: 0.9936, span_micro_f1: 0.9938, micro_p: 0.9912, micro_r: 0.9828, micro_f1: 0.9870
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2350, loss: 0.9741, span_acc: 0.9984, attr_start_acc: 0.9888, attr_end_acc: 0.9914, span_micro_p: 0.9944, span_micro_r: 0.9942, span_micro_f1: 0.9943, micro_p: 0.9917, micro_r: 0.9827, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2360, loss: 0.9430, span_acc: 0.9985, attr_start_acc: 0.9887, attr_end_acc: 0.9916, span_micro_p: 0.9948, span_micro_r: 0.9946, span_micro_f1: 0.9947, micro_p: 0.9919, micro_r: 0.9826, micro_f1: 0.9872
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2370, loss: 1.7112, span_acc: 0.9984, attr_start_acc: 0.9876, attr_end_acc: 0.9921, span_micro_p: 0.9950, span_micro_r: 0.9946, span_micro_f1: 0.9948, micro_p: 0.9922, micro_r: 0.9814, micro_f1: 0.9868
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2380, loss: 1.8969, span_acc: 0.9980, attr_start_acc: 0.9854, attr_end_acc: 0.9913, span_micro_p: 0.9938, span_micro_r: 0.9929, span_micro_f1: 0.9934, micro_p: 0.9915, micro_r: 0.9782, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2390, loss: 1.8113, span_acc: 0.9980, attr_start_acc: 0.9847, attr_end_acc: 0.9900, span_micro_p: 0.9939, span_micro_r: 0.9927, span_micro_f1: 0.9933, micro_p: 0.9916, micro_r: 0.9769, micro_f1: 0.9842
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2400, loss: 1.9799, span_acc: 0.9980, attr_start_acc: 0.9851, attr_end_acc: 0.9900, span_micro_p: 0.9939, span_micro_r: 0.9927, span_micro_f1: 0.9933, micro_p: 0.9918, micro_r: 0.9771, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2410, loss: 1.9347, span_acc: 0.9979, attr_start_acc: 0.9845, attr_end_acc: 0.9897, span_micro_p: 0.9937, span_micro_r: 0.9919, span_micro_f1: 0.9928, micro_p: 0.9919, micro_r: 0.9768, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2420, loss: 1.7973, span_acc: 0.9979, attr_start_acc: 0.9852, attr_end_acc: 0.9901, span_micro_p: 0.9937, span_micro_r: 0.9921, span_micro_f1: 0.9929, micro_p: 0.9919, micro_r: 0.9772, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2430, loss: 1.6863, span_acc: 0.9980, attr_start_acc: 0.9853, attr_end_acc: 0.9900, span_micro_p: 0.9937, span_micro_r: 0.9924, span_micro_f1: 0.9931, micro_p: 0.9922, micro_r: 0.9773, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2440, loss: 1.6152, span_acc: 0.9980, attr_start_acc: 0.9858, attr_end_acc: 0.9899, span_micro_p: 0.9936, span_micro_r: 0.9922, span_micro_f1: 0.9929, micro_p: 0.9923, micro_r: 0.9773, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2450, loss: 1.6015, span_acc: 0.9979, attr_start_acc: 0.9857, attr_end_acc: 0.9896, span_micro_p: 0.9932, span_micro_r: 0.9920, span_micro_f1: 0.9926, micro_p: 0.9921, micro_r: 0.9771, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2460, loss: 1.7216, span_acc: 0.9980, attr_start_acc: 0.9858, attr_end_acc: 0.9891, span_micro_p: 0.9932, span_micro_r: 0.9921, span_micro_f1: 0.9927, micro_p: 0.9921, micro_r: 0.9766, micro_f1: 0.9843
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2470, loss: 1.6471, span_acc: 0.9980, attr_start_acc: 0.9864, attr_end_acc: 0.9896, span_micro_p: 0.9935, span_micro_r: 0.9924, span_micro_f1: 0.9930, micro_p: 0.9924, micro_r: 0.9775, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2480, loss: 1.6355, span_acc: 0.9981, attr_start_acc: 0.9863, attr_end_acc: 0.9896, span_micro_p: 0.9937, span_micro_r: 0.9925, span_micro_f1: 0.9931, micro_p: 0.9925, micro_r: 0.9775, micro_f1: 0.9849
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2490, loss: 1.6252, span_acc: 0.9981, attr_start_acc: 0.9865, attr_end_acc: 0.9898, span_micro_p: 0.9936, span_micro_r: 0.9924, span_micro_f1: 0.9930, micro_p: 0.9926, micro_r: 0.9779, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2500, loss: 1.6583, span_acc: 0.9980, attr_start_acc: 0.9863, attr_end_acc: 0.9894, span_micro_p: 0.9932, span_micro_r: 0.9924, span_micro_f1: 0.9928, micro_p: 0.9923, micro_r: 0.9772, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2510, loss: 1.5888, span_acc: 0.9980, attr_start_acc: 0.9862, attr_end_acc: 0.9892, span_micro_p: 0.9934, span_micro_r: 0.9925, span_micro_f1: 0.9930, micro_p: 0.9923, micro_r: 0.9772, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2520, loss: 1.5931, span_acc: 0.9979, attr_start_acc: 0.9854, attr_end_acc: 0.9887, span_micro_p: 0.9932, span_micro_r: 0.9922, span_micro_f1: 0.9927, micro_p: 0.9919, micro_r: 0.9763, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2530, loss: 1.5765, span_acc: 0.9978, attr_start_acc: 0.9853, attr_end_acc: 0.9885, span_micro_p: 0.9928, span_micro_r: 0.9922, span_micro_f1: 0.9925, micro_p: 0.9919, micro_r: 0.9761, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2540, loss: 1.5291, span_acc: 0.9979, attr_start_acc: 0.9856, attr_end_acc: 0.9884, span_micro_p: 0.9929, span_micro_r: 0.9923, span_micro_f1: 0.9926, micro_p: 0.9918, micro_r: 0.9761, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 7, steps: 2550, loss: 1.4657, span_acc: 0.9979, attr_start_acc: 0.9851, attr_end_acc: 0.9884, span_micro_p: 0.9931, span_micro_r: 0.9925, span_micro_f1: 0.9928, micro_p: 0.9919, micro_r: 0.9758, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.54 / 97.18 / 97.85000000000001), p: (95.56 / 95.61), r: (96.39 / 95.15), f1: (95.98 / 95.38)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 19.236766164812618, 'span_acc': 0.9854334438654666, 'attr_start_acc': 0.9717741935483871, 'attr_end_acc': 0.978494623655914, 'span_micro_p': 0.9556291390728476, 'span_micro_r': 0.9639278557114228, 'span_micro_f1': 0.959760558696375, 'micro_p': 0.9560513860716701, 'micro_r': 0.9515477792732167, 'micro_f1': 0.9537942664418213, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9403, 0.9367, 0.9385), 'TITLE': (0.9634, 0.9536, 0.9585), 'EDU': (0.9804, 0.9434, 0.9615), 'RACE': (0.9333, 1.0, 0.9655), 'NAME': (0.9714, 1.0, 0.9855), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9537942664418213 / 0.9595687331536389
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 7 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.96000000000001 / 96.26 / 97.55), p: (95.94 / 96.31), r: (95.77 / 94.6), f1: (95.86 / 95.45)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 11.640512653866654, 'span_acc': 0.9796165489404641, 'attr_start_acc': 0.9625766871165644, 'attr_end_acc': 0.9754601226993865, 'span_micro_p': 0.9594345421020283, 'span_micro_r': 0.9576687116564417, 'span_micro_f1': 0.9585508136321769, 'micro_p': 0.9631480324797002, 'micro_r': 0.9460122699386503, 'micro_f1': 0.9545032497678737, 'category-p/r/f1': {'LOC': (0.8571, 1.0, 0.9231), 'ORG': (0.9556, 0.9349, 0.9451), 'TITLE': (0.9617, 0.943, 0.9523), 'PRO': (0.9167, 1.0, 0.9565), 'EDU': (0.9905, 0.9286, 0.9586), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9545032497678737 / 0.9568724790567794
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2560, loss: 1.1560, span_acc: 1.0000, attr_start_acc: 0.9817, attr_end_acc: 0.9969, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 0.9938, micro_r: 0.9786, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2570, loss: 0.6283, span_acc: 0.9993, attr_start_acc: 0.9805, attr_end_acc: 0.9889, span_micro_p: 0.9986, span_micro_r: 0.9972, span_micro_f1: 0.9979, micro_p: 0.9901, micro_r: 0.9721, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2580, loss: 1.0067, span_acc: 0.9987, attr_start_acc: 0.9778, attr_end_acc: 0.9876, span_micro_p: 0.9956, span_micro_r: 0.9947, span_micro_f1: 0.9952, micro_p: 0.9900, micro_r: 0.9698, micro_f1: 0.9798
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2590, loss: 0.6788, span_acc: 0.9985, attr_start_acc: 0.9779, attr_end_acc: 0.9836, span_micro_p: 0.9950, span_micro_r: 0.9931, span_micro_f1: 0.9940, micro_p: 0.9909, micro_r: 0.9677, micro_f1: 0.9792
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2600, loss: 2.2244, span_acc: 0.9981, attr_start_acc: 0.9793, attr_end_acc: 0.9844, span_micro_p: 0.9950, span_micro_r: 0.9935, span_micro_f1: 0.9942, micro_p: 0.9923, micro_r: 0.9697, micro_f1: 0.9809
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2610, loss: 2.6456, span_acc: 0.9980, attr_start_acc: 0.9786, attr_end_acc: 0.9849, span_micro_p: 0.9938, span_micro_r: 0.9929, span_micro_f1: 0.9933, micro_p: 0.9910, micro_r: 0.9698, micro_f1: 0.9803
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2620, loss: 2.2584, span_acc: 0.9978, attr_start_acc: 0.9802, attr_end_acc: 0.9834, span_micro_p: 0.9930, span_micro_r: 0.9923, span_micro_f1: 0.9926, micro_p: 0.9910, micro_r: 0.9696, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2630, loss: 2.6474, span_acc: 0.9977, attr_start_acc: 0.9816, attr_end_acc: 0.9838, span_micro_p: 0.9936, span_micro_r: 0.9924, span_micro_f1: 0.9930, micro_p: 0.9916, micro_r: 0.9709, micro_f1: 0.9811
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2640, loss: 2.3531, span_acc: 0.9976, attr_start_acc: 0.9818, attr_end_acc: 0.9834, span_micro_p: 0.9928, span_micro_r: 0.9923, span_micro_f1: 0.9926, micro_p: 0.9915, micro_r: 0.9706, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2650, loss: 2.0102, span_acc: 0.9978, attr_start_acc: 0.9827, attr_end_acc: 0.9851, span_micro_p: 0.9931, span_micro_r: 0.9928, span_micro_f1: 0.9930, micro_p: 0.9919, micro_r: 0.9726, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2660, loss: 1.9910, span_acc: 0.9980, attr_start_acc: 0.9834, attr_end_acc: 0.9858, span_micro_p: 0.9935, span_micro_r: 0.9935, span_micro_f1: 0.9935, micro_p: 0.9917, micro_r: 0.9735, micro_f1: 0.9825
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2670, loss: 1.8866, span_acc: 0.9979, attr_start_acc: 0.9824, attr_end_acc: 0.9862, span_micro_p: 0.9933, span_micro_r: 0.9935, span_micro_f1: 0.9934, micro_p: 0.9913, micro_r: 0.9728, micro_f1: 0.9820
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2680, loss: 2.0781, span_acc: 0.9981, attr_start_acc: 0.9813, attr_end_acc: 0.9867, span_micro_p: 0.9937, span_micro_r: 0.9939, span_micro_f1: 0.9938, micro_p: 0.9916, micro_r: 0.9723, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2690, loss: 2.1394, span_acc: 0.9982, attr_start_acc: 0.9822, attr_end_acc: 0.9876, span_micro_p: 0.9942, span_micro_r: 0.9944, span_micro_f1: 0.9943, micro_p: 0.9923, micro_r: 0.9738, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2700, loss: 2.1187, span_acc: 0.9982, attr_start_acc: 0.9826, attr_end_acc: 0.9876, span_micro_p: 0.9939, span_micro_r: 0.9944, span_micro_f1: 0.9941, micro_p: 0.9923, micro_r: 0.9742, micro_f1: 0.9831
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2710, loss: 1.9568, span_acc: 0.9983, attr_start_acc: 0.9830, attr_end_acc: 0.9881, span_micro_p: 0.9943, span_micro_r: 0.9948, span_micro_f1: 0.9946, micro_p: 0.9927, micro_r: 0.9751, micro_f1: 0.9838
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2720, loss: 2.0317, span_acc: 0.9982, attr_start_acc: 0.9818, attr_end_acc: 0.9874, span_micro_p: 0.9940, span_micro_r: 0.9941, span_micro_f1: 0.9940, micro_p: 0.9925, micro_r: 0.9734, micro_f1: 0.9829
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2730, loss: 1.9135, span_acc: 0.9983, attr_start_acc: 0.9824, attr_end_acc: 0.9879, span_micro_p: 0.9943, span_micro_r: 0.9944, span_micro_f1: 0.9944, micro_p: 0.9929, micro_r: 0.9744, micro_f1: 0.9836
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2740, loss: 1.8566, span_acc: 0.9983, attr_start_acc: 0.9830, attr_end_acc: 0.9880, span_micro_p: 0.9939, span_micro_r: 0.9944, span_micro_f1: 0.9941, micro_p: 0.9931, micro_r: 0.9749, micro_f1: 0.9839
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2750, loss: 1.6745, span_acc: 0.9983, attr_start_acc: 0.9834, attr_end_acc: 0.9884, span_micro_p: 0.9942, span_micro_r: 0.9945, span_micro_f1: 0.9943, micro_p: 0.9933, micro_r: 0.9756, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2760, loss: 2.0928, span_acc: 0.9984, attr_start_acc: 0.9839, attr_end_acc: 0.9885, span_micro_p: 0.9941, span_micro_r: 0.9945, span_micro_f1: 0.9943, micro_p: 0.9930, micro_r: 0.9760, micro_f1: 0.9845
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2770, loss: 2.7876, span_acc: 0.9984, attr_start_acc: 0.9838, attr_end_acc: 0.9889, span_micro_p: 0.9940, span_micro_r: 0.9945, span_micro_f1: 0.9942, micro_p: 0.9931, micro_r: 0.9764, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2780, loss: 2.9906, span_acc: 0.9984, attr_start_acc: 0.9841, attr_end_acc: 0.9889, span_micro_p: 0.9940, span_micro_r: 0.9945, span_micro_f1: 0.9942, micro_p: 0.9929, micro_r: 0.9766, micro_f1: 0.9847
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2790, loss: 3.0010, span_acc: 0.9984, attr_start_acc: 0.9846, attr_end_acc: 0.9892, span_micro_p: 0.9941, span_micro_r: 0.9946, span_micro_f1: 0.9943, micro_p: 0.9930, micro_r: 0.9772, micro_f1: 0.9851
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2800, loss: 2.9174, span_acc: 0.9984, attr_start_acc: 0.9847, attr_end_acc: 0.9892, span_micro_p: 0.9943, span_micro_r: 0.9948, span_micro_f1: 0.9945, micro_p: 0.9932, micro_r: 0.9774, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2810, loss: 2.9852, span_acc: 0.9985, attr_start_acc: 0.9851, attr_end_acc: 0.9894, span_micro_p: 0.9943, span_micro_r: 0.9949, span_micro_f1: 0.9946, micro_p: 0.9934, micro_r: 0.9780, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2820, loss: 2.9412, span_acc: 0.9985, attr_start_acc: 0.9855, attr_end_acc: 0.9895, span_micro_p: 0.9946, span_micro_r: 0.9951, span_micro_f1: 0.9948, micro_p: 0.9934, micro_r: 0.9785, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2830, loss: 2.9886, span_acc: 0.9986, attr_start_acc: 0.9854, attr_end_acc: 0.9895, span_micro_p: 0.9946, span_micro_r: 0.9952, span_micro_f1: 0.9949, micro_p: 0.9934, micro_r: 0.9785, micro_f1: 0.9859
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2840, loss: 3.2135, span_acc: 0.9984, attr_start_acc: 0.9852, attr_end_acc: 0.9894, span_micro_p: 0.9941, span_micro_r: 0.9947, span_micro_f1: 0.9944, micro_p: 0.9932, micro_r: 0.9780, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2850, loss: 3.2232, span_acc: 0.9984, attr_start_acc: 0.9854, attr_end_acc: 0.9895, span_micro_p: 0.9939, span_micro_r: 0.9947, span_micro_f1: 0.9943, micro_p: 0.9932, micro_r: 0.9782, micro_f1: 0.9857
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2860, loss: 3.1289, span_acc: 0.9983, attr_start_acc: 0.9851, attr_end_acc: 0.9892, span_micro_p: 0.9938, span_micro_r: 0.9944, span_micro_f1: 0.9941, micro_p: 0.9931, micro_r: 0.9779, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 8, steps: 2870, loss: 3.0779, span_acc: 0.9984, attr_start_acc: 0.9853, attr_end_acc: 0.9891, span_micro_p: 0.9940, span_micro_r: 0.9946, span_micro_f1: 0.9943, micro_p: 0.9931, micro_r: 0.9780, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.61 / 98.11999999999999 / 98.25), p: (95.14 / 96.1), r: (96.86 / 96.23), f1: (95.99 / 96.17)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 15.395273656618517, 'span_acc': 0.9861440075793463, 'attr_start_acc': 0.9811827956989247, 'attr_end_acc': 0.9825268817204301, 'span_micro_p': 0.9514435695538058, 'span_micro_r': 0.9686038744154977, 'span_micro_f1': 0.959947037404833, 'micro_p': 0.9610215053763441, 'micro_r': 0.9623149394347241, 'micro_f1': 0.9616677874915938, 'category-p/r/f1': {'PRO': (0.8947, 0.9444, 0.9189), 'ORG': (0.9469, 0.9578, 0.9523), 'TITLE': (0.9636, 0.958, 0.9608), 'EDU': (0.9808, 0.9623, 0.9715), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9616677874915938 / 0.9595687331536389
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 8 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.68 / 96.99 / 97.36), p: (94.88 / 96.46000000000001), r: (95.58 / 95.28), f1: (95.23 / 95.86)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 16.089543027322996, 'span_acc': 0.9767911200807265, 'attr_start_acc': 0.9699386503067484, 'attr_end_acc': 0.9736196319018405, 'span_micro_p': 0.9488428745432399, 'span_micro_r': 0.9558282208588957, 'span_micro_f1': 0.9523227383863081, 'micro_p': 0.9645962732919254, 'micro_r': 0.9527607361963191, 'micro_f1': 0.958641975308642, 'category-p/r/f1': {'ORG': (0.9523, 0.9385, 0.9453), 'TITLE': (0.9632, 0.9495, 0.9563), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.958641975308642 / 0.9568724790567794
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2880, loss: -0.1469, span_acc: 0.9981, attr_start_acc: 0.9892, attr_end_acc: 0.9730, span_micro_p: 0.9920, span_micro_r: 0.9973, span_micro_f1: 0.9947, micro_p: 0.9972, micro_r: 0.9676, micro_f1: 0.9822
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2890, loss: -0.2859, span_acc: 0.9979, attr_start_acc: 0.9840, attr_end_acc: 0.9666, span_micro_p: 0.9894, span_micro_r: 0.9947, span_micro_f1: 0.9921, micro_p: 0.9903, micro_r: 0.9545, micro_f1: 0.9721
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2900, loss: 0.1018, span_acc: 0.9982, attr_start_acc: 0.9878, attr_end_acc: 0.9704, span_micro_p: 0.9914, span_micro_r: 0.9957, span_micro_f1: 0.9935, micro_p: 0.9901, micro_r: 0.9599, micro_f1: 0.9748
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2910, loss: 2.0194, span_acc: 0.9985, attr_start_acc: 0.9864, attr_end_acc: 0.9783, span_micro_p: 0.9927, span_micro_r: 0.9957, span_micro_f1: 0.9942, micro_p: 0.9911, micro_r: 0.9665, micro_f1: 0.9787
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2920, loss: 2.3434, span_acc: 0.9985, attr_start_acc: 0.9878, attr_end_acc: 0.9805, span_micro_p: 0.9923, span_micro_r: 0.9957, span_micro_f1: 0.9940, micro_p: 0.9930, micro_r: 0.9702, micro_f1: 0.9815
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2930, loss: 3.1402, span_acc: 0.9988, attr_start_acc: 0.9865, attr_end_acc: 0.9793, span_micro_p: 0.9937, span_micro_r: 0.9964, span_micro_f1: 0.9951, micro_p: 0.9919, micro_r: 0.9697, micro_f1: 0.9807
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2940, loss: 2.9711, span_acc: 0.9987, attr_start_acc: 0.9863, attr_end_acc: 0.9808, span_micro_p: 0.9939, span_micro_r: 0.9959, span_micro_f1: 0.9949, micro_p: 0.9926, micro_r: 0.9712, micro_f1: 0.9818
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2950, loss: 2.5789, span_acc: 0.9988, attr_start_acc: 0.9873, attr_end_acc: 0.9822, span_micro_p: 0.9946, span_micro_r: 0.9964, span_micro_f1: 0.9955, micro_p: 0.9932, micro_r: 0.9735, micro_f1: 0.9833
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2960, loss: 3.9042, span_acc: 0.9988, attr_start_acc: 0.9863, attr_end_acc: 0.9812, span_micro_p: 0.9944, span_micro_r: 0.9960, span_micro_f1: 0.9952, micro_p: 0.9926, micro_r: 0.9723, micro_f1: 0.9823
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2970, loss: 3.5705, span_acc: 0.9988, attr_start_acc: 0.9867, attr_end_acc: 0.9826, span_micro_p: 0.9950, span_micro_r: 0.9962, span_micro_f1: 0.9956, micro_p: 0.9932, micro_r: 0.9741, micro_f1: 0.9835
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2980, loss: 3.2572, span_acc: 0.9989, attr_start_acc: 0.9872, attr_end_acc: 0.9839, span_micro_p: 0.9953, span_micro_r: 0.9965, span_micro_f1: 0.9959, micro_p: 0.9934, micro_r: 0.9756, micro_f1: 0.9844
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 2990, loss: 3.8433, span_acc: 0.9984, attr_start_acc: 0.9862, attr_end_acc: 0.9844, span_micro_p: 0.9942, span_micro_r: 0.9956, span_micro_f1: 0.9949, micro_p: 0.9927, micro_r: 0.9750, micro_f1: 0.9837
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3000, loss: 3.5504, span_acc: 0.9984, attr_start_acc: 0.9861, attr_end_acc: 0.9850, span_micro_p: 0.9941, span_micro_r: 0.9950, span_micro_f1: 0.9946, micro_p: 0.9930, micro_r: 0.9754, micro_f1: 0.9841
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3010, loss: 3.7845, span_acc: 0.9985, attr_start_acc: 0.9870, attr_end_acc: 0.9849, span_micro_p: 0.9946, span_micro_r: 0.9954, span_micro_f1: 0.9950, micro_p: 0.9934, micro_r: 0.9760, micro_f1: 0.9846
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3020, loss: 3.6789, span_acc: 0.9986, attr_start_acc: 0.9869, attr_end_acc: 0.9854, span_micro_p: 0.9949, span_micro_r: 0.9957, span_micro_f1: 0.9953, micro_p: 0.9935, micro_r: 0.9763, micro_f1: 0.9848
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3030, loss: 3.4253, span_acc: 0.9986, attr_start_acc: 0.9872, attr_end_acc: 0.9858, span_micro_p: 0.9946, span_micro_r: 0.9957, span_micro_f1: 0.9951, micro_p: 0.9934, micro_r: 0.9768, micro_f1: 0.9850
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3040, loss: 3.1884, span_acc: 0.9987, attr_start_acc: 0.9872, attr_end_acc: 0.9862, span_micro_p: 0.9948, span_micro_r: 0.9958, span_micro_f1: 0.9953, micro_p: 0.9931, micro_r: 0.9774, micro_f1: 0.9852
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3050, loss: 3.3512, span_acc: 0.9987, attr_start_acc: 0.9876, attr_end_acc: 0.9866, span_micro_p: 0.9950, span_micro_r: 0.9959, span_micro_f1: 0.9954, micro_p: 0.9934, micro_r: 0.9780, micro_f1: 0.9856
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3060, loss: 3.4561, span_acc: 0.9987, attr_start_acc: 0.9872, attr_end_acc: 0.9865, span_micro_p: 0.9949, span_micro_r: 0.9959, span_micro_f1: 0.9954, micro_p: 0.9932, micro_r: 0.9778, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3070, loss: 3.4159, span_acc: 0.9988, attr_start_acc: 0.9876, attr_end_acc: 0.9865, span_micro_p: 0.9951, span_micro_r: 0.9960, span_micro_f1: 0.9956, micro_p: 0.9931, micro_r: 0.9780, micro_f1: 0.9855
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3080, loss: 3.3049, span_acc: 0.9988, attr_start_acc: 0.9880, attr_end_acc: 0.9868, span_micro_p: 0.9953, span_micro_r: 0.9962, span_micro_f1: 0.9958, micro_p: 0.9932, micro_r: 0.9788, micro_f1: 0.9860
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3090, loss: 3.1042, span_acc: 0.9989, attr_start_acc: 0.9882, attr_end_acc: 0.9871, span_micro_p: 0.9955, span_micro_r: 0.9964, span_micro_f1: 0.9960, micro_p: 0.9934, micro_r: 0.9793, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3100, loss: 2.9328, span_acc: 0.9989, attr_start_acc: 0.9880, attr_end_acc: 0.9872, span_micro_p: 0.9955, span_micro_r: 0.9964, span_micro_f1: 0.9960, micro_p: 0.9935, micro_r: 0.9793, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3110, loss: 3.2537, span_acc: 0.9989, attr_start_acc: 0.9878, attr_end_acc: 0.9874, span_micro_p: 0.9956, span_micro_r: 0.9965, span_micro_f1: 0.9961, micro_p: 0.9937, micro_r: 0.9793, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3120, loss: 3.5696, span_acc: 0.9988, attr_start_acc: 0.9877, attr_end_acc: 0.9872, span_micro_p: 0.9955, span_micro_r: 0.9962, span_micro_f1: 0.9958, micro_p: 0.9938, micro_r: 0.9790, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3130, loss: 3.4805, span_acc: 0.9988, attr_start_acc: 0.9878, attr_end_acc: 0.9871, span_micro_p: 0.9956, span_micro_r: 0.9962, span_micro_f1: 0.9959, micro_p: 0.9937, micro_r: 0.9791, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3140, loss: 3.5722, span_acc: 0.9989, attr_start_acc: 0.9874, attr_end_acc: 0.9869, span_micro_p: 0.9957, span_micro_r: 0.9964, span_micro_f1: 0.9960, micro_p: 0.9938, micro_r: 0.9785, micro_f1: 0.9861
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3150, loss: 3.4928, span_acc: 0.9989, attr_start_acc: 0.9878, attr_end_acc: 0.9871, span_micro_p: 0.9955, span_micro_r: 0.9963, span_micro_f1: 0.9959, micro_p: 0.9939, micro_r: 0.9789, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3160, loss: 3.3963, span_acc: 0.9989, attr_start_acc: 0.9878, attr_end_acc: 0.9872, span_micro_p: 0.9956, span_micro_r: 0.9965, span_micro_f1: 0.9961, micro_p: 0.9939, micro_r: 0.9790, micro_f1: 0.9864
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3170, loss: 3.4397, span_acc: 0.9989, attr_start_acc: 0.9879, attr_end_acc: 0.9871, span_micro_p: 0.9955, span_micro_r: 0.9964, span_micro_f1: 0.9960, micro_p: 0.9937, micro_r: 0.9791, micro_f1: 0.9863
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3180, loss: 3.5262, span_acc: 0.9989, attr_start_acc: 0.9878, attr_end_acc: 0.9869, span_micro_p: 0.9955, span_micro_r: 0.9963, span_micro_f1: 0.9959, micro_p: 0.9936, micro_r: 0.9789, micro_f1: 0.9862
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 9, steps: 3190, loss: 3.4645, span_acc: 0.9988, attr_start_acc: 0.9870, attr_end_acc: 0.9867, span_micro_p: 0.9955, span_micro_r: 0.9961, span_micro_f1: 0.9958, micro_p: 0.9934, micro_r: 0.9775, micro_f1: 0.9854
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.57000000000001 / 96.37 / 97.24000000000001), p: (95.65 / 97.08), r: (96.93 / 93.94), f1: (96.28 / 95.49)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 45.63812097771894, 'span_acc': 0.9856702984367598, 'attr_start_acc': 0.9637096774193549, 'attr_end_acc': 0.9724462365591398, 'span_micro_p': 0.956493078444298, 'span_micro_r': 0.9692718770875084, 'span_micro_f1': 0.9628400796284009, 'micro_p': 0.9707927677329624, 'micro_r': 0.9394347240915208, 'micro_f1': 0.9548563611491109, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9528, 0.929, 0.9407), 'TITLE': (0.9816, 0.929, 0.9546), 'EDU': (0.981, 0.9717, 0.9763), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9548563611491109 / 0.9616677874915938
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 9 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.96000000000001 / 96.00999999999999 / 97.3), p: (95.66 / 97.59), r: (96.00999999999999 / 94.54), f1: (95.84 / 96.04)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 42.10069060925418, 'span_acc': 0.9796165489404641, 'attr_start_acc': 0.9601226993865031, 'attr_end_acc': 0.9730061349693252, 'span_micro_p': 0.956601466992665, 'span_micro_r': 0.9601226993865031, 'span_micro_f1': 0.9583588487446418, 'micro_p': 0.9759341355288157, 'micro_r': 0.945398773006135, 'micro_f1': 0.9604238080398878, 'category-p/r/f1': {'TITLE': (0.9756, 0.9313, 0.9529), 'ORG': (0.9683, 0.9385, 0.9532), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9604238080398878 / 0.958641975308642
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on val set: 0.961668
INFO:train_bert_mtl_span_attr_boundary.py:Best micro_f1 on test set: 0.960424
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:Test set results:
INFO:train_bert_mtl_span_attr_boundary.py:Span Accuracy: 0.9767911200807265
INFO:train_bert_mtl_span_attr_boundary.py:Attr Start Accuracy: 0.9699386503067484
INFO:train_bert_mtl_span_attr_boundary.py:Attr End Accuracy: 0.9699386503067484
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro precision: 0.9488428745432399
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro recall: 0.9558282208588957
INFO:train_bert_mtl_span_attr_boundary.py:Span Micro F1: 0.9523227383863081
INFO:train_bert_mtl_span_attr_boundary.py:Micro precision: 0.9645962732919254
INFO:train_bert_mtl_span_attr_boundary.py:Micro recall: 0.9527607361963191
INFO:train_bert_mtl_span_attr_boundary.py:Micro F1: 0.958641975308642
INFO:train_bert_mtl_span_attr_boundary.py:Category-P/R/F1: {'ORG': (0.9523, 0.9385, 0.9453), 'TITLE': (0.9632, 0.9495, 0.9563), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9908, 0.9643, 0.9774), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 train ===
we have added 3 tokens ['“', '”', '—']
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 10, loss: 2.1087, span_acc: 0.6288, attr_start_acc: 0.0025, attr_end_acc: 0.0660, span_micro_p: 0.3548, span_micro_r: 0.0556, span_micro_f1: 0.0961, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 20, loss: 1.7991, span_acc: 0.7837, attr_start_acc: 0.1725, attr_end_acc: 0.3757, span_micro_p: 0.7411, span_micro_r: 0.4020, span_micro_f1: 0.5213, micro_p: 0.3676, micro_r: 0.0854, micro_f1: 0.1386
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 30, loss: 1.6624, span_acc: 0.8356, attr_start_acc: 0.3392, attr_end_acc: 0.5084, span_micro_p: 0.7865, span_micro_r: 0.5307, span_micro_f1: 0.6338, micro_p: 0.5906, micro_r: 0.2315, micro_f1: 0.3326
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 40, loss: 1.5740, span_acc: 0.8651, attr_start_acc: 0.4291, attr_end_acc: 0.5817, span_micro_p: 0.8306, span_micro_r: 0.6108, span_micro_f1: 0.7039, micro_p: 0.7071, micro_r: 0.3266, micro_f1: 0.4468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 50, loss: 1.5193, span_acc: 0.8843, attr_start_acc: 0.4967, attr_end_acc: 0.6267, span_micro_p: 0.8524, span_micro_r: 0.6600, span_micro_f1: 0.7440, micro_p: 0.7738, micro_r: 0.3949, micro_f1: 0.5229
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 60, loss: 1.4659, span_acc: 0.8999, attr_start_acc: 0.5443, attr_end_acc: 0.6577, span_micro_p: 0.8728, span_micro_r: 0.7032, span_micro_f1: 0.7789, micro_p: 0.8164, micro_r: 0.4477, micro_f1: 0.5783
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 70, loss: 1.4313, span_acc: 0.9079, attr_start_acc: 0.5781, attr_end_acc: 0.6905, span_micro_p: 0.8817, span_micro_r: 0.7262, span_micro_f1: 0.7965, micro_p: 0.8383, micro_r: 0.4873, micro_f1: 0.6163
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 80, loss: 1.4020, span_acc: 0.9135, attr_start_acc: 0.6045, attr_end_acc: 0.7088, span_micro_p: 0.8832, span_micro_r: 0.7405, span_micro_f1: 0.8056, micro_p: 0.8453, micro_r: 0.5169, micro_f1: 0.6415
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 90, loss: 1.3757, span_acc: 0.9202, attr_start_acc: 0.6309, attr_end_acc: 0.7281, span_micro_p: 0.8898, span_micro_r: 0.7600, span_micro_f1: 0.8198, micro_p: 0.8604, micro_r: 0.5483, micro_f1: 0.6698
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 100, loss: 1.3560, span_acc: 0.9253, attr_start_acc: 0.6562, attr_end_acc: 0.7453, span_micro_p: 0.8952, span_micro_r: 0.7752, span_micro_f1: 0.8309, micro_p: 0.8698, micro_r: 0.5752, micro_f1: 0.6925
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 110, loss: 1.3358, span_acc: 0.9303, attr_start_acc: 0.6773, attr_end_acc: 0.7584, span_micro_p: 0.8968, span_micro_r: 0.7863, span_micro_f1: 0.8379, micro_p: 0.8788, micro_r: 0.5985, micro_f1: 0.7120
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 120, loss: 1.3172, span_acc: 0.9346, attr_start_acc: 0.6948, attr_end_acc: 0.7726, span_micro_p: 0.9012, span_micro_r: 0.7982, span_micro_f1: 0.8466, micro_p: 0.8888, micro_r: 0.6197, micro_f1: 0.7303
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 130, loss: 1.3026, span_acc: 0.9382, attr_start_acc: 0.7119, attr_end_acc: 0.7846, span_micro_p: 0.9062, span_micro_r: 0.8096, span_micro_f1: 0.8552, micro_p: 0.8971, micro_r: 0.6395, micro_f1: 0.7467
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 140, loss: 1.2917, span_acc: 0.9403, attr_start_acc: 0.7257, attr_end_acc: 0.7947, span_micro_p: 0.9076, span_micro_r: 0.8153, span_micro_f1: 0.8590, micro_p: 0.9017, micro_r: 0.6541, micro_f1: 0.7582
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 150, loss: 1.2785, span_acc: 0.9430, attr_start_acc: 0.7385, attr_end_acc: 0.8050, span_micro_p: 0.9107, span_micro_r: 0.8227, span_micro_f1: 0.8645, micro_p: 0.9066, micro_r: 0.6700, micro_f1: 0.7706
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 160, loss: 1.2680, span_acc: 0.9448, attr_start_acc: 0.7491, attr_end_acc: 0.8142, span_micro_p: 0.9126, span_micro_r: 0.8278, span_micro_f1: 0.8681, micro_p: 0.9113, micro_r: 0.6824, micro_f1: 0.7804
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 170, loss: 1.2562, span_acc: 0.9467, attr_start_acc: 0.7597, attr_end_acc: 0.8228, span_micro_p: 0.9139, span_micro_r: 0.8332, span_micro_f1: 0.8717, micro_p: 0.9134, micro_r: 0.6937, micro_f1: 0.7885
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 180, loss: 1.2454, span_acc: 0.9484, attr_start_acc: 0.7687, attr_end_acc: 0.8298, span_micro_p: 0.9162, span_micro_r: 0.8382, span_micro_f1: 0.8755, micro_p: 0.9171, micro_r: 0.7043, micro_f1: 0.7967
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 190, loss: 1.2364, span_acc: 0.9494, attr_start_acc: 0.7757, attr_end_acc: 0.8351, span_micro_p: 0.9145, span_micro_r: 0.8401, span_micro_f1: 0.8757, micro_p: 0.9167, micro_r: 0.7113, micro_f1: 0.8010
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 200, loss: 1.2270, span_acc: 0.9508, attr_start_acc: 0.7835, attr_end_acc: 0.8395, span_micro_p: 0.9161, span_micro_r: 0.8442, span_micro_f1: 0.8787, micro_p: 0.9189, micro_r: 0.7196, micro_f1: 0.8071
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 210, loss: 1.2175, span_acc: 0.9521, attr_start_acc: 0.7904, attr_end_acc: 0.8454, span_micro_p: 0.9176, span_micro_r: 0.8480, span_micro_f1: 0.8814, micro_p: 0.9207, micro_r: 0.7280, micro_f1: 0.8131
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 220, loss: 1.2127, span_acc: 0.9526, attr_start_acc: 0.7963, attr_end_acc: 0.8496, span_micro_p: 0.9176, span_micro_r: 0.8502, span_micro_f1: 0.8826, micro_p: 0.9220, micro_r: 0.7340, micro_f1: 0.8173
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 230, loss: 1.2039, span_acc: 0.9536, attr_start_acc: 0.8017, attr_end_acc: 0.8523, span_micro_p: 0.9191, span_micro_r: 0.8538, span_micro_f1: 0.8852, micro_p: 0.9248, micro_r: 0.7395, micro_f1: 0.8219
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 240, loss: 1.1981, span_acc: 0.9548, attr_start_acc: 0.8075, attr_end_acc: 0.8572, span_micro_p: 0.9199, span_micro_r: 0.8571, span_micro_f1: 0.8874, micro_p: 0.9261, micro_r: 0.7464, micro_f1: 0.8266
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 250, loss: 1.1888, span_acc: 0.9559, attr_start_acc: 0.8122, attr_end_acc: 0.8612, span_micro_p: 0.9222, span_micro_r: 0.8606, span_micro_f1: 0.8904, micro_p: 0.9279, micro_r: 0.7524, micro_f1: 0.8310
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 260, loss: 1.1799, span_acc: 0.9568, attr_start_acc: 0.8157, attr_end_acc: 0.8638, span_micro_p: 0.9227, span_micro_r: 0.8631, span_micro_f1: 0.8919, micro_p: 0.9286, micro_r: 0.7563, micro_f1: 0.8337
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 270, loss: 1.1714, span_acc: 0.9571, attr_start_acc: 0.8196, attr_end_acc: 0.8667, span_micro_p: 0.9229, span_micro_r: 0.8650, span_micro_f1: 0.8930, micro_p: 0.9298, micro_r: 0.7611, micro_f1: 0.8371
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 280, loss: 1.1649, span_acc: 0.9581, attr_start_acc: 0.8236, attr_end_acc: 0.8694, span_micro_p: 0.9238, span_micro_r: 0.8674, span_micro_f1: 0.8947, micro_p: 0.9303, micro_r: 0.7655, micro_f1: 0.8399
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 290, loss: 1.1565, span_acc: 0.9588, attr_start_acc: 0.8277, attr_end_acc: 0.8727, span_micro_p: 0.9246, span_micro_r: 0.8700, span_micro_f1: 0.8965, micro_p: 0.9319, micro_r: 0.7707, micro_f1: 0.8437
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 300, loss: 1.1483, span_acc: 0.9598, attr_start_acc: 0.8320, attr_end_acc: 0.8755, span_micro_p: 0.9265, span_micro_r: 0.8730, span_micro_f1: 0.8990, micro_p: 0.9337, micro_r: 0.7758, micro_f1: 0.8475
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 0, steps: 310, loss: 1.1399, span_acc: 0.9606, attr_start_acc: 0.8355, attr_end_acc: 0.8780, span_micro_p: 0.9280, span_micro_r: 0.8755, span_micro_f1: 0.9010, micro_p: 0.9352, micro_r: 0.7800, micro_f1: 0.8506
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.87 / 87.57000000000001 / 94.42), p: (96.02000000000001 / 98.17), r: (93.58999999999999 / 82.84), f1: (94.78999999999999 / 89.85)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.8025891685588828, 'span_acc': 0.9786830885836096, 'attr_start_acc': 0.8756720430107527, 'attr_end_acc': 0.9442204301075269, 'span_micro_p': 0.9602467443454421, 'span_micro_r': 0.935871743486974, 'span_micro_f1': 0.9479025710419486, 'micro_p': 0.981658692185008, 'micro_r': 0.8283983849259757, 'micro_f1': 0.8985401459854013, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'TITLE': (0.9943, 0.7551, 0.8583), 'ORG': (0.9655, 0.8599, 0.9096), 'PRO': (0.9412, 0.8889, 0.9143), 'EDU': (0.9802, 0.934, 0.9565), 'CONT': (1.0, 0.9394, 0.9688), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.8985401459854013 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 0 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.36 / 89.63 / 95.46), p: (96.39 / 98.27), r: (93.44 / 87.18), f1: (94.89 / 92.39)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.8057423327703895, 'span_acc': 0.9735620585267407, 'attr_start_acc': 0.896319018404908, 'attr_end_acc': 0.9546012269938651, 'span_micro_p': 0.9639240506329114, 'span_micro_r': 0.9343558282208589, 'span_micro_f1': 0.9489096573208723, 'micro_p': 0.9827109266943291, 'micro_r': 0.8717791411042944, 'micro_f1': 0.923927178153446, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.963, 0.7879, 0.8667), 'TITLE': (0.9877, 0.8303, 0.9022), 'ORG': (0.9709, 0.9042, 0.9364), 'EDU': (0.9901, 0.8929, 0.939), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.923927178153446 / 0
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 320, loss: 0.9431, span_acc: 0.9571, attr_start_acc: 0.8571, attr_end_acc: 0.8857, span_micro_p: 0.8750, span_micro_r: 0.8000, span_micro_f1: 0.8358, micro_p: 1.0000, micro_r: 0.7429, micro_f1: 0.8525
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 330, loss: 0.8449, span_acc: 0.9866, attr_start_acc: 0.9638, attr_end_acc: 0.9638, span_micro_p: 0.9531, span_micro_r: 0.9433, span_micro_f1: 0.9482, micro_p: 0.9862, micro_r: 0.9251, micro_f1: 0.9547
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 340, loss: 0.8478, span_acc: 0.9858, attr_start_acc: 0.9547, attr_end_acc: 0.9559, span_micro_p: 0.9530, span_micro_r: 0.9391, span_micro_f1: 0.9460, micro_p: 0.9753, micro_r: 0.9168, micro_f1: 0.9451
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 350, loss: 0.8304, span_acc: 0.9864, attr_start_acc: 0.9505, attr_end_acc: 0.9568, span_micro_p: 0.9580, span_micro_r: 0.9438, span_micro_f1: 0.9508, micro_p: 0.9750, micro_r: 0.9184, micro_f1: 0.9458
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 360, loss: 0.8338, span_acc: 0.9854, attr_start_acc: 0.9523, attr_end_acc: 0.9625, span_micro_p: 0.9556, span_micro_r: 0.9425, span_micro_f1: 0.9490, micro_p: 0.9754, micro_r: 0.9225, micro_f1: 0.9482
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 370, loss: 0.8364, span_acc: 0.9823, attr_start_acc: 0.9464, attr_end_acc: 0.9617, span_micro_p: 0.9509, span_micro_r: 0.9387, span_micro_f1: 0.9447, micro_p: 0.9701, micro_r: 0.9154, micro_f1: 0.9419
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 380, loss: 0.8257, span_acc: 0.9821, attr_start_acc: 0.9483, attr_end_acc: 0.9618, span_micro_p: 0.9500, span_micro_r: 0.9387, span_micro_f1: 0.9443, micro_p: 0.9684, micro_r: 0.9156, micro_f1: 0.9413
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 390, loss: 0.8174, span_acc: 0.9822, attr_start_acc: 0.9501, attr_end_acc: 0.9611, span_micro_p: 0.9543, span_micro_r: 0.9422, span_micro_f1: 0.9482, micro_p: 0.9712, micro_r: 0.9167, micro_f1: 0.9432
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 400, loss: 0.8101, span_acc: 0.9821, attr_start_acc: 0.9513, attr_end_acc: 0.9595, span_micro_p: 0.9567, span_micro_r: 0.9447, span_micro_f1: 0.9507, micro_p: 0.9723, micro_r: 0.9179, micro_f1: 0.9443
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 410, loss: 0.8013, span_acc: 0.9821, attr_start_acc: 0.9522, attr_end_acc: 0.9586, span_micro_p: 0.9551, span_micro_r: 0.9422, span_micro_f1: 0.9486, micro_p: 0.9720, micro_r: 0.9178, micro_f1: 0.9441
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 420, loss: 0.7975, span_acc: 0.9831, attr_start_acc: 0.9539, attr_end_acc: 0.9611, span_micro_p: 0.9570, span_micro_r: 0.9451, span_micro_f1: 0.9510, micro_p: 0.9733, micro_r: 0.9214, micro_f1: 0.9466
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 430, loss: 0.7845, span_acc: 0.9834, attr_start_acc: 0.9553, attr_end_acc: 0.9632, span_micro_p: 0.9567, span_micro_r: 0.9461, span_micro_f1: 0.9513, micro_p: 0.9729, micro_r: 0.9241, micro_f1: 0.9479
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 440, loss: 0.7771, span_acc: 0.9836, attr_start_acc: 0.9543, attr_end_acc: 0.9629, span_micro_p: 0.9571, span_micro_r: 0.9457, span_micro_f1: 0.9513, micro_p: 0.9731, micro_r: 0.9233, micro_f1: 0.9475
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 450, loss: 0.7728, span_acc: 0.9836, attr_start_acc: 0.9531, attr_end_acc: 0.9626, span_micro_p: 0.9566, span_micro_r: 0.9452, span_micro_f1: 0.9509, micro_p: 0.9727, micro_r: 0.9229, micro_f1: 0.9471
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 460, loss: 0.7675, span_acc: 0.9836, attr_start_acc: 0.9528, attr_end_acc: 0.9629, span_micro_p: 0.9567, span_micro_r: 0.9459, span_micro_f1: 0.9513, micro_p: 0.9722, micro_r: 0.9227, micro_f1: 0.9468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 470, loss: 0.7627, span_acc: 0.9837, attr_start_acc: 0.9528, attr_end_acc: 0.9631, span_micro_p: 0.9567, span_micro_r: 0.9463, span_micro_f1: 0.9514, micro_p: 0.9719, micro_r: 0.9232, micro_f1: 0.9469
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 480, loss: 0.7598, span_acc: 0.9834, attr_start_acc: 0.9517, attr_end_acc: 0.9626, span_micro_p: 0.9553, span_micro_r: 0.9447, span_micro_f1: 0.9500, micro_p: 0.9715, micro_r: 0.9222, micro_f1: 0.9462
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 490, loss: 0.7514, span_acc: 0.9834, attr_start_acc: 0.9528, attr_end_acc: 0.9634, span_micro_p: 0.9559, span_micro_r: 0.9461, span_micro_f1: 0.9510, micro_p: 0.9721, micro_r: 0.9237, micro_f1: 0.9473
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 500, loss: 0.7533, span_acc: 0.9828, attr_start_acc: 0.9530, attr_end_acc: 0.9632, span_micro_p: 0.9550, span_micro_r: 0.9458, span_micro_f1: 0.9504, micro_p: 0.9720, micro_r: 0.9235, micro_f1: 0.9471
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 510, loss: 0.7466, span_acc: 0.9829, attr_start_acc: 0.9528, attr_end_acc: 0.9625, span_micro_p: 0.9546, span_micro_r: 0.9449, span_micro_f1: 0.9497, micro_p: 0.9717, micro_r: 0.9231, micro_f1: 0.9468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 520, loss: 0.7411, span_acc: 0.9826, attr_start_acc: 0.9519, attr_end_acc: 0.9628, span_micro_p: 0.9548, span_micro_r: 0.9445, span_micro_f1: 0.9497, micro_p: 0.9719, micro_r: 0.9228, micro_f1: 0.9467
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 530, loss: 0.7308, span_acc: 0.9831, attr_start_acc: 0.9516, attr_end_acc: 0.9636, span_micro_p: 0.9559, span_micro_r: 0.9460, span_micro_f1: 0.9509, micro_p: 0.9722, micro_r: 0.9230, micro_f1: 0.9470
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 540, loss: 0.7229, span_acc: 0.9833, attr_start_acc: 0.9520, attr_end_acc: 0.9639, span_micro_p: 0.9563, span_micro_r: 0.9464, span_micro_f1: 0.9513, micro_p: 0.9727, micro_r: 0.9238, micro_f1: 0.9476
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 550, loss: 0.7125, span_acc: 0.9831, attr_start_acc: 0.9514, attr_end_acc: 0.9641, span_micro_p: 0.9558, span_micro_r: 0.9457, span_micro_f1: 0.9507, micro_p: 0.9723, micro_r: 0.9234, micro_f1: 0.9472
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 560, loss: 0.7156, span_acc: 0.9833, attr_start_acc: 0.9520, attr_end_acc: 0.9642, span_micro_p: 0.9552, span_micro_r: 0.9461, span_micro_f1: 0.9507, micro_p: 0.9718, micro_r: 0.9236, micro_f1: 0.9471
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 570, loss: 0.7114, span_acc: 0.9829, attr_start_acc: 0.9524, attr_end_acc: 0.9641, span_micro_p: 0.9540, span_micro_r: 0.9471, span_micro_f1: 0.9505, micro_p: 0.9720, micro_r: 0.9238, micro_f1: 0.9473
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 580, loss: 0.7065, span_acc: 0.9829, attr_start_acc: 0.9531, attr_end_acc: 0.9634, span_micro_p: 0.9532, span_micro_r: 0.9471, span_micro_f1: 0.9502, micro_p: 0.9718, micro_r: 0.9232, micro_f1: 0.9469
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 590, loss: 0.6999, span_acc: 0.9828, attr_start_acc: 0.9528, attr_end_acc: 0.9636, span_micro_p: 0.9534, span_micro_r: 0.9476, span_micro_f1: 0.9505, micro_p: 0.9720, micro_r: 0.9229, micro_f1: 0.9468
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 600, loss: 0.6900, span_acc: 0.9829, attr_start_acc: 0.9537, attr_end_acc: 0.9642, span_micro_p: 0.9543, span_micro_r: 0.9487, span_micro_f1: 0.9515, micro_p: 0.9724, micro_r: 0.9242, micro_f1: 0.9477
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 610, loss: 0.6912, span_acc: 0.9830, attr_start_acc: 0.9536, attr_end_acc: 0.9643, span_micro_p: 0.9544, span_micro_r: 0.9481, span_micro_f1: 0.9512, micro_p: 0.9724, micro_r: 0.9240, micro_f1: 0.9476
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 620, loss: 0.6839, span_acc: 0.9832, attr_start_acc: 0.9541, attr_end_acc: 0.9644, span_micro_p: 0.9548, span_micro_r: 0.9484, span_micro_f1: 0.9516, micro_p: 0.9723, micro_r: 0.9244, micro_f1: 0.9477
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 1, steps: 630, loss: 0.6827, span_acc: 0.9830, attr_start_acc: 0.9540, attr_end_acc: 0.9640, span_micro_p: 0.9548, span_micro_r: 0.9474, span_micro_f1: 0.9511, micro_p: 0.9722, micro_r: 0.9238, micro_f1: 0.9474
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.52 / 96.57 / 97.18), p: (96.23 / 96.75), r: (95.59 / 94.21000000000001), f1: (95.91 / 95.47)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.3926027867757991, 'span_acc': 0.9851965892941734, 'attr_start_acc': 0.9657258064516129, 'attr_end_acc': 0.9717741935483871, 'span_micro_p': 0.9623402824478816, 'span_micro_r': 0.9559118236472945, 'span_micro_f1': 0.9591152815013405, 'micro_p': 0.967519004837595, 'micro_r': 0.9421265141318977, 'micro_f1': 0.954653937947494, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.8947, 0.9444, 0.9189), 'EDU': (0.9792, 0.8868, 0.9307), 'ORG': (0.9546, 0.929, 0.9416), 'TITLE': (0.9719, 0.9507, 0.9612), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.954653937947494 / 0.8985401459854013
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 1 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.00999999999999 / 95.77 / 95.95), p: (96.41999999999999 / 97.05), r: (94.23 / 92.94), f1: (95.30999999999999 / 94.95)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.29747039641974105, 'span_acc': 0.9801210898082745, 'attr_start_acc': 0.9576687116564417, 'attr_end_acc': 0.9595092024539877, 'span_micro_p': 0.9642184557438794, 'span_micro_r': 0.9423312883435583, 'span_micro_f1': 0.9531492398386596, 'micro_p': 0.9705317104420244, 'micro_r': 0.9294478527607362, 'micro_f1': 0.9495455969915387, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'EDU': (0.9898, 0.8661, 0.9238), 'ORG': (0.9546, 0.9132, 0.9334), 'TITLE': (0.9745, 0.9417, 0.9578), 'PRO': (0.9697, 0.9697, 0.9697), 'NAME': (0.9912, 1.0, 0.9956), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9495455969915387 / 0.923927178153446
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 640, loss: 0.2599, span_acc: 1.0000, attr_start_acc: 0.9740, attr_end_acc: 0.9740, span_micro_p: 1.0000, span_micro_r: 1.0000, span_micro_f1: 1.0000, micro_p: 1.0000, micro_r: 0.9610, micro_f1: 0.9801
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 650, loss: 0.2873, span_acc: 0.9851, attr_start_acc: 0.9682, attr_end_acc: 0.9618, span_micro_p: 0.9700, span_micro_r: 0.9537, span_micro_f1: 0.9618, micro_p: 0.9800, micro_r: 0.9342, micro_f1: 0.9565
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 660, loss: 0.4252, span_acc: 0.9838, attr_start_acc: 0.9627, attr_end_acc: 0.9683, span_micro_p: 0.9590, span_micro_r: 0.9440, span_micro_f1: 0.9515, micro_p: 0.9740, micro_r: 0.9354, micro_f1: 0.9543
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 670, loss: 0.3792, span_acc: 0.9862, attr_start_acc: 0.9630, attr_end_acc: 0.9742, span_micro_p: 0.9645, span_micro_r: 0.9545, span_micro_f1: 0.9595, micro_p: 0.9757, micro_r: 0.9403, micro_f1: 0.9577
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 680, loss: 0.3896, span_acc: 0.9867, attr_start_acc: 0.9666, attr_end_acc: 0.9762, span_micro_p: 0.9631, span_micro_r: 0.9563, span_micro_f1: 0.9597, micro_p: 0.9742, micro_r: 0.9445, micro_f1: 0.9591
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 690, loss: 0.3828, span_acc: 0.9876, attr_start_acc: 0.9688, attr_end_acc: 0.9778, span_micro_p: 0.9629, span_micro_r: 0.9606, span_micro_f1: 0.9617, micro_p: 0.9742, micro_r: 0.9475, micro_f1: 0.9607
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 700, loss: 0.3785, span_acc: 0.9878, attr_start_acc: 0.9692, attr_end_acc: 0.9766, span_micro_p: 0.9658, span_micro_r: 0.9632, span_micro_f1: 0.9645, micro_p: 0.9759, micro_r: 0.9473, micro_f1: 0.9614
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 710, loss: 0.3627, span_acc: 0.9890, attr_start_acc: 0.9702, attr_end_acc: 0.9782, span_micro_p: 0.9680, span_micro_r: 0.9663, span_micro_f1: 0.9672, micro_p: 0.9776, micro_r: 0.9500, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 720, loss: 0.3653, span_acc: 0.9872, attr_start_acc: 0.9691, attr_end_acc: 0.9773, span_micro_p: 0.9675, span_micro_r: 0.9647, span_micro_f1: 0.9661, micro_p: 0.9778, micro_r: 0.9487, micro_f1: 0.9630
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 730, loss: 0.3630, span_acc: 0.9883, attr_start_acc: 0.9698, attr_end_acc: 0.9783, span_micro_p: 0.9697, span_micro_r: 0.9667, span_micro_f1: 0.9682, micro_p: 0.9792, micro_r: 0.9502, micro_f1: 0.9645
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 740, loss: 0.3609, span_acc: 0.9890, attr_start_acc: 0.9714, attr_end_acc: 0.9793, span_micro_p: 0.9712, span_micro_r: 0.9685, span_micro_f1: 0.9699, micro_p: 0.9806, micro_r: 0.9525, micro_f1: 0.9664
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 750, loss: 0.3846, span_acc: 0.9885, attr_start_acc: 0.9674, attr_end_acc: 0.9762, span_micro_p: 0.9694, span_micro_r: 0.9655, span_micro_f1: 0.9674, micro_p: 0.9791, micro_r: 0.9468, micro_f1: 0.9627
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 760, loss: 0.4002, span_acc: 0.9887, attr_start_acc: 0.9670, attr_end_acc: 0.9747, span_micro_p: 0.9699, span_micro_r: 0.9661, span_micro_f1: 0.9680, micro_p: 0.9797, micro_r: 0.9457, micro_f1: 0.9624
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 770, loss: 0.3830, span_acc: 0.9891, attr_start_acc: 0.9667, attr_end_acc: 0.9757, span_micro_p: 0.9708, span_micro_r: 0.9666, span_micro_f1: 0.9687, micro_p: 0.9807, micro_r: 0.9460, micro_f1: 0.9630
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 780, loss: 0.3701, span_acc: 0.9892, attr_start_acc: 0.9669, attr_end_acc: 0.9768, span_micro_p: 0.9714, span_micro_r: 0.9673, span_micro_f1: 0.9693, micro_p: 0.9810, micro_r: 0.9469, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 790, loss: 0.3603, span_acc: 0.9888, attr_start_acc: 0.9663, attr_end_acc: 0.9766, span_micro_p: 0.9703, span_micro_r: 0.9668, span_micro_f1: 0.9686, micro_p: 0.9800, micro_r: 0.9463, micro_f1: 0.9629
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 800, loss: 0.3633, span_acc: 0.9888, attr_start_acc: 0.9666, attr_end_acc: 0.9768, span_micro_p: 0.9687, span_micro_r: 0.9656, span_micro_f1: 0.9672, micro_p: 0.9797, micro_r: 0.9469, micro_f1: 0.9630
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 810, loss: 0.3563, span_acc: 0.9884, attr_start_acc: 0.9661, attr_end_acc: 0.9759, span_micro_p: 0.9675, span_micro_r: 0.9652, span_micro_f1: 0.9663, micro_p: 0.9796, micro_r: 0.9455, micro_f1: 0.9623
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 820, loss: 0.3706, span_acc: 0.9888, attr_start_acc: 0.9665, attr_end_acc: 0.9766, span_micro_p: 0.9681, span_micro_r: 0.9663, span_micro_f1: 0.9672, micro_p: 0.9804, micro_r: 0.9464, micro_f1: 0.9631
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 830, loss: 0.3679, span_acc: 0.9885, attr_start_acc: 0.9663, attr_end_acc: 0.9760, span_micro_p: 0.9677, span_micro_r: 0.9659, span_micro_f1: 0.9668, micro_p: 0.9797, micro_r: 0.9460, micro_f1: 0.9626
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 840, loss: 0.3743, span_acc: 0.9881, attr_start_acc: 0.9667, attr_end_acc: 0.9750, span_micro_p: 0.9683, span_micro_r: 0.9659, span_micro_f1: 0.9671, micro_p: 0.9800, micro_r: 0.9458, micro_f1: 0.9626
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 850, loss: 0.3685, span_acc: 0.9881, attr_start_acc: 0.9671, attr_end_acc: 0.9752, span_micro_p: 0.9691, span_micro_r: 0.9669, span_micro_f1: 0.9680, micro_p: 0.9804, micro_r: 0.9466, micro_f1: 0.9632
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 860, loss: 0.3719, span_acc: 0.9883, attr_start_acc: 0.9670, attr_end_acc: 0.9752, span_micro_p: 0.9697, span_micro_r: 0.9675, span_micro_f1: 0.9686, micro_p: 0.9805, micro_r: 0.9464, micro_f1: 0.9631
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 870, loss: 0.3619, span_acc: 0.9884, attr_start_acc: 0.9672, attr_end_acc: 0.9756, span_micro_p: 0.9701, span_micro_r: 0.9679, span_micro_f1: 0.9690, micro_p: 0.9809, micro_r: 0.9469, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 880, loss: 0.3500, span_acc: 0.9884, attr_start_acc: 0.9672, attr_end_acc: 0.9757, span_micro_p: 0.9699, span_micro_r: 0.9676, span_micro_f1: 0.9687, micro_p: 0.9807, micro_r: 0.9468, micro_f1: 0.9634
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 890, loss: 0.3484, span_acc: 0.9887, attr_start_acc: 0.9676, attr_end_acc: 0.9758, span_micro_p: 0.9705, span_micro_r: 0.9678, span_micro_f1: 0.9692, micro_p: 0.9808, micro_r: 0.9474, micro_f1: 0.9638
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 900, loss: 0.3543, span_acc: 0.9887, attr_start_acc: 0.9667, attr_end_acc: 0.9757, span_micro_p: 0.9703, span_micro_r: 0.9679, span_micro_f1: 0.9691, micro_p: 0.9805, micro_r: 0.9468, micro_f1: 0.9634
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 910, loss: 0.3486, span_acc: 0.9890, attr_start_acc: 0.9666, attr_end_acc: 0.9758, span_micro_p: 0.9708, span_micro_r: 0.9684, span_micro_f1: 0.9696, micro_p: 0.9808, micro_r: 0.9471, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 920, loss: 0.3499, span_acc: 0.9889, attr_start_acc: 0.9669, attr_end_acc: 0.9758, span_micro_p: 0.9710, span_micro_r: 0.9684, span_micro_f1: 0.9697, micro_p: 0.9809, micro_r: 0.9472, micro_f1: 0.9638
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 930, loss: 0.3556, span_acc: 0.9891, attr_start_acc: 0.9673, attr_end_acc: 0.9755, span_micro_p: 0.9709, span_micro_r: 0.9686, span_micro_f1: 0.9697, micro_p: 0.9810, micro_r: 0.9476, micro_f1: 0.9640
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 940, loss: 0.3518, span_acc: 0.9892, attr_start_acc: 0.9674, attr_end_acc: 0.9751, span_micro_p: 0.9710, span_micro_r: 0.9683, span_micro_f1: 0.9696, micro_p: 0.9811, micro_r: 0.9473, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 2, steps: 950, loss: 0.3479, span_acc: 0.9893, attr_start_acc: 0.9679, attr_end_acc: 0.9753, span_micro_p: 0.9713, span_micro_r: 0.9687, span_micro_f1: 0.9700, micro_p: 0.9809, micro_r: 0.9479, micro_f1: 0.9642
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.99 / 96.57 / 96.98), p: (95.78 / 97.15), r: (96.99 / 93.94), f1: (96.38 / 95.52000000000001)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 0.5774860078263746, 'span_acc': 0.9899336807200378, 'attr_start_acc': 0.9657258064516129, 'attr_end_acc': 0.969758064516129, 'span_micro_p': 0.9577836411609498, 'span_micro_r': 0.969939879759519, 'span_micro_f1': 0.9638234317955525, 'micro_p': 0.9714683368128044, 'micro_r': 0.9394347240915208, 'micro_f1': 0.9551830311323981, 'category-p/r/f1': {'ORG': (0.9618, 0.9194, 0.9401), 'PRO': (0.9444, 0.9444, 0.9444), 'EDU': (0.9533, 0.9623, 0.9578), 'TITLE': (0.9774, 0.9406, 0.9586), 'CONT': (1.0, 0.9394, 0.9688), 'NAME': (0.9903, 1.0, 0.9951), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9551830311323981 / 0.954653937947494
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 2 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.65 / 96.00999999999999 / 97.18), p: (95.25 / 97.71), r: (96.00999999999999 / 94.23), f1: (95.63000000000001 / 95.94)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.15768123647701815, 'span_acc': 0.9864783047426842, 'attr_start_acc': 0.9601226993865031, 'attr_end_acc': 0.9717791411042945, 'span_micro_p': 0.9525258673158856, 'span_micro_r': 0.9601226993865031, 'span_micro_f1': 0.9563091964558509, 'micro_p': 0.9770992366412213, 'micro_r': 0.9423312883435583, 'micro_f1': 0.9594003747657713, 'category-p/r/f1': {'LOC': (1.0, 0.6667, 0.8), 'PRO': (0.9375, 0.9091, 0.9231), 'TITLE': (0.9731, 0.9365, 0.9544), 'ORG': (0.9755, 0.9349, 0.9548), 'CONT': (1.0, 0.9643, 0.9818), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9594003747657713 / 0.9495455969915387
INFO:train_bert_mtl_span_attr_boundary.py:Best test ckpt and saved
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 960, loss: 1.0176, span_acc: 0.9890, attr_start_acc: 0.9565, attr_end_acc: 0.9739, span_micro_p: 0.9737, span_micro_r: 0.9569, span_micro_f1: 0.9652, micro_p: 1.0000, micro_r: 0.9391, micro_f1: 0.9686
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 970, loss: 0.0860, span_acc: 0.9941, attr_start_acc: 0.9741, attr_end_acc: 0.9724, span_micro_p: 0.9845, span_micro_r: 0.9761, span_micro_f1: 0.9803, micro_p: 0.9982, micro_r: 0.9552, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 980, loss: -0.0525, span_acc: 0.9945, attr_start_acc: 0.9733, attr_end_acc: 0.9788, span_micro_p: 0.9826, span_micro_r: 0.9763, span_micro_f1: 0.9794, micro_p: 0.9905, micro_r: 0.9585, micro_f1: 0.9742
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 990, loss: -0.0081, span_acc: 0.9947, attr_start_acc: 0.9725, attr_end_acc: 0.9787, span_micro_p: 0.9822, span_micro_r: 0.9761, span_micro_f1: 0.9791, micro_p: 0.9887, micro_r: 0.9581, micro_f1: 0.9731
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1000, loss: 0.0114, span_acc: 0.9936, attr_start_acc: 0.9704, attr_end_acc: 0.9762, span_micro_p: 0.9809, span_micro_r: 0.9717, span_micro_f1: 0.9763, micro_p: 0.9858, micro_r: 0.9509, micro_f1: 0.9680
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1010, loss: 0.1349, span_acc: 0.9922, attr_start_acc: 0.9684, attr_end_acc: 0.9736, span_micro_p: 0.9775, span_micro_r: 0.9678, span_micro_f1: 0.9726, micro_p: 0.9829, micro_r: 0.9463, micro_f1: 0.9643
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1020, loss: 0.1150, span_acc: 0.9919, attr_start_acc: 0.9678, attr_end_acc: 0.9719, span_micro_p: 0.9766, span_micro_r: 0.9684, span_micro_f1: 0.9725, micro_p: 0.9804, micro_r: 0.9451, micro_f1: 0.9624
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1030, loss: 0.1385, span_acc: 0.9922, attr_start_acc: 0.9691, attr_end_acc: 0.9739, span_micro_p: 0.9777, span_micro_r: 0.9684, span_micro_f1: 0.9730, micro_p: 0.9825, micro_r: 0.9483, micro_f1: 0.9651
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1040, loss: 0.1231, span_acc: 0.9927, attr_start_acc: 0.9703, attr_end_acc: 0.9756, span_micro_p: 0.9787, span_micro_r: 0.9702, span_micro_f1: 0.9744, micro_p: 0.9832, micro_r: 0.9509, micro_f1: 0.9668
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1050, loss: 0.2554, span_acc: 0.9919, attr_start_acc: 0.9689, attr_end_acc: 0.9751, span_micro_p: 0.9780, span_micro_r: 0.9661, span_micro_f1: 0.9720, micro_p: 0.9835, micro_r: 0.9496, micro_f1: 0.9663
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1060, loss: 0.3288, span_acc: 0.9920, attr_start_acc: 0.9699, attr_end_acc: 0.9755, span_micro_p: 0.9768, span_micro_r: 0.9670, span_micro_f1: 0.9718, micro_p: 0.9834, micro_r: 0.9447, micro_f1: 0.9636
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1070, loss: 0.3231, span_acc: 0.9923, attr_start_acc: 0.9661, attr_end_acc: 0.9753, span_micro_p: 0.9771, span_micro_r: 0.9685, span_micro_f1: 0.9728, micro_p: 0.9834, micro_r: 0.9389, micro_f1: 0.9606
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1080, loss: 0.3893, span_acc: 0.9918, attr_start_acc: 0.9656, attr_end_acc: 0.9761, span_micro_p: 0.9780, span_micro_r: 0.9695, span_micro_f1: 0.9737, micro_p: 0.9834, micro_r: 0.9387, micro_f1: 0.9605
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1090, loss: 0.4095, span_acc: 0.9917, attr_start_acc: 0.9643, attr_end_acc: 0.9755, span_micro_p: 0.9775, span_micro_r: 0.9691, span_micro_f1: 0.9733, micro_p: 0.9837, micro_r: 0.9335, micro_f1: 0.9579
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1100, loss: 0.3852, span_acc: 0.9921, attr_start_acc: 0.9653, attr_end_acc: 0.9760, span_micro_p: 0.9782, span_micro_r: 0.9701, span_micro_f1: 0.9741, micro_p: 0.9842, micro_r: 0.9358, micro_f1: 0.9594
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1110, loss: 0.3834, span_acc: 0.9920, attr_start_acc: 0.9669, attr_end_acc: 0.9760, span_micro_p: 0.9783, span_micro_r: 0.9702, span_micro_f1: 0.9742, micro_p: 0.9839, micro_r: 0.9377, micro_f1: 0.9602
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1120, loss: 0.4148, span_acc: 0.9919, attr_start_acc: 0.9666, attr_end_acc: 0.9756, span_micro_p: 0.9776, span_micro_r: 0.9697, span_micro_f1: 0.9736, micro_p: 0.9835, micro_r: 0.9377, micro_f1: 0.9600
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1130, loss: 0.4110, span_acc: 0.9920, attr_start_acc: 0.9672, attr_end_acc: 0.9762, span_micro_p: 0.9778, span_micro_r: 0.9699, span_micro_f1: 0.9739, micro_p: 0.9837, micro_r: 0.9391, micro_f1: 0.9609
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1140, loss: 0.3790, span_acc: 0.9923, attr_start_acc: 0.9683, attr_end_acc: 0.9768, span_micro_p: 0.9786, span_micro_r: 0.9713, span_micro_f1: 0.9749, micro_p: 0.9841, micro_r: 0.9411, micro_f1: 0.9622
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1150, loss: 0.3988, span_acc: 0.9922, attr_start_acc: 0.9690, attr_end_acc: 0.9773, span_micro_p: 0.9790, span_micro_r: 0.9713, span_micro_f1: 0.9751, micro_p: 0.9843, micro_r: 0.9430, micro_f1: 0.9632
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1160, loss: 0.3931, span_acc: 0.9921, attr_start_acc: 0.9692, attr_end_acc: 0.9774, span_micro_p: 0.9791, span_micro_r: 0.9711, span_micro_f1: 0.9751, micro_p: 0.9844, micro_r: 0.9439, micro_f1: 0.9637
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1170, loss: 0.3786, span_acc: 0.9920, attr_start_acc: 0.9698, attr_end_acc: 0.9777, span_micro_p: 0.9784, span_micro_r: 0.9713, span_micro_f1: 0.9748, micro_p: 0.9840, micro_r: 0.9447, micro_f1: 0.9639
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1180, loss: 0.4346, span_acc: 0.9914, attr_start_acc: 0.9702, attr_end_acc: 0.9778, span_micro_p: 0.9792, span_micro_r: 0.9715, span_micro_f1: 0.9753, micro_p: 0.9845, micro_r: 0.9457, micro_f1: 0.9647
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1190, loss: 0.4229, span_acc: 0.9915, attr_start_acc: 0.9704, attr_end_acc: 0.9776, span_micro_p: 0.9791, span_micro_r: 0.9719, span_micro_f1: 0.9755, micro_p: 0.9846, micro_r: 0.9464, micro_f1: 0.9651
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1200, loss: 0.4235, span_acc: 0.9915, attr_start_acc: 0.9705, attr_end_acc: 0.9781, span_micro_p: 0.9790, span_micro_r: 0.9720, span_micro_f1: 0.9755, micro_p: 0.9846, micro_r: 0.9471, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1210, loss: 0.4049, span_acc: 0.9916, attr_start_acc: 0.9704, attr_end_acc: 0.9781, span_micro_p: 0.9790, span_micro_r: 0.9722, span_micro_f1: 0.9756, micro_p: 0.9843, micro_r: 0.9475, micro_f1: 0.9655
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1220, loss: 0.4182, span_acc: 0.9917, attr_start_acc: 0.9704, attr_end_acc: 0.9777, span_micro_p: 0.9791, span_micro_r: 0.9723, span_micro_f1: 0.9757, micro_p: 0.9839, micro_r: 0.9475, micro_f1: 0.9654
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1230, loss: 0.4047, span_acc: 0.9917, attr_start_acc: 0.9701, attr_end_acc: 0.9774, span_micro_p: 0.9794, span_micro_r: 0.9725, span_micro_f1: 0.9759, micro_p: 0.9839, micro_r: 0.9470, micro_f1: 0.9651
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1240, loss: 0.3935, span_acc: 0.9917, attr_start_acc: 0.9700, attr_end_acc: 0.9774, span_micro_p: 0.9788, span_micro_r: 0.9724, span_micro_f1: 0.9756, micro_p: 0.9831, micro_r: 0.9468, micro_f1: 0.9646
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1250, loss: 0.3985, span_acc: 0.9917, attr_start_acc: 0.9697, attr_end_acc: 0.9776, span_micro_p: 0.9786, span_micro_r: 0.9725, span_micro_f1: 0.9755, micro_p: 0.9829, micro_r: 0.9472, micro_f1: 0.9647
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1260, loss: 0.4006, span_acc: 0.9919, attr_start_acc: 0.9697, attr_end_acc: 0.9781, span_micro_p: 0.9788, span_micro_r: 0.9729, span_micro_f1: 0.9759, micro_p: 0.9831, micro_r: 0.9476, micro_f1: 0.9650
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 3, steps: 1270, loss: 0.3975, span_acc: 0.9920, attr_start_acc: 0.9703, attr_end_acc: 0.9785, span_micro_p: 0.9790, span_micro_r: 0.9734, span_micro_f1: 0.9762, micro_p: 0.9833, micro_r: 0.9487, micro_f1: 0.9657
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.48 / 97.04 / 97.78), p: (95.6 / 96.52), r: (95.72 / 95.22), f1: (95.66 / 95.87)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 1.748718864459456, 'span_acc': 0.9848413074372335, 'attr_start_acc': 0.9704301075268817, 'attr_end_acc': 0.9778225806451613, 'span_micro_p': 0.9559706470980653, 'span_micro_r': 0.957247828991316, 'span_micro_f1': 0.9566088117489987, 'micro_p': 0.9652114597544338, 'micro_r': 0.9522207267833109, 'micro_f1': 0.9586720867208672, 'category-p/r/f1': {'PRO': (0.85, 0.9444, 0.8947), 'ORG': (0.9533, 0.9405, 0.9469), 'TITLE': (0.9689, 0.9493, 0.959), 'EDU': (0.9808, 0.9623, 0.9715), 'NAME': (0.9903, 1.0, 0.9951), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0), 'LOC': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9586720867208672 / 0.9551830311323981
INFO:train_bert_mtl_span_attr_boundary.py:Best ckpt and saved.
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 3 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.3 / 96.07 / 97.11999999999999), p: (96.26 / 97.34), r: (94.85 / 94.28999999999999), f1: (95.55 / 95.78999999999999)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 0.6836779597420363, 'span_acc': 0.9830474268415742, 'attr_start_acc': 0.9607361963190184, 'attr_end_acc': 0.9711656441717792, 'span_micro_p': 0.962640099626401, 'span_micro_r': 0.9484662576687116, 'span_micro_f1': 0.9555006180469716, 'micro_p': 0.9734008866371121, 'micro_r': 0.9429447852760736, 'micro_f1': 0.9579308195699595, 'category-p/r/f1': {'LOC': (1.0, 0.8333, 0.9091), 'ORG': (0.9697, 0.9259, 0.9473), 'TITLE': (0.9692, 0.9378, 0.9532), 'PRO': (0.9429, 1.0, 0.9706), 'EDU': (0.9909, 0.9732, 0.982), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9579308195699595 / 0.9594003747657713
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1280, loss: 0.1005, span_acc: 0.9956, attr_start_acc: 0.9732, attr_end_acc: 0.9866, span_micro_p: 0.9865, span_micro_r: 0.9733, span_micro_f1: 0.9799, micro_p: 1.0000, micro_r: 0.9597, micro_f1: 0.9795
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1290, loss: 0.4693, span_acc: 0.9859, attr_start_acc: 0.9726, attr_end_acc: 0.9824, span_micro_p: 0.9784, span_micro_r: 0.9689, span_micro_f1: 0.9737, micro_p: 0.9899, micro_r: 0.9569, micro_f1: 0.9731
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1300, loss: 0.2876, span_acc: 0.9895, attr_start_acc: 0.9821, attr_end_acc: 0.9843, span_micro_p: 0.9821, span_micro_r: 0.9767, span_micro_f1: 0.9794, micro_p: 0.9908, micro_r: 0.9664, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1310, loss: 0.3829, span_acc: 0.9918, attr_start_acc: 0.9790, attr_end_acc: 0.9805, span_micro_p: 0.9837, span_micro_r: 0.9799, span_micro_f1: 0.9818, micro_p: 0.9896, micro_r: 0.9618, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1320, loss: 0.6908, span_acc: 0.9928, attr_start_acc: 0.9778, attr_end_acc: 0.9824, span_micro_p: 0.9843, span_micro_r: 0.9808, span_micro_f1: 0.9825, micro_p: 0.9898, micro_r: 0.9631, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1330, loss: 0.6310, span_acc: 0.9924, attr_start_acc: 0.9742, attr_end_acc: 0.9798, span_micro_p: 0.9821, span_micro_r: 0.9776, span_micro_f1: 0.9799, micro_p: 0.9862, micro_r: 0.9576, micro_f1: 0.9717
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1340, loss: 0.5186, span_acc: 0.9930, attr_start_acc: 0.9754, attr_end_acc: 0.9815, span_micro_p: 0.9819, span_micro_r: 0.9782, span_micro_f1: 0.9801, micro_p: 0.9864, micro_r: 0.9591, micro_f1: 0.9725
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1350, loss: 0.4363, span_acc: 0.9932, attr_start_acc: 0.9763, attr_end_acc: 0.9817, span_micro_p: 0.9814, span_micro_r: 0.9785, span_micro_f1: 0.9800, micro_p: 0.9863, micro_r: 0.9603, micro_f1: 0.9731
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1360, loss: 0.3383, span_acc: 0.9934, attr_start_acc: 0.9775, attr_end_acc: 0.9824, span_micro_p: 0.9819, span_micro_r: 0.9782, span_micro_f1: 0.9800, micro_p: 0.9866, micro_r: 0.9615, micro_f1: 0.9739
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1370, loss: 0.2492, span_acc: 0.9935, attr_start_acc: 0.9784, attr_end_acc: 0.9828, span_micro_p: 0.9816, span_micro_r: 0.9788, span_micro_f1: 0.9802, micro_p: 0.9868, micro_r: 0.9627, micro_f1: 0.9746
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1380, loss: 0.2619, span_acc: 0.9941, attr_start_acc: 0.9794, attr_end_acc: 0.9835, span_micro_p: 0.9829, span_micro_r: 0.9805, span_micro_f1: 0.9817, micro_p: 0.9876, micro_r: 0.9643, micro_f1: 0.9758
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1390, loss: 0.2643, span_acc: 0.9940, attr_start_acc: 0.9787, attr_end_acc: 0.9829, span_micro_p: 0.9836, span_micro_r: 0.9805, span_micro_f1: 0.9820, micro_p: 0.9873, micro_r: 0.9640, micro_f1: 0.9755
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1400, loss: 0.2453, span_acc: 0.9940, attr_start_acc: 0.9788, attr_end_acc: 0.9830, span_micro_p: 0.9834, span_micro_r: 0.9804, span_micro_f1: 0.9819, micro_p: 0.9872, micro_r: 0.9642, micro_f1: 0.9756
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1410, loss: 0.2185, span_acc: 0.9942, attr_start_acc: 0.9790, attr_end_acc: 0.9834, span_micro_p: 0.9842, span_micro_r: 0.9811, span_micro_f1: 0.9826, micro_p: 0.9874, micro_r: 0.9650, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1420, loss: 0.3071, span_acc: 0.9941, attr_start_acc: 0.9792, attr_end_acc: 0.9829, span_micro_p: 0.9836, span_micro_r: 0.9814, span_micro_f1: 0.9825, micro_p: 0.9868, micro_r: 0.9652, micro_f1: 0.9759
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1430, loss: 0.2852, span_acc: 0.9943, attr_start_acc: 0.9800, attr_end_acc: 0.9834, span_micro_p: 0.9842, span_micro_r: 0.9818, span_micro_f1: 0.9830, micro_p: 0.9874, micro_r: 0.9665, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1440, loss: 0.3163, span_acc: 0.9943, attr_start_acc: 0.9801, attr_end_acc: 0.9833, span_micro_p: 0.9840, span_micro_r: 0.9815, span_micro_f1: 0.9827, micro_p: 0.9877, micro_r: 0.9666, micro_f1: 0.9770
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1450, loss: 0.3921, span_acc: 0.9940, attr_start_acc: 0.9797, attr_end_acc: 0.9839, span_micro_p: 0.9832, span_micro_r: 0.9814, span_micro_f1: 0.9823, micro_p: 0.9868, micro_r: 0.9662, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1460, loss: 0.3775, span_acc: 0.9940, attr_start_acc: 0.9792, attr_end_acc: 0.9839, span_micro_p: 0.9835, span_micro_r: 0.9810, span_micro_f1: 0.9823, micro_p: 0.9871, micro_r: 0.9659, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1470, loss: 0.3520, span_acc: 0.9941, attr_start_acc: 0.9793, attr_end_acc: 0.9837, span_micro_p: 0.9835, span_micro_r: 0.9815, span_micro_f1: 0.9825, micro_p: 0.9871, micro_r: 0.9658, micro_f1: 0.9763
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1480, loss: 0.3310, span_acc: 0.9943, attr_start_acc: 0.9791, attr_end_acc: 0.9833, span_micro_p: 0.9840, span_micro_r: 0.9818, span_micro_f1: 0.9829, micro_p: 0.9874, micro_r: 0.9653, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1490, loss: 0.3145, span_acc: 0.9944, attr_start_acc: 0.9793, attr_end_acc: 0.9835, span_micro_p: 0.9840, span_micro_r: 0.9821, span_micro_f1: 0.9830, micro_p: 0.9876, micro_r: 0.9657, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1500, loss: 0.2668, span_acc: 0.9946, attr_start_acc: 0.9788, attr_end_acc: 0.9837, span_micro_p: 0.9846, span_micro_r: 0.9828, span_micro_f1: 0.9837, micro_p: 0.9878, micro_r: 0.9656, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1510, loss: 0.2495, span_acc: 0.9947, attr_start_acc: 0.9790, attr_end_acc: 0.9836, span_micro_p: 0.9848, span_micro_r: 0.9831, span_micro_f1: 0.9840, micro_p: 0.9875, micro_r: 0.9657, micro_f1: 0.9765
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1520, loss: 0.2943, span_acc: 0.9948, attr_start_acc: 0.9796, attr_end_acc: 0.9834, span_micro_p: 0.9851, span_micro_r: 0.9835, span_micro_f1: 0.9843, micro_p: 0.9878, micro_r: 0.9662, micro_f1: 0.9769
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1530, loss: 0.2861, span_acc: 0.9948, attr_start_acc: 0.9800, attr_end_acc: 0.9838, span_micro_p: 0.9852, span_micro_r: 0.9838, span_micro_f1: 0.9845, micro_p: 0.9878, micro_r: 0.9666, micro_f1: 0.9771
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1540, loss: 0.2992, span_acc: 0.9948, attr_start_acc: 0.9799, attr_end_acc: 0.9839, span_micro_p: 0.9852, span_micro_r: 0.9833, span_micro_f1: 0.9843, micro_p: 0.9880, micro_r: 0.9667, micro_f1: 0.9772
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1550, loss: 0.3410, span_acc: 0.9945, attr_start_acc: 0.9796, attr_end_acc: 0.9837, span_micro_p: 0.9837, span_micro_r: 0.9826, span_micro_f1: 0.9831, micro_p: 0.9876, micro_r: 0.9663, micro_f1: 0.9768
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1560, loss: 0.3567, span_acc: 0.9945, attr_start_acc: 0.9793, attr_end_acc: 0.9839, span_micro_p: 0.9835, span_micro_r: 0.9822, span_micro_f1: 0.9829, micro_p: 0.9876, micro_r: 0.9661, micro_f1: 0.9767
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1570, loss: 0.3787, span_acc: 0.9943, attr_start_acc: 0.9788, attr_end_acc: 0.9834, span_micro_p: 0.9832, span_micro_r: 0.9818, span_micro_f1: 0.9825, micro_p: 0.9873, micro_r: 0.9652, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1580, loss: 0.3995, span_acc: 0.9942, attr_start_acc: 0.9785, attr_end_acc: 0.9832, span_micro_p: 0.9832, span_micro_r: 0.9816, span_micro_f1: 0.9824, micro_p: 0.9872, micro_r: 0.9650, micro_f1: 0.9759
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 4, steps: 1590, loss: 0.4124, span_acc: 0.9943, attr_start_acc: 0.9784, attr_end_acc: 0.9835, span_micro_p: 0.9833, span_micro_r: 0.9816, span_micro_f1: 0.9825, micro_p: 0.9875, micro_r: 0.9650, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 val ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (98.45 / 97.18 / 97.58), p: (95.26 / 95.78999999999999), r: (96.59 / 95.02000000000001), f1: (95.92 / 95.41)
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation result: {'loss': 2.8779466105846296, 'span_acc': 0.9844860255802937, 'attr_start_acc': 0.9717741935483871, 'attr_end_acc': 0.9758064516129032, 'span_micro_p': 0.9525691699604744, 'span_micro_r': 0.9659318637274549, 'span_micro_f1': 0.9592039800995025, 'micro_p': 0.9579375848032564, 'micro_r': 0.9502018842530283, 'micro_f1': 0.954054054054054, 'category-p/r/f1': {'LOC': (0, 0.0, 0), 'PRO': (0.8421, 0.8889, 0.8649), 'ORG': (0.9443, 0.9443, 0.9443), 'TITLE': (0.9602, 0.9449, 0.9525), 'EDU': (0.972, 0.9811, 0.9765), 'CONT': (1.0, 0.9697, 0.9846), 'NAME': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.954054054054054 / 0.9586720867208672
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 4 test ===
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 10 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 20 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 30 finished
INFO:train_bert_mtl_span_attr_boundary.py:Evaluation...Batches: 40 finished
INFO:train_bert_mtl_span_attr_boundary.py:acc: (97.69 / 96.44 / 96.87), p: (95.16 / 96.48), r: (95.28 / 94.11), f1: (95.22 / 95.28)
INFO:train_bert_mtl_span_attr_boundary.py:Test result: {'loss': 1.546140820725159, 'span_acc': 0.9768920282542886, 'attr_start_acc': 0.9644171779141104, 'attr_end_acc': 0.9687116564417177, 'span_micro_p': 0.9515931372549019, 'span_micro_r': 0.9527607361963191, 'span_micro_f1': 0.9521765787860208, 'micro_p': 0.9647798742138365, 'micro_r': 0.9411042944785276, 'micro_f1': 0.9527950310559007, 'category-p/r/f1': {'LOC': (1.0, 0.1667, 0.2858), 'PRO': (0.9643, 0.8182, 0.8853), 'TITLE': (0.9552, 0.9391, 0.9471), 'ORG': (0.9628, 0.9349, 0.9486), 'EDU': (0.991, 0.9821, 0.9865), 'NAME': (1.0, 1.0, 1.0), 'CONT': (1.0, 1.0, 1.0), 'RACE': (1.0, 1.0, 1.0)}}.
INFO:train_bert_mtl_span_attr_boundary.py:Metric micro_f1 current / best: 0.9527950310559007 / 0.9594003747657713
INFO:train_bert_mtl_span_attr_boundary.py:=== Epoch 5 train ===
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1600, loss: -0.1142, span_acc: 0.9971, attr_start_acc: 0.9787, attr_end_acc: 0.9894, span_micro_p: 0.9947, span_micro_r: 0.9841, span_micro_f1: 0.9894, micro_p: 0.9892, micro_r: 0.9787, micro_f1: 0.9840
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1610, loss: 0.0560, span_acc: 0.9954, attr_start_acc: 0.9805, attr_end_acc: 0.9805, span_micro_p: 0.9951, span_micro_r: 0.9887, span_micro_f1: 0.9919, micro_p: 0.9933, micro_r: 0.9707, micro_f1: 0.9819
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1620, loss: 0.1819, span_acc: 0.9952, attr_start_acc: 0.9782, attr_end_acc: 0.9846, span_micro_p: 0.9937, span_micro_r: 0.9892, span_micro_f1: 0.9914, micro_p: 0.9916, micro_r: 0.9691, micro_f1: 0.9802
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1630, loss: 0.1143, span_acc: 0.9959, attr_start_acc: 0.9785, attr_end_acc: 0.9859, span_micro_p: 0.9946, span_micro_r: 0.9900, span_micro_f1: 0.9923, micro_p: 0.9931, micro_r: 0.9691, micro_f1: 0.9810
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1640, loss: 0.0761, span_acc: 0.9956, attr_start_acc: 0.9768, attr_end_acc: 0.9838, span_micro_p: 0.9930, span_micro_r: 0.9893, span_micro_f1: 0.9911, micro_p: 0.9901, micro_r: 0.9671, micro_f1: 0.9785
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1650, loss: 0.0137, span_acc: 0.9959, attr_start_acc: 0.9775, attr_end_acc: 0.9838, span_micro_p: 0.9915, span_micro_r: 0.9897, span_micro_f1: 0.9906, micro_p: 0.9885, micro_r: 0.9671, micro_f1: 0.9777
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1660, loss: -0.0881, span_acc: 0.9961, attr_start_acc: 0.9777, attr_end_acc: 0.9828, span_micro_p: 0.9916, span_micro_r: 0.9884, span_micro_f1: 0.9900, micro_p: 0.9891, micro_r: 0.9671, micro_f1: 0.9780
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1670, loss: 0.1424, span_acc: 0.9961, attr_start_acc: 0.9780, attr_end_acc: 0.9836, span_micro_p: 0.9906, span_micro_r: 0.9875, span_micro_f1: 0.9890, micro_p: 0.9884, micro_r: 0.9669, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1680, loss: 0.1413, span_acc: 0.9961, attr_start_acc: 0.9780, attr_end_acc: 0.9832, span_micro_p: 0.9901, span_micro_r: 0.9866, span_micro_f1: 0.9883, micro_p: 0.9898, micro_r: 0.9664, micro_f1: 0.9780
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1690, loss: 0.1441, span_acc: 0.9962, attr_start_acc: 0.9790, attr_end_acc: 0.9836, span_micro_p: 0.9897, span_micro_r: 0.9868, span_micro_f1: 0.9882, micro_p: 0.9896, micro_r: 0.9674, micro_f1: 0.9784
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1700, loss: 0.2478, span_acc: 0.9960, attr_start_acc: 0.9787, attr_end_acc: 0.9829, span_micro_p: 0.9886, span_micro_r: 0.9858, span_micro_f1: 0.9872, micro_p: 0.9890, micro_r: 0.9663, micro_f1: 0.9775
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1710, loss: 0.2378, span_acc: 0.9957, attr_start_acc: 0.9777, attr_end_acc: 0.9821, span_micro_p: 0.9878, span_micro_r: 0.9846, span_micro_f1: 0.9862, micro_p: 0.9884, micro_r: 0.9646, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1720, loss: 0.2621, span_acc: 0.9958, attr_start_acc: 0.9780, attr_end_acc: 0.9819, span_micro_p: 0.9879, span_micro_r: 0.9848, span_micro_f1: 0.9864, micro_p: 0.9878, micro_r: 0.9644, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1730, loss: 0.2606, span_acc: 0.9960, attr_start_acc: 0.9790, attr_end_acc: 0.9828, span_micro_p: 0.9880, span_micro_r: 0.9851, span_micro_f1: 0.9866, micro_p: 0.9874, micro_r: 0.9649, micro_f1: 0.9760
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1740, loss: 0.2736, span_acc: 0.9957, attr_start_acc: 0.9790, attr_end_acc: 0.9829, span_micro_p: 0.9868, span_micro_r: 0.9844, span_micro_f1: 0.9856, micro_p: 0.9872, micro_r: 0.9645, micro_f1: 0.9757
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1750, loss: 0.3284, span_acc: 0.9952, attr_start_acc: 0.9794, attr_end_acc: 0.9830, span_micro_p: 0.9872, span_micro_r: 0.9845, span_micro_f1: 0.9859, micro_p: 0.9875, micro_r: 0.9650, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1760, loss: 0.2727, span_acc: 0.9955, attr_start_acc: 0.9793, attr_end_acc: 0.9829, span_micro_p: 0.9878, span_micro_r: 0.9852, span_micro_f1: 0.9865, micro_p: 0.9877, micro_r: 0.9650, micro_f1: 0.9762
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1770, loss: 0.4476, span_acc: 0.9954, attr_start_acc: 0.9787, attr_end_acc: 0.9828, span_micro_p: 0.9879, span_micro_r: 0.9855, span_micro_f1: 0.9867, micro_p: 0.9878, micro_r: 0.9646, micro_f1: 0.9761
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1780, loss: 0.4392, span_acc: 0.9955, attr_start_acc: 0.9789, attr_end_acc: 0.9829, span_micro_p: 0.9884, span_micro_r: 0.9857, span_micro_f1: 0.9871, micro_p: 0.9885, micro_r: 0.9647, micro_f1: 0.9764
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1790, loss: 0.4102, span_acc: 0.9957, attr_start_acc: 0.9798, attr_end_acc: 0.9832, span_micro_p: 0.9888, span_micro_r: 0.9864, span_micro_f1: 0.9876, micro_p: 0.9890, micro_r: 0.9657, micro_f1: 0.9772
INFO:train_bert_mtl_span_attr_boundary.py:Training...Epoches: 5, steps: 1800, loss: 0.3856, span_acc: 0.9957, attr_start_acc: 0.9797, attr_end_acc: 0.9835, span_micro_p: 0.9888, span_micro_r: 0.9863, span_micro_f1: 0.9875, micro_p: 0.9892, micro_r: 0.9661, micro_f1: 0.9775
W0109 15:15:06.451583 34208 init.cc:226] Warning: PaddlePaddle catches a failure signal, it may not work properly
W0109 15:15:06.451663 34208 init.cc:228] You could check whether you killed PaddlePaddle thread/process accidentally or report the case to PaddlePaddle
W0109 15:15:06.451676 34208 init.cc:231] The detail failure signal is:

W0109 15:15:06.451685 34208 init.cc:234] *** Aborted at 1610176506 (unix time) try "date -d @1610176506" if you are using GNU date ***
W0109 15:15:06.454392 34208 init.cc:234] PC: @                0x0 (unknown)
W0109 15:15:06.485023 34208 init.cc:234] *** SIGTERM (@0x3ec0000a5e3) received by PID 34208 (TID 0x7fdc7c7e6740) from PID 42467; stack trace: ***
W0109 15:15:06.488685 34208 init.cc:234]     @     0x7fdc7c3c95e0 (unknown)
W0109 15:15:06.516249 34208 init.cc:234]     @     0x7fdc6387c742 at::TensorIterator::compute_names()
W0109 15:15:06.529650 34208 init.cc:234]     @     0x7fdc63884fca at::TensorIterator::build()
W0109 15:15:06.540951 34208 init.cc:234]     @     0x7fdc6388565d at::TensorIterator::TensorIterator()
W0109 15:15:06.551182 34208 init.cc:234]     @     0x7fdc6388671b at::TensorIterator::reduce_op()
W0109 15:15:06.562016 34208 init.cc:234]     @     0x7fdc2e0762ec at::native::make_reduction()
W0109 15:15:06.564656 34208 init.cc:234]     @     0x7fdc2e077753 at::native::max_kernel_impl()
W0109 15:15:06.580130 34208 init.cc:234]     @     0x7fdc6385f810 _ZN2at6native12DispatchStubIPFvRNS_6TensorES3_RKS2_lbENS0_8max_stubEEclIJS3_S3_S5_RlRbEEEvN3c1010DeviceTypeEDpOT_
W0109 15:15:06.596359 34208 init.cc:234]     @     0x7fdc6385bbd2 at::native::max_out()
W0109 15:15:06.611346 34208 init.cc:234]     @     0x7fdc6385c77f at::native::max()
W0109 15:15:06.621197 34208 init.cc:234]     @     0x7fdc63c95047 at::TypeDefault::max_dim()
W0109 15:15:06.633792 34208 init.cc:234]     @     0x7fdc63b13544 _ZN3c104impl28wrap_kernel_functor_unboxed_INS0_6detail31WrapFunctionIntoRuntimeFunctor_IPFSt5tupleIJN2at6TensorES6_EERKS6_lbES7_NS_4guts8typelist8typelistIJS9_lbEEEEESA_E4callEPNS_14OperatorKernelES9_lb
W0109 15:15:06.641816 34208 init.cc:234]     @     0x7fdc63d36944 at::Tensor::max()
W0109 15:15:06.649744 34208 init.cc:234]     @     0x7fdc637e3229 at::native::max_values()
W0109 15:15:06.660604 34208 init.cc:234]     @     0x7fdc63c951a5 at::TypeDefault::max_values()
W0109 15:15:06.667033 34208 init.cc:234]     @     0x7fdc63455557 _ZN3c104impl28wrap_kernel_functor_unboxed_INS0_6detail31WrapFunctionIntoRuntimeFunctor_IPFN2at6TensorERKS5_NS_8ArrayRefIlEEbES5_NS_4guts8typelist8typelistIJS7_S9_bEEEEESA_E4callEPNS_14OperatorKernelES7_S9_b
W0109 15:15:06.675284 34208 init.cc:234]     @     0x7fdc63bfafb1 at::max_values()
W0109 15:15:06.684031 34208 init.cc:234]     @     0x7fdc637e002e at::native::logsumexp_out()
W0109 15:15:06.692134 34208 init.cc:234]     @     0x7fdc637e0e41 at::native::logsumexp()
W0109 15:15:06.700430 34208 init.cc:234]     @     0x7fdc63c94a15 at::TypeDefault::logsumexp()
W0109 15:15:06.706682 34208 init.cc:234]     @     0x7fdc63455557 _ZN3c104impl28wrap_kernel_functor_unboxed_INS0_6detail31WrapFunctionIntoRuntimeFunctor_IPFN2at6TensorERKS5_NS_8ArrayRefIlEEbES5_NS_4guts8typelist8typelistIJS7_S9_bEEEEESA_E4callEPNS_14OperatorKernelES7_S9_b
W0109 15:15:06.714993 34208 init.cc:234]     @     0x7fdc63bfb771 at::logsumexp()
W0109 15:15:06.722440 34208 init.cc:234]     @     0x7fdc6584d5cd torch::autograd::VariableType::logsumexp()
W0109 15:15:06.728662 34208 init.cc:234]     @     0x7fdc63455557 _ZN3c104impl28wrap_kernel_functor_unboxed_INS0_6detail31WrapFunctionIntoRuntimeFunctor_IPFN2at6TensorERKS5_NS_8ArrayRefIlEEbES5_NS_4guts8typelist8typelistIJS7_S9_bEEEEESA_E4callEPNS_14OperatorKernelES7_S9_b
W0109 15:15:06.736820 34208 init.cc:234]     @     0x7fdc63d4a771 at::Tensor::logsumexp()
W0109 15:15:06.748145 34208 init.cc:234]     @     0x7fdc732d7174 torch::autograd::THPVariable_logsumexp()
W0109 15:15:06.748486 34208 init.cc:234]     @     0x561974113d36 _PyMethodDef_RawFastCallKeywords
W0109 15:15:06.748772 34208 init.cc:234]     @     0x561974113db1 _PyCFunction_FastCallKeywords
W0109 15:15:06.749064 34208 init.cc:234]     @     0x56197417fa85 _PyEval_EvalFrameDefault
W0109 15:15:06.749322 34208 init.cc:234]     @     0x56197411320b _PyFunction_FastCallKeywords
W0109 15:15:06.749604 34208 init.cc:234]     @     0x56197417f229 _PyEval_EvalFrameDefault
W0109 15:15:06.749867 34208 init.cc:234]     @     0x5619740c32b9 _PyEval_EvalCodeWithName
