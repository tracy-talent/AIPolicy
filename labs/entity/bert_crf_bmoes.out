nohup: ignoring input
2020-10-27 22:42:42.658687: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-10-27 22:42:44 - INFO - train_bert_crf.py - running train_bert_crf.py --pretrain_path /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext --metric micro_f1 --dataset policy --tagscheme bio --use_crf --batch_size 16 --lr 1e-3 --bert_lr 3e-5 --weight_decay 0 --warmup_step 0 --max_length 256 --max_epoch 20 --optimizer adam
train_bert_crf.py:109: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
  logger.warn("Val file {} does not exist! Use test file instead".format(args.val_file))
2020-10-27 22:42:44 - WARNING - train_bert_crf.py - Val file /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/val.char.bio does not exist! Use test file instead
2020-10-27 22:42:44 - INFO - train_bert_crf.py - Arguments:
2020-10-27 22:42:44 - INFO - train_bert_crf.py - pretrain_path: /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext
2020-10-27 22:42:44 - INFO - train_bert_crf.py - ckpt: policy_bio_bert_crf
2020-10-27 22:42:44 - INFO - train_bert_crf.py - only_test: False
2020-10-27 22:42:44 - INFO - train_bert_crf.py - use_lstm: False
2020-10-27 22:42:44 - INFO - train_bert_crf.py - use_crf: True
2020-10-27 22:42:44 - INFO - train_bert_crf.py - tagscheme: bio
2020-10-27 22:42:44 - INFO - train_bert_crf.py - metric: micro_f1
2020-10-27 22:42:44 - INFO - train_bert_crf.py - dataset: policy
2020-10-27 22:42:44 - INFO - train_bert_crf.py - train_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/train.char.bio
2020-10-27 22:42:44 - INFO - train_bert_crf.py - val_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/test.char.bio
2020-10-27 22:42:44 - INFO - train_bert_crf.py - test_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/test.char.bio
2020-10-27 22:42:44 - INFO - train_bert_crf.py - tag2id_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy/tag2id.bio
2020-10-27 22:42:44 - INFO - train_bert_crf.py - batch_size: 16
2020-10-27 22:42:44 - INFO - train_bert_crf.py - lr: 0.001
2020-10-27 22:42:44 - INFO - train_bert_crf.py - bert_lr: 3e-05
2020-10-27 22:42:44 - INFO - train_bert_crf.py - optimizer: adam
2020-10-27 22:42:44 - INFO - train_bert_crf.py - weight_decay: 0.0
2020-10-27 22:42:44 - INFO - train_bert_crf.py - warmup_step: 0
2020-10-27 22:42:44 - INFO - train_bert_crf.py - max_length: 256
2020-10-27 22:42:44 - INFO - train_bert_crf.py - max_epoch: 20
2020-10-27 22:42:52 - INFO - train_bert_crf.py - === Epoch 0 train ===
INFO:train_bert_crf.py:=== Epoch 0 train ===
2020-10-27 22:43:01 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 5, loss: 2.6365, acc: 0.0255, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 5, loss: 2.6365, acc: 0.0255, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 22:43:10 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 10, loss: 2.1762, acc: 0.0546, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 10, loss: 2.1762, acc: 0.0546, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 22:43:19 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 15, loss: 1.9106, acc: 0.1182, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 15, loss: 1.9106, acc: 0.1182, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 22:43:27 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 20, loss: 1.7266, acc: 0.1958, micro_p: 0.0109, micro_r: 0.0056, micro_f1: 0.0074
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 20, loss: 1.7266, acc: 0.1958, micro_p: 0.0109, micro_r: 0.0056, micro_f1: 0.0074
2020-10-27 22:43:37 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 25, loss: 1.5723, acc: 0.2409, micro_p: 0.0622, micro_r: 0.0283, micro_f1: 0.0389
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 25, loss: 1.5723, acc: 0.2409, micro_p: 0.0622, micro_r: 0.0283, micro_f1: 0.0389
2020-10-27 22:43:43 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 30, loss: 1.4508, acc: 0.2869, micro_p: 0.1310, micro_r: 0.0608, micro_f1: 0.0831
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 30, loss: 1.4508, acc: 0.2869, micro_p: 0.1310, micro_r: 0.0608, micro_f1: 0.0831
2020-10-27 22:43:47 - INFO - train_bert_crf.py - === Epoch 0 val ===
INFO:train_bert_crf.py:=== Epoch 0 val ===
2020-10-27 22:43:53 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.6740819209039548, 'micro_p': 0.6148867313915858, 'micro_r': 0.33687943262411346, 'micro_f1': 0.4352806414662085}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.6740819209039548, 'micro_p': 0.6148867313915858, 'micro_r': 0.33687943262411346, 'micro_f1': 0.4352806414662085}.
2020-10-27 22:43:53 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.4352806414662085 / 0
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.4352806414662085 / 0
2020-10-27 22:43:53 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 22:43:55 - INFO - train_bert_crf.py - === Epoch 1 train ===
INFO:train_bert_crf.py:=== Epoch 1 train ===
2020-10-27 22:44:00 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 35, loss: 0.6740, acc: 0.6621, micro_p: 0.6111, micro_r: 0.2907, micro_f1: 0.3940
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 35, loss: 0.6740, acc: 0.6621, micro_p: 0.6111, micro_r: 0.2907, micro_f1: 0.3940
2020-10-27 22:44:48 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 40, loss: 0.5575, acc: 0.6699, micro_p: 0.6119, micro_r: 0.3594, micro_f1: 0.4528
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 40, loss: 0.5575, acc: 0.6699, micro_p: 0.6119, micro_r: 0.3594, micro_f1: 0.4528
2020-10-27 22:46:07 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 45, loss: 0.5223, acc: 0.6832, micro_p: 0.6016, micro_r: 0.3992, micro_f1: 0.4799
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 45, loss: 0.5223, acc: 0.6832, micro_p: 0.6016, micro_r: 0.3992, micro_f1: 0.4799
2020-10-27 22:47:21 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 50, loss: 0.4955, acc: 0.7005, micro_p: 0.6161, micro_r: 0.4365, micro_f1: 0.5109
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 50, loss: 0.4955, acc: 0.7005, micro_p: 0.6161, micro_r: 0.4365, micro_f1: 0.5109
2020-10-27 22:48:34 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 55, loss: 0.4726, acc: 0.7142, micro_p: 0.6272, micro_r: 0.4682, micro_f1: 0.5361
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 55, loss: 0.4726, acc: 0.7142, micro_p: 0.6272, micro_r: 0.4682, micro_f1: 0.5361
2020-10-27 22:49:51 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 60, loss: 0.4555, acc: 0.7204, micro_p: 0.6257, micro_r: 0.4875, micro_f1: 0.5481
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 60, loss: 0.4555, acc: 0.7204, micro_p: 0.6257, micro_r: 0.4875, micro_f1: 0.5481
2020-10-27 22:50:49 - INFO - train_bert_crf.py - === Epoch 1 val ===
INFO:train_bert_crf.py:=== Epoch 1 val ===
2020-10-27 22:51:43 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8502824858757062, 'micro_p': 0.6845753899480069, 'micro_r': 0.700354609929078, 'micro_f1': 0.6923751095530236}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8502824858757062, 'micro_p': 0.6845753899480069, 'micro_r': 0.700354609929078, 'micro_f1': 0.6923751095530236}.
2020-10-27 22:51:43 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.6923751095530236 / 0.4352806414662085
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.6923751095530236 / 0.4352806414662085
2020-10-27 22:51:43 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 22:51:49 - INFO - train_bert_crf.py - === Epoch 2 train ===
INFO:train_bert_crf.py:=== Epoch 2 train ===
2020-10-27 22:52:15 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 65, loss: 0.2407, acc: 0.8873, micro_p: 0.8409, micro_r: 0.7255, micro_f1: 0.7789
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 65, loss: 0.2407, acc: 0.8873, micro_p: 0.8409, micro_r: 0.7255, micro_f1: 0.7789
2020-10-27 22:53:55 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 70, loss: 0.2506, acc: 0.8876, micro_p: 0.7737, micro_r: 0.7312, micro_f1: 0.7518
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 70, loss: 0.2506, acc: 0.8876, micro_p: 0.7737, micro_r: 0.7312, micro_f1: 0.7518
2020-10-27 22:55:15 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 75, loss: 0.2422, acc: 0.8706, micro_p: 0.7837, micro_r: 0.7196, micro_f1: 0.7503
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 75, loss: 0.2422, acc: 0.8706, micro_p: 0.7837, micro_r: 0.7196, micro_f1: 0.7503
2020-10-27 22:56:32 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 80, loss: 0.2239, acc: 0.8860, micro_p: 0.7846, micro_r: 0.7394, micro_f1: 0.7613
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 80, loss: 0.2239, acc: 0.8860, micro_p: 0.7846, micro_r: 0.7394, micro_f1: 0.7613
2020-10-27 22:57:53 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 85, loss: 0.2044, acc: 0.8900, micro_p: 0.7903, micro_r: 0.7493, micro_f1: 0.7693
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 85, loss: 0.2044, acc: 0.8900, micro_p: 0.7903, micro_r: 0.7493, micro_f1: 0.7693
2020-10-27 22:59:19 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 90, loss: 0.2022, acc: 0.8848, micro_p: 0.7860, micro_r: 0.7462, micro_f1: 0.7656
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 90, loss: 0.2022, acc: 0.8848, micro_p: 0.7860, micro_r: 0.7462, micro_f1: 0.7656
2020-10-27 23:00:48 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 95, loss: 0.2012, acc: 0.8818, micro_p: 0.7879, micro_r: 0.7476, micro_f1: 0.7672
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 95, loss: 0.2012, acc: 0.8818, micro_p: 0.7879, micro_r: 0.7476, micro_f1: 0.7672
2020-10-27 23:01:06 - INFO - train_bert_crf.py - === Epoch 2 val ===
INFO:train_bert_crf.py:=== Epoch 2 val ===
2020-10-27 23:01:59 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8859463276836158, 'micro_p': 0.7385398981324278, 'micro_r': 0.7712765957446809, 'micro_f1': 0.7545533391153512}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8859463276836158, 'micro_p': 0.7385398981324278, 'micro_r': 0.7712765957446809, 'micro_f1': 0.7545533391153512}.
2020-10-27 23:01:59 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.7545533391153512 / 0.6923751095530236
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.7545533391153512 / 0.6923751095530236
2020-10-27 23:01:59 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 23:02:13 - INFO - train_bert_crf.py - === Epoch 3 train ===
INFO:train_bert_crf.py:=== Epoch 3 train ===
2020-10-27 23:03:26 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 100, loss: 0.1229, acc: 0.9467, micro_p: 0.7966, micro_r: 0.8160, micro_f1: 0.8062
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 100, loss: 0.1229, acc: 0.9467, micro_p: 0.7966, micro_r: 0.8160, micro_f1: 0.8062
2020-10-27 23:04:48 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 105, loss: 0.1141, acc: 0.9449, micro_p: 0.8343, micro_r: 0.8293, micro_f1: 0.8318
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 105, loss: 0.1141, acc: 0.9449, micro_p: 0.8343, micro_r: 0.8293, micro_f1: 0.8318
2020-10-27 23:06:03 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 110, loss: 0.1122, acc: 0.9390, micro_p: 0.8497, micro_r: 0.8244, micro_f1: 0.8369
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 110, loss: 0.1122, acc: 0.9390, micro_p: 0.8497, micro_r: 0.8244, micro_f1: 0.8369
2020-10-27 23:07:30 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 115, loss: 0.1109, acc: 0.9400, micro_p: 0.8566, micro_r: 0.8348, micro_f1: 0.8456
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 115, loss: 0.1109, acc: 0.9400, micro_p: 0.8566, micro_r: 0.8348, micro_f1: 0.8456
2020-10-27 23:09:01 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 120, loss: 0.1130, acc: 0.9364, micro_p: 0.8596, micro_r: 0.8363, micro_f1: 0.8478
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 120, loss: 0.1130, acc: 0.9364, micro_p: 0.8596, micro_r: 0.8363, micro_f1: 0.8478
2020-10-27 23:10:30 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 125, loss: 0.1132, acc: 0.9365, micro_p: 0.8585, micro_r: 0.8403, micro_f1: 0.8493
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 125, loss: 0.1132, acc: 0.9365, micro_p: 0.8585, micro_r: 0.8403, micro_f1: 0.8493
2020-10-27 23:11:22 - INFO - train_bert_crf.py - === Epoch 3 val ===
INFO:train_bert_crf.py:=== Epoch 3 val ===
2020-10-27 23:12:24 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8802966101694916, 'micro_p': 0.753448275862069, 'micro_r': 0.774822695035461, 'micro_f1': 0.7639860139860141}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8802966101694916, 'micro_p': 0.753448275862069, 'micro_r': 0.774822695035461, 'micro_f1': 0.7639860139860141}.
2020-10-27 23:12:24 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.7639860139860141 / 0.7545533391153512
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.7639860139860141 / 0.7545533391153512
2020-10-27 23:12:24 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 23:12:54 - INFO - train_bert_crf.py - === Epoch 4 train ===
INFO:train_bert_crf.py:=== Epoch 4 train ===
2020-10-27 23:13:31 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 130, loss: 0.1038, acc: 0.9495, micro_p: 0.8820, micro_r: 0.8765, micro_f1: 0.8793
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 130, loss: 0.1038, acc: 0.9495, micro_p: 0.8820, micro_r: 0.8765, micro_f1: 0.8793
2020-10-27 23:14:53 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 135, loss: 0.0879, acc: 0.9503, micro_p: 0.8818, micro_r: 0.8765, micro_f1: 0.8791
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 135, loss: 0.0879, acc: 0.9503, micro_p: 0.8818, micro_r: 0.8765, micro_f1: 0.8791
2020-10-27 23:16:23 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 140, loss: 0.0812, acc: 0.9493, micro_p: 0.8795, micro_r: 0.8756, micro_f1: 0.8775
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 140, loss: 0.0812, acc: 0.9493, micro_p: 0.8795, micro_r: 0.8756, micro_f1: 0.8775
