nohup: ignoring input
2020-10-27 16:28:22.711619: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-10-27 16:29:20 - INFO - train_bert_crf.py - running train_bert_crf.py --pretrain_path /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext --metric micro_f1 --dataset policy_qmc --tagscheme bmoes --use_lstm --use_crf --batch_size 16 --lr 1e-3 --bert_lr 3e-5 --weight_decay 0 --warmup_step 0 --max_length 256 --max_epoch 20 --optimizer adam
train_bert_crf.py:109: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
  logger.warn("Val file {} does not exist! Use test file instead".format(args.val_file))
2020-10-27 16:29:20 - WARNING - train_bert_crf.py - Val file /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy_qmc/val.char.bmoes does not exist! Use test file instead
2020-10-27 16:29:20 - INFO - train_bert_crf.py - Arguments:
2020-10-27 16:29:20 - INFO - train_bert_crf.py - pretrain_path: /home/liujian/NLP/corpus/transformers/hfl-chinese-bert-wwm-ext
2020-10-27 16:29:20 - INFO - train_bert_crf.py - ckpt: policy_qmc_bmoes_bert_lstm_crf_bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - only_test: False
2020-10-27 16:29:20 - INFO - train_bert_crf.py - use_lstm: True
2020-10-27 16:29:20 - INFO - train_bert_crf.py - use_crf: True
2020-10-27 16:29:20 - INFO - train_bert_crf.py - tagscheme: bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - metric: micro_f1
2020-10-27 16:29:20 - INFO - train_bert_crf.py - dataset: policy_qmc
2020-10-27 16:29:20 - INFO - train_bert_crf.py - train_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy_qmc/train.char.bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - val_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy_qmc/test.char.bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - test_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy_qmc/test.char.bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - tag2id_file: /home/liujian/VSCode/AIPolicy/input/benchmark/ner/policy_qmc/tag2id.bmoes
2020-10-27 16:29:20 - INFO - train_bert_crf.py - batch_size: 16
2020-10-27 16:29:20 - INFO - train_bert_crf.py - lr: 0.001
2020-10-27 16:29:20 - INFO - train_bert_crf.py - bert_lr: 3e-05
2020-10-27 16:29:20 - INFO - train_bert_crf.py - optimizer: adam
2020-10-27 16:29:20 - INFO - train_bert_crf.py - weight_decay: 0.0
2020-10-27 16:29:20 - INFO - train_bert_crf.py - warmup_step: 0
2020-10-27 16:29:20 - INFO - train_bert_crf.py - max_length: 256
2020-10-27 16:29:20 - INFO - train_bert_crf.py - max_epoch: 20
2020-10-27 16:34:13 - INFO - train_bert_crf.py - === Epoch 0 train ===
INFO:train_bert_crf.py:=== Epoch 0 train ===
2020-10-27 16:35:55 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 5, loss: 2.6594, acc: 0.0190, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 5, loss: 2.6594, acc: 0.0190, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 16:37:42 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 10, loss: 2.2024, acc: 0.0586, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 10, loss: 2.2024, acc: 0.0586, micro_p: 0.0000, micro_r: 0.0000, micro_f1: 0.0000
2020-10-27 16:39:44 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 15, loss: 1.9395, acc: 0.1515, micro_p: 0.2500, micro_r: 0.0072, micro_f1: 0.0140
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 15, loss: 1.9395, acc: 0.1515, micro_p: 0.2500, micro_r: 0.0072, micro_f1: 0.0140
2020-10-27 16:41:36 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 20, loss: 1.7054, acc: 0.2232, micro_p: 0.5647, micro_r: 0.0320, micro_f1: 0.0606
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 20, loss: 1.7054, acc: 0.2232, micro_p: 0.5647, micro_r: 0.0320, micro_f1: 0.0606
2020-10-27 16:43:17 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 25, loss: 1.5454, acc: 0.2845, micro_p: 0.6703, micro_r: 0.0672, micro_f1: 0.1221
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 25, loss: 1.5454, acc: 0.2845, micro_p: 0.6703, micro_r: 0.0672, micro_f1: 0.1221
2020-10-27 16:45:01 - INFO - train_bert_crf.py - Training...Epoches: 0, steps: 30, loss: 1.3940, acc: 0.3416, micro_p: 0.7057, micro_r: 0.1234, micro_f1: 0.2100
INFO:train_bert_crf.py:Training...Epoches: 0, steps: 30, loss: 1.3940, acc: 0.3416, micro_p: 0.7057, micro_r: 0.1234, micro_f1: 0.2100
2020-10-27 16:45:50 - INFO - train_bert_crf.py - === Epoch 0 val ===
INFO:train_bert_crf.py:=== Epoch 0 val ===
2020-10-27 16:46:59 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.6892655367231638, 'micro_p': 0.8369230769230769, 'micro_r': 0.48226950354609927, 'micro_f1': 0.6119235095613048}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.6892655367231638, 'micro_p': 0.8369230769230769, 'micro_r': 0.48226950354609927, 'micro_f1': 0.6119235095613048}.
2020-10-27 16:46:59 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.6119235095613048 / 0
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.6119235095613048 / 0
2020-10-27 16:46:59 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 16:47:42 - INFO - train_bert_crf.py - === Epoch 1 train ===
INFO:train_bert_crf.py:=== Epoch 1 train ===
2020-10-27 16:48:53 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 35, loss: 0.5085, acc: 0.7170, micro_p: 0.8515, micro_r: 0.4057, micro_f1: 0.5495
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 35, loss: 0.5085, acc: 0.7170, micro_p: 0.8515, micro_r: 0.4057, micro_f1: 0.5495
2020-10-27 16:50:51 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 40, loss: 0.4599, acc: 0.7484, micro_p: 0.8519, micro_r: 0.4991, micro_f1: 0.6294
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 40, loss: 0.4599, acc: 0.7484, micro_p: 0.8519, micro_r: 0.4991, micro_f1: 0.6294
2020-10-27 16:52:52 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 45, loss: 0.4307, acc: 0.7637, micro_p: 0.8215, micro_r: 0.5396, micro_f1: 0.6514
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 45, loss: 0.4307, acc: 0.7637, micro_p: 0.8215, micro_r: 0.5396, micro_f1: 0.6514
2020-10-27 16:54:39 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 50, loss: 0.4052, acc: 0.7723, micro_p: 0.8226, micro_r: 0.5710, micro_f1: 0.6741
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 50, loss: 0.4052, acc: 0.7723, micro_p: 0.8226, micro_r: 0.5710, micro_f1: 0.6741
2020-10-27 16:56:40 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 55, loss: 0.3906, acc: 0.7850, micro_p: 0.8204, micro_r: 0.5913, micro_f1: 0.6872
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 55, loss: 0.3906, acc: 0.7850, micro_p: 0.8204, micro_r: 0.5913, micro_f1: 0.6872
2020-10-27 16:58:20 - INFO - train_bert_crf.py - Training...Epoches: 1, steps: 60, loss: 0.3788, acc: 0.7860, micro_p: 0.8269, micro_r: 0.6006, micro_f1: 0.6958
INFO:train_bert_crf.py:Training...Epoches: 1, steps: 60, loss: 0.3788, acc: 0.7860, micro_p: 0.8269, micro_r: 0.6006, micro_f1: 0.6958
2020-10-27 16:59:48 - INFO - train_bert_crf.py - === Epoch 1 val ===
INFO:train_bert_crf.py:=== Epoch 1 val ===
2020-10-27 17:00:55 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.7824858757062146, 'micro_p': 0.8767441860465116, 'micro_r': 0.6684397163120568, 'micro_f1': 0.7585513078470824}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.7824858757062146, 'micro_p': 0.8767441860465116, 'micro_r': 0.6684397163120568, 'micro_f1': 0.7585513078470824}.
2020-10-27 17:00:55 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.7585513078470824 / 0.6119235095613048
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.7585513078470824 / 0.6119235095613048
2020-10-27 17:00:55 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:01:36 - INFO - train_bert_crf.py - === Epoch 2 train ===
INFO:train_bert_crf.py:=== Epoch 2 train ===
2020-10-27 17:01:56 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 65, loss: 0.1479, acc: 0.9855, micro_p: 0.9455, micro_r: 0.9286, micro_f1: 0.9369
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 65, loss: 0.1479, acc: 0.9855, micro_p: 0.9455, micro_r: 0.9286, micro_f1: 0.9369
2020-10-27 17:03:31 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 70, loss: 0.1755, acc: 0.8814, micro_p: 0.9298, micro_r: 0.7966, micro_f1: 0.8580
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 70, loss: 0.1755, acc: 0.8814, micro_p: 0.9298, micro_r: 0.7966, micro_f1: 0.8580
2020-10-27 17:05:22 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 75, loss: 0.1968, acc: 0.8785, micro_p: 0.9054, micro_r: 0.7917, micro_f1: 0.8447
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 75, loss: 0.1968, acc: 0.8785, micro_p: 0.9054, micro_r: 0.7917, micro_f1: 0.8447
2020-10-27 17:07:06 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 80, loss: 0.1895, acc: 0.8865, micro_p: 0.9036, micro_r: 0.7879, micro_f1: 0.8418
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 80, loss: 0.1895, acc: 0.8865, micro_p: 0.9036, micro_r: 0.7879, micro_f1: 0.8418
2020-10-27 17:08:51 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 85, loss: 0.1926, acc: 0.8874, micro_p: 0.9098, micro_r: 0.7875, micro_f1: 0.8442
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 85, loss: 0.1926, acc: 0.8874, micro_p: 0.9098, micro_r: 0.7875, micro_f1: 0.8442
2020-10-27 17:10:38 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 90, loss: 0.1880, acc: 0.8887, micro_p: 0.9025, micro_r: 0.7849, micro_f1: 0.8396
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 90, loss: 0.1880, acc: 0.8887, micro_p: 0.9025, micro_r: 0.7849, micro_f1: 0.8396
2020-10-27 17:12:37 - INFO - train_bert_crf.py - Training...Epoches: 2, steps: 95, loss: 0.1888, acc: 0.8889, micro_p: 0.8966, micro_r: 0.7869, micro_f1: 0.8382
INFO:train_bert_crf.py:Training...Epoches: 2, steps: 95, loss: 0.1888, acc: 0.8889, micro_p: 0.8966, micro_r: 0.7869, micro_f1: 0.8382
2020-10-27 17:13:02 - INFO - train_bert_crf.py - === Epoch 2 val ===
INFO:train_bert_crf.py:=== Epoch 2 val ===
2020-10-27 17:14:08 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.881002824858757, 'micro_p': 0.8370786516853933, 'micro_r': 0.7925531914893617, 'micro_f1': 0.8142076502732241}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.881002824858757, 'micro_p': 0.8370786516853933, 'micro_r': 0.7925531914893617, 'micro_f1': 0.8142076502732241}.
2020-10-27 17:14:08 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8142076502732241 / 0.7585513078470824
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8142076502732241 / 0.7585513078470824
2020-10-27 17:14:08 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:14:50 - INFO - train_bert_crf.py - === Epoch 3 train ===
INFO:train_bert_crf.py:=== Epoch 3 train ===
2020-10-27 17:16:12 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 100, loss: 0.0928, acc: 0.9654, micro_p: 0.9301, micro_r: 0.8986, micro_f1: 0.9141
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 100, loss: 0.0928, acc: 0.9654, micro_p: 0.9301, micro_r: 0.8986, micro_f1: 0.9141
2020-10-27 17:18:07 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 105, loss: 0.1056, acc: 0.9447, micro_p: 0.9353, micro_r: 0.8836, micro_f1: 0.9087
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 105, loss: 0.1056, acc: 0.9447, micro_p: 0.9353, micro_r: 0.8836, micro_f1: 0.9087
2020-10-27 17:19:56 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 110, loss: 0.0949, acc: 0.9470, micro_p: 0.9395, micro_r: 0.8833, micro_f1: 0.9106
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 110, loss: 0.0949, acc: 0.9470, micro_p: 0.9395, micro_r: 0.8833, micro_f1: 0.9106
2020-10-27 17:21:42 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 115, loss: 0.0930, acc: 0.9490, micro_p: 0.9382, micro_r: 0.8849, micro_f1: 0.9108
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 115, loss: 0.0930, acc: 0.9490, micro_p: 0.9382, micro_r: 0.8849, micro_f1: 0.9108
2020-10-27 17:23:19 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 120, loss: 0.0989, acc: 0.9442, micro_p: 0.9371, micro_r: 0.8776, micro_f1: 0.9064
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 120, loss: 0.0989, acc: 0.9442, micro_p: 0.9371, micro_r: 0.8776, micro_f1: 0.9064
2020-10-27 17:25:11 - INFO - train_bert_crf.py - Training...Epoches: 3, steps: 125, loss: 0.0980, acc: 0.9475, micro_p: 0.9365, micro_r: 0.8844, micro_f1: 0.9097
INFO:train_bert_crf.py:Training...Epoches: 3, steps: 125, loss: 0.0980, acc: 0.9475, micro_p: 0.9365, micro_r: 0.8844, micro_f1: 0.9097
2020-10-27 17:26:18 - INFO - train_bert_crf.py - === Epoch 3 val ===
INFO:train_bert_crf.py:=== Epoch 3 val ===
2020-10-27 17:27:23 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8771186440677966, 'micro_p': 0.9, 'micro_r': 0.7819148936170213, 'micro_f1': 0.8368121442125238}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8771186440677966, 'micro_p': 0.9, 'micro_r': 0.7819148936170213, 'micro_f1': 0.8368121442125238}.
2020-10-27 17:27:23 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8368121442125238 / 0.8142076502732241
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8368121442125238 / 0.8142076502732241
2020-10-27 17:27:23 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:28:07 - INFO - train_bert_crf.py - === Epoch 4 train ===
INFO:train_bert_crf.py:=== Epoch 4 train ===
2020-10-27 17:28:57 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 130, loss: 0.0893, acc: 0.9462, micro_p: 0.9613, micro_r: 0.8765, micro_f1: 0.9169
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 130, loss: 0.0893, acc: 0.9462, micro_p: 0.9613, micro_r: 0.8765, micro_f1: 0.9169
2020-10-27 17:30:28 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 135, loss: 0.0821, acc: 0.9654, micro_p: 0.9596, micro_r: 0.9117, micro_f1: 0.9350
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 135, loss: 0.0821, acc: 0.9654, micro_p: 0.9596, micro_r: 0.9117, micro_f1: 0.9350
2020-10-27 17:32:21 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 140, loss: 0.0990, acc: 0.9611, micro_p: 0.9491, micro_r: 0.9020, micro_f1: 0.9249
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 140, loss: 0.0990, acc: 0.9611, micro_p: 0.9491, micro_r: 0.9020, micro_f1: 0.9249
2020-10-27 17:34:18 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 145, loss: 0.1017, acc: 0.9565, micro_p: 0.9393, micro_r: 0.8985, micro_f1: 0.9185
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 145, loss: 0.1017, acc: 0.9565, micro_p: 0.9393, micro_r: 0.8985, micro_f1: 0.9185
2020-10-27 17:36:14 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 150, loss: 0.0947, acc: 0.9554, micro_p: 0.9373, micro_r: 0.9025, micro_f1: 0.9196
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 150, loss: 0.0947, acc: 0.9554, micro_p: 0.9373, micro_r: 0.9025, micro_f1: 0.9196
2020-10-27 17:37:50 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 155, loss: 0.0885, acc: 0.9576, micro_p: 0.9434, micro_r: 0.9032, micro_f1: 0.9228
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 155, loss: 0.0885, acc: 0.9576, micro_p: 0.9434, micro_r: 0.9032, micro_f1: 0.9228
2020-10-27 17:39:29 - INFO - train_bert_crf.py - Training...Epoches: 4, steps: 160, loss: 0.0869, acc: 0.9569, micro_p: 0.9439, micro_r: 0.9000, micro_f1: 0.9214
INFO:train_bert_crf.py:Training...Epoches: 4, steps: 160, loss: 0.0869, acc: 0.9569, micro_p: 0.9439, micro_r: 0.9000, micro_f1: 0.9214
2020-10-27 17:39:40 - INFO - train_bert_crf.py - === Epoch 4 val ===
INFO:train_bert_crf.py:=== Epoch 4 val ===
2020-10-27 17:40:44 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8968926553672316, 'micro_p': 0.8848368522072937, 'micro_r': 0.8173758865248227, 'micro_f1': 0.8497695852534562}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8968926553672316, 'micro_p': 0.8848368522072937, 'micro_r': 0.8173758865248227, 'micro_f1': 0.8497695852534562}.
2020-10-27 17:40:44 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8497695852534562 / 0.8368121442125238
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8497695852534562 / 0.8368121442125238
2020-10-27 17:40:44 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:41:23 - INFO - train_bert_crf.py - === Epoch 5 train ===
INFO:train_bert_crf.py:=== Epoch 5 train ===
2020-10-27 17:43:11 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 165, loss: 0.0294, acc: 0.9852, micro_p: 0.9801, micro_r: 0.9636, micro_f1: 0.9718
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 165, loss: 0.0294, acc: 0.9852, micro_p: 0.9801, micro_r: 0.9636, micro_f1: 0.9718
2020-10-27 17:45:00 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 170, loss: 0.0348, acc: 0.9766, micro_p: 0.9744, micro_r: 0.9409, micro_f1: 0.9574
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 170, loss: 0.0348, acc: 0.9766, micro_p: 0.9744, micro_r: 0.9409, micro_f1: 0.9574
2020-10-27 17:46:54 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 175, loss: 0.0383, acc: 0.9747, micro_p: 0.9733, micro_r: 0.9387, micro_f1: 0.9557
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 175, loss: 0.0383, acc: 0.9747, micro_p: 0.9733, micro_r: 0.9387, micro_f1: 0.9557
2020-10-27 17:48:46 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 180, loss: 0.0385, acc: 0.9765, micro_p: 0.9694, micro_r: 0.9387, micro_f1: 0.9538
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 180, loss: 0.0385, acc: 0.9765, micro_p: 0.9694, micro_r: 0.9387, micro_f1: 0.9538
2020-10-27 17:50:25 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 185, loss: 0.0409, acc: 0.9755, micro_p: 0.9694, micro_r: 0.9392, micro_f1: 0.9541
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 185, loss: 0.0409, acc: 0.9755, micro_p: 0.9694, micro_r: 0.9392, micro_f1: 0.9541
2020-10-27 17:52:10 - INFO - train_bert_crf.py - Training...Epoches: 5, steps: 190, loss: 0.0429, acc: 0.9742, micro_p: 0.9659, micro_r: 0.9375, micro_f1: 0.9515
INFO:train_bert_crf.py:Training...Epoches: 5, steps: 190, loss: 0.0429, acc: 0.9742, micro_p: 0.9659, micro_r: 0.9375, micro_f1: 0.9515
2020-10-27 17:52:50 - INFO - train_bert_crf.py - === Epoch 5 val ===
INFO:train_bert_crf.py:=== Epoch 5 val ===
2020-10-27 17:53:54 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.913135593220339, 'micro_p': 0.8713235294117647, 'micro_r': 0.8404255319148937, 'micro_f1': 0.8555956678700362}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.913135593220339, 'micro_p': 0.8713235294117647, 'micro_r': 0.8404255319148937, 'micro_f1': 0.8555956678700362}.
2020-10-27 17:53:54 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8555956678700362 / 0.8497695852534562
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8555956678700362 / 0.8497695852534562
2020-10-27 17:53:54 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 17:54:34 - INFO - train_bert_crf.py - === Epoch 6 train ===
INFO:train_bert_crf.py:=== Epoch 6 train ===
2020-10-27 17:55:37 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 195, loss: 0.0289, acc: 0.9861, micro_p: 0.9817, micro_r: 0.9556, micro_f1: 0.9685
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 195, loss: 0.0289, acc: 0.9861, micro_p: 0.9817, micro_r: 0.9556, micro_f1: 0.9685
2020-10-27 17:57:25 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 200, loss: 0.0369, acc: 0.9874, micro_p: 0.9752, micro_r: 0.9610, micro_f1: 0.9681
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 200, loss: 0.0369, acc: 0.9874, micro_p: 0.9752, micro_r: 0.9610, micro_f1: 0.9681
2020-10-27 17:58:58 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 205, loss: 0.0360, acc: 0.9841, micro_p: 0.9760, micro_r: 0.9583, micro_f1: 0.9671
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 205, loss: 0.0360, acc: 0.9841, micro_p: 0.9760, micro_r: 0.9583, micro_f1: 0.9671
2020-10-27 18:00:50 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 210, loss: 0.0414, acc: 0.9803, micro_p: 0.9667, micro_r: 0.9513, micro_f1: 0.9589
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 210, loss: 0.0414, acc: 0.9803, micro_p: 0.9667, micro_r: 0.9513, micro_f1: 0.9589
2020-10-27 18:02:46 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 215, loss: 0.0369, acc: 0.9825, micro_p: 0.9699, micro_r: 0.9544, micro_f1: 0.9621
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 215, loss: 0.0369, acc: 0.9825, micro_p: 0.9699, micro_r: 0.9544, micro_f1: 0.9621
2020-10-27 18:04:33 - INFO - train_bert_crf.py - Training...Epoches: 6, steps: 220, loss: 0.0375, acc: 0.9804, micro_p: 0.9685, micro_r: 0.9493, micro_f1: 0.9588
INFO:train_bert_crf.py:Training...Epoches: 6, steps: 220, loss: 0.0375, acc: 0.9804, micro_p: 0.9685, micro_r: 0.9493, micro_f1: 0.9588
2020-10-27 18:06:06 - INFO - train_bert_crf.py - === Epoch 6 val ===
INFO:train_bert_crf.py:=== Epoch 6 val ===
2020-10-27 18:07:10 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9103107344632768, 'micro_p': 0.8635547576301615, 'micro_r': 0.8528368794326241, 'micro_f1': 0.8581623550401427}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9103107344632768, 'micro_p': 0.8635547576301615, 'micro_r': 0.8528368794326241, 'micro_f1': 0.8581623550401427}.
2020-10-27 18:07:10 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8581623550401427 / 0.8555956678700362
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8581623550401427 / 0.8555956678700362
2020-10-27 18:07:10 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 18:07:52 - INFO - train_bert_crf.py - === Epoch 7 train ===
INFO:train_bert_crf.py:=== Epoch 7 train ===
2020-10-27 18:08:16 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 225, loss: 0.0491, acc: 0.9575, micro_p: 0.9016, micro_r: 0.9016, micro_f1: 0.9016
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 225, loss: 0.0491, acc: 0.9575, micro_p: 0.9016, micro_r: 0.9016, micro_f1: 0.9016
2020-10-27 18:10:09 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 230, loss: 0.0786, acc: 0.9408, micro_p: 0.9383, micro_r: 0.9122, micro_f1: 0.9251
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 230, loss: 0.0786, acc: 0.9408, micro_p: 0.9383, micro_r: 0.9122, micro_f1: 0.9251
2020-10-27 18:12:04 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 235, loss: 0.0595, acc: 0.9534, micro_p: 0.9583, micro_r: 0.9200, micro_f1: 0.9388
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 235, loss: 0.0595, acc: 0.9534, micro_p: 0.9583, micro_r: 0.9200, micro_f1: 0.9388
2020-10-27 18:13:37 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 240, loss: 0.0482, acc: 0.9632, micro_p: 0.9654, micro_r: 0.9331, micro_f1: 0.9489
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 240, loss: 0.0482, acc: 0.9632, micro_p: 0.9654, micro_r: 0.9331, micro_f1: 0.9489
2020-10-27 18:15:23 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 245, loss: 0.0558, acc: 0.9614, micro_p: 0.9629, micro_r: 0.9326, micro_f1: 0.9475
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 245, loss: 0.0558, acc: 0.9614, micro_p: 0.9629, micro_r: 0.9326, micro_f1: 0.9475
2020-10-27 18:17:00 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 250, loss: 0.0512, acc: 0.9663, micro_p: 0.9654, micro_r: 0.9366, micro_f1: 0.9508
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 250, loss: 0.0512, acc: 0.9663, micro_p: 0.9654, micro_r: 0.9366, micro_f1: 0.9508
2020-10-27 18:18:32 - INFO - train_bert_crf.py - Training...Epoches: 7, steps: 255, loss: 0.0572, acc: 0.9656, micro_p: 0.9655, micro_r: 0.9400, micro_f1: 0.9526
INFO:train_bert_crf.py:Training...Epoches: 7, steps: 255, loss: 0.0572, acc: 0.9656, micro_p: 0.9655, micro_r: 0.9400, micro_f1: 0.9526
2020-10-27 18:19:02 - INFO - train_bert_crf.py - === Epoch 7 val ===
INFO:train_bert_crf.py:=== Epoch 7 val ===
2020-10-27 18:20:08 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.876412429378531, 'micro_p': 0.8714011516314779, 'micro_r': 0.8049645390070922, 'micro_f1': 0.8368663594470046}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.876412429378531, 'micro_p': 0.8714011516314779, 'micro_r': 0.8049645390070922, 'micro_f1': 0.8368663594470046}.
2020-10-27 18:20:08 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8368663594470046 / 0.8581623550401427
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8368663594470046 / 0.8581623550401427
2020-10-27 18:20:08 - INFO - train_bert_crf.py - === Epoch 8 train ===
INFO:train_bert_crf.py:=== Epoch 8 train ===
2020-10-27 18:21:30 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 260, loss: 0.0172, acc: 0.9872, micro_p: 0.9962, micro_r: 0.9707, micro_f1: 0.9833
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 260, loss: 0.0172, acc: 0.9872, micro_p: 0.9962, micro_r: 0.9707, micro_f1: 0.9833
2020-10-27 18:23:12 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 265, loss: 0.0220, acc: 0.9818, micro_p: 0.9804, micro_r: 0.9585, micro_f1: 0.9693
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 265, loss: 0.0220, acc: 0.9818, micro_p: 0.9804, micro_r: 0.9585, micro_f1: 0.9693
2020-10-27 18:25:09 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 270, loss: 0.0260, acc: 0.9870, micro_p: 0.9800, micro_r: 0.9683, micro_f1: 0.9741
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 270, loss: 0.0260, acc: 0.9870, micro_p: 0.9800, micro_r: 0.9683, micro_f1: 0.9741
2020-10-27 18:26:56 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 275, loss: 0.0280, acc: 0.9845, micro_p: 0.9794, micro_r: 0.9659, micro_f1: 0.9726
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 275, loss: 0.0280, acc: 0.9845, micro_p: 0.9794, micro_r: 0.9659, micro_f1: 0.9726
2020-10-27 18:28:37 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 280, loss: 0.0292, acc: 0.9821, micro_p: 0.9788, micro_r: 0.9613, micro_f1: 0.9700
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 280, loss: 0.0292, acc: 0.9821, micro_p: 0.9788, micro_r: 0.9613, micro_f1: 0.9700
2020-10-27 18:30:35 - INFO - train_bert_crf.py - Training...Epoches: 8, steps: 285, loss: 0.0281, acc: 0.9827, micro_p: 0.9764, micro_r: 0.9615, micro_f1: 0.9689
INFO:train_bert_crf.py:Training...Epoches: 8, steps: 285, loss: 0.0281, acc: 0.9827, micro_p: 0.9764, micro_r: 0.9615, micro_f1: 0.9689
2020-10-27 18:31:44 - INFO - train_bert_crf.py - === Epoch 8 val ===
INFO:train_bert_crf.py:=== Epoch 8 val ===
2020-10-27 18:32:53 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8930084745762712, 'micro_p': 0.8655616942909761, 'micro_r': 0.8333333333333334, 'micro_f1': 0.849141824751581}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8930084745762712, 'micro_p': 0.8655616942909761, 'micro_r': 0.8333333333333334, 'micro_f1': 0.849141824751581}.
2020-10-27 18:32:53 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.849141824751581 / 0.8581623550401427
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.849141824751581 / 0.8581623550401427
2020-10-27 18:32:53 - INFO - train_bert_crf.py - === Epoch 9 train ===
INFO:train_bert_crf.py:=== Epoch 9 train ===
2020-10-27 18:33:37 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 290, loss: 0.0228, acc: 0.9881, micro_p: 0.9910, micro_r: 0.9821, micro_f1: 0.9865
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 290, loss: 0.0228, acc: 0.9881, micro_p: 0.9910, micro_r: 0.9821, micro_f1: 0.9865
2020-10-27 18:35:23 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 295, loss: 0.0210, acc: 0.9925, micro_p: 0.9780, micro_r: 0.9760, micro_f1: 0.9770
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 295, loss: 0.0210, acc: 0.9925, micro_p: 0.9780, micro_r: 0.9760, micro_f1: 0.9770
2020-10-27 18:37:09 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 300, loss: 0.0242, acc: 0.9905, micro_p: 0.9817, micro_r: 0.9750, micro_f1: 0.9783
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 300, loss: 0.0242, acc: 0.9905, micro_p: 0.9817, micro_r: 0.9750, micro_f1: 0.9783
2020-10-27 18:39:02 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 305, loss: 0.0253, acc: 0.9872, micro_p: 0.9820, micro_r: 0.9716, micro_f1: 0.9767
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 305, loss: 0.0253, acc: 0.9872, micro_p: 0.9820, micro_r: 0.9716, micro_f1: 0.9767
2020-10-27 18:40:42 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 310, loss: 0.0273, acc: 0.9864, micro_p: 0.9810, micro_r: 0.9694, micro_f1: 0.9752
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 310, loss: 0.0273, acc: 0.9864, micro_p: 0.9810, micro_r: 0.9694, micro_f1: 0.9752
2020-10-27 18:42:30 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 315, loss: 0.0250, acc: 0.9874, micro_p: 0.9808, micro_r: 0.9703, micro_f1: 0.9755
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 315, loss: 0.0250, acc: 0.9874, micro_p: 0.9808, micro_r: 0.9703, micro_f1: 0.9755
2020-10-27 18:43:57 - INFO - train_bert_crf.py - Training...Epoches: 9, steps: 320, loss: 0.0235, acc: 0.9885, micro_p: 0.9821, micro_r: 0.9721, micro_f1: 0.9771
INFO:train_bert_crf.py:Training...Epoches: 9, steps: 320, loss: 0.0235, acc: 0.9885, micro_p: 0.9821, micro_r: 0.9721, micro_f1: 0.9771
2020-10-27 18:44:06 - INFO - train_bert_crf.py - === Epoch 9 val ===
INFO:train_bert_crf.py:=== Epoch 9 val ===
2020-10-27 18:45:10 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9096045197740112, 'micro_p': 0.870201096892139, 'micro_r': 0.8439716312056738, 'micro_f1': 0.8568856885688569}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9096045197740112, 'micro_p': 0.870201096892139, 'micro_r': 0.8439716312056738, 'micro_f1': 0.8568856885688569}.
2020-10-27 18:45:10 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8568856885688569 / 0.8581623550401427
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8568856885688569 / 0.8581623550401427
2020-10-27 18:45:10 - INFO - train_bert_crf.py - === Epoch 10 train ===
INFO:train_bert_crf.py:=== Epoch 10 train ===
2020-10-27 18:46:48 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 325, loss: 0.0127, acc: 0.9936, micro_p: 0.9938, micro_r: 0.9817, micro_f1: 0.9877
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 325, loss: 0.0127, acc: 0.9936, micro_p: 0.9938, micro_r: 0.9817, micro_f1: 0.9877
2020-10-27 18:48:34 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 330, loss: 0.0139, acc: 0.9928, micro_p: 0.9841, micro_r: 0.9743, micro_f1: 0.9792
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 330, loss: 0.0139, acc: 0.9928, micro_p: 0.9841, micro_r: 0.9743, micro_f1: 0.9792
2020-10-27 18:50:22 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 335, loss: 0.0147, acc: 0.9911, micro_p: 0.9871, micro_r: 0.9772, micro_f1: 0.9821
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 335, loss: 0.0147, acc: 0.9911, micro_p: 0.9871, micro_r: 0.9772, micro_f1: 0.9821
2020-10-27 18:52:17 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 340, loss: 0.0155, acc: 0.9925, micro_p: 0.9888, micro_r: 0.9799, micro_f1: 0.9844
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 340, loss: 0.0155, acc: 0.9925, micro_p: 0.9888, micro_r: 0.9799, micro_f1: 0.9844
2020-10-27 18:53:51 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 345, loss: 0.0168, acc: 0.9920, micro_p: 0.9878, micro_r: 0.9786, micro_f1: 0.9832
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 345, loss: 0.0168, acc: 0.9920, micro_p: 0.9878, micro_r: 0.9786, micro_f1: 0.9832
2020-10-27 18:55:40 - INFO - train_bert_crf.py - Training...Epoches: 10, steps: 350, loss: 0.0165, acc: 0.9917, micro_p: 0.9883, micro_r: 0.9787, micro_f1: 0.9835
INFO:train_bert_crf.py:Training...Epoches: 10, steps: 350, loss: 0.0165, acc: 0.9917, micro_p: 0.9883, micro_r: 0.9787, micro_f1: 0.9835
2020-10-27 18:56:23 - INFO - train_bert_crf.py - === Epoch 10 val ===
INFO:train_bert_crf.py:=== Epoch 10 val ===
2020-10-27 18:57:26 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9046610169491526, 'micro_p': 0.8724954462659381, 'micro_r': 0.849290780141844, 'micro_f1': 0.8607367475292004}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9046610169491526, 'micro_p': 0.8724954462659381, 'micro_r': 0.849290780141844, 'micro_f1': 0.8607367475292004}.
2020-10-27 18:57:26 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8607367475292004 / 0.8581623550401427
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8607367475292004 / 0.8581623550401427
2020-10-27 18:57:26 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 18:58:10 - INFO - train_bert_crf.py - === Epoch 11 train ===
INFO:train_bert_crf.py:=== Epoch 11 train ===
2020-10-27 18:59:19 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 355, loss: 0.0167, acc: 0.9903, micro_p: 0.9873, micro_r: 0.9710, micro_f1: 0.9791
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 355, loss: 0.0167, acc: 0.9903, micro_p: 0.9873, micro_r: 0.9710, micro_f1: 0.9791
2020-10-27 19:01:04 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 360, loss: 0.0163, acc: 0.9895, micro_p: 0.9867, micro_r: 0.9706, micro_f1: 0.9786
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 360, loss: 0.0163, acc: 0.9895, micro_p: 0.9867, micro_r: 0.9706, micro_f1: 0.9786
2020-10-27 19:02:47 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 365, loss: 0.0147, acc: 0.9915, micro_p: 0.9868, micro_r: 0.9761, micro_f1: 0.9814
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 365, loss: 0.0147, acc: 0.9915, micro_p: 0.9868, micro_r: 0.9761, micro_f1: 0.9814
2020-10-27 19:04:26 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 370, loss: 0.0125, acc: 0.9933, micro_p: 0.9895, micro_r: 0.9800, micro_f1: 0.9847
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 370, loss: 0.0125, acc: 0.9933, micro_p: 0.9895, micro_r: 0.9800, micro_f1: 0.9847
2020-10-27 19:06:22 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 375, loss: 0.0133, acc: 0.9933, micro_p: 0.9883, micro_r: 0.9805, micro_f1: 0.9844
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 375, loss: 0.0133, acc: 0.9933, micro_p: 0.9883, micro_r: 0.9805, micro_f1: 0.9844
2020-10-27 19:08:20 - INFO - train_bert_crf.py - Training...Epoches: 11, steps: 380, loss: 0.0150, acc: 0.9920, micro_p: 0.9895, micro_r: 0.9772, micro_f1: 0.9833
INFO:train_bert_crf.py:Training...Epoches: 11, steps: 380, loss: 0.0150, acc: 0.9920, micro_p: 0.9895, micro_r: 0.9772, micro_f1: 0.9833
2020-10-27 19:09:50 - INFO - train_bert_crf.py - === Epoch 11 val ===
INFO:train_bert_crf.py:=== Epoch 11 val ===
2020-10-27 19:10:57 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9046610169491526, 'micro_p': 0.8715596330275229, 'micro_r': 0.8421985815602837, 'micro_f1': 0.8566275924256087}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9046610169491526, 'micro_p': 0.8715596330275229, 'micro_r': 0.8421985815602837, 'micro_f1': 0.8566275924256087}.
2020-10-27 19:10:57 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8566275924256087 / 0.8607367475292004
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8566275924256087 / 0.8607367475292004
2020-10-27 19:10:57 - INFO - train_bert_crf.py - === Epoch 12 train ===
INFO:train_bert_crf.py:=== Epoch 12 train ===
2020-10-27 19:11:21 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 385, loss: 0.0096, acc: 1.0000, micro_p: 0.9730, micro_r: 1.0000, micro_f1: 0.9863
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 385, loss: 0.0096, acc: 1.0000, micro_p: 0.9730, micro_r: 1.0000, micro_f1: 0.9863
2020-10-27 19:13:13 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 390, loss: 0.0099, acc: 0.9986, micro_p: 0.9877, micro_r: 0.9926, micro_f1: 0.9901
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 390, loss: 0.0099, acc: 0.9986, micro_p: 0.9877, micro_r: 0.9926, micro_f1: 0.9901
2020-10-27 19:14:50 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 395, loss: 0.0099, acc: 0.9980, micro_p: 0.9935, micro_r: 0.9910, micro_f1: 0.9922
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 395, loss: 0.0099, acc: 0.9980, micro_p: 0.9935, micro_r: 0.9910, micro_f1: 0.9922
2020-10-27 19:16:37 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 400, loss: 0.0151, acc: 0.9946, micro_p: 0.9902, micro_r: 0.9858, micro_f1: 0.9880
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 400, loss: 0.0151, acc: 0.9946, micro_p: 0.9902, micro_r: 0.9858, micro_f1: 0.9880
2020-10-27 19:18:23 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 405, loss: 0.0135, acc: 0.9944, micro_p: 0.9913, micro_r: 0.9860, micro_f1: 0.9886
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 405, loss: 0.0135, acc: 0.9944, micro_p: 0.9913, micro_r: 0.9860, micro_f1: 0.9886
2020-10-27 19:20:07 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 410, loss: 0.0124, acc: 0.9950, micro_p: 0.9904, micro_r: 0.9862, micro_f1: 0.9883
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 410, loss: 0.0124, acc: 0.9950, micro_p: 0.9904, micro_r: 0.9862, micro_f1: 0.9883
2020-10-27 19:21:57 - INFO - train_bert_crf.py - Training...Epoches: 12, steps: 415, loss: 0.0123, acc: 0.9948, micro_p: 0.9888, micro_r: 0.9853, micro_f1: 0.9871
INFO:train_bert_crf.py:Training...Epoches: 12, steps: 415, loss: 0.0123, acc: 0.9948, micro_p: 0.9888, micro_r: 0.9853, micro_f1: 0.9871
2020-10-27 19:22:18 - INFO - train_bert_crf.py - === Epoch 12 val ===
INFO:train_bert_crf.py:=== Epoch 12 val ===
2020-10-27 19:23:23 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9028954802259888, 'micro_p': 0.8788990825688073, 'micro_r': 0.849290780141844, 'micro_f1': 0.8638412984670876}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9028954802259888, 'micro_p': 0.8788990825688073, 'micro_r': 0.849290780141844, 'micro_f1': 0.8638412984670876}.
2020-10-27 19:23:23 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8638412984670876 / 0.8607367475292004
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8638412984670876 / 0.8607367475292004
2020-10-27 19:23:23 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 19:24:07 - INFO - train_bert_crf.py - === Epoch 13 train ===
INFO:train_bert_crf.py:=== Epoch 13 train ===
2020-10-27 19:25:33 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 420, loss: 0.0126, acc: 0.9966, micro_p: 0.9891, micro_r: 0.9891, micro_f1: 0.9891
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 420, loss: 0.0126, acc: 0.9966, micro_p: 0.9891, micro_r: 0.9891, micro_f1: 0.9891
2020-10-27 19:27:19 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 425, loss: 0.0092, acc: 0.9959, micro_p: 0.9918, micro_r: 0.9885, micro_f1: 0.9902
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 425, loss: 0.0092, acc: 0.9959, micro_p: 0.9918, micro_r: 0.9885, micro_f1: 0.9902
2020-10-27 19:29:04 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 430, loss: 0.0073, acc: 0.9974, micro_p: 0.9938, micro_r: 0.9928, micro_f1: 0.9933
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 430, loss: 0.0073, acc: 0.9974, micro_p: 0.9938, micro_r: 0.9928, micro_f1: 0.9933
2020-10-27 19:31:13 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 435, loss: 0.0073, acc: 0.9973, micro_p: 0.9923, micro_r: 0.9909, micro_f1: 0.9916
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 435, loss: 0.0073, acc: 0.9973, micro_p: 0.9923, micro_r: 0.9909, micro_f1: 0.9916
2020-10-27 19:32:46 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 440, loss: 0.0072, acc: 0.9975, micro_p: 0.9919, micro_r: 0.9914, micro_f1: 0.9916
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 440, loss: 0.0072, acc: 0.9975, micro_p: 0.9919, micro_r: 0.9914, micro_f1: 0.9916
2020-10-27 19:34:25 - INFO - train_bert_crf.py - Training...Epoches: 13, steps: 445, loss: 0.0069, acc: 0.9971, micro_p: 0.9933, micro_r: 0.9910, micro_f1: 0.9922
INFO:train_bert_crf.py:Training...Epoches: 13, steps: 445, loss: 0.0069, acc: 0.9971, micro_p: 0.9933, micro_r: 0.9910, micro_f1: 0.9922
2020-10-27 19:35:27 - INFO - train_bert_crf.py - === Epoch 13 val ===
INFO:train_bert_crf.py:=== Epoch 13 val ===
2020-10-27 19:36:32 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.900776836158192, 'micro_p': 0.8809523809523809, 'micro_r': 0.8528368794326241, 'micro_f1': 0.8666666666666667}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.900776836158192, 'micro_p': 0.8809523809523809, 'micro_r': 0.8528368794326241, 'micro_f1': 0.8666666666666667}.
2020-10-27 19:36:32 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8666666666666667 / 0.8638412984670876
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8666666666666667 / 0.8638412984670876
2020-10-27 19:36:32 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 19:37:15 - INFO - train_bert_crf.py - === Epoch 14 train ===
INFO:train_bert_crf.py:=== Epoch 14 train ===
2020-10-27 19:38:09 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 450, loss: 0.0185, acc: 1.0000, micro_p: 0.9946, micro_r: 1.0000, micro_f1: 0.9973
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 450, loss: 0.0185, acc: 1.0000, micro_p: 0.9946, micro_r: 1.0000, micro_f1: 0.9973
2020-10-27 19:39:50 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 455, loss: 0.0073, acc: 0.9988, micro_p: 0.9958, micro_r: 0.9979, micro_f1: 0.9969
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 455, loss: 0.0073, acc: 0.9988, micro_p: 0.9958, micro_r: 0.9979, micro_f1: 0.9969
2020-10-27 19:41:31 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 460, loss: 0.0123, acc: 0.9959, micro_p: 0.9913, micro_r: 0.9938, micro_f1: 0.9926
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 460, loss: 0.0123, acc: 0.9959, micro_p: 0.9913, micro_r: 0.9938, micro_f1: 0.9926
2020-10-27 19:43:25 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 465, loss: 0.0104, acc: 0.9965, micro_p: 0.9916, micro_r: 0.9933, micro_f1: 0.9924
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 465, loss: 0.0104, acc: 0.9965, micro_p: 0.9916, micro_r: 0.9933, micro_f1: 0.9924
2020-10-27 19:45:16 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 470, loss: 0.0098, acc: 0.9973, micro_p: 0.9931, micro_r: 0.9943, micro_f1: 0.9937
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 470, loss: 0.0098, acc: 0.9973, micro_p: 0.9931, micro_r: 0.9943, micro_f1: 0.9937
2020-10-27 19:47:05 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 475, loss: 0.0095, acc: 0.9971, micro_p: 0.9934, micro_r: 0.9929, micro_f1: 0.9931
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 475, loss: 0.0095, acc: 0.9971, micro_p: 0.9934, micro_r: 0.9929, micro_f1: 0.9931
2020-10-27 19:48:42 - INFO - train_bert_crf.py - Training...Epoches: 14, steps: 480, loss: 0.0088, acc: 0.9968, micro_p: 0.9942, micro_r: 0.9920, micro_f1: 0.9931
INFO:train_bert_crf.py:Training...Epoches: 14, steps: 480, loss: 0.0088, acc: 0.9968, micro_p: 0.9942, micro_r: 0.9920, micro_f1: 0.9931
2020-10-27 19:48:51 - INFO - train_bert_crf.py - === Epoch 14 val ===
INFO:train_bert_crf.py:=== Epoch 14 val ===
2020-10-27 19:49:56 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9127824858757062, 'micro_p': 0.8768115942028986, 'micro_r': 0.8581560283687943, 'micro_f1': 0.8673835125448028}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9127824858757062, 'micro_p': 0.8768115942028986, 'micro_r': 0.8581560283687943, 'micro_f1': 0.8673835125448028}.
2020-10-27 19:49:56 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8673835125448028 / 0.8666666666666667
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8673835125448028 / 0.8666666666666667
2020-10-27 19:49:56 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 19:50:39 - INFO - train_bert_crf.py - === Epoch 15 train ===
INFO:train_bert_crf.py:=== Epoch 15 train ===
2020-10-27 19:52:25 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 485, loss: 0.0080, acc: 0.9989, micro_p: 0.9844, micro_r: 0.9974, micro_f1: 0.9908
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 485, loss: 0.0080, acc: 0.9989, micro_p: 0.9844, micro_r: 0.9974, micro_f1: 0.9908
2020-10-27 19:54:09 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 490, loss: 0.0066, acc: 0.9986, micro_p: 0.9874, micro_r: 0.9958, micro_f1: 0.9916
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 490, loss: 0.0066, acc: 0.9986, micro_p: 0.9874, micro_r: 0.9958, micro_f1: 0.9916
2020-10-27 19:55:52 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 495, loss: 0.0067, acc: 0.9971, micro_p: 0.9918, micro_r: 0.9954, micro_f1: 0.9936
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 495, loss: 0.0067, acc: 0.9971, micro_p: 0.9918, micro_r: 0.9954, micro_f1: 0.9936
2020-10-27 19:57:49 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 500, loss: 0.0057, acc: 0.9975, micro_p: 0.9938, micro_r: 0.9952, micro_f1: 0.9945
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 500, loss: 0.0057, acc: 0.9975, micro_p: 0.9938, micro_r: 0.9952, micro_f1: 0.9945
2020-10-27 19:59:36 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 505, loss: 0.0063, acc: 0.9975, micro_p: 0.9934, micro_r: 0.9951, micro_f1: 0.9942
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 505, loss: 0.0063, acc: 0.9975, micro_p: 0.9934, micro_r: 0.9951, micro_f1: 0.9942
2020-10-27 20:01:31 - INFO - train_bert_crf.py - Training...Epoches: 15, steps: 510, loss: 0.0058, acc: 0.9978, micro_p: 0.9940, micro_r: 0.9954, micro_f1: 0.9947
INFO:train_bert_crf.py:Training...Epoches: 15, steps: 510, loss: 0.0058, acc: 0.9978, micro_p: 0.9940, micro_r: 0.9954, micro_f1: 0.9947
2020-10-27 20:02:18 - INFO - train_bert_crf.py - === Epoch 15 val ===
INFO:train_bert_crf.py:=== Epoch 15 val ===
2020-10-27 20:03:25 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9057203389830508, 'micro_p': 0.8745519713261649, 'micro_r': 0.8652482269503546, 'micro_f1': 0.8698752228163994}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9057203389830508, 'micro_p': 0.8745519713261649, 'micro_r': 0.8652482269503546, 'micro_f1': 0.8698752228163994}.
2020-10-27 20:03:25 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8698752228163994 / 0.8673835125448028
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8698752228163994 / 0.8673835125448028
2020-10-27 20:03:25 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 20:04:08 - INFO - train_bert_crf.py - === Epoch 16 train ===
INFO:train_bert_crf.py:=== Epoch 16 train ===
2020-10-27 20:05:19 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 515, loss: 0.0016, acc: 0.9991, micro_p: 1.0000, micro_r: 0.9955, micro_f1: 0.9977
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 515, loss: 0.0016, acc: 0.9991, micro_p: 1.0000, micro_r: 0.9955, micro_f1: 0.9977
2020-10-27 20:06:58 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 520, loss: 0.0014, acc: 0.9997, micro_p: 1.0000, micro_r: 0.9983, micro_f1: 0.9992
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 520, loss: 0.0014, acc: 0.9997, micro_p: 1.0000, micro_r: 0.9983, micro_f1: 0.9992
2020-10-27 20:08:59 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 525, loss: 0.0040, acc: 0.9994, micro_p: 0.9960, micro_r: 0.9970, micro_f1: 0.9965
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 525, loss: 0.0040, acc: 0.9994, micro_p: 0.9960, micro_r: 0.9970, micro_f1: 0.9965
2020-10-27 20:11:00 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 530, loss: 0.0039, acc: 0.9987, micro_p: 0.9957, micro_r: 0.9957, micro_f1: 0.9957
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 530, loss: 0.0039, acc: 0.9987, micro_p: 0.9957, micro_r: 0.9957, micro_f1: 0.9957
2020-10-27 20:12:37 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 535, loss: 0.0049, acc: 0.9982, micro_p: 0.9955, micro_r: 0.9949, micro_f1: 0.9952
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 535, loss: 0.0049, acc: 0.9982, micro_p: 0.9955, micro_r: 0.9949, micro_f1: 0.9952
2020-10-27 20:14:18 - INFO - train_bert_crf.py - Training...Epoches: 16, steps: 540, loss: 0.0042, acc: 0.9985, micro_p: 0.9961, micro_r: 0.9957, micro_f1: 0.9959
INFO:train_bert_crf.py:Training...Epoches: 16, steps: 540, loss: 0.0042, acc: 0.9985, micro_p: 0.9961, micro_r: 0.9957, micro_f1: 0.9959
2020-10-27 20:15:35 - INFO - train_bert_crf.py - === Epoch 16 val ===
INFO:train_bert_crf.py:=== Epoch 16 val ===
2020-10-27 20:16:42 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9113700564971752, 'micro_p': 0.8868613138686131, 'micro_r': 0.8617021276595744, 'micro_f1': 0.8741007194244603}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9113700564971752, 'micro_p': 0.8868613138686131, 'micro_r': 0.8617021276595744, 'micro_f1': 0.8741007194244603}.
2020-10-27 20:16:42 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8741007194244603 / 0.8698752228163994
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8741007194244603 / 0.8698752228163994
2020-10-27 20:16:42 - INFO - train_bert_crf.py - Best ckpt and saved.
INFO:train_bert_crf.py:Best ckpt and saved.
2020-10-27 20:17:27 - INFO - train_bert_crf.py - === Epoch 17 train ===
INFO:train_bert_crf.py:=== Epoch 17 train ===
2020-10-27 20:17:52 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 545, loss: 0.0252, acc: 0.9878, micro_p: 1.0000, micro_r: 0.9868, micro_f1: 0.9934
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 545, loss: 0.0252, acc: 0.9878, micro_p: 1.0000, micro_r: 0.9868, micro_f1: 0.9934
2020-10-27 20:19:29 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 550, loss: 0.0052, acc: 0.9980, micro_p: 1.0000, micro_r: 0.9975, micro_f1: 0.9988
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 550, loss: 0.0052, acc: 0.9980, micro_p: 1.0000, micro_r: 0.9975, micro_f1: 0.9988
2020-10-27 20:21:17 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 555, loss: 0.0044, acc: 0.9987, micro_p: 0.9960, micro_r: 0.9973, micro_f1: 0.9967
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 555, loss: 0.0044, acc: 0.9987, micro_p: 0.9960, micro_r: 0.9973, micro_f1: 0.9967
2020-10-27 20:23:30 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 560, loss: 0.0036, acc: 0.9988, micro_p: 0.9967, micro_r: 0.9975, micro_f1: 0.9971
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 560, loss: 0.0036, acc: 0.9988, micro_p: 0.9967, micro_r: 0.9975, micro_f1: 0.9971
2020-10-27 20:25:07 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 565, loss: 0.0036, acc: 0.9989, micro_p: 0.9967, micro_r: 0.9974, micro_f1: 0.9970
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 565, loss: 0.0036, acc: 0.9989, micro_p: 0.9967, micro_r: 0.9974, micro_f1: 0.9970
2020-10-27 20:26:52 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 570, loss: 0.0039, acc: 0.9989, micro_p: 0.9957, micro_r: 0.9968, micro_f1: 0.9962
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 570, loss: 0.0039, acc: 0.9989, micro_p: 0.9957, micro_r: 0.9968, micro_f1: 0.9962
2020-10-27 20:28:46 - INFO - train_bert_crf.py - Training...Epoches: 17, steps: 575, loss: 0.0042, acc: 0.9984, micro_p: 0.9960, micro_r: 0.9960, micro_f1: 0.9960
INFO:train_bert_crf.py:Training...Epoches: 17, steps: 575, loss: 0.0042, acc: 0.9984, micro_p: 0.9960, micro_r: 0.9960, micro_f1: 0.9960
2020-10-27 20:29:14 - INFO - train_bert_crf.py - === Epoch 17 val ===
INFO:train_bert_crf.py:=== Epoch 17 val ===
2020-10-27 20:30:21 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.899364406779661, 'micro_p': 0.8831168831168831, 'micro_r': 0.8439716312056738, 'micro_f1': 0.8631006346328197}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.899364406779661, 'micro_p': 0.8831168831168831, 'micro_r': 0.8439716312056738, 'micro_f1': 0.8631006346328197}.
2020-10-27 20:30:21 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8631006346328197 / 0.8741007194244603
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8631006346328197 / 0.8741007194244603
2020-10-27 20:30:21 - INFO - train_bert_crf.py - === Epoch 18 train ===
INFO:train_bert_crf.py:=== Epoch 18 train ===
2020-10-27 20:31:54 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 580, loss: 0.0052, acc: 0.9952, micro_p: 0.9968, micro_r: 0.9935, micro_f1: 0.9952
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 580, loss: 0.0052, acc: 0.9952, micro_p: 0.9968, micro_r: 0.9935, micro_f1: 0.9952
2020-10-27 20:33:44 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 585, loss: 0.0034, acc: 0.9972, micro_p: 0.9955, micro_r: 0.9955, micro_f1: 0.9955
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 585, loss: 0.0034, acc: 0.9972, micro_p: 0.9955, micro_r: 0.9955, micro_f1: 0.9955
2020-10-27 20:35:34 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 590, loss: 0.0027, acc: 0.9982, micro_p: 0.9962, micro_r: 0.9971, micro_f1: 0.9966
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 590, loss: 0.0027, acc: 0.9982, micro_p: 0.9962, micro_r: 0.9971, micro_f1: 0.9966
2020-10-27 20:37:31 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 595, loss: 0.0033, acc: 0.9981, micro_p: 0.9965, micro_r: 0.9958, micro_f1: 0.9962
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 595, loss: 0.0033, acc: 0.9981, micro_p: 0.9965, micro_r: 0.9958, micro_f1: 0.9962
2020-10-27 20:39:09 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 600, loss: 0.0039, acc: 0.9983, micro_p: 0.9949, micro_r: 0.9960, micro_f1: 0.9955
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 600, loss: 0.0039, acc: 0.9983, micro_p: 0.9949, micro_r: 0.9960, micro_f1: 0.9955
2020-10-27 20:40:59 - INFO - train_bert_crf.py - Training...Epoches: 18, steps: 605, loss: 0.0045, acc: 0.9982, micro_p: 0.9938, micro_r: 0.9952, micro_f1: 0.9945
INFO:train_bert_crf.py:Training...Epoches: 18, steps: 605, loss: 0.0045, acc: 0.9982, micro_p: 0.9938, micro_r: 0.9952, micro_f1: 0.9945
2020-10-27 20:42:04 - INFO - train_bert_crf.py - === Epoch 18 val ===
INFO:train_bert_crf.py:=== Epoch 18 val ===
2020-10-27 20:43:11 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.8877118644067796, 'micro_p': 0.8969465648854962, 'micro_r': 0.8333333333333334, 'micro_f1': 0.8639705882352942}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.8877118644067796, 'micro_p': 0.8969465648854962, 'micro_r': 0.8333333333333334, 'micro_f1': 0.8639705882352942}.
2020-10-27 20:43:11 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.8639705882352942 / 0.8741007194244603
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.8639705882352942 / 0.8741007194244603
2020-10-27 20:43:11 - INFO - train_bert_crf.py - === Epoch 19 train ===
INFO:train_bert_crf.py:=== Epoch 19 train ===
2020-10-27 20:43:55 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 610, loss: 0.0118, acc: 0.9857, micro_p: 1.0000, micro_r: 0.9801, micro_f1: 0.9900
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 610, loss: 0.0118, acc: 0.9857, micro_p: 1.0000, micro_r: 0.9801, micro_f1: 0.9900
2020-10-27 20:45:37 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 615, loss: 0.0071, acc: 0.9905, micro_p: 0.9980, micro_r: 0.9861, micro_f1: 0.9920
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 615, loss: 0.0071, acc: 0.9905, micro_p: 0.9980, micro_r: 0.9861, micro_f1: 0.9920
2020-10-27 20:47:21 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 620, loss: 0.0054, acc: 0.9945, micro_p: 0.9977, micro_r: 0.9919, micro_f1: 0.9948
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 620, loss: 0.0054, acc: 0.9945, micro_p: 0.9977, micro_r: 0.9919, micro_f1: 0.9948
2020-10-27 20:48:55 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 625, loss: 0.0057, acc: 0.9957, micro_p: 0.9967, micro_r: 0.9934, micro_f1: 0.9951
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 625, loss: 0.0057, acc: 0.9957, micro_p: 0.9967, micro_r: 0.9934, micro_f1: 0.9951
2020-10-27 20:49:10 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 630, loss: 0.0047, acc: 0.9967, micro_p: 0.9974, micro_r: 0.9949, micro_f1: 0.9962
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 630, loss: 0.0047, acc: 0.9967, micro_p: 0.9974, micro_r: 0.9949, micro_f1: 0.9962
2020-10-27 20:49:24 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 635, loss: 0.0051, acc: 0.9966, micro_p: 0.9964, micro_r: 0.9944, micro_f1: 0.9954
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 635, loss: 0.0051, acc: 0.9966, micro_p: 0.9964, micro_r: 0.9944, micro_f1: 0.9954
2020-10-27 20:49:40 - INFO - train_bert_crf.py - Training...Epoches: 19, steps: 640, loss: 0.0064, acc: 0.9969, micro_p: 0.9960, micro_r: 0.9947, micro_f1: 0.9954
INFO:train_bert_crf.py:Training...Epoches: 19, steps: 640, loss: 0.0064, acc: 0.9969, micro_p: 0.9960, micro_r: 0.9947, micro_f1: 0.9954
2020-10-27 20:49:41 - INFO - train_bert_crf.py - === Epoch 19 val ===
INFO:train_bert_crf.py:=== Epoch 19 val ===
2020-10-27 20:49:47 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.900776836158192, 'micro_p': 0.8949343339587242, 'micro_r': 0.8457446808510638, 'micro_f1': 0.869644484958979}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.900776836158192, 'micro_p': 0.8949343339587242, 'micro_r': 0.8457446808510638, 'micro_f1': 0.869644484958979}.
2020-10-27 20:49:47 - INFO - train_bert_crf.py - Metric micro_f1 current / best: 0.869644484958979 / 0.8741007194244603
INFO:train_bert_crf.py:Metric micro_f1 current / best: 0.869644484958979 / 0.8741007194244603
2020-10-27 20:49:47 - INFO - train_bert_crf.py - Best micro_f1 on val set: 0.874101
INFO:train_bert_crf.py:Best micro_f1 on val set: 0.874101
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Evaluation result: {'acc': 0.9113700564971752, 'micro_p': 0.8868613138686131, 'micro_r': 0.8617021276595744, 'micro_f1': 0.8741007194244603}.
INFO:train_bert_crf.py:Evaluation result: {'acc': 0.9113700564971752, 'micro_p': 0.8868613138686131, 'micro_r': 0.8617021276595744, 'micro_f1': 0.8741007194244603}.
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Test set results:
INFO:train_bert_crf.py:Test set results:
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Accuracy: 0.9113700564971752
INFO:train_bert_crf.py:Accuracy: 0.9113700564971752
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Micro precision: 0.8868613138686131
INFO:train_bert_crf.py:Micro precision: 0.8868613138686131
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Micro recall: 0.8617021276595744
INFO:train_bert_crf.py:Micro recall: 0.8617021276595744
2020-10-27 20:49:54 - INFO - train_bert_crf.py - Micro F1: 0.8741007194244603
INFO:train_bert_crf.py:Micro F1: 0.8741007194244603
